/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v2.11.0.

#include <gtest/gtest.h>

#include "portdnn/padding_mode.h"

#include "portdnn/pooling/operators.h"

#include "test/types/cartesian_product.h"
#include "test/types/data_format_types.h"
#include "test/types/kernel_data_types.h"
#include "test/types/nested_pairs_to_triple.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include "test/pooling/pooling_fixture.h"

#include <array>
#include <vector>

using namespace sycldnn;  // NOLINT(google-build-using-namespace)
using DataTypeList = sycldnn::types::KernelDataTypes;
using DataFormatList = sycldnn::types::DataFormatTypes;
using BackendList = sycldnn::types::DefaultBackendTypes;

using SNNTypePairs =
    sycldnn::types::CartesianProduct<DataTypeList, DataFormatList>::type;
using SNNTypeBackendPairs =
    sycldnn::types::CartesianProduct<SNNTypePairs, BackendList>::type;
using TestTriples =
    sycldnn::types::NestedPairsToTriple<SNNTypeBackendPairs>::type;
using GTestTypeTriples = sycldnn::types::ToGTestTypes<TestTriples>::type;

template <typename Triple>
using AvgWindow7Stride1Grad =
    PoolingFixture<typename Triple::FirstType, typename Triple::SecondType,
                   typename Triple::ThirdType, pooling::Average,
                   pooling::Backpropagate>;
TYPED_TEST_SUITE(AvgWindow7Stride1Grad, GTestTypeTriples);
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.15218253968254,   8.794019274376419,  10.836082766439908,
      13.43846371882086,  14.767630385487529, 12.924773242630383,
      11.262471655328797, 9.729138321995464,  10.870209750566895,
      13.2671485260771,   16.213973922902493, 19.93064058956916,
      21.509807256235824, 18.69552154195011,  16.19988662131519,
      13.931859410430839, 16.22060657596372,  19.6889739229025,
      23.913577097505666, 29.196910430838997, 31.06774376417233,
      26.85345804988662,  23.163378684807256, 19.847732426303853,
      23.856320861678007, 28.838973922902497, 34.86357709750566,
      42.346910430839,    44.567743764172334, 38.35345804988661,
      32.96337868480725,  28.16201814058957,  34.48965419501134,
      41.47230725623584,  49.83024376417234,  60.113577097505676,
      62.33441043083901,  53.32012471655329,  45.59671201814059,
      38.7953514739229,   32.93013038548752,  39.54135487528345,
      47.43262471655329,  57.11595804988662,  58.98679138321995,
      50.372505668934245, 43.01575963718821,  36.557256235827666,
      30.61782879818594,  36.72905328798186,  44.0092120181406,
      52.925878684807266, 54.505045351473925, 46.49075963718821,
      39.66179138321995,  33.679478458049886, 27.76782879818594,
      33.287216553287976, 39.85308956916101,  47.884041950113385,
      49.21320861678005,  41.94178004535147,  35.75566893424036,
      30.344784580498867};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612,  0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.04081632653061224,  0.08163265306122448,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.12244897959183673,  0.08163265306122448,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.12244897959183673,
      0.08163265306122448,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.12244897959183673,  0.08163265306122448,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.12244897959183673,  0.08163265306122448,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.12244897959183673,
      0.08163265306122448,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.12244897959183673,  0.061224489795918366,
      0.14285714285714285,  0.14285714285714285,  0.14285714285714285,
      0.14285714285714285,  0.14285714285714285,  0.14285714285714285,
      0.08163265306122448};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.72748866213152,  14.30436507936508,  16.90265873015873,
      17.588038548752838, 20.860198412698413, 21.672165532879816,
      25.91305555555556,  26.87692743764172,  28.571388888888887,
      29.535260770975057, 25.037579365079367, 25.849546485260767,
      21.839563492063494, 22.524943310657594, 18.88140022675737,
      19.458276643990928, 21.055039682539682, 21.74041950113379,
      25.720005668934242, 26.5342970521542,   31.46325963718821,
      32.42794784580499,  38.716116780045354, 39.86128117913832,
      41.874450113378686, 43.01961451247165,  36.426354875283444,
      37.39104308390022,  31.58548185941043,  32.39977324263038,
      27.17833900226757,  27.863718820861678, 31.629246031746028,
      32.44121315192744,  38.41325963718821,  39.377947845805,
      46.68429138321996,  47.82715419501133,  57.037148526077104,
      58.393820861677995, 60.77881519274377,  62.13548752834466,
      52.564053287981864, 53.70691609977324,  45.362069160997734,
      46.32675736961451,  38.88349773242631,  39.69546485260771,
      46.74876984126984,  47.712641723356015, 56.532783446712024,
      57.677947845804994, 68.37048185941043,  69.72715419501132,
      83.08333900226756,  84.693820861678,    87.52500566893423,
      89.13548752834467,  75.35024376417233,  76.70691609977322,
      64.78159297052154,  65.9267573696145,   55.360164399092966,
      56.32403628117914,  68.0154365079365,   68.97930839002268,
      81.79945011337868,  82.94461451247167,  98.30381519274377,
      99.66048752834467,  118.6166723356009,  120.22715419501135,
      123.05833900226756, 124.66882086167801, 105.28357709750567,
      106.64024943310658, 90.04825963718821,  91.19342403628119,
      76.62683106575963,  77.5907029478458,   65.04829365079365,
      65.86026077097505,  78.11802154195011,  79.0827097505669,
      93.7223866213152,   94.86524943310658,  112.87524376417234,
      114.23191609977324, 116.616910430839,   117.9735827664399,
      99.6021485260771,   100.74501133786849, 85.06683106575963,
      86.03151927437642,  72.30254535147392,  73.11451247165533,
      60.55027777777778,  61.23565759637188,  72.64381519274376,
      73.45810657596373,  87.0537358276644,   88.0184240362812,
      104.70659297052154, 105.85175736961453, 107.86492630385487,
      109.01009070294785, 92.01683106575963,  92.98151927437642,
      78.50929138321995,  79.3235827664399,   66.67357709750567,
      67.35895691609977,  54.95878117913832,  55.53565759637188,
      65.88905328798187,  66.57443310657595,  78.89421201814059,
      79.70617913832201,  94.80421201814059,  95.76808390022677,
      97.46254535147392,  98.4264172335601,   83.07159297052154,
      83.88356009070294,  70.82595804988662,  71.51133786848072,
      60.11269274376417,  60.689569160997735};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.20408163265306123,
      0.24489795918367346, 0.12244897959183672, 0.16326530612244897,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.20408163265306123,
      0.24489795918367346, 0.1020408163265306,  0.12244897959183673,
      0.24489795918367346, 0.2857142857142857,  0.24489795918367346,
      0.2857142857142857,  0.24489795918367346, 0.2857142857142857,
      0.24489795918367346, 0.2857142857142857,  0.24489795918367346,
      0.2857142857142857,  0.24489795918367346, 0.2857142857142857,
      0.14285714285714285, 0.16326530612244897};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907029477, 27.45497732426304,  28.031853741496597,
      28.60873015873016,  33.119937641723354, 33.80531746031746,
      34.49069727891156,  35.176077097505676, 40.90842970521542,
      41.720396825396826, 42.532363945578226, 43.34433106575963,
      50.862239229024944, 51.82611111111112,  52.78998299319728,
      53.75385487528344,  56.178905895691614, 57.14277777777777,
      58.10664965986395,  59.070521541950114, 49.263191609977326,
      50.07515873015873,  50.88712585034013,  51.699092970521534,
      42.993747165532874, 43.67912698412699,  44.36450680272108,
      45.04988662131519,  37.18592403628118,  37.76280045351474,
      38.33967687074829,  38.916553287981856, 41.42469954648526,
      42.110079365079365, 42.795459183673465, 43.48083900226758,
      50.62571995464852,  51.440011337868484, 52.25430272108843,
      53.0685941043084,   61.961831065759625, 62.92651927437642,
      63.89120748299319,  64.85589569160997,  76.28706916099772,
      77.43223356009071,  78.57739795918367,  79.72256235827663,
      82.6037358276644,   83.74890022675737,  84.89406462585035,
      86.0392290249433,   71.88802154195011,  72.85270975056689,
      73.81739795918367,  74.78208616780044,  62.356672335600905,
      63.17096371882086,  63.98525510204081,  64.79954648526076,
      53.67129818594104,  54.35667800453514,  55.04205782312925,
      55.727437641723355, 62.446524943310656, 63.258492063492056,
      64.07045918367346,  64.88242630385488,  75.86183106575963,
      76.82651927437642,  77.79120748299319,  78.75589569161,
      92.2257199546485,   93.36858276643991,  94.51144557823127,
      95.65430839002266,  112.71762471655326, 114.07429705215421,
      115.4309693877551,  116.78764172335599, 120.20095804988661,
      121.55763038548754, 122.91430272108843, 124.27097505668932,
      103.98524376417232, 105.12810657596373, 106.27096938775509,
      107.41383219954648, 89.75945011337868,  90.72413832199547,
      91.68882653061223,  92.65351473922902,  76.9550283446712,
      77.76699546485261,  78.578962585034,    79.39092970521541,
      92.53366780045351,  93.49753968253968,  94.46141156462583,
      95.42528344671203,  111.92040249433107, 113.06556689342405,
      114.21073129251698, 115.35589569160999, 135.38429138321993,
      136.74096371882086, 138.09763605442174, 139.45430839002265,
      164.5561961451247,  166.16667800453513, 167.77715986394557,
      169.387641723356,   173.43952947845804, 175.05001133786845,
      176.66049319727892, 178.27097505668934, 149.3438151927438,
      150.70048752834467, 152.05715986394554, 153.41383219954645,
      128.4180215419501,  129.5631859410431,  130.70835034013604,
      131.853514739229,   109.75645691609976, 110.72032879818593,
      111.68420068027211, 112.64807256235828, 135.06700113378685,
      136.030873015873,   136.99474489795915, 137.95861678004536,
      162.45373582766442, 163.59890022675737, 164.74406462585029,
      165.88922902494335, 195.25095804988663, 196.60763038548754,
      197.9643027210884,  199.32097505668935, 235.62286281179135,
      237.2333446712018,  238.8438265306122,  240.4543083900227,
      244.5061961451247,  246.11667800453512, 247.72715986394553,
      249.33764172335603, 209.21048185941046, 210.56715419501134,
      211.92382653061222, 213.28049886621315, 178.95135487528344,
      180.09651927437642, 181.24168367346937, 182.38684807256237,
      152.2897902494331,  153.25366213151926, 154.21753401360544,
      155.1814058956916,  129.2846201814059,  130.0965873015873,
      130.90855442176868, 131.7205215419501,  155.27135487528346,
      156.23604308390023, 157.20073129251696, 158.1654195011338,
      186.301910430839,   187.4447732426304,  188.58763605442172,
      189.73049886621317, 224.39381519274377, 225.75048752834468,
      227.10715986394555, 228.4638321995465,  231.8771485260771,
      233.233820861678,   234.59049319727885, 235.9471655328798,
      198.06143424036284, 199.2042970521542,  200.34715986394554,
      201.49002267573698, 169.1689739229025,  170.13366213151926,
      171.09835034013605, 172.06303854875284, 143.79312358276644,
      144.60509070294785, 145.41705782312928, 146.22902494331066,
      120.41517573696144, 121.10055555555556, 121.78593537414966,
      122.47131519274376, 144.47333900226758, 145.28763038548752,
      146.10192176870743, 146.91621315192745, 173.14278344671206,
      174.1074716553288,  175.07215986394553, 176.0368480725624,
      208.26802154195013, 209.41318594104308, 210.55835034013603,
      211.70351473922906, 214.5846882086168,  215.72985260770974,
      216.8750170068027,  218.0201814058957,  183.0689739229025,
      184.03366213151926, 184.99835034013603, 185.96303854875285,
      156.20429138321995, 157.0185827664399,  157.8328741496599,
      158.6471655328798,  132.6617743764172,  133.34715419501134,
      134.03253401360547, 134.71791383219954, 109.34068594104308,
      109.91756235827664, 110.49443877551022, 111.07131519274375,
      131.0927267573696,  131.77810657596373, 132.4634863945578,
      133.1488662131519,  156.9764569160998,  157.78842403628119,
      158.60039115646254, 159.41235827664403, 188.64455215419503,
      189.60842403628118, 190.5722959183673,  191.53616780045354,
      193.9612188208617,  194.92509070294784, 195.888962585034,
      196.8528344671202,  165.33121882086166, 166.14318594104307,
      166.9551530612245,  167.7671201814059,  140.96653628117912,
      141.65191609977325, 142.33729591836737, 143.02267573696145,
      119.64850907029479, 120.22538548752834, 120.8022619047619,
      121.37913832199547};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.1020408163265306,  0.12244897959183673,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.2857142857142857,  0.32653061224489793,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.36734693877551017, 0.40816326530612246, 0.44897959183673464,
      0.4897959183673469,  0.2040816326530612,  0.24489795918367344,
      0.2857142857142857,  0.32653061224489793, 0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.36734693877551017,
      0.40816326530612246, 0.44897959183673464, 0.4897959183673469,
      0.2040816326530612,  0.24489795918367344, 0.2857142857142857,
      0.32653061224489793, 0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.36734693877551017, 0.40816326530612246,
      0.44897959183673464, 0.4897959183673469,  0.2040816326530612,
      0.24489795918367344, 0.2857142857142857,  0.32653061224489793,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.36734693877551017, 0.40816326530612246, 0.44897959183673464,
      0.4897959183673469,  0.2040816326530612,  0.24489795918367344,
      0.2857142857142857,  0.32653061224489793, 0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.36734693877551017,
      0.40816326530612246, 0.44897959183673464, 0.4897959183673469,
      0.2040816326530612,  0.24489795918367344, 0.2857142857142857,
      0.32653061224489793, 0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.36734693877551017, 0.40816326530612246,
      0.44897959183673464, 0.4897959183673469,  0.18367346938775508,
      0.2040816326530612,  0.22448979591836732, 0.24489795918367346,
      0.44897959183673464, 0.4897959183673469,  0.5306122448979591,
      0.5714285714285714,  0.44897959183673464, 0.4897959183673469,
      0.5306122448979591,  0.5714285714285714,  0.44897959183673464,
      0.4897959183673469,  0.5306122448979591,  0.5714285714285714,
      0.44897959183673464, 0.4897959183673469,  0.5306122448979591,
      0.5714285714285714,  0.44897959183673464, 0.4897959183673469,
      0.5306122448979591,  0.5714285714285714,  0.44897959183673464,
      0.4897959183673469,  0.5306122448979591,  0.5714285714285714,
      0.26530612244897955, 0.2857142857142857,  0.3061224489795918,
      0.32653061224489793};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.882772108843537,  9.66202380952381,   11.549778911564626,
      13.87874716553288,  14.47124716553288,  16.30922335600907,
      14.486604308390024, 12.815856009070295, 11.036604308390022,
      12.034812925170067, 14.65079931972789,  17.395697278911566,
      20.748475056689344, 21.276689342403625, 23.63609410430839,
      20.884903628117918, 18.39782879818594,  15.781842403628119,
      18.0181462585034,   21.824608843537412, 25.783792517006805,
      30.581014739229026, 30.959229024943305, 34.001967120181405,
      29.9174433106576,   26.263701814058955, 22.457239229024943,
      26.56528911564626,  32.057465986394554, 37.73093537414966,
      44.561490929705215, 44.66970521541949,  48.62244331065759,
      42.63791950113379,  37.32703514739229,  31.834858276643992,
      38.52778911564626,  46.26996598639456,  54.193435374149665,
      63.64899092970522,  62.969705215419495, 67.7099433106576,
      59.10041950113378,  51.539535147392286, 43.79735827664399,
      36.81636054421769,  44.158537414965984, 51.653435374149666,
      60.57565759637188,  59.71637188208616,  63.996609977324255,
      55.78708616780045,  48.59763038548753,  41.25545351473922,
      34.2508843537415,   41.04544217687076,  47.968911564625856,
      56.19668934240362,  55.262403628117916, 59.08430839002267,
      51.458117913832204, 44.79247165532879,  37.99791383219955,
      31.075374149659865, 37.21687074829932,  43.46687074829933,
      50.88512471655329,  49.95083900226758,  53.315600907029484,
      46.40369614512471,  40.37070294784581,  34.22920634920635};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.12244897959183673, 0.12244897959183673,  0.12244897959183673,
      0.12244897959183673, 0.10204081632653061,  0.061224489795918366,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.08163265306122448, 0.18367346938775508,  0.30612244897959184,
      0.30612244897959184, 0.30612244897959184,  0.30612244897959184,
      0.30612244897959184, 0.22448979591836732,  0.12244897959183673};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.188667800453512, 15.765544217687074, 18.63866780045351,
      19.32404761904762,  22.3056746031746,   23.099557823129253,
      26.837023809523814, 27.75749433106576,  28.060000000000002,
      28.94249433106576,  31.697976190476187, 32.61844671201814,
      28.179325396825394, 28.97320861678005,  24.946332199546482,
      25.63171201814059,  21.496332199546483, 22.073208616780043,
      23.384246031746027, 24.069625850340135, 28.487307256235823,
      29.30159863945578,  33.84819160997732,  34.79139455782313,
      40.403350340136065, 41.49695011337869,  41.50489795918368,
      42.55337868480725,  46.17858843537415,  47.27218820861678,
      40.826604308390024, 41.769807256235836, 35.98136621315193,
      36.79565759637188,  30.878304988662126, 31.563684807256237,
      35.22432539682539,  36.0362925170068,   42.68452947845804,
      43.649217687074824, 50.45017573696144,  51.56758503401361,
      59.8664455782313,   61.16202947845805,  60.67632653061225,
      61.91845804988661,  66.70835034013605,  68.00393424036281,
      58.717477324263044, 59.8348866213152,   51.56271541950114,
      52.52740362811791,  44.10251133786848,  44.914478458049885,
      52.16670634920634,  53.13057823129252,  62.96976757369613,
      64.11493197278911,  74.13541383219955,  75.46187074829932,
      87.58501700680273,  89.12298185941043,  87.8648979591837,
      89.33941043083898,  95.70692176870749,  97.24488662131517,
      83.94938208616782,  85.27583900226757,  73.50890589569161,
      74.65407029478457,  62.70584467120181,  63.669716553287984,
      76.09170634920633,  77.05557823129251,  91.39476757369613,
      92.53993197278912,  107.06041383219953, 108.38687074829933,
      125.76001700680273, 127.29798185941044, 124.46489795918367,
      125.93941043083899, 133.88192176870749, 135.4198866213152,
      116.8743820861678,  118.20083900226756, 101.9339058956916,
      103.07907029478457, 86.63084467120181,  87.59471655328798,
      72.82075396825397,  73.63272108843537,  87.35238662131518,
      88.31707482993197,  102.18946145124715, 103.30687074829933,
      119.855731292517,   121.15131519274377, 118.19061224489795,
      119.43274376417232, 126.69763605442176, 127.99321995464851,
      110.45676303854874, 111.5741723356009,  96.23057256235828,
      97.19526077097505,  81.69893990929705,  82.51090702947845,
      67.8163888888889,   68.501768707483,    81.27659297052153,
      82.09088435374152,  94.99462018140588,  95.93782312925171,
      111.29977891156462, 112.39337868480725, 109.47632653061224,
      110.52480725623583, 117.07501700680271, 118.16861678004534,
      101.97303287981859, 102.91623582766441, 88.77065192743764,
      89.58494331065758,  75.31044784580499,  75.9958276643991,
      61.57387188208617,  62.15074829931973,  73.74836167800453,
      74.43374149659864,  86.13985827664398,  86.93374149659866,
      100.84977891156461, 101.77024943310659, 99.01918367346937,
      99.90167800453516,  105.710731292517,   106.63120181405897,
      92.01350907029477,  92.80739229024942,  80.0560260770975,
      80.74140589569161,  67.88153628117914,  68.4584126984127};
  const std::array<int, 4> in_shape = {{1, 8, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.18367346938775508,
      0.24489795918367346, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.16326530612244897,
      0.20408163265306123, 0.1020408163265306,  0.12244897959183673,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.14285714285714285, 0.16326530612244897, 0.32653061224489793,
      0.36734693877551017, 0.5510204081632653,  0.6122448979591837,
      0.5510204081632653,  0.6122448979591837,  0.5510204081632653,
      0.6122448979591837,  0.5510204081632653,  0.6122448979591837,
      0.5510204081632653,  0.6122448979591837,  0.4081632653061224,
      0.44897959183673464, 0.22448979591836732, 0.24489795918367346};
  const std::array<int, 4> in_shape = {{1, 8, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.800459183673464, 30.377335600907024, 30.954212018140588,
      31.531088435374148, 36.59195578231292,  37.27733560090702,
      37.96271541950113,  38.64809523809524,  43.81746598639456,
      44.6113492063492,   45.405232426303854, 46.199115646258505,
      52.75357709750567,  53.67404761904763,  54.594518140589564,
      55.51498866213152,  55.23750566893423,  56.120000000000005,
      57.00249433106575,  57.88498866213152,  62.47548185941042,
      63.39595238095237,  64.31642290249434,  65.23689342403628,
      55.56476757369614,  56.35865079365079,  57.15253401360544,
      57.9464172335601,   49.20728458049886,  49.892664399092965,
      50.57804421768707,  51.26342403628118,  42.4157879818594,
      42.992664399092966, 43.56954081632652,  44.146417233560086,
      46.08311224489796,  46.768492063492054, 47.45387188208617,
      48.13925170068027,  56.1603231292517,   56.974614512471646,
      57.788905895691606, 58.60319727891156,  66.75318027210885,
      67.69638321995464,  68.63958616780045,  69.58278911564626,
      79.71310090702949,  80.80670068027213,  81.90030045351473,
      82.99390022675738,  81.96131519274377,  83.00979591836736,
      84.05827664399091,  85.1067573696145,   91.26357709750566,
      92.3571768707483,   93.45077664399092,  94.54437641723356,
      80.71000566893422,  81.65320861678005,  82.59641156462584,
      83.53961451247167,  71.14844104308389,  71.96273242630386,
      72.7770238095238,   73.59131519274376,  61.07123015873015,
      61.75660997732425,  62.44198979591836,  63.127369614512475,
      69.63668367346938,  70.44865079365078,  71.26061791383219,
      72.0725850340136,   84.40437074829931,  85.36905895691608,
      86.33374716553288,  87.29843537414965,  99.78294217687076,
      100.90035147392288, 102.01776077097504, 103.13517006802722,
      118.43730725623585, 119.7328911564626,  121.02847505668933,
      122.3240589569161,  120.11052154195012, 121.3526530612245,
      122.59478458049884, 123.83691609977322, 132.12111678004533,
      133.4167006802721,  134.71228458049885, 136.00786848072562,
      116.3175453514739,  117.43495464852609, 118.55236394557821,
      119.6697732426304,  102.16074263038549, 103.12543083900228,
      104.09011904761903, 105.05480725623582, 87.39305555555555,
      88.20502267573696,  89.01698979591835,  89.82895691609977,
      103.36954081632652, 104.33341269841269, 105.29728458049885,
      106.26115646258503, 124.79437074829933, 125.93953514739226,
      127.08469954648525, 128.22986394557822, 146.94437074829932,
      148.2708276643991,  149.59728458049887, 150.92374149659864,
      173.63206916099776, 175.17003401360546, 176.7079988662131,
      178.24596371882086, 174.255283446712,   175.7297959183674,
      177.20430839002262, 178.67882086167796, 189.87587868480722,
      191.41384353741498, 192.95180839002265, 194.48977324263035,
      166.5723072562358,  167.89876417233563, 169.22522108843535,
      170.55167800453515, 145.87264739229025, 147.01781179138322,
      148.16297619047617, 149.30814058956915, 124.44781746031745,
      125.41168934240362, 126.37556122448976, 127.33943310657597,
      151.21954081632654, 152.18341269841267, 153.14728458049885,
      154.11115646258503, 181.64437074829937, 182.78953514739226,
      183.9346995464852,  185.07986394557824, 212.79437074829934,
      214.12082766439906, 215.44728458049886, 216.77374149659866,
      249.98206916099775, 251.52003401360545, 253.05799886621313,
      254.59596371882088, 247.45528344671206, 248.92979591836735,
      250.40430839002266, 251.87882086167798, 266.22587868480724,
      267.76384353741497, 269.30180839002264, 270.8397732426304,
      232.42230725623583, 233.7487641723356,  235.07522108843534,
      236.4016780045351,  202.72264739229024, 203.8678117913832,
      205.01297619047617, 206.15814058956914, 172.29781746031748,
      173.26168934240363, 174.22556122448978, 175.18943310657596,
      144.82954081632653, 145.64150793650794, 146.45347505668934,
      147.26544217687075, 173.74008503401365, 174.70477324263035,
      175.66946145124712, 176.63414965986394, 203.2615136054422,
      204.3789229024943,  205.49633219954646, 206.61374149659866,
      238.41587868480727, 239.711462585034,   241.00704648526076,
      242.30263038548753, 235.13909297052157, 236.3812244897959,
      237.62335600907025, 238.86548752834463, 252.09968820861678,
      253.39527210884353, 254.69085600907025, 255.98643990929702,
      219.79611678004537, 220.9135260770975,  222.03093537414964,
      223.1483446712018,  191.4964569160998,  192.46114512471655,
      193.42583333333332, 194.3905215419501,  162.5859126984127,
      163.3978798185941,  164.20984693877548, 165.0218140589569,
      134.9473979591837,  135.6327777777778,  136.31815759637186,
      137.003537414966,   161.73889455782316, 162.55318594104307,
      163.367477324263,   164.18176870748303, 189.046037414966,
      189.98924036281176, 190.93244331065756, 191.87564625850342,
      221.50595804988663, 222.59955782312923, 223.69315759637183,
      224.7867573696145,  217.90417233560095, 218.95265306122448,
      220.00113378684804, 221.04961451247166, 233.05643424036282,
      234.15003401360542, 235.24363378684805, 236.33723356009068,
      203.00286281179137, 203.94606575963718, 204.88926870748296,
      205.83247165532882, 176.72701247165534, 177.54130385487528,
      178.35559523809522, 179.16988662131516, 149.93551587301587,
      150.62089569160997, 151.30627551020405, 151.9916553287982,
      122.57086734693878, 123.14774376417235, 123.7246201814059,
      124.30149659863946, 146.81134353741498, 147.49672335600906,
      148.18210317460316, 148.86748299319729, 171.48583333333335,
      172.27971655328795, 173.07359977324262, 173.8674829931973,
      200.77908730158728, 201.69955782312923, 202.62002834467117,
      203.54049886621317, 197.15587301587303, 198.03836734693874,
      198.9208616780045,  199.8033560090703,  210.50099206349208,
      211.421462585034,   212.34193310657594, 213.26240362811794,
      183.2331349206349,  184.02701814058955, 184.82090136054418,
      185.61478458049885, 159.42667233560093, 160.112052154195,
      160.7974319727891,  161.48281179138323, 135.1861961451247,
      135.76307256235827, 136.33994897959184, 136.9168253968254};
  const std::array<int, 4> in_shape = {{1, 8, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.3061224489795918,  0.36734693877551017,
      0.42857142857142855, 0.4897959183673469,  0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.2857142857142857,  0.32653061224489793,
      0.36734693877551017, 0.40816326530612246, 0.18367346938775508,
      0.2040816326530612,  0.22448979591836732, 0.24489795918367346,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.26530612244897955, 0.2857142857142857,  0.3061224489795918,
      0.32653061224489793, 0.6122448979591837,  0.6530612244897959,
      0.693877551020408,   0.7346938775510203,  1.0408163265306123,
      1.1020408163265305,  1.1632653061224487,  1.2244897959183674,
      1.0408163265306123,  1.1020408163265305,  1.1632653061224487,
      1.2244897959183674,  1.0408163265306123,  1.1020408163265305,
      1.1632653061224487,  1.2244897959183674,  1.0408163265306123,
      1.1020408163265305,  1.1632653061224487,  1.2244897959183674,
      1.0408163265306123,  1.1020408163265305,  1.1632653061224487,
      1.2244897959183674,  0.7755102040816326,  0.8163265306122448,
      0.8571428571428571,  0.8979591836734693,  0.42857142857142855,
      0.44897959183673464, 0.4693877551020408,  0.4897959183673469};
  const std::array<int, 4> in_shape = {{1, 8, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678004535,  10.5300283446712,   12.555198412698413,
      14.688871882086168, 14.710102040816327, 15.773435374149658,
      18.094070294784576, 16.285907029478455, 14.36924036281179,
      12.344070294784583, 13.199416099773241, 16.034450113378682,
      18.998395691609975, 22.091252834467117, 21.791054421768706,
      23.054387755102034, 26.136927437641713, 23.430804988662125,
      20.595770975056684, 17.6318253968254,   19.815685941043082,
      23.960243764172333, 28.257522675736958, 32.70752267573695,
      31.893435374149657, 33.390102040816316, 37.50041950113378,
      33.5085827664399,   29.36402494331065,  25.06674603174603,
      29.274257369614514, 35.27595804988662,  41.45895124716553,
      47.82323696145123,  46.225816326530605, 48.00248299319726,
      53.51280045351472,  47.692392290249416, 41.690691609977314,
      35.50769841269841,  42.56592403628118,  51.06762471655329,
      59.7506179138322,   68.6149036281179,   65.55914965986395,
      67.33581632653059,  74.3044671201814,   65.98405895691609,
      57.48235827664399,  48.79936507936508,  40.702590702947845,
      48.77571995464853,  57.00157029478458,  65.380141723356,
      62.27438775510203,  63.7710544217687,   70.17303854875283,
      62.25263038548753,  54.17950113378685,  45.953650793650795,
      37.883939909297055, 45.361831065759645, 52.96863378684808,
      60.704348072562354, 57.69581632653061,  58.95914965986395,
      64.75002267573697,  57.40104308390023,  49.92315192743765,
      42.31634920634921,  34.38291950113379,  41.14652494331066,
      48.01863378684808,  54.99924603174604,  52.193095238095246,
      53.25642857142858,  58.40444444444445,  51.74934240362813,
      44.98573696145125,  38.113628117913834};
  const std::array<int, 4> in_shape = {{1, 8, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.20408163265306123, 0.20408163265306123,  0.20408163265306123,
      0.20408163265306123, 0.18367346938775508,  0.14285714285714285,
      0.08163265306122448, 0.12244897959183672,  0.2857142857142857,
      0.48979591836734687, 0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.6122448979591837,
      0.44897959183673464, 0.24489795918367346,  0.12244897959183672,
      0.2857142857142857,  0.48979591836734687,  0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.7346938775510203,
      0.6122448979591837,  0.44897959183673464,  0.24489795918367346,
      0.12244897959183672, 0.2857142857142857,   0.48979591836734687,
      0.7346938775510203,  0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.6122448979591837,   0.44897959183673464,
      0.24489795918367346, 0.12244897959183672,  0.2857142857142857,
      0.48979591836734687, 0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.6122448979591837,
      0.44897959183673464, 0.24489795918367346,  0.12244897959183672,
      0.2857142857142857,  0.48979591836734687,  0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.7346938775510203,
      0.6122448979591837,  0.44897959183673464,  0.24489795918367346,
      0.12244897959183672, 0.2857142857142857,   0.48979591836734687,
      0.7346938775510203,  0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.6122448979591837,   0.44897959183673464,
      0.24489795918367346, 0.1020408163265306,   0.22448979591836732,
      0.36734693877551017, 0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,  0.5306122448979591,   0.4285714285714285,
      0.30612244897959184, 0.16326530612244897};
  const std::array<int, 4> in_shape = {{1, 8, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.64984693877551,
                                         17.22672335600907,
                                         20.374676870748296,
                                         21.0600566893424,
                                         24.31651360544218,
                                         25.110396825396826,
                                         28.475357142857142,
                                         29.377743764172337,
                                         28.581111111111106,
                                         29.420204081632654,
                                         30.707777777777775,
                                         31.546870748299316,
                                         35.285753968253964,
                                         36.18814058956915,
                                         31.77793083900226,
                                         32.57181405895691,
                                         28.053100907029474,
                                         28.73848072562358,
                                         24.111264172335602,
                                         24.688140589569166,
                                         25.713452380952383,
                                         26.398832199546483,
                                         31.25460884353741,
                                         32.068900226757364,
                                         37.053588435374145,
                                         37.99679138321995,
                                         43.11039115646258,
                                         44.18250566893423,
                                         42.58519274376416,
                                         43.58210884353741,
                                         45.11185941043083,
                                         46.10877551020407,
                                         51.20174036281178,
                                         52.273854875283426,
                                         45.918407029478445,
                                         46.86160997732425,
                                         40.377250566893416,
                                         41.19154195011337,
                                         34.57827097505669,
                                         35.2636507936508,
                                         38.819404761904764,
                                         39.631371882086164,
                                         46.95579931972788,
                                         47.920487528344665,
                                         55.39763605442177,
                                         56.515045351473916,
                                         64.14491496598639,
                                         65.4150453514739,
                                         62.60582766439907,
                                         63.786870748299314,
                                         65.59916099773243,
                                         66.78020408163263,
                                         73.73070861678003,
                                         75.00083900226755,
                                         65.89975623582765,
                                         67.0171655328798,
                                         57.76336167800453,
                                         58.7280498866213,
                                         49.321524943310656,
                                         50.13349206349206,
                                         57.58464285714285,
                                         58.54851473922903,
                                         69.40675170068026,
                                         70.55191609977324,
                                         81.5914455782313,
                                         82.91790249433106,
                                         94.13872448979592,
                                         95.64647392290246,
                                         91.0496371882086,
                                         92.45163265306121,
                                         94.60297052154196,
                                         96.00496598639452,
                                         105.5178514739229,
                                         107.02560090702944,
                                         94.05832766439909,
                                         95.38478458049883,
                                         82.23621882086168,
                                         83.38138321995463,
                                         70.05152494331065,
                                         71.01539682539682,
                                         84.1679761904762,
                                         85.13184807256236,
                                         100.9900850340136,
                                         102.13524943310658,
                                         118.17477891156463,
                                         119.5012358276644,
                                         135.72205782312926,
                                         137.2298072562358,
                                         129.7163038548753,
                                         131.1182993197279,
                                         133.2696371882086,
                                         134.67163265306118,
                                         147.10118480725623,
                                         148.6089342403628,
                                         130.6416609977324,
                                         131.96811791383217,
                                         113.81955215419498,
                                         114.96471655328799,
                                         96.63485827664397,
                                         97.59873015873016,
                                         80.59321428571428,
                                         81.40518140589569,
                                         96.58675170068028,
                                         97.55143990929706,
                                         112.88573129251701,
                                         114.00314058956916,
                                         129.4901530612245,
                                         130.760283446712,
                                         123.36773242630383,
                                         124.54877551020407,
                                         126.36106575963717,
                                         127.5421088435374,
                                         139.07594671201812,
                                         140.34607709750566,
                                         123.38785147392288,
                                         124.50526077097506,
                                         107.3943140589569,
                                         108.3590022675737,
                                         91.09533446712017,
                                         91.90730158730159,
                                         75.0825,
                                         75.76787981859411,
                                         89.90937074829932,
                                         90.72366213151929,
                                         104.99406462585034,
                                         105.93726757369616,
                                         120.33658163265305,
                                         121.40869614512471,
                                         114.39471655328798,
                                         115.39163265306122,
                                         116.92138321995462,
                                         117.9182993197279,
                                         128.42793083900224,
                                         129.50004535147394,
                                         113.85888321995462,
                                         114.80208616780045,
                                         99.0320124716553,
                                         99.8463038548753,
                                         83.9473185941043,
                                         84.63269841269842,
                                         68.188962585034,
                                         68.76583900226758,
                                         81.60767006802722,
                                         82.29304988662132,
                                         95.2433843537415,
                                         96.03726757369616,
                                         109.09610544217686,
                                         109.99849206349208,
                                         103.54709750566892,
                                         104.38619047619049,
                                         105.67376417233557,
                                         106.51285714285716,
                                         115.90650226757367,
                                         116.8088888888889,
                                         102.70480158730156,
                                         103.49868480725625,
                                         89.28609410430836,
                                         89.9714739229025,
                                         75.6503798185941,
                                         76.22725623582767};
  const std::array<int, 4> in_shape = {{1, 8, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.30612244897959184,
      0.36734693877551017, 0.24489795918367346, 0.2857142857142857,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.48979591836734687, 0.5714285714285714,
      0.8571428571428571,  0.9795918367346937,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.1020408163265305,  1.2244897959183674,
      0.8163265306122447,  0.8979591836734693,  0.44897959183673464,
      0.4897959183673469,  0.2040816326530612,  0.24489795918367344,
      0.48979591836734687, 0.5714285714285714,  0.8571428571428571,
      0.9795918367346937,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.1020408163265305,  1.2244897959183674,  0.8163265306122447,
      0.8979591836734693,  0.44897959183673464, 0.4897959183673469,
      0.2040816326530612,  0.24489795918367344, 0.48979591836734687,
      0.5714285714285714,  0.8571428571428571,  0.9795918367346937,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.1020408163265305,
      1.2244897959183674,  0.8163265306122447,  0.8979591836734693,
      0.44897959183673464, 0.4897959183673469,  0.2040816326530612,
      0.24489795918367344, 0.48979591836734687, 0.5714285714285714,
      0.8571428571428571,  0.9795918367346937,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.1020408163265305,  1.2244897959183674,
      0.8163265306122447,  0.8979591836734693,  0.44897959183673464,
      0.4897959183673469,  0.2040816326530612,  0.24489795918367344,
      0.48979591836734687, 0.5714285714285714,  0.8571428571428571,
      0.9795918367346937,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.1020408163265305,  1.2244897959183674,  0.8163265306122447,
      0.8979591836734693,  0.44897959183673464, 0.4897959183673469,
      0.2040816326530612,  0.24489795918367344, 0.48979591836734687,
      0.5714285714285714,  0.8571428571428571,  0.9795918367346937,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.1020408163265305,
      1.2244897959183674,  0.8163265306122447,  0.8979591836734693,
      0.44897959183673464, 0.4897959183673469,  0.18367346938775508,
      0.2040816326530612,  0.4081632653061224,  0.44897959183673464,
      0.6734693877551019,  0.7346938775510203,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.7959183673469387,  0.857142857142857,
      0.5714285714285714,  0.6122448979591837,  0.3061224489795918,
      0.32653061224489793};
  const std::array<int, 4> in_shape = {{1, 8, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.72281746031746,  33.29969387755102,
      33.876570294784585, 34.45344671201814,
      40.06397392290249,  40.74935374149659,
      41.434733560090706, 42.1201133786848,
      47.8391439909297,   48.63302721088436,
      49.426910430838994, 50.22079365079365,
      56.04832766439909,  56.950714285714284,
      57.853100907029464, 58.75548752834467,
      56.32312925170068,  57.16222222222221,
      58.00131519274377,  58.84040816326531,
      60.576462585034015, 61.41555555555555,
      62.254648526077105, 63.09374149659863,
      69.66912131519274,  70.57150793650793,
      71.47389455782313,  72.3762811791383,
      62.76197845804988,  63.55586167800452,
      64.34974489795918,  65.14362811791382,
      55.42082199546485,  56.10620181405895,
      56.79158163265306,  57.47696145124716,
      47.64565192743764,  48.222528344671204,
      48.79940476190476,  49.37628117913833,
      50.74152494331066,  51.426904761904765,
      52.112284580498866, 52.797664399092966,
      61.69492630385488,  62.50921768707482,
      63.32350907029478,  64.13780045351473,
      73.16397392290249,  74.10717687074829,
      75.0503798185941,   75.9935827664399,
      85.1486678004535,   86.22078231292517,
      87.2928968253968,   88.36501133786847,
      84.17346938775509,  85.17038548752832,
      86.1673015873016,   87.16421768707482,
      89.22680272108843,  90.22371882086166,
      91.22063492063492,  92.21755102040814,
      101.33136621315192, 102.40348072562357,
      103.47559523809524, 104.54770975056685,
      90.89361111111111,  91.83681405895689,
      92.78001700680272,  93.7232199546485,
      79.94020975056691,  80.75450113378683,
      81.56879251700681,  82.38308390022674,
      68.47116213151928,  69.15654195011338,
      69.84192176870748,  70.5273015873016,
      76.82684240362812,  77.63880952380953,
      78.45077664399093,  79.26274376417233,
      92.94691043083901,  93.91159863945576,
      94.87628684807257,  95.84097505668933,
      109.67786281179137, 110.79527210884353,
      111.91268140589568, 113.03009070294783,
      127.01969954648524, 128.28982993197278,
      129.55996031746028, 130.8300907029478,
      124.03061224489795, 125.21165532879814,
      126.39269841269842, 127.57374149659863,
      130.01727891156463, 131.19832199546485,
      132.37936507936507, 133.56040816326527,
      146.19128684807256, 147.46141723356007,
      148.73154761904763, 150.0016780045351,
      130.68210317460318, 131.7995124716553,
      132.91692176870748, 134.0343310657596,
      114.56203514739231, 115.52672335600906,
      116.49141156462585, 117.4560997732426,
      97.83108276643992,  98.64304988662131,
      99.4550170068027,   100.26698412698413,
      114.20541383219954, 115.1692857142857,
      116.1331575963719,  117.09702947845805,
      137.6683390022676,  138.81350340136052,
      139.95866780045353, 141.10383219954647,
      161.85643424036283, 163.1828911564626,
      164.50934807256235, 165.83580498866212,
      186.7696995464853,  188.27744897959184,
      189.78519841269838, 191.29294784580492,
      180.69727891156467, 182.0992743764172,
      183.50126984126985, 184.90326530612242,
      187.80394557823132, 189.20594104308393,
      190.6079365079365,  192.00993197278905,
      209.52795351473924, 211.0357029478458,
      212.54345238095237, 214.05120181405889,
      186.79019841269843, 188.11665532879817,
      189.44311224489795, 190.76956916099766,
      163.32727324263038, 164.47243764172336,
      165.6176020408163,  166.76276643990926,
      139.13917800453515, 140.1030498866213,
      141.06692176870746, 142.03079365079364,
      167.3720804988662,  168.3359523809524,
      169.29982426303857, 170.26369614512473,
      200.83500566893426, 201.9801700680272,
      203.12533446712015, 204.27049886621316,
      235.0231009070295,  236.34955782312926,
      237.676014739229,   239.0024716553288,
      269.936366213152,   271.4441156462585,
      272.951865079365,   274.4596145124716,
      258.030612244898,   259.4326077097506,
      260.83460317460316, 262.2365986394558,
      265.13727891156464, 266.5392743764172,
      267.94126984126984, 269.34326530612236,
      292.69462018140587, 294.20236961451246,
      295.71011904761906, 297.2178684807256,
      259.9568650793651,  261.2833219954648,
      262.6097789115646,  263.93623582766435,
      226.49393990929704, 227.63910430838996,
      228.78426870748302, 229.92943310657597,
      192.3058446712018,  193.26971655328794,
      194.23358843537414, 195.19746031746033,
      160.37446145124716, 161.18642857142856,
      161.99839569160997, 162.81036281179138,
      192.20881519274377, 193.17350340136056,
      194.1381916099773,  195.10287981859412,
      224.65405328798187, 225.77146258503402,
      226.88887188208614, 228.0062811791383,
      257.7101757369615,  258.980306122449,
      260.2504365079365,  261.520566893424,
      245.55442176870753, 246.73546485260766,
      247.9165079365079,  249.09755102040813,
      251.54108843537418, 252.72213151927434,
      253.9031746031746,  255.0842176870748,
      276.8817630385488,  278.15189342403625,
      279.4220238095238,  280.6921541950113,
      245.65829365079364, 246.77570294784576,
      247.89311224489796, 249.0105215419501,
      213.82393990929705, 214.7886281179138,
      215.7533163265306,  216.7180045351474,
      181.37870181405896, 182.19066893424034,
      183.00263605442177, 183.81460317460318,
      149.4796201814059,  150.165,
      150.8503798185941,  151.53575963718822,
      179.0044501133787,  179.81874149659865,
      180.6330328798186,  181.44732426303858,
      209.04492630385488, 209.98812925170068,
      210.93133219954646, 211.87453514739232,
      239.6010487528345,  240.6731632653061,
      241.74527777777774, 242.81739229024942,
      227.79251700680274, 228.78943310657596,
      229.7863492063492,  230.78326530612244,
      232.84585034013605, 233.84276643990924,
      234.83968253968254, 235.8365986394558,
      255.78374716553287, 256.8558616780045,
      257.9279761904762,  259.0000907029479,
      226.77456349206346, 227.71776643990924,
      228.6609693877551,  229.6041723356009,
      197.2497335600907,  198.0640249433106,
      198.87831632653064, 199.6926077097506,
      167.2092573696145,  167.8946371882086,
      168.5800170068027,  169.26539682539683,
      135.80104875283448, 136.377925170068,
      136.9548015873016,  137.53167800453517,
      162.5299603174603,  163.21534013605444,
      163.9007199546485,  164.58609977324264,
      189.69288548752832, 190.486768707483,
      191.28065192743765, 192.0745351473923,
      217.28982426303855, 218.19221088435373,
      219.09459750566893, 219.99698412698416,
      206.2551020408163,  207.09419501133783,
      207.93328798185942, 208.77238095238098,
      210.50843537414966, 211.34752834467113,
      212.18662131519278, 213.02571428571432,
      230.9106179138322,  231.81300453514734,
      232.7153911564626,  233.6177777777778,
      204.6157199546485,  205.40960317460312,
      206.20348639455787, 206.9973696145125,
      177.88680839002268, 178.57218820861672,
      179.2575680272109,  179.942947845805,
      150.72388321995464, 151.3007596371882,
      151.87763605442177, 152.45451247165533};
  const std::array<int, 4> in_shape = {{1, 8, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5510204081632653,  0.6122448979591837,
      0.6734693877551019,  0.7346938775510203,  0.44897959183673464,
      0.4897959183673469,  0.5306122448979591,  0.5714285714285714,
      0.26530612244897955, 0.2857142857142857,  0.3061224489795918,
      0.32653061224489793, 0.3673469387755102,  0.4081632653061224,
      0.4489795918367347,  0.48979591836734687, 0.8979591836734693,
      0.9795918367346937,  1.0612244897959182,  1.1428571428571428,
      1.5918367346938775,  1.7142857142857142,  1.8367346938775508,
      1.9591836734693875,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.0816326530612246,
      2.204081632653061,   2.326530612244898,   2.4489795918367347,
      1.5510204081632653,  1.6326530612244894,  1.714285714285714,
      1.7959183673469385,  0.8571428571428571,  0.8979591836734693,
      0.9387755102040816,  0.9795918367346939,  0.3673469387755102,
      0.4081632653061224,  0.4489795918367347,  0.48979591836734687,
      0.8979591836734693,  0.9795918367346937,  1.0612244897959182,
      1.1428571428571428,  1.5918367346938775,  1.7142857142857142,
      1.8367346938775508,  1.9591836734693875,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.0816326530612246,  2.204081632653061,   2.326530612244898,
      2.4489795918367347,  1.5510204081632653,  1.6326530612244894,
      1.714285714285714,   1.7959183673469385,  0.8571428571428571,
      0.8979591836734693,  0.9387755102040816,  0.9795918367346939,
      0.3673469387755102,  0.4081632653061224,  0.4489795918367347,
      0.48979591836734687, 0.8979591836734693,  0.9795918367346937,
      1.0612244897959182,  1.1428571428571428,  1.5918367346938775,
      1.7142857142857142,  1.8367346938775508,  1.9591836734693875,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.0816326530612246,  2.204081632653061,
      2.326530612244898,   2.4489795918367347,  1.5510204081632653,
      1.6326530612244894,  1.714285714285714,   1.7959183673469385,
      0.8571428571428571,  0.8979591836734693,  0.9387755102040816,
      0.9795918367346939,  0.3673469387755102,  0.4081632653061224,
      0.4489795918367347,  0.48979591836734687, 0.8979591836734693,
      0.9795918367346937,  1.0612244897959182,  1.1428571428571428,
      1.5918367346938775,  1.7142857142857142,  1.8367346938775508,
      1.9591836734693875,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.0816326530612246,
      2.204081632653061,   2.326530612244898,   2.4489795918367347,
      1.5510204081632653,  1.6326530612244894,  1.714285714285714,
      1.7959183673469385,  0.8571428571428571,  0.8979591836734693,
      0.9387755102040816,  0.9795918367346939,  0.3673469387755102,
      0.4081632653061224,  0.4489795918367347,  0.48979591836734687,
      0.8979591836734693,  0.9795918367346937,  1.0612244897959182,
      1.1428571428571428,  1.5918367346938775,  1.7142857142857142,
      1.8367346938775508,  1.9591836734693875,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.0816326530612246,  2.204081632653061,   2.326530612244898,
      2.4489795918367347,  1.5510204081632653,  1.6326530612244894,
      1.714285714285714,   1.7959183673469385,  0.8571428571428571,
      0.8979591836734693,  0.9387755102040816,  0.9795918367346939,
      0.3673469387755102,  0.4081632653061224,  0.4489795918367347,
      0.48979591836734687, 0.8979591836734693,  0.9795918367346937,
      1.0612244897959182,  1.1428571428571428,  1.5918367346938775,
      1.7142857142857142,  1.8367346938775508,  1.9591836734693875,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.0816326530612246,  2.204081632653061,
      2.326530612244898,   2.4489795918367347,  1.5510204081632653,
      1.6326530612244894,  1.714285714285714,   1.7959183673469385,
      0.8571428571428571,  0.8979591836734693,  0.9387755102040816,
      0.9795918367346939,  0.3469387755102041,  0.36734693877551017,
      0.3877551020408163,  0.4081632653061224,  0.7755102040816326,
      0.8163265306122448,  0.8571428571428571,  0.8979591836734693,
      1.2857142857142856,  1.3469387755102038,  1.4081632653061225,
      1.4693877551020407,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.530612244897959,
      1.5918367346938773,  1.6530612244897958,  1.714285714285714,
      1.1020408163265305,  1.1428571428571428,  1.183673469387755,
      1.2244897959183674,  0.5918367346938775,  0.6122448979591836,
      0.6326530612244897,  0.6530612244897959};
  const std::array<int, 4> in_shape = {{1, 8, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.15218253968254,   8.794019274376419,  10.836082766439908,
      13.43846371882086,  14.767630385487529, 12.924773242630383,
      11.262471655328797, 9.729138321995464,  10.870209750566895,
      13.2671485260771,   16.213973922902493, 19.93064058956916,
      21.509807256235824, 18.69552154195011,  16.19988662131519,
      13.931859410430839, 15.456264172335601, 18.77157029478458,
      22.813633786848072, 27.873157596371875, 29.70232426303854,
      25.68803854875283,  22.168594104308387, 19.002607709750567,
      21.81935941043084,  26.396570294784585, 31.938633786848076,
      38.83149092970521,  40.95232426303855,  35.271371882086164,
      30.33526077097505,  25.931179138321994, 30.23995464852608,
      36.381451247165536, 43.7401814058957,   52.803038548752845,
      54.836371882086176, 46.93541950113379,  40.157641723356015,
      34.18213151927438,  41.26316893424036,  49.49752267573696,
      59.306252834467124, 71.31910997732427,  73.4399433106576,
      62.638990929705216, 53.43621315192744,  45.37498866213151,
      38.95086734693877,  46.68522108843537,  55.88284013605442,
      67.12903061224489,  68.95819727891156,  58.75724489795918,
      50.08224489795918,  42.497210884353734, 36.10086734693878,
      43.2433843537415,   51.72671768707483,  62.087193877551016,
      63.66636054421768,  54.20826530612245,  46.176122448979584,
      39.16251700680272,  32.38284013605442,  38.770255102040814,
      46.348826530612236, 55.59501700680271,  56.92418367346938,
      48.43751700680272,  41.23870748299319,  34.95979591836735};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612,  0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.04081632653061224,  0.08163265306122448,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.12244897959183673,  0.18367346938775508,  0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.24489795918367346,
      0.18367346938775508,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.24489795918367346,  0.18367346938775508,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.24489795918367346,  0.18367346938775508,  0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.24489795918367346,
      0.18367346938775508,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.24489795918367346,  0.16326530612244897,
      0.36734693877551017,  0.36734693877551017,  0.36734693877551017,
      0.36734693877551017,  0.36734693877551017,  0.36734693877551017,
      0.20408163265306123,  0.1020408163265306,   0.22448979591836732,
      0.22448979591836732,  0.22448979591836732,  0.22448979591836732,
      0.22448979591836732,  0.22448979591836732,  0.12244897959183673};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.72748866213152,  14.30436507936508,  16.90265873015873,
      17.588038548752838, 20.860198412698413, 21.672165532879816,
      25.91305555555556,  26.87692743764172,  28.571388888888887,
      29.535260770975057, 25.037579365079367, 25.849546485260767,
      21.839563492063494, 22.524943310657594, 18.88140022675737,
      19.458276643990928, 21.055039682539682, 21.74041950113379,
      25.720005668934242, 26.5342970521542,   31.46325963718821,
      32.42794784580499,  38.716116780045354, 39.86128117913832,
      41.874450113378686, 43.01961451247165,  36.426354875283444,
      37.39104308390022,  31.58548185941043,  32.39977324263038,
      27.17833900226757,  27.863718820861678, 30.11864512471655,
      30.912528344671202, 36.59993764172336,  37.54314058956916,
      44.509858276643996, 45.627267573696145, 54.419858276644,
      55.74631519274375,  58.07819160997733,  59.40464852607708,
      50.258667800453516, 51.37607709750566,  43.393985260770975,
      44.33718820861677,  37.21133219954648,  38.005215419501134,
      42.71824829931972,  43.63871882086168,  51.699540816326525,
      52.79314058956917,  62.581683673469385, 63.87726757369615,
      76.12501700680274,  77.66298185941042,  80.3666836734694,
      81.9046485260771,   69.24715986394558,  70.54274376417233,
      59.57692176870748,  60.6705215419501,   50.94188775510204,
      51.86235827664399,  59.59741496598638,  60.47990929705216,
      71.71442176870748,  72.76290249433107,  86.238231292517,
      87.4803628117914,   104.13156462585036, 105.60607709750569,
      108.19823129251701, 109.67274376417235, 92.62870748299319,
      93.87083900226757,  79.26680272108842,  80.31528344671203,
      67.48176870748298,  68.36426303854876,  81.60586734693877,
      82.52633786848072,  97.90144557823128,  98.99504535147392,
      117.31692176870747, 118.61250566893425, 141.10025510204082,
      142.63821995464855, 145.3419217687075,  146.8798866213152,
      123.98239795918367, 125.27798185941043, 105.77882653061222,
      106.87242630385488, 89.82950680272108,  90.74997732426301,
      77.10785147392289,  77.90173469387754,  92.42723922902492,
      93.37044217687074,  110.64827097505669, 111.76568027210884,
      132.93160430839,    134.25806122448978, 136.58993764172334,
      137.9163945578231,  116.3970804988662,  117.51448979591837,
      99.22128684807255,  100.16448979591836, 84.20053854875285,
      84.99442176870747,  71.51635487528345,  72.20173469387755,
      85.67247732426303,  86.486768707483,    102.48874716553287,
      103.45343537414966, 123.02922335600907, 124.17438775510203,
      126.18755668934239, 127.33272108843536, 107.45184240362812,
      108.4165306122449,  91.53795351473923,  92.35224489795917,
      77.63965419501133,  78.32503401360545,  64.18880385487529,
      64.76568027210884,  76.85513038548753,  77.54051020408163,
      91.88568594104308,  92.69765306122447,  110.22616213151927,
      111.19003401360543, 112.8844954648526,  113.84836734693876,
      96.06306689342404,  96.87503401360544,  81.79203514739228,
      82.47741496598638,  69.34271541950113,  69.9195918367347};
  const std::array<int, 4> in_shape = {{1, 9, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.42857142857142855,
      0.4897959183673469,  0.3061224489795918,  0.36734693877551017,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.42857142857142855, 0.4897959183673469,  0.3061224489795918,
      0.36734693877551017, 0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.42857142857142855,
      0.4897959183673469,  0.2857142857142857,  0.32653061224489793,
      0.6530612244897959,  0.7346938775510203,  0.6530612244897959,
      0.7346938775510203,  0.6530612244897959,  0.7346938775510203,
      0.6530612244897959,  0.7346938775510203,  0.6530612244897959,
      0.7346938775510203,  0.6530612244897959,  0.7346938775510203,
      0.36734693877551017, 0.40816326530612246, 0.18367346938775508,
      0.2040816326530612,  0.4081632653061224,  0.44897959183673464,
      0.4081632653061224,  0.44897959183673464, 0.4081632653061224,
      0.44897959183673464, 0.4081632653061224,  0.44897959183673464,
      0.4081632653061224,  0.44897959183673464, 0.4081632653061224,
      0.44897959183673464, 0.22448979591836732, 0.24489795918367346};
  const std::array<int, 4> in_shape = {{1, 9, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907029477, 27.45497732426304,  28.031853741496597,
      28.60873015873016,  33.119937641723354, 33.80531746031746,
      34.49069727891156,  35.176077097505676, 40.90842970521542,
      41.720396825396826, 42.532363945578226, 43.34433106575963,
      50.862239229024944, 51.82611111111112,  52.78998299319728,
      53.75385487528344,  56.178905895691614, 57.14277777777777,
      58.10664965986395,  59.070521541950114, 49.263191609977326,
      50.07515873015873,  50.88712585034013,  51.699092970521534,
      42.993747165532874, 43.67912698412699,  44.36450680272108,
      45.04988662131519,  37.18592403628118,  37.76280045351474,
      38.33967687074829,  38.916553287981856, 41.42469954648526,
      42.110079365079365, 42.795459183673465, 43.48083900226758,
      50.62571995464852,  51.440011337868484, 52.25430272108843,
      53.0685941043084,   61.961831065759625, 62.92651927437642,
      63.89120748299319,  64.85589569160997,  76.28706916099772,
      77.43223356009071,  78.57739795918367,  79.72256235827663,
      82.6037358276644,   83.74890022675737,  84.89406462585035,
      86.0392290249433,   71.88802154195011,  72.85270975056689,
      73.81739795918367,  74.78208616780044,  62.356672335600905,
      63.17096371882086,  63.98525510204081,  64.79954648526076,
      53.67129818594104,  54.35667800453514,  55.04205782312925,
      55.727437641723355, 59.44340702947846,  60.2372902494331,
      61.031173469387745, 61.825056689342404, 72.2566723356009,
      73.19987528344672,  74.1430782312925,   75.08628117913833,
      87.9023072562358,   89.01971655328799,  90.13712585034013,
      91.25453514739229,  107.51325963718818, 108.839716553288,
      110.16617346938774, 111.4926303854875,  114.82992630385486,
      116.15638321995466, 117.48284013605442, 118.80929705215416,
      99.39992630385487,  100.51733560090703, 101.63474489795917,
      102.75215419501131, 85.84476757369615,  86.78797052154195,
      87.73117346938774,  88.67437641723355,  73.62878117913833,
      74.42266439909297,  75.21654761904762,  76.01043083900227,
      84.5160260770975,   85.43649659863944,  86.35696712018138,
      87.27743764172337,  102.30548185941042, 103.39908163265305,
      104.49268140589568, 105.58628117913834, 123.867783446712,
      125.16336734693877, 126.45895124716553, 127.7545351473923,
      150.7120691609977,  152.25003401360547, 153.78799886621314,
      155.32596371882084, 159.19540249433103, 160.7333673469388,
      162.27133219954646, 163.8092970521542,  137.1987358276644,
      138.49431972789117, 139.78990362811788, 141.08548752834466,
      118.06024376417234, 119.15384353741496, 120.24744331065759,
      121.3410430839002,  100.96330498866214, 101.88377551020407,
      102.80424603174603, 103.72471655328798, 118.31233560090702,
      119.19482993197276, 120.07732426303852, 120.95981859410432,
      142.38036281179137, 143.42884353741496, 144.47732426303853,
      145.52580498866214, 171.23433106575962, 172.476462585034,
      173.71859410430838, 174.9607256235828,  206.78861678004532,
      208.26312925170072, 209.73764172335598, 211.21215419501138,
      214.92195011337864, 216.39646258503402, 217.8709750566893,
      219.3454875283447,  184.01528344671203, 185.25741496598638,
      186.49954648526074, 187.74167800453515, 157.48512471655332,
      158.53360544217685, 159.5820861678004,  160.63056689342406,
      134.08104308390025, 134.96353741496597, 135.84603174603174,
      136.7285260770975,  162.29126417233562, 163.21173469387753,
      164.13220521541948, 165.05267573696145, 194.70929138321995,
      195.80289115646255, 196.8964909297052,  197.99009070294784,
      233.3382596371882,  234.63384353741495, 235.92942743764172,
      237.2250113378685,  280.6625453514739,  282.20051020408164,
      283.7384750566893,  285.2764399092971,  289.14587868480726,
      290.683843537415,   292.2218083900226,  293.7597732426304,
      246.6692120181406,  247.96479591836734, 249.2603798185941,
      250.55596371882086, 210.4640532879819,  211.55765306122444,
      212.65125283446713, 213.74485260770976, 178.73854308390025,
      179.65901360544217, 180.57948412698414, 181.49995464852603,
      153.42181972789115, 154.21570294784578, 155.00958616780042,
      155.8034693877551,  183.91127551020406, 184.85447845804984,
      185.79768140589567, 186.74088435374148, 220.1791326530612,
      221.29654195011338, 222.41395124716553, 223.53136054421768,
      264.53675170068027, 265.86320861678,    267.1896655328798,
      268.51612244897956, 271.853418367347,   273.1798752834467,
      274.5063321995465,  275.8327891156462,  231.67675170068028,
      232.7941609977324,  233.91157029478455, 235.02897959183673,
      197.49937074829933, 198.4425736961451,  199.38577664399094,
      200.3289795918367,  167.60719387755103, 168.4010770975057,
      169.19496031746033, 169.98884353741494, 142.34732993197278,
      143.0327097505669,  143.71808956916098, 144.4034693877551,
      170.53066326530612, 171.34495464852606, 172.15924603174602,
      172.973537414966,   204.01280612244898, 204.97749433106574,
      205.94218253968253, 206.90687074829933, 244.91328231292516,
      246.05844671201814, 247.20361111111106, 248.34877551020406,
      251.22994897959185, 252.37511337868477, 253.52027777777775,
      254.66544217687073, 213.93899659863948, 214.90368480725624,
      215.868373015873,   216.8330612244898,  182.26161564625852,
      183.07590702947846, 183.89019841269842, 184.70448979591833,
      154.5939285714286,  155.27930839002266, 155.96468820861676,
      156.6500680272109,  127.80073129251701, 128.37760770975058,
      128.9544841269841,  129.53136054421768, 153.02488095238095,
      153.71026077097505, 154.39564058956915, 155.08102040816325,
      182.95940476190475, 183.77137188208616, 184.5833390022676,
      185.39530612244894, 219.4884523809524,  220.45232426303855,
      221.41619614512473, 222.38006802721085, 224.80511904761906,
      225.7689909297052,  226.7328628117914,  227.69673469387752,
      191.31416666666667, 192.12613378684807, 192.93810090702948,
      193.7500680272109,  162.8986904761905,  163.58407029478457,
      164.2694501133787,  164.95482993197277, 138.1085544217687,
      138.68543083900227, 139.26230725623583, 139.8391836734694};
  const std::array<int, 4> in_shape = {{1, 9, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.1020408163265306,  0.12244897959183673,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.2857142857142857,  0.32653061224489793,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.36734693877551017, 0.40816326530612246, 0.44897959183673464,
      0.4897959183673469,  0.5510204081632653,  0.6122448979591836,
      0.673469387755102,   0.7346938775510203,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  0.7959183673469388,
      0.8571428571428571,  0.9183673469387754,  0.9795918367346939,
      0.5510204081632653,  0.6122448979591836,  0.673469387755102,
      0.7346938775510203,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  0.7959183673469388,  0.8571428571428571,
      0.9183673469387754,  0.9795918367346939,  0.5510204081632653,
      0.6122448979591836,  0.673469387755102,   0.7346938775510203,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      0.7959183673469388,  0.8571428571428571,  0.9183673469387754,
      0.9795918367346939,  0.5510204081632653,  0.6122448979591836,
      0.673469387755102,   0.7346938775510203,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  0.7959183673469388,
      0.8571428571428571,  0.9183673469387754,  0.9795918367346939,
      0.5510204081632653,  0.6122448979591836,  0.673469387755102,
      0.7346938775510203,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  0.7959183673469388,  0.8571428571428571,
      0.9183673469387754,  0.9795918367346939,  0.5306122448979591,
      0.5714285714285714,  0.6122448979591837,  0.6530612244897959,
      1.2244897959183674,  1.3061224489795917,  1.387755102040816,
      1.4693877551020407,  1.2244897959183674,  1.3061224489795917,
      1.387755102040816,   1.4693877551020407,  1.2244897959183674,
      1.3061224489795917,  1.387755102040816,   1.4693877551020407,
      1.2244897959183674,  1.3061224489795917,  1.387755102040816,
      1.4693877551020407,  1.2244897959183674,  1.3061224489795917,
      1.387755102040816,   1.4693877551020407,  1.2244897959183674,
      1.3061224489795917,  1.387755102040816,   1.4693877551020407,
      0.693877551020408,   0.7346938775510203,  0.7755102040816326,
      0.8163265306122449,  0.3469387755102041,  0.36734693877551017,
      0.3877551020408163,  0.4081632653061224,  0.7755102040816326,
      0.8163265306122448,  0.8571428571428571,  0.8979591836734693,
      0.7755102040816326,  0.8163265306122448,  0.8571428571428571,
      0.8979591836734693,  0.7755102040816326,  0.8163265306122448,
      0.8571428571428571,  0.8979591836734693,  0.7755102040816326,
      0.8163265306122448,  0.8571428571428571,  0.8979591836734693,
      0.7755102040816326,  0.8163265306122448,  0.8571428571428571,
      0.8979591836734693,  0.7755102040816326,  0.8163265306122448,
      0.8571428571428571,  0.8979591836734693,  0.42857142857142855,
      0.44897959183673464, 0.4693877551020408,  0.4897959183673469};
  const std::array<int, 4> in_shape = {{1, 9, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.882772108843537,  9.66202380952381,   11.549778911564626,
      13.87874716553288,  14.47124716553288,  16.30922335600907,
      14.486604308390024, 12.815856009070295, 11.036604308390022,
      12.034812925170067, 14.65079931972789,  17.395697278911566,
      20.748475056689344, 21.276689342403625, 23.63609410430839,
      20.884903628117918, 18.39782879818594,  15.781842403628119,
      17.163384353741495, 20.799778911564623, 24.58549319727891,
      29.176366213151926, 29.57600907029478,  32.52112811791383,
      28.627080498866217, 25.14000566893424,  21.50361111111111,
      24.286003401360542, 29.327159863945575, 34.54144557823129,
      40.826763038548755, 41.001405895691605, 44.70485827664399,
      39.227477324263035, 34.359450113378685, 29.318293650793645,
      33.76993197278911,  40.57537414965986,  47.54680272108843,
      55.87378684807257,  55.35092970521542,  59.59188208616779,
      52.039501133786835, 45.40004535147391,  38.59460317460317,
      46.16028911564626,  55.31573129251701,  64.64430272108844,
      75.7296201814059,   74.46426303854875,  79.60771541950113,
      69.33033446712017,  60.34802154195011,  51.19257936507936,
      43.59481292517007,  52.20263605442177,  60.95977891156462,
      71.35065192743765,  70.0102947845805,   74.69541383219953,
      65.00136621315193,  56.54286281179137,  47.935039682539674,
      40.419302721088435, 48.374064625850345, 56.457738095238085,
      66.0390873015873,   64.69873015873014,  68.92670634920634,
      59.94694444444444,  52.12109410430838,  44.16633219954649,
      36.2672619047619,   43.385289115646266, 50.61181972789116,
      59.169359410430836, 57.89328798185941,  61.59983560090703,
      53.54864512471655,  46.539121315192745, 39.421094104308395};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.12244897959183673, 0.12244897959183673,  0.12244897959183673,
      0.12244897959183673, 0.10204081632653061,  0.061224489795918366,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.24489795918367346, 0.5510204081632653,   0.9183673469387754,
      0.9183673469387754,  0.9183673469387754,   0.9183673469387754,
      0.9183673469387754,  0.673469387755102,    0.36734693877551017,
      0.24489795918367346, 0.5510204081632653,   0.9183673469387754,
      0.9183673469387754,  0.9183673469387754,   0.9183673469387754,
      0.9183673469387754,  0.673469387755102,    0.36734693877551017,
      0.24489795918367346, 0.5510204081632653,   0.9183673469387754,
      0.9183673469387754,  0.9183673469387754,   0.9183673469387754,
      0.9183673469387754,  0.673469387755102,    0.36734693877551017,
      0.24489795918367346, 0.5510204081632653,   0.9183673469387754,
      0.9183673469387754,  0.9183673469387754,   0.9183673469387754,
      0.9183673469387754,  0.673469387755102,    0.36734693877551017,
      0.24489795918367346, 0.5510204081632653,   0.9183673469387754,
      0.9183673469387754,  0.9183673469387754,   0.9183673469387754,
      0.9183673469387754,  0.673469387755102,    0.36734693877551017,
      0.22448979591836732, 0.4897959183673469,   0.7959183673469388,
      0.7959183673469388,  0.7959183673469388,   0.7959183673469388,
      0.7959183673469388,  0.5714285714285714,   0.30612244897959184,
      0.14285714285714285, 0.30612244897959184,  0.4897959183673469,
      0.4897959183673469,  0.4897959183673469,   0.4897959183673469,
      0.4897959183673469,  0.346938775510204,    0.18367346938775508};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.188667800453512, 15.765544217687074, 18.63866780045351,
      19.32404761904762,  22.3056746031746,   23.099557823129253,
      26.837023809523814, 27.75749433106576,  28.060000000000002,
      28.94249433106576,  31.697976190476187, 32.61844671201814,
      28.179325396825394, 28.97320861678005,  24.946332199546482,
      25.63171201814059,  21.496332199546483, 22.073208616780043,
      23.384246031746027, 24.069625850340135, 28.487307256235823,
      29.30159863945578,  33.84819160997732,  34.79139455782313,
      40.403350340136065, 41.49695011337869,  41.50489795918368,
      42.55337868480725,  46.17858843537415,  47.27218820861678,
      40.826604308390024, 41.769807256235836, 35.98136621315193,
      36.79565759637188,  30.878304988662126, 31.563684807256237,
      33.53288548752834,  34.32676870748299,  40.65635487528344,
      41.599557823129246, 48.078463718820856, 49.17098639455782,
      57.08600340136055,  58.35273242630385,  57.937551020408165,
      59.15201814058956,  63.77552721088435,  65.04225623582767,
      56.16163832199546,  57.254160997732434, 49.336808390022675,
      50.28001133786848,  42.21333900226756,  43.00722222222222,
      47.65153628117913,  48.572006802721084, 57.56071995464852,
      58.65431972789115,  67.81616213151926,  69.08289115646258,
      80.18481292517008,  81.65352607709751,  80.59469387755102,
      82.00281179138321,  87.94100340136053,  89.40971655328798,
      77.18822562358275,  78.45495464852607,  67.62530045351474,
      68.71890022675737,  57.71611678004534,  58.63658730158729,
      66.65736961451248,  67.53986394557822,  80.10226757369614,
      81.15074829931972,  93.87913832199544,  95.09360544217687,
      110.33945578231291, 111.74757369614514, 109.35183673469386,
      110.70185941043084, 117.77564625850339, 119.18376417233559,
      102.86453514739229, 104.07900226757367, 89.75160997732426,
      90.80009070294783,  76.30671201814059,  77.18920634920634,
      91.40010770975054,  92.32057823129252,  109.53786281179136,
      110.63146258503401, 128.02187641723353, 129.28860544217687,
      149.99052721088432, 151.4592403628118,  147.52040816326524,
      148.9285260770975,  157.74671768707478, 159.21543083900227,
      137.39393990929705, 138.66066893424033, 119.60244331065762,
      120.69604308390022, 101.46468820861679, 102.38515873015872,
      86.39574263038547,  87.18962585034014,  103.46206916099773,
      104.40527210884353, 120.82703514739227, 121.91955782312924,
      141.4345748299319,  142.7013038548753,  138.80612244897955,
      140.020589569161,   148.12409863945575, 149.39082766439907,
      128.91020975056688, 130.00273242630385, 112.14252267573697,
      113.08572562358275, 95.07619614512473,  95.87007936507935,
      80.15322562358276,  80.83860544217687,  95.9338378684807,
      96.74812925170069,  111.97227324263038, 112.91547619047617,
      130.98457482993197, 132.0781746031746,  128.34897959183675,
      129.3974603174603,  136.75981292517008, 137.85341269841268,
      118.95068594104309, 119.89388888888888, 103.42789682539683,
      104.24218820861677, 87.64728458049886,  88.33266439909298,
      71.95764739229024,  72.5345238095238,   86.08519841269838,
      86.77057823129253,  100.42975623582764, 101.22363945578232,
      117.41824829931971, 118.33871882086167, 114.90408163265303,
      115.78657596371882, 122.2792006802721,  123.19967120181406,
      106.30340702947845, 107.0972902494331,  92.39286281179139,
      93.07824263038549,  78.26531179138321,  78.84218820861679};
  const std::array<int, 4> in_shape = {{1, 9, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.18367346938775508,
      0.24489795918367346, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.16326530612244897,
      0.20408163265306123, 0.1020408163265306,  0.12244897959183673,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.4285714285714285,  0.4897959183673469,  0.9795918367346936,
      1.1020408163265305,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.6530612244897958,
      1.8367346938775508,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.2244897959183672,
      1.346938775510204,   0.673469387755102,   0.7346938775510203,
      0.4285714285714285,  0.4897959183673469,  0.9795918367346936,
      1.1020408163265305,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.6530612244897958,
      1.8367346938775508,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.2244897959183672,
      1.346938775510204,   0.673469387755102,   0.7346938775510203,
      0.4285714285714285,  0.4897959183673469,  0.9795918367346936,
      1.1020408163265305,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.6530612244897958,
      1.8367346938775508,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.2244897959183672,
      1.346938775510204,   0.673469387755102,   0.7346938775510203,
      0.4285714285714285,  0.4897959183673469,  0.9795918367346936,
      1.1020408163265305,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.6530612244897958,
      1.8367346938775508,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.2244897959183672,
      1.346938775510204,   0.673469387755102,   0.7346938775510203,
      0.4285714285714285,  0.4897959183673469,  0.9795918367346936,
      1.1020408163265305,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.6530612244897958,
      1.8367346938775508,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.2244897959183672,
      1.346938775510204,   0.673469387755102,   0.7346938775510203,
      0.4081632653061224,  0.44897959183673464, 0.8979591836734693,
      0.9795918367346939,  1.4693877551020407,  1.5918367346938775,
      1.4693877551020407,  1.5918367346938775,  1.4693877551020407,
      1.5918367346938775,  1.4693877551020407,  1.5918367346938775,
      1.4693877551020407,  1.5918367346938775,  1.0612244897959182,
      1.1428571428571428,  0.5714285714285714,  0.6122448979591837,
      0.26530612244897955, 0.2857142857142857,  0.5714285714285714,
      0.6122448979591837,  0.9183673469387754,  0.9795918367346939,
      0.9183673469387754,  0.9795918367346939,  0.9183673469387754,
      0.9795918367346939,  0.9183673469387754,  0.9795918367346939,
      0.9183673469387754,  0.9795918367346939,  0.6530612244897959,
      0.693877551020408,   0.3469387755102041,  0.36734693877551017};
  const std::array<int, 4> in_shape = {{1, 9, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.800459183673464, 30.377335600907024, 30.954212018140588,
      31.531088435374148, 36.59195578231292,  37.27733560090702,
      37.96271541950113,  38.64809523809524,  43.81746598639456,
      44.6113492063492,   45.405232426303854, 46.199115646258505,
      52.75357709750567,  53.67404761904763,  54.594518140589564,
      55.51498866213152,  55.23750566893423,  56.120000000000005,
      57.00249433106575,  57.88498866213152,  62.47548185941042,
      63.39595238095237,  64.31642290249434,  65.23689342403628,
      55.56476757369614,  56.35865079365079,  57.15253401360544,
      57.9464172335601,   49.20728458049886,  49.892664399092965,
      50.57804421768707,  51.26342403628118,  42.4157879818594,
      42.992664399092966, 43.56954081632652,  44.146417233560086,
      46.08311224489796,  46.768492063492054, 47.45387188208617,
      48.13925170068027,  56.1603231292517,   56.974614512471646,
      57.788905895691606, 58.60319727891156,  66.75318027210885,
      67.69638321995464,  68.63958616780045,  69.58278911564626,
      79.71310090702949,  80.80670068027213,  81.90030045351473,
      82.99390022675738,  81.96131519274377,  83.00979591836736,
      84.05827664399091,  85.1067573696145,   91.26357709750566,
      92.3571768707483,   93.45077664399092,  94.54437641723356,
      80.71000566893422,  81.65320861678005,  82.59641156462584,
      83.53961451247167,  71.14844104308389,  71.96273242630386,
      72.7770238095238,   73.59131519274376,  61.07123015873015,
      61.75660997732425,  62.44198979591836,  63.127369614512475,
      66.27188775510204,  67.06577097505668,  67.85965419501134,
      68.65353741496598,  80.36950680272109,  81.31270975056688,
      82.2559126984127,   83.19911564625849,  95.06440476190477,
      96.15692743764171,  97.24945011337869,  98.34197278911564,
      112.90527777777778, 114.1720068027211,  115.4387358276644,
      116.7054648526077,  114.66063492063493, 115.87510204081633,
      117.08956916099771, 118.30403628117912, 126.2843253968254,
      127.5510544217687,  128.817783446712,   130.08451247165533,
      111.23075396825395, 112.32327664399092, 113.41579931972788,
      114.50832199546487, 97.73041383219955,  98.67361678004535,
      99.61681972789114,  100.56002267573696, 83.6327947845805,
      84.42667800453512,  85.22056122448978,  86.01444444444444,
      94.38260204081632,  95.30307256235827,  96.22354308390024,
      97.14401360544217,  114.02784013605442, 115.12143990929704,
      116.2150396825397,  117.3086394557823,  134.36559523809524,
      135.63232426303853, 136.89905328798187, 138.16578231292516,
      158.90091269841272, 160.36962585034016, 161.83833900226756,
      163.30705215419502, 159.78126984126985, 161.18938775510205,
      162.5975056689342,  164.00562358276642, 174.41329365079366,
      175.88200680272107, 177.35071995464853, 178.81943310657596,
      153.1097222222222,  154.3764512471655,  155.64318027210885,
      156.90990929705214, 134.15700113378685, 135.25060090702948,
      136.3442006802721,  137.43780045351474, 114.51176303854875,
      115.43223356009068, 116.35270408163264, 117.27317460317458,
      132.4322448979592,  133.31473922902495, 134.1972335600907,
      135.07972789115644, 159.15605442176872, 160.20453514739228,
      161.25301587301584, 162.30149659863943, 186.54380952380956,
      187.75827664399088, 188.97274376417235, 190.18721088435373,
      219.27079365079368, 220.67891156462582, 222.08702947845805,
      223.49514739229028, 217.35365079365081, 218.70367346938772,
      220.0536961451247,  221.40371882086168, 234.1431746031746,
      235.55129251700677, 236.959410430839,   238.36752834467117,
      204.51460317460317, 205.72907029478458, 206.943537414966,
      208.15800453514734, 178.45473922902494, 179.50321995464853,
      180.5517006802721,  181.60018140589565, 151.73092970521543,
      152.61342403628117, 153.49591836734692, 154.3784126984127,
      181.87974489795917, 182.8002154195011,  183.7206859410431,
      184.64115646258503, 217.98212585034014, 219.0757256235827,
      220.1693253968254,  221.26292517006803, 254.77702380952383,
      256.04375283446706, 257.31048185941046, 258.57721088435375,
      298.51234126984133, 299.98105442176865, 301.44976757369614,
      302.9184807256236,  293.63269841269846, 295.0408163265305,
      296.44893424036275, 297.857052154195,   314.0247222222223,
      315.49343537414956, 316.96214852607704, 318.43086167800453,
      273.5211507936508,  274.7878798185941,  276.05460884353744,
      277.32133786848067, 238.11128684807255, 239.20488662131524,
      240.2984863945578,  241.39208616780044, 202.00890589569156,
      202.92937641723358, 203.8498469387755,  204.77031746031744,
      171.99760204081633, 172.79148526077094, 173.58536848072566,
      174.37925170068027, 205.98093537414968, 206.92413832199546,
      207.8673412698413,  208.81054421768707, 240.56154761904762,
      241.65407029478453, 242.74659297052153, 243.83911564625848,
      281.60242063492063, 282.8691496598638,  284.13587868480727,
      285.4026077097506,  276.3977777777778,  277.6122448979591,
      278.8267120181406,  280.041179138322,   294.9814682539683,
      296.2481972789115,  297.5149263038549,  298.78165532879814,
      256.7278968253968,  257.82041950113376, 258.91294217687073,
      260.0054648526077,  223.34184240362808, 224.28504535147394,
      225.22824829931972, 226.1714512471655,  189.35850907029476,
      190.15239229024945, 190.94627551020406, 191.7401587301587,
      159.62107142857144, 160.3064512471655,  160.99183106575964,
      161.67721088435374, 191.0533843537415,  191.8676757369614,
      192.6819671201814,  193.49625850340138, 223.00134353741495,
      223.94454648526076, 224.8877494331066,  225.83095238095234,
      260.8755498866213,  261.96914965986394, 263.0627494331066,
      264.1563492063492,  255.64947845804986, 256.6979591836735,
      257.74643990929707, 258.7949206349206,  272.4260260770975,
      273.51962585034016, 274.6132256235828,  275.70682539682537,
      236.95816893424032, 237.90137188208618, 238.844574829932,
      239.78777777777776, 206.04150226757363, 206.85579365079366,
      207.6700850340136,  208.48437641723353, 174.6091893424036,
      175.29456916099772, 175.97994897959182, 176.66532879818595,
      143.33841836734695, 143.91529478458048, 144.49217120181407,
      145.0690476190476,  171.4850170068027,  172.17039682539675,
      172.85577664399096, 173.54115646258506, 200.06562925170067,
      200.85951247165528, 201.65339569161003, 202.44727891156464,
      233.91602607709748, 234.83649659863943, 235.75696712018146,
      236.67743764172334, 228.92566893424032, 229.80816326530606,
      230.69065759637192, 231.57315192743764, 243.63793083900222,
      244.5584013605442,  245.4788718820862,  246.3993424036281,
      211.8129308390022,  212.6068140589569,  213.4006972789116,
      214.1945804988662,  184.10034580498862, 184.78572562358278,
      185.47110544217685, 186.15648526077098, 155.9537471655329,
      156.53062358276642, 157.1075,           157.68437641723358};
  const std::array<int, 4> in_shape = {{1, 9, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.3061224489795918,  0.36734693877551017,
      0.42857142857142855, 0.4897959183673469,  0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.2857142857142857,  0.32653061224489793,
      0.36734693877551017, 0.40816326530612246, 0.18367346938775508,
      0.2040816326530612,  0.22448979591836732, 0.24489795918367346,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.7959183673469388,  0.857142857142857,   0.9183673469387754,
      0.9795918367346939,  1.8367346938775508,  1.9591836734693873,
      2.081632653061224,   2.204081632653061,   3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  3.122448979591837,   3.3061224489795915,
      3.4897959183673466,  3.6734693877551017,  3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.693877551020408,   1.2857142857142856,
      1.346938775510204,   1.4081632653061222,  1.4693877551020407,
      0.7959183673469388,  0.857142857142857,   0.9183673469387754,
      0.9795918367346939,  1.8367346938775508,  1.9591836734693873,
      2.081632653061224,   2.204081632653061,   3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  3.122448979591837,   3.3061224489795915,
      3.4897959183673466,  3.6734693877551017,  3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.693877551020408,   1.2857142857142856,
      1.346938775510204,   1.4081632653061222,  1.4693877551020407,
      0.7959183673469388,  0.857142857142857,   0.9183673469387754,
      0.9795918367346939,  1.8367346938775508,  1.9591836734693873,
      2.081632653061224,   2.204081632653061,   3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  3.122448979591837,   3.3061224489795915,
      3.4897959183673466,  3.6734693877551017,  3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.693877551020408,   1.2857142857142856,
      1.346938775510204,   1.4081632653061222,  1.4693877551020407,
      0.7959183673469388,  0.857142857142857,   0.9183673469387754,
      0.9795918367346939,  1.8367346938775508,  1.9591836734693873,
      2.081632653061224,   2.204081632653061,   3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  3.122448979591837,   3.3061224489795915,
      3.4897959183673466,  3.6734693877551017,  3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.693877551020408,   1.2857142857142856,
      1.346938775510204,   1.4081632653061222,  1.4693877551020407,
      0.7959183673469388,  0.857142857142857,   0.9183673469387754,
      0.9795918367346939,  1.8367346938775508,  1.9591836734693873,
      2.081632653061224,   2.204081632653061,   3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  3.122448979591837,   3.3061224489795915,
      3.4897959183673466,  3.6734693877551017,  3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.693877551020408,   1.2857142857142856,
      1.346938775510204,   1.4081632653061222,  1.4693877551020407,
      0.7755102040816326,  0.8163265306122448,  0.857142857142857,
      0.8979591836734693,  1.7142857142857144,  1.7959183673469385,
      1.8775510204081631,  1.9591836734693877,  2.816326530612245,
      2.9387755102040813,  3.0612244897959178,  3.183673469387755,
      2.816326530612245,   2.9387755102040813,  3.0612244897959178,
      3.183673469387755,   2.816326530612245,   2.9387755102040813,
      3.0612244897959178,  3.183673469387755,   2.816326530612245,
      2.9387755102040813,  3.0612244897959178,  3.183673469387755,
      2.816326530612245,   2.9387755102040813,  3.0612244897959178,
      3.183673469387755,   2.0408163265306123,  2.1224489795918364,
      2.204081632653061,   2.2857142857142856,  1.1020408163265305,
      1.1428571428571428,  1.183673469387755,   1.2244897959183674,
      0.5102040816326531,  0.5306122448979591,  0.5510204081632653,
      0.5714285714285714,  1.1020408163265305,  1.1428571428571428,
      1.183673469387755,   1.2244897959183674,  1.7755102040816326,
      1.8367346938775508,  1.8979591836734693,  1.9591836734693877,
      1.7755102040816326,  1.8367346938775508,  1.8979591836734693,
      1.9591836734693877,  1.7755102040816326,  1.8367346938775508,
      1.8979591836734693,  1.9591836734693877,  1.7755102040816326,
      1.8367346938775508,  1.8979591836734693,  1.9591836734693877,
      1.7755102040816326,  1.8367346938775508,  1.8979591836734693,
      1.9591836734693877,  1.2653061224489797,  1.3061224489795917,
      1.3469387755102038,  1.387755102040816,   0.673469387755102,
      0.6938775510204082,  0.7142857142857142,  0.7346938775510203};
  const std::array<int, 4> in_shape = {{1, 9, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678004535,  10.5300283446712,   12.555198412698413,
      14.688871882086168, 14.710102040816327, 15.773435374149658,
      18.094070294784576, 16.285907029478455, 14.36924036281179,
      12.344070294784583, 13.199416099773241, 16.034450113378682,
      18.998395691609975, 22.091252834467117, 21.791054421768706,
      23.054387755102034, 26.136927437641713, 23.430804988662125,
      20.595770975056684, 17.6318253968254,   18.87050453514739,
      22.82798752834467,  26.93479024943311,  31.1909126984127,
      30.450238095238095, 31.913571428571423, 35.877063492063485,
      32.068900226757364, 28.111417233560083, 24.004614512471655,
      26.75264739229025,  32.25774943310658,  37.93598072562358,
      43.78734126984127,  42.39388888888889,  44.09055555555555,
      49.220714285714266, 43.88874149659863,  38.3836394557823,
      32.705408163265304, 37.29990929705215,  44.7692970521542,
      52.404671201814054, 60.20603174603175,  57.59174603174603,
      59.21841269841269,  65.4152380952381,   58.11183673469387,
      50.64244897959183,  43.00707482993198,  51.05740929705215,
      61.13393990929706,  71.38359977324264,  81.80638888888889,
      77.74626984126985,  79.44293650793652,  87.23976190476192,
      77.33636054421768,  67.25982993197279,  57.01017006802721,
      48.238758503401364, 57.72005102040817,  67.35066326530612,
      77.13059523809525,  73.16769841269843,  74.63103174603175,
      81.81674603174604,  72.48477324263038,  63.00348072562359,
      53.37286848072563,  44.7377380952381,   53.504744897959185,
      62.40066326530612,  71.42549319727893,  67.66497732426305,
      68.92831065759638,  75.47116780045353,  66.83307256235827,
      58.06606575963718,  49.17014739229025,  40.151683673469385,
      48.000323129251704, 55.95746598639456,  64.02311224489797,
      60.58402494331066,  61.647358276643985, 67.42831065759637,
      59.688174603174595, 51.83953514739229,  43.882392290249435};
  const std::array<int, 4> in_shape = {{1, 9, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.20408163265306123, 0.20408163265306123,  0.20408163265306123,
      0.20408163265306123, 0.18367346938775508,  0.14285714285714285,
      0.08163265306122448, 0.12244897959183672,  0.2857142857142857,
      0.48979591836734687, 0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.6122448979591837,
      0.44897959183673464, 0.24489795918367346,  0.3061224489795918,
      0.673469387755102,   1.1020408163265305,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.2857142857142858,  0.9183673469387754,   0.4897959183673469,
      0.3061224489795918,  0.673469387755102,    1.1020408163265305,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.2857142857142858,   0.9183673469387754,
      0.4897959183673469,  0.3061224489795918,   0.673469387755102,
      1.1020408163265305,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.2857142857142858,
      0.9183673469387754,  0.4897959183673469,   0.3061224489795918,
      0.673469387755102,   1.1020408163265305,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.2857142857142858,  0.9183673469387754,   0.4897959183673469,
      0.3061224489795918,  0.673469387755102,    1.1020408163265305,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.2857142857142858,   0.9183673469387754,
      0.4897959183673469,  0.2857142857142857,   0.6122448979591836,
      0.9795918367346939,  1.3877551020408163,   1.3877551020408163,
      1.3877551020408163,  1.3877551020408163,   1.1020408163265305,
      0.7755102040816326,  0.40816326530612246,  0.18367346938775508,
      0.3877551020408163,  0.6122448979591837,   0.8571428571428572,
      0.8571428571428572,  0.8571428571428572,   0.8571428571428572,
      0.6734693877551019,  0.4693877551020408,   0.24489795918367346};
  const std::array<int, 4> in_shape = {{1, 9, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.64984693877551,  17.22672335600907,  20.374676870748296,
      21.0600566893424,   24.31651360544218,  25.110396825396826,
      28.475357142857142, 29.377743764172337, 28.581111111111106,
      29.420204081632654, 30.707777777777775, 31.546870748299316,
      35.285753968253964, 36.18814058956915,  31.77793083900226,
      32.57181405895691,  28.053100907029474, 28.73848072562358,
      24.111264172335602, 24.688140589569166, 25.713452380952383,
      26.398832199546483, 31.25460884353741,  32.068900226757364,
      37.053588435374145, 37.99679138321995,  43.11039115646258,
      44.18250566893423,  42.58519274376416,  43.58210884353741,
      45.11185941043083,  46.10877551020407,  51.20174036281178,
      52.273854875283426, 45.918407029478445, 46.86160997732425,
      40.377250566893416, 41.19154195011337,  34.57827097505669,
      35.2636507936508,   36.947125850340136, 37.74100907029478,
      44.71277210884353,  45.65597505668934,  52.77705782312924,
      53.86958049886622,  61.13998299319727,  62.3818253968254,
      59.745736961451236, 60.90047619047619,  62.672403628117905,
      63.827142857142846, 70.51228458049886,  71.75412698412697,
      63.04527777777776,  64.13780045351473,  55.27963151927437,
      56.222834467120165, 47.215345804988665, 48.00922902494331,
      52.58482426303855,  53.5052947845805,   63.42189909297051,
      64.51549886621316,  74.60523242630384,  75.87196145124716,
      86.13482426303854,  87.57468253968254,  83.44891156462585,
      84.78777777777778,  86.84224489795918,  88.1811111111111,
      97.00157029478457,  98.44142857142853,  86.51075396825397,
      87.77748299319725,  75.67367913832199,  76.7672789115646,
      64.49034580498866,  65.41081632653061,  73.71732426303855,
      74.5998185941043,   88.4901133786848,   89.5385941043084,
      103.59487528344668, 104.80934240362811, 119.03160997732424,
      120.4120634920635,  113.89986394557822, 115.18349206349205,
      117.15319727891155, 118.43682539682538, 129.45002267573693,
      130.8304761904762,  115.00920634920634, 116.22367346938773,
      100.23641723356009, 101.28489795918367, 85.13165532879819,
      86.01414965986396,  101.19434807256235, 102.1148185941043,
      121.17428004535147, 122.26787981859412, 141.50047052154196,
      142.76719954648527, 162.17291950113375, 163.61277777777778,
      154.15367346938774, 155.4925396825397,  157.54700680272106,
      158.88587301587305, 173.03966553287978, 174.47952380952384,
      153.40599206349205, 154.67272108843537, 133.42606009070295,
      134.51965986394558, 113.09986961451249, 114.02034013605441,
      95.68363378684808,  96.47751700680273,  114.49689909297052,
      115.44010204081634, 133.60880385487528, 134.70132653061225,
      153.01934807256234, 154.2611904761905,  145.18065759637187,
      146.33539682539686, 148.10732426303852, 149.2620634920635,
      162.39164965986393, 163.63349206349207, 143.87702380952382,
      144.96954648526076, 125.06375850340137, 126.00696145124718,
      105.95185374149659, 106.74573696145126, 88.79009637188209,
      89.4754761904762,   106.1951984126984,  107.00948979591837,
      123.85812358276644, 124.80132653061224, 141.77887188208615,
      142.85098639455785, 134.33303854875282, 135.3299546485261,
      136.8597052154195,  137.85662131519277, 149.87022108843536,
      150.94233560090706, 132.72294217687076, 133.66614512471654,
      115.31784013605443, 116.13213151927437, 97.65491496598639,
      98.3402947845805,   79.72649092970521,  80.30336734693877,
      95.31526643990931,  96.00064625850341,  111.12104875283448,
      111.91493197278912, 127.14383786848073, 128.04622448979595,
      120.3289569160998,  121.16804988662132, 122.45562358276645,
      123.29471655328797, 133.95423469387757, 134.85662131519274,
      118.58246598639457, 119.37634920634919, 102.99369047619048,
      103.67907029478458, 87.1879081632653,   87.76478458049887};
  const std::array<int, 4> in_shape = {{1, 9, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.30612244897959184,
      0.36734693877551017, 0.24489795918367346, 0.2857142857142857,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.48979591836734687, 0.5714285714285714,
      0.8571428571428571,  0.9795918367346937,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.1020408163265305,  1.2244897959183674,
      0.8163265306122447,  0.8979591836734693,  0.44897959183673464,
      0.4897959183673469,  0.5510204081632653,  0.6122448979591836,
      1.2244897959183674,  1.346938775510204,   2.020408163265306,
      2.204081632653061,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.387755102040816,   2.5714285714285716,  1.714285714285714,
      1.8367346938775508,  0.9183673469387754,  0.9795918367346939,
      0.5510204081632653,  0.6122448979591836,  1.2244897959183674,
      1.346938775510204,   2.020408163265306,   2.204081632653061,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.387755102040816,
      2.5714285714285716,  1.714285714285714,   1.8367346938775508,
      0.9183673469387754,  0.9795918367346939,  0.5510204081632653,
      0.6122448979591836,  1.2244897959183674,  1.346938775510204,
      2.020408163265306,   2.204081632653061,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.387755102040816,   2.5714285714285716,
      1.714285714285714,   1.8367346938775508,  0.9183673469387754,
      0.9795918367346939,  0.5510204081632653,  0.6122448979591836,
      1.2244897959183674,  1.346938775510204,   2.020408163265306,
      2.204081632653061,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.387755102040816,   2.5714285714285716,  1.714285714285714,
      1.8367346938775508,  0.9183673469387754,  0.9795918367346939,
      0.5510204081632653,  0.6122448979591836,  1.2244897959183674,
      1.346938775510204,   2.020408163265306,   2.204081632653061,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.387755102040816,
      2.5714285714285716,  1.714285714285714,   1.8367346938775508,
      0.9183673469387754,  0.9795918367346939,  0.5306122448979591,
      0.5714285714285714,  1.1428571428571428,  1.2244897959183672,
      1.8367346938775508,  1.9591836734693877,  2.612244897959183,
      2.7755102040816326,  2.612244897959183,   2.7755102040816326,
      2.612244897959183,   2.7755102040816326,  2.612244897959183,
      2.7755102040816326,  2.0816326530612246,  2.204081632653061,
      1.4693877551020407,  1.5510204081632653,  0.7755102040816326,
      0.8163265306122449,  0.3469387755102041,  0.36734693877551017,
      0.7346938775510203,  0.7755102040816326,  1.163265306122449,
      1.2244897959183674,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.2857142857142856,  1.3469387755102038,  0.8979591836734693,
      0.9387755102040816,  0.4693877551020408,  0.4897959183673469};
  const std::array<int, 4> in_shape = {{1, 9, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.72281746031746,  33.29969387755102,  33.876570294784585,
      34.45344671201814,  40.06397392290249,  40.74935374149659,
      41.434733560090706, 42.1201133786848,   47.8391439909297,
      48.63302721088436,  49.426910430838994, 50.22079365079365,
      56.04832766439909,  56.950714285714284, 57.853100907029464,
      58.75548752834467,  56.32312925170068,  57.16222222222221,
      58.00131519274377,  58.84040816326531,  60.576462585034015,
      61.41555555555555,  62.254648526077105, 63.09374149659863,
      69.66912131519274,  70.57150793650793,  71.47389455782313,
      72.3762811791383,   62.76197845804988,  63.55586167800452,
      64.34974489795918,  65.14362811791382,  55.42082199546485,
      56.10620181405895,  56.79158163265306,  57.47696145124716,
      47.64565192743764,  48.222528344671204, 48.79940476190476,
      49.37628117913833,  50.74152494331066,  51.426904761904765,
      52.112284580498866, 52.797664399092966, 61.69492630385488,
      62.50921768707482,  63.32350907029478,  64.13780045351473,
      73.16397392290249,  74.10717687074829,  75.0503798185941,
      75.9935827664399,   85.1486678004535,   86.22078231292517,
      87.2928968253968,   88.36501133786847,  84.17346938775509,
      85.17038548752832,  86.1673015873016,   87.16421768707482,
      89.22680272108843,  90.22371882086166,  91.22063492063492,
      92.21755102040814,  101.33136621315192, 102.40348072562357,
      103.47559523809524, 104.54770975056685, 90.89361111111111,
      91.83681405895689,  92.78001700680272,  93.7232199546485,
      79.94020975056691,  80.75450113378683,  81.56879251700681,
      82.38308390022674,  68.47116213151928,  69.15654195011338,
      69.84192176870748,  70.5273015873016,   73.10036848072562,
      73.89425170068027,  74.68813492063491,  75.48201814058956,
      88.48234126984129,  89.42554421768706,  90.36874716553288,
      91.31195011337869,  104.46159297052155, 105.55411564625848,
      106.64663832199544, 107.73916099773244, 121.03812358276642,
      122.27996598639454, 123.52180839002263, 124.7636507936508,
      118.33673469387755, 119.49147392290247, 120.64621315192743,
      121.80095238095238, 124.19006802721088, 125.34480725623581,
      126.49954648526077, 127.65428571428569, 139.7827267573696,
      141.02456916099771, 142.26641156462583, 143.50825396825394,
      124.99803287981858, 126.09055555555553, 127.18307823129251,
      128.27560090702946, 109.61606009070294, 110.55926303854874,
      111.50246598639455, 112.44566893424033, 93.63680839002267,
      94.43069160997733,  95.22457482993195,  96.01845804988662,
      104.24917800453515, 105.1696485260771,  106.09011904761904,
      107.010589569161,   125.75019841269844, 126.84379818594103,
      127.93739795918367, 129.03099773242633, 147.94373582766443,
      149.21046485260769, 150.477193877551,   151.74392290249432,
      170.82979024943305, 172.26964852607708, 173.70950680272102,
      175.14936507936508, 165.55895691609976, 166.8978231292517,
      168.23668934240362, 169.57555555555555, 172.34562358276642,
      173.68448979591835, 175.02335600907028, 176.3622222222222,
      192.56328231292514, 194.00314058956914, 195.44299886621312,
      196.88285714285706, 171.75477891156459, 173.02150793650793,
      174.28823696145122, 175.5549659863945,  150.25375850340134,
      151.34735827664397, 152.4409580498866,  153.5345578231292,
      128.06022108843536, 128.98069160997733, 129.90116213151924,
      130.82163265306122, 146.55215419501133, 147.4346485260771,
      148.31714285714284, 149.1996371882086,  175.93174603174606,
      176.9802267573696,  178.02870748299316, 179.0771882086168,
      205.97528344671204, 207.18975056689337, 208.40421768707478,
      209.61868480725622, 236.6827664399093,  238.06321995464847,
      239.4436734693877,  240.824126984127,   226.51609977324264,
      227.79972789115644, 229.08335600907026, 230.3669841269841,
      233.02276643990933, 234.3063945578231,  235.59002267573692,
      236.87365079365077, 257.5195918367347,  258.90004535147386,
      260.2804988662131,  261.6609523809524,  228.8039455782313,
      230.01841269841267, 231.23287981859409, 232.44734693877547,
      199.4243537414966,  200.47283446712018, 201.5213151927437,
      202.56979591836733, 169.3808163265306,  170.26331065759638,
      171.1458049886621,  172.02829931972792, 201.46822562358278,
      202.3886961451247,  203.30916666666664, 204.2296371882086,
      241.25496031746036, 242.34856009070293, 243.44215986394553,
      244.53575963718825, 281.7342120181406,  283.0009410430839,
      284.26767006802714, 285.53439909297055, 322.9059807256236,
      324.3458390022675,  325.7856972789116,  327.22555555555556,
      306.96848072562364, 308.3073469387755,  309.6462131519274,
      310.9850793650794,  313.75514739229027, 315.0940136054421,
      316.4328798185941,  317.7717460317461,  344.63947278911564,
      346.07933106575956, 347.5191893424036,  348.9590476190477,
      305.54525510204076, 306.8119841269841,  308.07871315192745,
      309.34544217687073, 265.75852040816324, 266.8521201814059,
      267.94571995464844, 269.03931972789115, 225.279268707483,
      226.19973922902497, 227.12020975056686, 228.04068027210883,
      190.5733843537415,  191.36726757369615, 192.1611507936508,
      192.95503401360546, 228.05059523809524, 228.99379818594105,
      229.9370011337868,  230.88020408163268, 266.1250850340136,
      267.21760770975055, 268.31013038548747, 269.4026530612245,
      304.7968537414966,  306.0386961451247,  307.2805385487528,
      308.522380952381,   289.2065759637188,  290.36131519274375,
      291.51605442176873, 292.6707936507937,  295.0599092970521,
      296.21464852607704, 297.36938775510197, 298.524126984127,
      323.5414569160997,  324.78329931972786, 326.02514172335594,
      327.26698412698414, 286.6615249433106,  287.75404761904764,
      288.84657029478456, 289.93909297052153, 249.1843140589569,
      250.12751700680275, 251.0707199546485,  252.01392290249436,
      211.10982426303852, 211.90370748299318, 212.69759070294782,
      213.49147392290251, 176.89481292517007, 177.58019274376417,
      178.26557256235827, 178.9509523809524,  211.57610544217687,
      212.3903968253968,  213.20468820861677, 214.01897959183674,
      246.77304421768704, 247.71624716553288, 248.65945011337865,
      249.6026530612245,  282.4856292517007,  283.5577437641723,
      284.629858276644,   285.7019727891157,  267.66916099773243,
      268.66607709750565, 269.66299319727887, 270.6599092970522,
      272.7224943310657,  273.719410430839,   274.71632653061226,
      275.71324263038554, 298.6683276643991,  299.7404421768707,
      300.8125566893424,  301.8846712018141,  264.5026814058957,
      265.4458843537415,  266.3890873015873,  267.3322902494331,
      229.82138888888886, 230.63568027210886, 231.44997165532877,
      232.26426303854873, 194.62445011337869, 195.30982993197279,
      195.99520975056686, 196.680589569161,   158.87610544217688,
      159.45298185941041, 160.029858276644,   160.60673469387754,
      189.94515306122446, 190.63053287981862, 191.3159126984127,
      192.00129251700682, 221.44821428571424, 222.24209750566897,
      223.03598072562357, 223.82986394557824, 253.38528911564626,
      254.28767573696146, 255.19006235827663, 256.0924489795919,
      239.81882086167798, 240.6579138321996,  241.49700680272107,
      242.33609977324264, 244.0721541950113,  244.9112471655329,
      245.7503401360544,  246.58943310657594, 267.0060827664399,
      267.90846938775513, 268.8108560090703,  269.7132426303855,
      236.37104875283444, 237.16493197278913, 237.95881519274374,
      238.75269841269838, 205.30200113378683, 205.98738095238096,
      206.67276077097503, 207.35814058956916, 173.79893990929705,
      174.3758163265306,  174.95269274376415, 175.52956916099774};
  const std::array<int, 4> in_shape = {{1, 9, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5510204081632653,  0.6122448979591837,
      0.6734693877551019,  0.7346938775510203,  0.44897959183673464,
      0.4897959183673469,  0.5306122448979591,  0.5714285714285714,
      0.26530612244897955, 0.2857142857142857,  0.3061224489795918,
      0.32653061224489793, 0.3673469387755102,  0.4081632653061224,
      0.4489795918367347,  0.48979591836734687, 0.8979591836734693,
      0.9795918367346937,  1.0612244897959182,  1.1428571428571428,
      1.5918367346938775,  1.7142857142857142,  1.8367346938775508,
      1.9591836734693875,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.0816326530612246,
      2.204081632653061,   2.326530612244898,   2.4489795918367347,
      1.5510204081632653,  1.6326530612244894,  1.714285714285714,
      1.7959183673469385,  0.8571428571428571,  0.8979591836734693,
      0.9387755102040816,  0.9795918367346939,  1.0408163265306123,
      1.1020408163265305,  1.163265306122449,   1.2244897959183672,
      2.3265306122448974,  2.4489795918367347,  2.571428571428571,
      2.693877551020408,   3.8571428571428568,  4.040816326530612,
      4.224489795918367,   4.408163265306122,   5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      4.591836734693877,   4.775510204081632,   4.959183673469387,
      5.142857142857143,   3.3061224489795915,  3.428571428571428,
      3.551020408163265,   3.6734693877551017,  1.7755102040816326,
      1.8367346938775508,  1.8979591836734693,  1.9591836734693877,
      1.0408163265306123,  1.1020408163265305,  1.163265306122449,
      1.2244897959183672,  2.3265306122448974,  2.4489795918367347,
      2.571428571428571,   2.693877551020408,   3.8571428571428568,
      4.040816326530612,   4.224489795918367,   4.408163265306122,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.591836734693877,   4.775510204081632,
      4.959183673469387,   5.142857142857143,   3.3061224489795915,
      3.428571428571428,   3.551020408163265,   3.6734693877551017,
      1.7755102040816326,  1.8367346938775508,  1.8979591836734693,
      1.9591836734693877,  1.0408163265306123,  1.1020408163265305,
      1.163265306122449,   1.2244897959183672,  2.3265306122448974,
      2.4489795918367347,  2.571428571428571,   2.693877551020408,
      3.8571428571428568,  4.040816326530612,   4.224489795918367,
      4.408163265306122,   5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    4.591836734693877,
      4.775510204081632,   4.959183673469387,   5.142857142857143,
      3.3061224489795915,  3.428571428571428,   3.551020408163265,
      3.6734693877551017,  1.7755102040816326,  1.8367346938775508,
      1.8979591836734693,  1.9591836734693877,  1.0408163265306123,
      1.1020408163265305,  1.163265306122449,   1.2244897959183672,
      2.3265306122448974,  2.4489795918367347,  2.571428571428571,
      2.693877551020408,   3.8571428571428568,  4.040816326530612,
      4.224489795918367,   4.408163265306122,   5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      4.591836734693877,   4.775510204081632,   4.959183673469387,
      5.142857142857143,   3.3061224489795915,  3.428571428571428,
      3.551020408163265,   3.6734693877551017,  1.7755102040816326,
      1.8367346938775508,  1.8979591836734693,  1.9591836734693877,
      1.0408163265306123,  1.1020408163265305,  1.163265306122449,
      1.2244897959183672,  2.3265306122448974,  2.4489795918367347,
      2.571428571428571,   2.693877551020408,   3.8571428571428568,
      4.040816326530612,   4.224489795918367,   4.408163265306122,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.591836734693877,   4.775510204081632,
      4.959183673469387,   5.142857142857143,   3.3061224489795915,
      3.428571428571428,   3.551020408163265,   3.6734693877551017,
      1.7755102040816326,  1.8367346938775508,  1.8979591836734693,
      1.9591836734693877,  1.0204081632653061,  1.0612244897959182,
      1.1020408163265305,  1.1428571428571428,  2.204081632653061,
      2.2857142857142856,  2.3673469387755097,  2.4489795918367343,
      3.5510204081632653,  3.6734693877551017,  3.795918367346938,
      3.9183673469387754,  5.061224489795918,   5.224489795918366,
      5.387755102040815,   5.551020408163265,   5.061224489795918,
      5.224489795918366,   5.387755102040815,   5.551020408163265,
      5.061224489795918,   5.224489795918366,   5.387755102040815,
      5.551020408163265,   5.061224489795918,   5.224489795918366,
      5.387755102040815,   5.551020408163265,   4.040816326530612,
      4.163265306122449,   4.285714285714285,   4.408163265306122,
      2.8571428571428568,  2.9387755102040813,  3.020408163265306,
      3.1020408163265305,  1.510204081632653,   1.5510204081632653,
      1.5918367346938775,  1.6326530612244898,  0.673469387755102,
      0.6938775510204082,  0.7142857142857142,  0.7346938775510203,
      1.4285714285714284,  1.4693877551020407,  1.510204081632653,
      1.5510204081632653,  2.265306122448979,   2.326530612244898,
      2.387755102040816,   2.4489795918367347,  3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      2.510204081632653,   2.571428571428571,   2.63265306122449,
      2.6938775510204076,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  0.9183673469387754,
      0.9387755102040816,  0.9591836734693877,  0.9795918367346939};
  const std::array<int, 4> in_shape = {{1, 9, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.15218253968254,   8.794019274376419,  10.836082766439908,
      13.43846371882086,  14.767630385487529, 12.924773242630383,
      11.262471655328797, 9.729138321995464,  10.870209750566895,
      13.2671485260771,   16.213973922902493, 19.93064058956916,
      21.509807256235824, 18.69552154195011,  16.19988662131519,
      13.931859410430839, 15.456264172335601, 18.77157029478458,
      22.813633786848072, 27.873157596371875, 29.70232426303854,
      25.68803854875283,  22.168594104308387, 19.002607709750567,
      20.910345804988662, 25.307284580498866, 30.63506235827664,
      37.266014739229014, 39.34518140589568,  33.902324263038544,
      29.168594104308387, 24.94138321995465,  27.855782312925168,
      33.5265306122449,   40.32653061224489,  48.70748299319727,
      50.6408163265306,   43.364625850340126, 37.117006802721086,
      31.604081632653063, 36.36244897959183,  43.63319727891156,
      52.299863945578224, 62.9208163265306,   64.85414965986392,
      55.33795918367347,  47.223673469387755, 40.11074829931973,
      48.15193310657597,  57.672681405895695, 68.97823696145124,
      82.78252267573696,  84.86168934240362,  72.24549886621315,
      61.53399092970521,  52.182970521541954, 45.301933106575966,
      54.230844671201815, 64.82211451247166,  77.74068594104308,
      79.56985260770976,  67.69651927437643,  57.627868480725624,
      48.84827664399093,  41.583905895691615, 49.75771541950113,
      59.44422335600907,  71.24850907029479,  72.82767573696145,
      61.92577097505669,  52.69045351473923,  44.64555555555556,
      36.9978514739229,   44.25329365079365,  52.8445634920635,
      63.30599206349206,  64.63515873015874,  54.93325396825397,
      46.72174603174604,  39.57480725623583};
  const std::array<int, 4> in_shape = {{1, 10, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612,  0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.04081632653061224,  0.08163265306122448,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.12244897959183673,  0.18367346938775508,  0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.24489795918367346,
      0.32653061224489793,  0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.40816326530612246,  0.32653061224489793,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.40816326530612246,  0.32653061224489793,  0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.40816326530612246,
      0.32653061224489793,  0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.40816326530612246,  0.30612244897959184,
      0.6734693877551019,   0.6734693877551019,   0.6734693877551019,
      0.6734693877551019,   0.6734693877551019,   0.6734693877551019,
      0.36734693877551017,  0.24489795918367346,  0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.2857142857142857,
      0.14285714285714285,  0.30612244897959184,  0.30612244897959184,
      0.30612244897959184,  0.30612244897959184,  0.30612244897959184,
      0.30612244897959184,  0.16326530612244897};
  const std::array<int, 4> in_shape = {{1, 10, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.72748866213152,  14.30436507936508,  16.90265873015873,
      17.588038548752838, 20.860198412698413, 21.672165532879816,
      25.91305555555556,  26.87692743764172,  28.571388888888887,
      29.535260770975057, 25.037579365079367, 25.849546485260767,
      21.839563492063494, 22.524943310657594, 18.88140022675737,
      19.458276643990928, 21.055039682539682, 21.74041950113379,
      25.720005668934242, 26.5342970521542,   31.46325963718821,
      32.42794784580499,  38.716116780045354, 39.86128117913832,
      41.874450113378686, 43.01961451247165,  36.426354875283444,
      37.39104308390022,  31.58548185941043,  32.39977324263038,
      27.17833900226757,  27.863718820861678, 30.11864512471655,
      30.912528344671202, 36.59993764172336,  37.54314058956916,
      44.509858276643996, 45.627267573696145, 54.419858276644,
      55.74631519274375,  58.07819160997733,  59.40464852607708,
      50.258667800453516, 51.37607709750566,  43.393985260770975,
      44.33718820861677,  37.21133219954648,  38.005215419501134,
      40.91830498866213,  41.820691609977324, 49.54245464852608,
      50.61456916099773,  59.999994331065764, 61.27012471655328,
      73.02428004535149,  74.53202947845803,  77.1826133786848,
      78.69036281179136,  66.53451814058957,  67.80464852607709,
      57.26507369614513,  58.33718820861677,  48.98037981859411,
      49.8827664399093,   54.8724716553288,   55.711564625850336,
      66.05614512471656,  67.0530612244898,   79.47201814058958,
      80.65306122448978,  96.01297052154196,  97.41496598639453,
      99.87963718820862,  101.2816326530612,  85.54820861678004,
      86.72925170068025,  73.23709750566894,  74.23401360544217,
      62.36907029478458,  63.208163265306126, 71.88580498866214,
      72.72489795918366,  86.26947845804989,  87.26639455782312,
      103.41868480725623, 104.59972789115645, 124.43963718820861,
      125.8416326530612,  128.30630385487527, 129.70829931972784,
      109.49487528344675, 110.67591836734694, 93.45043083900227,
      94.44734693877551,  79.3824036281179,   80.22149659863946,
      95.40147959183673,  96.30386621315193,  114.27324829931972,
      115.34536281179139, 136.68634353741498, 137.9564739229025,
      164.05729591836737, 165.5650453514739,  168.2156292517007,
      169.72337868480724, 143.22086734693877, 144.4909977324263,
      121.99586734693874, 123.06798185941042, 103.46355442176869,
      104.36594104308391, 89.80998299319727,  90.60386621315193,
      107.51848639455781, 108.46168934240363, 128.52681972789117,
      129.64422902494331, 154.15491496598642, 155.48137188208617,
      157.81324829931975, 159.13970521541953, 134.27562925170065,
      135.39303854875286, 114.31253401360541, 115.25573696145125,
      96.90267006802718,  97.69655328798186,  82.48243197278912,
      83.16781179138323,  98.7011394557823,   99.51543083900226,
      117.92375850340134, 118.88844671201814, 141.35185374149657,
      142.49701814058957, 144.5101870748299,  145.6553514739229,
      122.88685374149657, 123.85154195011339, 104.56661564625847,
      105.38090702947846, 88.60573129251699,  89.29111111111112,
      73.41882653061224,  73.9957029478458,   87.82120748299317,
      88.5065873015873,   104.87715986394555, 105.689126984127,
      125.64811224489793, 126.61198412698413, 128.30644557823126,
      129.27031746031747, 109.0545408163265,  109.86650793650794,
      92.75811224489793,  93.44349206349207,  78.5727380952381,
      79.14961451247166};
  const std::array<int, 4> in_shape = {{1, 10, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.42857142857142855, 0.4897959183673469,
      0.5714285714285714,  0.6530612244897959,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  0.7346938775510203,
      0.8163265306122449,  0.5510204081632653,  0.6122448979591837,
      1.2244897959183672,  1.3469387755102038,  1.2244897959183672,
      1.3469387755102038,  1.2244897959183672,  1.3469387755102038,
      1.2244897959183672,  1.3469387755102038,  1.2244897959183672,
      1.3469387755102038,  1.2244897959183672,  1.3469387755102038,
      0.6734693877551019,  0.7346938775510203,  0.44897959183673464,
      0.4897959183673469,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.5306122448979591,  0.5714285714285714,
      0.26530612244897955, 0.2857142857142857,  0.5714285714285714,
      0.6122448979591837,  0.5714285714285714,  0.6122448979591837,
      0.5714285714285714,  0.6122448979591837,  0.5714285714285714,
      0.6122448979591837,  0.5714285714285714,  0.6122448979591837,
      0.5714285714285714,  0.6122448979591837,  0.3061224489795918,
      0.32653061224489793};
  const std::array<int, 4> in_shape = {{1, 10, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907029477, 27.45497732426304,  28.031853741496597,
      28.60873015873016,  33.119937641723354, 33.80531746031746,
      34.49069727891156,  35.176077097505676, 40.90842970521542,
      41.720396825396826, 42.532363945578226, 43.34433106575963,
      50.862239229024944, 51.82611111111112,  52.78998299319728,
      53.75385487528344,  56.178905895691614, 57.14277777777777,
      58.10664965986395,  59.070521541950114, 49.263191609977326,
      50.07515873015873,  50.88712585034013,  51.699092970521534,
      42.993747165532874, 43.67912698412699,  44.36450680272108,
      45.04988662131519,  37.18592403628118,  37.76280045351474,
      38.33967687074829,  38.916553287981856, 41.42469954648526,
      42.110079365079365, 42.795459183673465, 43.48083900226758,
      50.62571995464852,  51.440011337868484, 52.25430272108843,
      53.0685941043084,   61.961831065759625, 62.92651927437642,
      63.89120748299319,  64.85589569160997,  76.28706916099772,
      77.43223356009071,  78.57739795918367,  79.72256235827663,
      82.6037358276644,   83.74890022675737,  84.89406462585035,
      86.0392290249433,   71.88802154195011,  72.85270975056689,
      73.81739795918367,  74.78208616780044,  62.356672335600905,
      63.17096371882086,  63.98525510204081,  64.79954648526076,
      53.67129818594104,  54.35667800453514,  55.04205782312925,
      55.727437641723355, 59.44340702947846,  60.2372902494331,
      61.031173469387745, 61.825056689342404, 72.2566723356009,
      73.19987528344672,  74.1430782312925,   75.08628117913833,
      87.9023072562358,   89.01971655328799,  90.13712585034013,
      91.25453514739229,  107.51325963718818, 108.839716553288,
      110.16617346938774, 111.4926303854875,  114.82992630385486,
      116.15638321995466, 117.48284013605442, 118.80929705215416,
      99.39992630385487,  100.51733560090703, 101.63474489795917,
      102.75215419501131, 85.84476757369615,  86.78797052154195,
      87.73117346938774,  88.67437641723355,  73.62878117913833,
      74.42266439909297,  75.21654761904762,  76.01043083900227,
      80.93422335600908,  81.83660997732426,  82.73899659863945,
      83.64138321995465,  98.01279478458049,  99.08490929705216,
      100.15702380952379, 101.22913832199546, 118.72985827664397,
      119.99998866213153, 121.27011904761903, 122.54024943310657,
      144.54081065759635, 146.04856009070298, 147.5563095238095,
      149.06405895691606, 152.85747732426302, 154.3652267573696,
      155.8729761904762,  157.38072562358272, 131.7989058956916,
      133.06903628117914, 134.33916666666664, 135.60929705215418,
      113.45803287981859, 114.53014739229026, 115.60226190476189,
      116.67437641723355, 97.05837301587302,  97.96075963718822,
      98.86314625850339,  99.7655328798186,   108.90585034013606,
      109.7449433106576,  110.58403628117911, 111.42312925170067,
      131.11537414965986, 132.11229024943313, 133.10920634920632,
      134.1061224489796,  157.7629931972789,  158.94403628117917,
      160.1250793650793,  161.30612244897955, 190.6239455782313,
      192.02594104308392, 193.4279365079365,  194.82993197278907,
      198.3572789115646,  199.75927437641724, 201.16126984126984,
      202.5632653061224,  169.91537414965984, 171.0964172335601,
      172.2774603174603,  173.4585034013605,  145.4772789115646,
      146.47419501133788, 147.4711111111111,  148.46802721088434,
      123.89904761904764, 124.73814058956916, 125.57723356009069,
      126.41632653061225, 142.93251700680273, 143.7716099773243,
      144.61070294784577, 145.44979591836733, 171.54204081632656,
      172.53895691609978, 173.535873015873,   174.53278911564624,
      205.65632653061223, 206.83736961451245, 208.0184126984127,
      209.1994557823129,  247.4772789115646,  248.87927437641721,
      250.28126984126982, 251.6832653061224,  255.21061224489796,
      256.61260770975053, 258.01460317460317, 259.4165986394557,
      217.8087074829932,  218.9897505668935,  220.17079365079363,
      221.35183673469388, 185.9039455782313,  186.90086167800453,
      187.89777777777778, 188.89469387755102, 157.9257142857143,
      158.7648072562358,  159.60390022675736, 160.44299319727892,
      189.9005725623583,  190.80295918367347, 191.70534580498867,
      192.60773242630387, 227.47438208616782, 228.54649659863944,
      229.61861111111114, 230.69072562358278, 272.1025566893424,
      273.37268707482997, 274.6428174603175,  275.912947845805,
      326.60684240362815, 328.11459183673475, 329.6223412698412,
      331.1300907029478,  334.9235090702948,  336.4312585034014,
      337.93900793650795, 339.4467573696145,  285.17160430839,
      286.44173469387755, 287.7118650793651,  288.9819954648526,
      242.91962018140592, 243.99173469387748, 245.06384920634923,
      246.13596371882085, 206.02472222222224, 206.92710884353738,
      207.8294954648526,  208.73188208616781, 178.8260827664399,
      179.61996598639453, 180.41384920634923, 181.20773242630386,
      214.09376984126985, 215.03697278911562, 215.98017573696146,
      216.92337868480726, 255.93623015873018, 257.05363945578233,
      258.1710487528345,  259.28845804988663, 306.98337301587304,
      308.30982993197284, 309.63628684807253, 310.96274376417233,
      314.3000396825397,  315.6264965986395,  316.95295351473925,
      318.27941043083905, 267.43384920634924, 268.5512585034013,
      269.66866780045353, 270.7860770975057,  227.68186507936508,
      228.62506802721083, 229.56827097505672, 230.5114739229025,
      193.01145691609977, 193.80534013605435, 194.5992233560091,
      195.3931065759637,  164.2794841269841,  164.96486394557823,
      165.6502437641724,  166.33562358276646, 196.58798752834466,
      197.4022789115646,  198.21657029478462, 199.03086167800453,
      234.88282879818595, 235.8475170068027,  236.81220521541954,
      237.77689342403627, 281.5585430839002,  282.70370748299314,
      283.8488718820862,  284.99403628117915, 287.8752097505669,
      289.0203741496598,  290.1655385487529,  291.3107029478458,
      244.80901927437642, 245.77370748299313, 246.73839569161004,
      247.70308390022677, 208.31893990929706, 209.13323129251694,
      209.947522675737,   210.76181405895693, 176.5260827664399,
      177.21146258503398, 177.89684240362814, 178.58222222222224,
      146.26077664399094, 146.83765306122447, 147.41452947845806,
      147.9914058956916,  174.95703514739228, 175.64241496598635,
      176.32779478458053, 177.0131746031746,  208.94235260770972,
      209.7543197278911,  210.56628684807262, 211.378253968254,
      250.33235260770974, 251.29622448979586, 252.26009637188213,
      253.22396825396825, 255.64901927437643, 256.6128911564625,
      257.57676303854885, 258.54063492063494, 217.29711451247164,
      218.109081632653,   218.9210487528345,  219.7330158730159,
      184.83084467120182, 185.51622448979586, 186.20160430839002,
      186.88698412698415, 156.5685997732426,  157.1454761904762,
      157.72235260770972, 158.29922902494332};
  const std::array<int, 4> in_shape = {{1, 10, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.1020408163265306,  0.12244897959183673,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.2857142857142857,  0.32653061224489793,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.36734693877551017, 0.40816326530612246, 0.44897959183673464,
      0.4897959183673469,  0.5510204081632653,  0.6122448979591836,
      0.673469387755102,   0.7346938775510203,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  0.7959183673469388,
      0.8571428571428571,  0.9183673469387754,  0.9795918367346939,
      1.0612244897959182,  1.1428571428571428,  1.2244897959183674,
      1.3061224489795917,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  1.3877551020408163,  1.4693877551020407,
      1.5510204081632653,  1.6326530612244898,  1.0612244897959182,
      1.1428571428571428,  1.2244897959183674,  1.3061224489795917,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      1.3877551020408163,  1.4693877551020407,  1.5510204081632653,
      1.6326530612244898,  1.0612244897959182,  1.1428571428571428,
      1.2244897959183674,  1.3061224489795917,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  1.3877551020408163,
      1.4693877551020407,  1.5510204081632653,  1.6326530612244898,
      1.0612244897959182,  1.1428571428571428,  1.2244897959183674,
      1.3061224489795917,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  1.3877551020408163,  1.4693877551020407,
      1.5510204081632653,  1.6326530612244898,  1.0408163265306123,
      1.1020408163265305,  1.163265306122449,   1.2244897959183674,
      2.326530612244898,   2.4489795918367343,  2.571428571428571,
      2.6938775510204076,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.6938775510204076,  2.326530612244898,
      2.4489795918367343,  2.571428571428571,   2.6938775510204076,
      2.326530612244898,   2.4489795918367343,  2.571428571428571,
      2.6938775510204076,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.6938775510204076,  2.326530612244898,
      2.4489795918367343,  2.571428571428571,   2.6938775510204076,
      1.2857142857142856,  1.3469387755102038,  1.4081632653061225,
      1.4693877551020407,  0.8571428571428572,  0.8979591836734693,
      0.9387755102040816,  0.9795918367346939,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.0204081632653061,
      1.0612244897959182,  1.1020408163265305,  1.1428571428571428,
      0.5102040816326531,  0.5306122448979591,  0.5510204081632653,
      0.5714285714285714,  1.1020408163265305,  1.1428571428571428,
      1.183673469387755,   1.2244897959183674,  1.1020408163265305,
      1.1428571428571428,  1.183673469387755,   1.2244897959183674,
      1.1020408163265305,  1.1428571428571428,  1.183673469387755,
      1.2244897959183674,  1.1020408163265305,  1.1428571428571428,
      1.183673469387755,   1.2244897959183674,  1.1020408163265305,
      1.1428571428571428,  1.183673469387755,   1.2244897959183674,
      1.1020408163265305,  1.1428571428571428,  1.183673469387755,
      1.2244897959183674,  0.5918367346938775,  0.6122448979591836,
      0.6326530612244897,  0.6530612244897959};
  const std::array<int, 4> in_shape = {{1, 10, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.882772108843537,  9.66202380952381,   11.549778911564626,
      13.87874716553288,  14.47124716553288,  16.30922335600907,
      14.486604308390024, 12.815856009070295, 11.036604308390022,
      12.034812925170067, 14.65079931972789,  17.395697278911566,
      20.748475056689344, 21.276689342403625, 23.63609410430839,
      20.884903628117918, 18.39782879818594,  15.781842403628119,
      17.163384353741495, 20.799778911564623, 24.58549319727891,
      29.176366213151926, 29.57600907029478,  32.52112811791383,
      28.627080498866217, 25.14000566893424,  21.50361111111111,
      23.268486394557826, 28.108962585034014, 33.11916666666667,
      39.16242063492063,  39.369206349206344, 42.964325396825394,
      37.71313492063492,  33.04238662131519,  28.201910430839,
      31.100034013605445, 37.38098639455782,  43.819761904761904,
      51.515793650793654, 51.085079365079366, 55.051031746031754,
      48.09150793650793,  41.968378684807256, 35.68742630385487,
      40.670034013605445, 48.75098639455783,  56.989761904761906,
      66.78579365079366,  65.72507936507937,  70.32103174603175,
      61.26150793650793,  53.33837868480725,  45.25742630385487,
      53.91527210884354,  64.52003401360544,  75.29452380952382,
      88.0627777777778,   86.25206349206353,  91.86468253968256,
      79.88849206349207,  69.45345804988662,  58.84869614512471,
      50.739761904761906, 60.69146258503402,  70.79248299319728,
      82.75121315192746,  80.94049886621316,  86.09597505668935,
      74.83407029478458,  65.03168934240362,  55.07998866213151,
      46.58772108843537,  55.70268707482993,  64.94656462585034,
      75.88148526077099,  74.1350566893424,   78.76910430839003,
      68.43577097505668,  59.44971655328798,  50.33475056689341,
      41.45914965986395,  49.55370748299319,  57.75676870748299,
      67.45359410430838,  65.83573696145123,  69.88407029478456,
      60.69359410430838,  52.707539682539675, 44.61298185941043};
  const std::array<int, 4> in_shape = {{1, 10, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.12244897959183673, 0.12244897959183673,  0.12244897959183673,
      0.12244897959183673, 0.10204081632653061,  0.061224489795918366,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.24489795918367346, 0.5510204081632653,   0.9183673469387754,
      0.9183673469387754,  0.9183673469387754,   0.9183673469387754,
      0.9183673469387754,  0.673469387755102,    0.36734693877551017,
      0.44897959183673464, 0.9795918367346939,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.1428571428571428,   0.6122448979591837,
      0.44897959183673464, 0.9795918367346939,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.1428571428571428,   0.6122448979591837,
      0.44897959183673464, 0.9795918367346939,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.1428571428571428,   0.6122448979591837,
      0.44897959183673464, 0.9795918367346939,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.1428571428571428,   0.6122448979591837,
      0.4285714285714285,  0.9183673469387754,   1.469387755102041,
      1.469387755102041,   1.469387755102041,    1.469387755102041,
      1.469387755102041,   1.0408163265306123,   0.5510204081632653,
      0.346938775510204,   0.7346938775510203,   1.163265306122449,
      1.163265306122449,   1.163265306122449,    1.163265306122449,
      1.163265306122449,   0.8163265306122449,   0.42857142857142855,
      0.2040816326530612,  0.4285714285714285,   0.6734693877551019,
      0.6734693877551019,  0.6734693877551019,   0.6734693877551019,
      0.6734693877551019,  0.4693877551020408,   0.24489795918367346};
  const std::array<int, 4> in_shape = {{1, 10, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.188667800453512, 15.765544217687074, 18.63866780045351,
      19.32404761904762,  22.3056746031746,   23.099557823129253,
      26.837023809523814, 27.75749433106576,  28.060000000000002,
      28.94249433106576,  31.697976190476187, 32.61844671201814,
      28.179325396825394, 28.97320861678005,  24.946332199546482,
      25.63171201814059,  21.496332199546483, 22.073208616780043,
      23.384246031746027, 24.069625850340135, 28.487307256235823,
      29.30159863945578,  33.84819160997732,  34.79139455782313,
      40.403350340136065, 41.49695011337869,  41.50489795918368,
      42.55337868480725,  46.17858843537415,  47.27218820861678,
      40.826604308390024, 41.769807256235836, 35.98136621315193,
      36.79565759637188,  30.878304988662126, 31.563684807256237,
      33.53288548752834,  34.32676870748299,  40.65635487528344,
      41.599557823129246, 48.078463718820856, 49.17098639455782,
      57.08600340136055,  58.35273242630385,  57.937551020408165,
      59.15201814058956,  63.77552721088435,  65.04225623582767,
      56.16163832199546,  57.254160997732434, 49.336808390022675,
      50.28001133786848,  42.21333900226756,  43.00722222222222,
      45.63458616780045,  46.53697278911565,  55.145810657596364,
      56.21792517006803,  64.9964909297052,   66.23833333333334,
      76.8849829931973,   78.32484126984126,  77.35795918367347,
      78.73841269841269,  84.4887925170068,   85.92865079365079,
      74.18442743764172,  75.42626984126984,  65.01265873015872,
      66.08477324263038,  55.5014342403628,   56.403820861678,
      61.36097505668933,  62.20006802721089,  73.76505668934239,
      74.76197278911565,  86.48478458049885,  87.63952380952381,
      101.69272108843538, 103.03158730158731, 100.8865306122449,
      102.17015873015873, 108.76319727891155, 110.10206349206351,
      95.02827664399092,  96.18301587301586,  82.93984126984125,
      83.93675736961451,  70.53575963718819,  71.37485260770974,
      80.50097505668933,  81.34006802721089,  96.50505668934238,
      97.50197278911565,  112.82478458049884, 113.97952380952381,
      132.23272108843534, 133.57158730158733, 130.16653061224488,
      131.45015873015873, 139.30319727891157, 140.6420634920635,
      121.36827664399091, 122.52301587301586, 105.67984126984125,
      106.6767573696145,  89.6757596371882,   90.51485260770974,
      106.92815759637188, 107.83054421768708, 127.96795351473921,
      129.04006802721088, 149.34720521541948, 150.58904761904765,
      174.68569727891153, 176.1255555555556,  171.12367346938774,
      172.50412698412705, 182.28950680272106, 183.72936507936512,
      158.535141723356,   159.77698412698413, 137.83480158730157,
      138.90691609977324, 116.79500566893424, 117.69739229024943,
      100.68564058956916, 101.47952380952381, 120.43972222222222,
      121.38292517006803, 140.49244331065756, 141.58496598639456,
      164.23569727891152, 165.50242630385492, 160.66653061224486,
      161.88099773242632, 170.92522108843534, 172.1919501133787,
      148.5756179138322,  149.66814058956916, 129.12017573696147,
      130.06337868480725, 109.3660941043084,  110.15997732426302,
      92.49006235827665,  93.17544217687075,  110.5910827664399,
      111.40537414965986, 128.94992630385485, 129.89312925170069,
      150.6693707482993,  151.76297052154197, 147.2216326530612,
      148.2701133786848,  156.4446088435374,  157.53820861678005,
      135.9283390022676,  136.87154195011337, 118.08514172335602,
      118.89943310657596, 99.98412131519275,  100.66950113378682,
      82.34142290249434,  82.9182993197279,   98.42203514739231,
      99.10741496598638,  114.71965419501134, 115.51353741496598,
      133.98671768707482, 134.90718820861676, 130.78897959183675,
      131.67147392290246, 138.84767006802724, 139.76814058956913,
      120.59330498866215, 121.38718820861676, 104.72969954648528,
      105.41507936507935, 88.6490873015873,   89.22596371882086};
  const std::array<int, 4> in_shape = {{1, 10, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.18367346938775508,
      0.24489795918367346, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.16326530612244897,
      0.20408163265306123, 0.1020408163265306,  0.12244897959183673,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.4285714285714285,  0.4897959183673469,  0.9795918367346936,
      1.1020408163265305,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.6530612244897958,
      1.8367346938775508,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.2244897959183672,
      1.346938775510204,   0.673469387755102,   0.7346938775510203,
      0.8163265306122448,  0.8979591836734693,  1.7959183673469385,
      1.9591836734693877,  2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.1224489795918364,
      2.2857142857142856,  1.1428571428571428,  1.2244897959183674,
      0.8163265306122448,  0.8979591836734693,  1.7959183673469385,
      1.9591836734693877,  2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.1224489795918364,
      2.2857142857142856,  1.1428571428571428,  1.2244897959183674,
      0.8163265306122448,  0.8979591836734693,  1.7959183673469385,
      1.9591836734693877,  2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.1224489795918364,
      2.2857142857142856,  1.1428571428571428,  1.2244897959183674,
      0.8163265306122448,  0.8979591836734693,  1.7959183673469385,
      1.9591836734693877,  2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.1224489795918364,
      2.2857142857142856,  1.1428571428571428,  1.2244897959183674,
      0.7959183673469388,  0.857142857142857,   1.7142857142857142,
      1.8367346938775508,  2.7551020408163263,  2.938775510204082,
      2.7551020408163263,  2.938775510204082,   2.7551020408163263,
      2.938775510204082,   2.7551020408163263,  2.938775510204082,
      2.7551020408163263,  2.938775510204082,   1.9591836734693877,
      2.0816326530612246,  1.0408163265306123,  1.1020408163265305,
      0.6530612244897959,  0.693877551020408,   1.3877551020408163,
      1.4693877551020407,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.5510204081632653,
      1.6326530612244898,  0.8163265306122449,  0.8571428571428571,
      0.3877551020408163,  0.4081632653061224,  0.8163265306122449,
      0.857142857142857,   1.2857142857142856,  1.3469387755102038,
      1.2857142857142856,  1.3469387755102038,  1.2857142857142856,
      1.3469387755102038,  1.2857142857142856,  1.3469387755102038,
      1.2857142857142856,  1.3469387755102038,  0.8979591836734693,
      0.9387755102040816,  0.4693877551020408,  0.4897959183673469};
  const std::array<int, 4> in_shape = {{1, 10, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.800459183673464, 30.377335600907024, 30.954212018140588,
      31.531088435374148, 36.59195578231292,  37.27733560090702,
      37.96271541950113,  38.64809523809524,  43.81746598639456,
      44.6113492063492,   45.405232426303854, 46.199115646258505,
      52.75357709750567,  53.67404761904763,  54.594518140589564,
      55.51498866213152,  55.23750566893423,  56.120000000000005,
      57.00249433106575,  57.88498866213152,  62.47548185941042,
      63.39595238095237,  64.31642290249434,  65.23689342403628,
      55.56476757369614,  56.35865079365079,  57.15253401360544,
      57.9464172335601,   49.20728458049886,  49.892664399092965,
      50.57804421768707,  51.26342403628118,  42.4157879818594,
      42.992664399092966, 43.56954081632652,  44.146417233560086,
      46.08311224489796,  46.768492063492054, 47.45387188208617,
      48.13925170068027,  56.1603231292517,   56.974614512471646,
      57.788905895691606, 58.60319727891156,  66.75318027210885,
      67.69638321995464,  68.63958616780045,  69.58278911564626,
      79.71310090702949,  80.80670068027213,  81.90030045351473,
      82.99390022675738,  81.96131519274377,  83.00979591836736,
      84.05827664399091,  85.1067573696145,   91.26357709750566,
      92.3571768707483,   93.45077664399092,  94.54437641723356,
      80.71000566893422,  81.65320861678005,  82.59641156462584,
      83.53961451247167,  71.14844104308389,  71.96273242630386,
      72.7770238095238,   73.59131519274376,  61.07123015873015,
      61.75660997732425,  62.44198979591836,  63.127369614512475,
      66.27188775510204,  67.06577097505668,  67.85965419501134,
      68.65353741496598,  80.36950680272109,  81.31270975056688,
      82.2559126984127,   83.19911564625849,  95.06440476190477,
      96.15692743764171,  97.24945011337869,  98.34197278911564,
      112.90527777777778, 114.1720068027211,  115.4387358276644,
      116.7054648526077,  114.66063492063493, 115.87510204081633,
      117.08956916099771, 118.30403628117912, 126.2843253968254,
      127.5510544217687,  128.817783446712,   130.08451247165533,
      111.23075396825395, 112.32327664399092, 113.41579931972788,
      114.50832199546487, 97.73041383219955,  98.67361678004535,
      99.61681972789114,  100.56002267573696, 83.6327947845805,
      84.42667800453512,  85.22056122448978,  86.01444444444444,
      90.36678571428573,  91.2691723356009,   92.17155895691609,
      93.0739455782313,   109.2195068027211,  110.29162131519273,
      111.36373582766439, 112.43585034013606, 128.75113945578232,
      129.9929818594104,  131.23482426303855, 132.4766666666667,
      152.33010770975056, 153.7699659863946,  155.20982426303854,
      156.64968253968252, 153.33546485260774, 154.71591836734694,
      156.09637188208612, 157.47682539682538, 167.5377267573696,
      168.9775850340136,  170.41744331065757, 171.85730158730158,
      147.1270124716553,  148.36885487528343, 149.61069727891154,
      150.85253968253969, 128.9532029478458,  130.02531746031744,
      131.0974319727891,  132.16954648526075, 110.10048185941042,
      111.0028684807256,  111.90525510204081, 112.807641723356,
      121.88285714285716, 122.72195011337865, 123.5610430839002,
      124.40013605442178, 146.53319727891156, 147.53011337868477,
      148.52702947845805, 149.5239455782313,  171.81482993197278,
      172.9695691609977,  174.12430839002266, 175.27904761904762,
      202.0465759637188,  203.38544217687075, 204.72430839002266,
      206.06317460317462, 200.489433106576,   201.7730612244898,
      203.0566893424036,  204.34031746031746, 216.18752834467122,
      217.5263945578231,  218.86526077097506, 220.20412698412702,
      188.90181405895692, 190.05655328798184, 191.21129251700683,
      192.36603174603172, 164.88276643990932, 165.8796825396825,
      166.87659863945578, 167.87351473922902, 140.23242630385488,
      141.07151927437639, 141.91061224489798, 142.74970521541948,
      160.16285714285715, 161.00195011337865, 161.84104308390022,
      162.68013605442178, 192.01319727891155, 193.01011337868476,
      194.00702947845804, 195.0039455782313,  224.4948299319728,
      225.6495691609977,  226.80430839002264, 227.95904761904762,
      263.1265759637188,  264.4654421768707,  265.80430839002264,
      267.14317460317466, 259.049433106576,   260.33306122448977,
      261.61668934240356, 262.90031746031747, 277.2675283446712,
      278.60639455782314, 279.945260770975,   281.284126984127,
      241.58181405895695, 242.73655328798182, 243.8912925170068,
      245.04603174603173, 210.36276643990934, 211.3596825396825,
      212.35659863945583, 213.353514739229,   178.51242630385488,
      179.3515192743764,  180.19061224489795, 181.02970521541948,
      212.95392857142858, 213.85631519274375, 214.75870181405898,
      215.66108843537415, 254.86379251700677, 255.93590702947841,
      257.00802154195014, 258.08013605442176, 297.4525680272108,
      298.69441043083896, 299.9362528344671,  301.1780952380953,
      347.93153628117915, 349.37139455782307, 350.8112528344671,
      352.2511111111112,  340.8668934240363,  342.2473469387755,
      343.6278004535147,  345.0082539682541,  363.1391553287982,
      364.5790136054421,  366.0188718820861,  367.45873015873025,
      315.8284410430839,  317.070283446712,   318.3121258503401,
      319.55396825396826, 274.5974886621315,  275.66960317460314,
      276.7417176870748,  277.8138321995465,  232.6876247165533,
      233.59001133786848, 234.49239795918365, 235.39478458049885,
      200.57739795918366, 201.37128117913832, 202.16516439909296,
      202.95904761904762, 239.93624149659863, 240.87944444444443,
      241.82264739229026, 242.76585034013607, 279.89236394557815,
      280.9848866213151,  282.0774092970522,  283.16993197278913,
      327.2046655328798,  328.47139455782303, 329.73812358276643,
      331.00485260770984, 320.1185941043084,  321.3330612244897,
      322.5475283446712,  323.76199546485265, 340.58371315192744,
      341.8504421768707,  343.1171712018141,  344.3839002267574,
      296.0587131519274,  297.1512358276644,  298.2437585034013,
      299.3362811791383,  257.2971485260771,  258.24035147392294,
      259.1835544217687,  260.1267573696145,  217.93830498866214,
      218.7321882086168,  219.5260714285714,  220.31995464852605,
      184.29474489795916, 184.9801247165533,  185.66550453514742,
      186.3508843537415,  220.36787414965983, 221.1821655328798,
      221.9964569160998,  222.81074829931973, 256.9566496598639,
      257.8998526077097,  258.8430555555556,  259.78625850340137,
      300.245141723356,   301.3387414965986,  302.43234126984134,
      303.52594104308395, 293.3947845804988,  294.4432653061224,
      295.49174603174606, 296.5402267573696,  311.7956179138322,
      312.8892176870748,  313.98281746031745, 315.0764172335601,
      270.9134750566893,  271.8566780045352,  272.79988095238093,
      273.74308390022674, 235.35599206349207, 236.17028344671203,
      236.98457482993197, 237.7988662131519,  199.2828628117914,
      199.9682426303855,  200.65362244897958, 201.33900226757365,
      164.1059693877551,  164.6828458049887,  165.25972222222225,
      165.8365986394558,  196.15869047619043, 196.84407029478461,
      197.5294501133787,  198.21482993197276, 228.645425170068,
      229.4393083900227,  230.23319160997735, 231.02707482993196,
      267.05296485260766, 267.97343537414963, 268.89390589569166,
      269.8143764172335,  260.69546485260764, 261.5779591836735,
      262.46045351473924, 263.34294784580493, 276.77486961451245,
      277.6953401360545,  278.6158106575964,  279.53628117913826,
      240.39272675736962, 241.1866099773243,  241.98049319727892,
      242.77437641723353, 208.77401927437643, 209.45939909297056,
      210.14477891156463, 210.8301587301587,  176.72129818594104,
      177.2981746031746,  177.87505102040816, 178.45192743764173};
  const std::array<int, 4> in_shape = {{1, 10, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.3061224489795918,  0.36734693877551017,
      0.42857142857142855, 0.4897959183673469,  0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.2857142857142857,  0.32653061224489793,
      0.36734693877551017, 0.40816326530612246, 0.18367346938775508,
      0.2040816326530612,  0.22448979591836732, 0.24489795918367346,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.7959183673469388,  0.857142857142857,   0.9183673469387754,
      0.9795918367346939,  1.8367346938775508,  1.9591836734693873,
      2.081632653061224,   2.204081632653061,   3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  3.122448979591837,   3.3061224489795915,
      3.4897959183673466,  3.6734693877551017,  3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.693877551020408,   1.2857142857142856,
      1.346938775510204,   1.4081632653061222,  1.4693877551020407,
      1.5510204081632653,  1.6326530612244896,  1.714285714285714,
      1.7959183673469385,  3.428571428571428,   3.591836734693877,
      3.755102040816326,   3.9183673469387754,  5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.081632653061224,   4.244897959183673,
      4.408163265306122,   4.571428571428571,   2.204081632653061,
      2.2857142857142856,  2.36734693877551,    2.4489795918367347,
      1.5510204081632653,  1.6326530612244896,  1.714285714285714,
      1.7959183673469385,  3.428571428571428,   3.591836734693877,
      3.755102040816326,   3.9183673469387754,  5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.081632653061224,   4.244897959183673,
      4.408163265306122,   4.571428571428571,   2.204081632653061,
      2.2857142857142856,  2.36734693877551,    2.4489795918367347,
      1.5510204081632653,  1.6326530612244896,  1.714285714285714,
      1.7959183673469385,  3.428571428571428,   3.591836734693877,
      3.755102040816326,   3.9183673469387754,  5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.081632653061224,   4.244897959183673,
      4.408163265306122,   4.571428571428571,   2.204081632653061,
      2.2857142857142856,  2.36734693877551,    2.4489795918367347,
      1.5510204081632653,  1.6326530612244896,  1.714285714285714,
      1.7959183673469385,  3.428571428571428,   3.591836734693877,
      3.755102040816326,   3.9183673469387754,  5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.081632653061224,   4.244897959183673,
      4.408163265306122,   4.571428571428571,   2.204081632653061,
      2.2857142857142856,  2.36734693877551,    2.4489795918367347,
      1.530612244897959,   1.5918367346938775,  1.6530612244897958,
      1.714285714285714,   3.3061224489795915,  3.4285714285714284,
      3.551020408163265,   3.6734693877551017,  5.326530612244897,
      5.5102040816326525,  5.693877551020407,   5.877551020408164,
      5.326530612244897,   5.5102040816326525,  5.693877551020407,
      5.877551020408164,   5.326530612244897,   5.5102040816326525,
      5.693877551020407,   5.877551020408164,   5.326530612244897,
      5.5102040816326525,  5.693877551020407,   5.877551020408164,
      5.326530612244897,   5.5102040816326525,  5.693877551020407,
      5.877551020408164,   3.7959183673469385,  3.9183673469387754,
      4.040816326530612,   4.163265306122449,   2.020408163265306,
      2.0816326530612246,  2.142857142857143,   2.204081632653061,
      1.2653061224489797,  1.3061224489795917,  1.3469387755102038,
      1.387755102040816,   2.693877551020408,   2.7755102040816326,
      2.8571428571428568,  2.9387755102040813,  4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   3.020408163265306,   3.1020408163265305,
      3.1836734693877546,  3.2653061224489797,  1.5918367346938775,
      1.6326530612244898,  1.673469387755102,   1.7142857142857142,
      0.7551020408163265,  0.7755102040816326,  0.7959183673469387,
      0.8163265306122448,  1.5918367346938775,  1.6326530612244898,
      1.673469387755102,   1.714285714285714,   2.510204081632653,
      2.571428571428571,   2.63265306122449,    2.6938775510204076,
      2.510204081632653,   2.571428571428571,   2.63265306122449,
      2.6938775510204076,  2.510204081632653,   2.571428571428571,
      2.63265306122449,    2.6938775510204076,  2.510204081632653,
      2.571428571428571,   2.63265306122449,    2.6938775510204076,
      2.510204081632653,   2.571428571428571,   2.63265306122449,
      2.6938775510204076,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  0.9183673469387754,
      0.9387755102040816,  0.9591836734693877,  0.9795918367346939};
  const std::array<int, 4> in_shape = {{1, 10, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678004535,  10.5300283446712,   12.555198412698413,
      14.688871882086168, 14.710102040816327, 15.773435374149658,
      18.094070294784576, 16.285907029478455, 14.36924036281179,
      12.344070294784583, 13.199416099773241, 16.034450113378682,
      18.998395691609975, 22.091252834467117, 21.791054421768706,
      23.054387755102034, 26.136927437641713, 23.430804988662125,
      20.595770975056684, 17.6318253968254,   18.87050453514739,
      22.82798752834467,  26.93479024943311,  31.1909126984127,
      30.450238095238095, 31.913571428571423, 35.877063492063485,
      32.068900226757364, 28.111417233560083, 24.004614512471655,
      25.626626984126982, 30.910640589569162, 36.3643820861678,
      41.9878514739229,   40.68765306122449,  42.350986394557815,
      47.31447845804988,  42.20019274376416,  36.916179138321986,
      31.46243764172336,  34.34428571428571,  41.23544217687075,
      48.28442176870748,  55.49122448979592,  53.128526077097504,
      54.67519274376416,  60.44424036281178,  53.71090702947845,
      46.81975056689342,  39.770770975056685, 44.97761904761904,
      53.86877551020408,  62.917755102040815, 72.12455782312925,
      68.59519274376417,  70.14185941043084,  77.07757369614512,
      68.34424036281179,  59.45308390022675,  50.40410430839003,
      59.67861111111111,  71.36738662131519,  83.22589002267573,
      95.25412131519273,  90.2178117913832,   91.88114512471654,
      100.58074829931971, 89.06170068027211,  77.37292517006803,
      65.51442176870749,  56.17759070294784,  67.15208049886621,
      78.27589002267572,  89.5490192743764,   84.71509070294783,
      86.17842403628117,  94.2351700680272,   83.41,
      72.43551020408164,  61.31170068027211,  51.59153628117914,
      61.64765873015873,  71.83269274376417,  82.14663832199545,
      77.63413832199545,  78.89747165532879,  86.19231292517006,
      76.26510204081633,  66.20897959183674,  56.0239455782313,
      45.920447845804986, 54.85412131519274,  63.89629818594105,
      73.04697845804988,  68.97495464852608,  70.03828798185941,
      76.4521768707483,   67.6270068027211,   58.693333333333335,
      49.651156462585035};
  const std::array<int, 4> in_shape = {{1, 10, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.20408163265306123, 0.20408163265306123,  0.20408163265306123,
      0.20408163265306123, 0.18367346938775508,  0.14285714285714285,
      0.08163265306122448, 0.12244897959183672,  0.2857142857142857,
      0.48979591836734687, 0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.6122448979591837,
      0.44897959183673464, 0.24489795918367346,  0.3061224489795918,
      0.673469387755102,   1.1020408163265305,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.2857142857142858,  0.9183673469387754,   0.4897959183673469,
      0.5714285714285714,  1.2244897959183674,   1.9591836734693875,
      2.7755102040816326,  2.7755102040816326,   2.7755102040816326,
      2.7755102040816326,  2.2040816326530615,   1.551020408163265,
      0.8163265306122449,  0.5714285714285714,   1.2244897959183674,
      1.9591836734693875,  2.7755102040816326,   2.7755102040816326,
      2.7755102040816326,  2.7755102040816326,   2.2040816326530615,
      1.551020408163265,   0.8163265306122449,   0.5714285714285714,
      1.2244897959183674,  1.9591836734693875,   2.7755102040816326,
      2.7755102040816326,  2.7755102040816326,   2.7755102040816326,
      2.2040816326530615,  1.551020408163265,    0.8163265306122449,
      0.5714285714285714,  1.2244897959183674,   1.9591836734693875,
      2.7755102040816326,  2.7755102040816326,   2.7755102040816326,
      2.7755102040816326,  2.2040816326530615,   1.551020408163265,
      0.8163265306122449,  0.5510204081632653,   1.1632653061224487,
      1.8367346938775506,  2.571428571428571,    2.571428571428571,
      2.571428571428571,   2.571428571428571,    2.020408163265306,
      1.4081632653061222,  0.7346938775510203,   0.44897959183673464,
      0.9387755102040816,  1.4693877551020407,   2.0408163265306123,
      2.0408163265306123,  2.0408163265306123,   2.0408163265306123,
      1.5918367346938773,  1.1020408163265305,   0.5714285714285714,
      0.26530612244897955, 0.5510204081632653,   0.857142857142857,
      1.1836734693877549,  1.1836734693877549,   1.1836734693877549,
      1.1836734693877549,  0.9183673469387754,   0.6326530612244897,
      0.32653061224489793};
  const std::array<int, 4> in_shape = {{1, 10, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.64984693877551,  17.22672335600907,  20.374676870748296,
      21.0600566893424,   24.31651360544218,  25.110396825396826,
      28.475357142857142, 29.377743764172337, 28.581111111111106,
      29.420204081632654, 30.707777777777775, 31.546870748299316,
      35.285753968253964, 36.18814058956915,  31.77793083900226,
      32.57181405895691,  28.053100907029474, 28.73848072562358,
      24.111264172335602, 24.688140589569166, 25.713452380952383,
      26.398832199546483, 31.25460884353741,  32.068900226757364,
      37.053588435374145, 37.99679138321995,  43.11039115646258,
      44.18250566893423,  42.58519274376416,  43.58210884353741,
      45.11185941043083,  46.10877551020407,  51.20174036281178,
      52.273854875283426, 45.918407029478445, 46.86160997732425,
      40.377250566893416, 41.19154195011337,  34.57827097505669,
      35.2636507936508,   36.947125850340136, 37.74100907029478,
      44.71277210884353,  45.65597505668934,  52.77705782312924,
      53.86958049886622,  61.13998299319727,  62.3818253968254,
      59.745736961451236, 60.90047619047619,  62.672403628117905,
      63.827142857142846, 70.51228458049886,  71.75412698412697,
      63.04527777777776,  64.13780045351473,  55.27963151927437,
      56.222834467120165, 47.215345804988665, 48.00922902494331,
      50.35086734693877,  51.253253968253965, 60.74916666666665,
      61.821281179138325, 71.48692176870746,  72.7287641723356,
      82.56413265306122,  83.9757029478458,   80.06274376417231,
      81.37530612244898,  83.38941043083898,  84.70197278911563,
      93.21738662131516,  94.62895691609975,  83.1585430839002,
      84.40038548752833,  72.76024376417232,  73.83235827664397,
      62.02248866213152,  62.92487528344672,  67.84947845804989,
      68.68857142857142,  81.47396825396824,  82.4708843537415,
      95.41410430839,     96.56884353741496,  109.66988662131516,
      110.98244897959184, 105.03655328798182, 106.25705215419501,
      108.12988662131517, 109.35038548752831, 119.5759183673469,
      120.88848072562357, 106.26707482993194, 107.4218140589569,
      92.64258503401359,  93.63950113378684,  78.70244897959184,
      79.54154195011337,  89.11614512471654,  89.95523809523807,
      106.7406349206349,  107.73755102040816, 124.68077097505666,
      125.83551020408163, 142.9365532879818,  144.2491156462585,
      135.96988662131517, 137.19038548752835, 139.0632199546485,
      140.28371882086168, 152.84258503401358, 154.15514739229025,
      135.5337414965986,  136.68848072562358, 117.90925170068026,
      118.9061678004535,  99.96911564625852,  100.80820861678006,
      118.45483560090703, 119.35722222222222, 141.6626587301587,
      142.73477324263038, 165.20993764172334, 166.45178004535146,
      189.09667233560086, 190.50824263038547, 179.12306122448976,
      180.4356235827664,  182.44972789115644, 183.76229024943308,
      199.74992630385483, 201.16149659863942, 176.88155895691605,
      178.12340136054422, 153.6737358276644,  154.74585034013606,
      130.12645691609978, 131.02884353741499, 111.56129818594104,
      112.35518140589568, 133.36095804988662, 134.30416099773242,
      155.45925736961448, 156.55178004535145, 177.8561961451247,
      179.0980385487528,  168.2754421768707,  169.43018140589567,
      171.2021088435374,  172.35684807256234, 187.22849773242626,
      188.4703401360544,  165.72747732426302, 166.82,
      143.92781746031744, 144.87102040816328, 121.82951814058958,
      122.62340136054422, 102.49769274376418, 103.18307256235828,
      122.4810260770975,  123.29531746031746, 142.72218253968254,
      143.66538548752834, 163.22116213151926, 164.2932766439909,
      154.27136054421766, 155.2682766439909,  156.79802721088433,
      157.79494331065757, 171.31251133786847, 172.38462585034011,
      151.58700113378683, 152.53020408163266, 131.6036678004535,
      132.41795918367347, 111.36251133786848, 112.0478911564626,
      91.26401927437644,  91.84089569160997,  109.02286281179138,
      109.70824263038548, 126.99871315192743, 127.7925963718821,
      145.19157029478458, 146.09395691609976, 137.1108163265306,
      137.94990929705216, 139.2374829931973,  140.07657596371882,
      152.00196712018138, 152.9043537414966,  134.46013038548753,
      135.2540136054422,  116.70128684807256, 117.38666666666667,
      98.72543650793651,  99.30231292517007};
  const std::array<int, 4> in_shape = {{1, 10, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.30612244897959184,
      0.36734693877551017, 0.24489795918367346, 0.2857142857142857,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.48979591836734687, 0.5714285714285714,
      0.8571428571428571,  0.9795918367346937,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.1020408163265305,  1.2244897959183674,
      0.8163265306122447,  0.8979591836734693,  0.44897959183673464,
      0.4897959183673469,  0.5510204081632653,  0.6122448979591836,
      1.2244897959183674,  1.346938775510204,   2.020408163265306,
      2.204081632653061,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.387755102040816,   2.5714285714285716,  1.714285714285714,
      1.8367346938775508,  0.9183673469387754,  0.9795918367346939,
      1.0612244897959182,  1.1428571428571428,  2.2857142857142856,
      2.4489795918367347,  3.6734693877551017,  3.918367346938775,
      5.224489795918366,   5.551020408163265,   5.224489795918366,
      5.551020408163265,   5.224489795918366,   5.551020408163265,
      5.224489795918366,   5.551020408163265,   4.163265306122448,
      4.408163265306123,   2.9387755102040813,  3.10204081632653,
      1.5510204081632653,  1.6326530612244898,  1.0612244897959182,
      1.1428571428571428,  2.2857142857142856,  2.4489795918367347,
      3.6734693877551017,  3.918367346938775,   5.224489795918366,
      5.551020408163265,   5.224489795918366,   5.551020408163265,
      5.224489795918366,   5.551020408163265,   5.224489795918366,
      5.551020408163265,   4.163265306122448,   4.408163265306123,
      2.9387755102040813,  3.10204081632653,    1.5510204081632653,
      1.6326530612244898,  1.0612244897959182,  1.1428571428571428,
      2.2857142857142856,  2.4489795918367347,  3.6734693877551017,
      3.918367346938775,   5.224489795918366,   5.551020408163265,
      5.224489795918366,   5.551020408163265,   5.224489795918366,
      5.551020408163265,   5.224489795918366,   5.551020408163265,
      4.163265306122448,   4.408163265306123,   2.9387755102040813,
      3.10204081632653,    1.5510204081632653,  1.6326530612244898,
      1.0612244897959182,  1.1428571428571428,  2.2857142857142856,
      2.4489795918367347,  3.6734693877551017,  3.918367346938775,
      5.224489795918366,   5.551020408163265,   5.224489795918366,
      5.551020408163265,   5.224489795918366,   5.551020408163265,
      5.224489795918366,   5.551020408163265,   4.163265306122448,
      4.408163265306123,   2.9387755102040813,  3.10204081632653,
      1.5510204081632653,  1.6326530612244898,  1.0408163265306123,
      1.1020408163265305,  2.204081632653061,   2.3265306122448974,
      3.4897959183673466,  3.6734693877551012,  4.897959183673469,
      5.142857142857142,   4.897959183673469,   5.142857142857142,
      4.897959183673469,   5.142857142857142,   4.897959183673469,
      5.142857142857142,   3.857142857142857,   4.040816326530612,
      2.693877551020408,   2.8163265306122445,  1.4081632653061225,
      1.4693877551020407,  0.8571428571428572,  0.8979591836734693,
      1.7959183673469385,  1.8775510204081631,  2.816326530612245,
      2.9387755102040813,  3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.061224489795918,   3.1836734693877546,  2.1224489795918364,
      2.204081632653061,   1.1020408163265305,  1.1428571428571428,
      0.5102040816326531,  0.5306122448979591,  1.0612244897959182,
      1.1020408163265305,  1.6530612244897958,  1.714285714285714,
      2.2857142857142856,  2.3673469387755097,  2.2857142857142856,
      2.3673469387755097,  2.2857142857142856,  2.3673469387755097,
      2.2857142857142856,  2.3673469387755097,  1.7755102040816326,
      1.8367346938775508,  1.2244897959183674,  1.2653061224489794,
      0.6326530612244897,  0.6530612244897959};
  const std::array<int, 4> in_shape = {{1, 10, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.72281746031746,  33.29969387755102,  33.876570294784585,
      34.45344671201814,  40.06397392290249,  40.74935374149659,
      41.434733560090706, 42.1201133786848,   47.8391439909297,
      48.63302721088436,  49.426910430838994, 50.22079365079365,
      56.04832766439909,  56.950714285714284, 57.853100907029464,
      58.75548752834467,  56.32312925170068,  57.16222222222221,
      58.00131519274377,  58.84040816326531,  60.576462585034015,
      61.41555555555555,  62.254648526077105, 63.09374149659863,
      69.66912131519274,  70.57150793650793,  71.47389455782313,
      72.3762811791383,   62.76197845804988,  63.55586167800452,
      64.34974489795918,  65.14362811791382,  55.42082199546485,
      56.10620181405895,  56.79158163265306,  57.47696145124716,
      47.64565192743764,  48.222528344671204, 48.79940476190476,
      49.37628117913833,  50.74152494331066,  51.426904761904765,
      52.112284580498866, 52.797664399092966, 61.69492630385488,
      62.50921768707482,  63.32350907029478,  64.13780045351473,
      73.16397392290249,  74.10717687074829,  75.0503798185941,
      75.9935827664399,   85.1486678004535,   86.22078231292517,
      87.2928968253968,   88.36501133786847,  84.17346938775509,
      85.17038548752832,  86.1673015873016,   87.16421768707482,
      89.22680272108843,  90.22371882086166,  91.22063492063492,
      92.21755102040814,  101.33136621315192, 102.40348072562357,
      103.47559523809524, 104.54770975056685, 90.89361111111111,
      91.83681405895689,  92.78001700680272,  93.7232199546485,
      79.94020975056691,  80.75450113378683,  81.56879251700681,
      82.38308390022674,  68.47116213151928,  69.15654195011338,
      69.84192176870748,  70.5273015873016,   73.10036848072562,
      73.89425170068027,  74.68813492063491,  75.48201814058956,
      88.48234126984129,  89.42554421768706,  90.36874716553288,
      91.31195011337869,  104.46159297052155, 105.55411564625848,
      106.64663832199544, 107.73916099773244, 121.03812358276642,
      122.27996598639454, 123.52180839002263, 124.7636507936508,
      118.33673469387755, 119.49147392290247, 120.64621315192743,
      121.80095238095238, 124.19006802721088, 125.34480725623581,
      126.49954648526077, 127.65428571428569, 139.7827267573696,
      141.02456916099771, 142.26641156462583, 143.50825396825394,
      124.99803287981858, 126.09055555555553, 127.18307823129251,
      128.27560090702946, 109.61606009070294, 110.55926303854874,
      111.50246598639455, 112.44566893424033, 93.63680839002267,
      94.43069160997733,  95.22457482993195,  96.01845804988662,
      99.79934807256237,  100.70173469387754, 101.60412131519273,
      102.50650793650793, 120.4262188208617,  121.4983333333333,
      122.570447845805,   123.64256235827665, 141.73200113378687,
      142.97384353741492, 144.21568594104306, 145.4575283446712,
      163.71669501133783, 165.12826530612244, 166.539835600907,
      167.9514058956916,  158.812925170068,   160.12548752834462,
      161.43804988662134, 162.75061224489795, 165.46625850340135,
      166.77882086167796, 168.09138321995468, 169.40394557823126,
      185.0232029478458,  186.4347732426303,  187.84634353741498,
      189.2579138321995,  165.0752437641723,  166.3170861678004,
      167.5589285714286,  168.80077097505665, 144.44837301587302,
      145.52048752834463, 146.59260204081633, 147.66471655328795,
      123.14259070294783, 124.04497732426304, 124.9473639455782,
      125.84975056689343, 134.8598639455782,  135.69895691609977,
      136.5380498866213,  137.37714285714284, 161.9510204081633,
      162.94793650793648, 163.94485260770975, 164.941768707483,
      189.67346938775512, 190.82820861678,    191.98294784580497,
      193.13768707482993, 218.02721088435374, 219.33977324263032,
      220.652335600907,   221.96489795918367, 208.85260770975057,
      210.07310657596364, 211.2936054421769,  212.51410430839002,
      215.03927437641727, 216.25977324263033, 217.48027210884356,
      218.70077097505663, 237.83927437641725, 239.1518367346938,
      240.46439909297052, 241.77696145124713, 211.37941043083902,
      212.53414965986389, 213.6888888888889,  214.8436281179138,
      184.28825396825397, 185.28517006802718, 186.28208616780043,
      187.27900226757367, 156.5658049886621,  157.40489795918367,
      158.24399092970518, 159.08308390022674, 177.39319727891157,
      178.23229024943308, 179.07138321995467, 179.91047619047615,
      212.48435374149665, 213.4812698412698,  214.47818594104314,
      215.47510204081632, 248.20680272108845, 249.36154195011332,
      250.51628117913836, 251.67102040816326, 284.56054421768704,
      285.8731065759636,  287.1856689342404,  288.498231292517,
      270.7192743764172,  271.93977324263034, 273.16027210884357,
      274.3807709750567,  276.90594104308394, 278.126439909297,
      279.34693877551024, 280.56743764172336, 304.3726077097506,
      305.68517006802716, 306.99773242630386, 308.3102947845805,
      269.9127437641723,  271.0674829931972,  272.2222222222222,
      273.37696145124715, 234.82158730158727, 235.81850340136052,
      236.8154195011337,  237.812335600907,   199.09913832199544,
      199.93823129251703, 200.77732426303848, 201.61641723356013,
      236.00728458049886, 236.90967120181406, 237.81205782312927,
      238.71444444444444, 282.2532029478458,  283.3253174603174,
      284.39743197278915, 285.46954648526076, 329.17803287981855,
      330.4198752834467,  331.66171768707494, 332.9035600907029,
      376.7817743764172,  378.1933446712017,  379.60491496598644,
      381.01648526077093, 356.9335600907029,  358.2461224489795,
      359.55868480725627, 360.8712471655328,  363.5868934240362,
      364.8994557823129,  366.2120181405896,  367.52458049886616,
      398.0882823129251,  399.49985260770967, 400.91142290249434,
      402.32299319727883, 352.52127551020396, 353.7631179138321,
      355.0049603174603,  356.24680272108844, 306.2753571428571,
      307.3474716553288,  308.4195861678004,  309.4917006802721,
      259.35052721088437, 260.25291383219957, 261.15530045351466,
      262.05768707482997, 222.32871315192742, 223.12259637188208,
      223.91647959183675, 224.71036281179136, 265.77871315192743,
      266.72191609977324, 267.6651190476191,  268.60832199546485,
      309.825992063492,   310.91851473922895, 312.01103741496604,
      313.1035600907029,  354.47054988662126, 355.7123922902494,
      356.9542346938776,  358.1960770975056,  335.3961451247165,
      336.5508843537414,  337.70562358276646, 338.86036281179133,
      341.2494784580498,  342.4042176870748,  343.55895691609976,
      344.7136961451247,  373.2151530612244,  374.4569954648525,
      375.6988378684807,  376.9406802721088,  330.36243197278907,
      331.45495464852604, 332.547477324263,   333.64,
      286.9124319727891,  287.8556349206349,  288.79883786848063,
      289.74204081632655, 242.8651530612245,  243.65903628117917,
      244.45291950113375, 245.24680272108844, 204.31000566893425,
      204.99538548752835, 205.68076530612245, 206.36614512471655,
      244.14776077097505, 244.962052154195,   245.77634353741496,
      246.59063492063493, 284.50116213151927, 285.44436507936507,
      286.38756802721093, 287.3307709750567,  325.3702097505668,
      326.44232426303853, 327.5144387755102,  328.5865532879818,
      307.54580498866204, 308.5427210884353,  309.53963718820864,
      310.5365532879818,  312.5991383219954,  313.59605442176866,
      314.59297052154193, 315.58988662131515, 341.5529081632653,
      342.62502267573694, 343.69713718820856, 344.76925170068023,
      302.23079931972785, 303.17400226757366, 304.11720521541946,
      305.0604081632653,  262.3930442176871,  263.207335600907,
      264.0216269841269,  264.83591836734695, 222.03964285714287,
      222.72502267573697, 223.41040249433104, 224.0957823129252,
      181.95116213151928, 182.52803854875287, 183.10491496598638,
      183.68179138321995, 217.36034580498867, 218.04572562358277,
      218.73110544217687, 219.41648526077097, 253.20354308390023,
      253.99742630385487, 254.79130952380953, 255.5851927437642,
      289.48075396825396, 290.38314058956917, 291.28552721088437,
      292.1879138321995,  273.3825396825397,  274.2216326530612,
      275.06072562358275, 275.8998185941043,  277.635873015873,
      278.4749659863946,  279.3140589569161,  280.15315192743765,
      303.1015476190476,  304.00393424036275, 304.90632086167795,
      305.8087074829932,  268.1263775510204,  268.92026077097506,
      269.71414399092964, 270.5080272108844,  232.71719387755104,
      233.4025736961451,  234.0879535147392,  234.77333333333334,
      196.87399659863948, 197.45087301587301, 198.02774943310658,
      198.60462585034014};
  const std::array<int, 4> in_shape = {{1, 10, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.04081632653061224,
                                         0.061224489795918366,
                                         0.08163265306122448,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.3061224489795918,
                                         0.36734693877551017,
                                         0.42857142857142855,
                                         0.4897959183673469,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5510204081632653,
                                         0.6122448979591837,
                                         0.6734693877551019,
                                         0.7346938775510203,
                                         0.44897959183673464,
                                         0.4897959183673469,
                                         0.5306122448979591,
                                         0.5714285714285714,
                                         0.26530612244897955,
                                         0.2857142857142857,
                                         0.3061224489795918,
                                         0.32653061224489793,
                                         0.3673469387755102,
                                         0.4081632653061224,
                                         0.4489795918367347,
                                         0.48979591836734687,
                                         0.8979591836734693,
                                         0.9795918367346937,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.5918367346938775,
                                         1.7142857142857142,
                                         1.8367346938775508,
                                         1.9591836734693875,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.0816326530612246,
                                         2.204081632653061,
                                         2.326530612244898,
                                         2.4489795918367347,
                                         1.5510204081632653,
                                         1.6326530612244894,
                                         1.714285714285714,
                                         1.7959183673469385,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         1.0408163265306123,
                                         1.1020408163265305,
                                         1.163265306122449,
                                         1.2244897959183672,
                                         2.3265306122448974,
                                         2.4489795918367347,
                                         2.571428571428571,
                                         2.693877551020408,
                                         3.8571428571428568,
                                         4.040816326530612,
                                         4.224489795918367,
                                         4.408163265306122,
                                         5.63265306122449,
                                         5.877551020408162,
                                         6.122448979591837,
                                         6.36734693877551,
                                         5.63265306122449,
                                         5.877551020408162,
                                         6.122448979591837,
                                         6.36734693877551,
                                         5.63265306122449,
                                         5.877551020408162,
                                         6.122448979591837,
                                         6.36734693877551,
                                         5.63265306122449,
                                         5.877551020408162,
                                         6.122448979591837,
                                         6.36734693877551,
                                         4.591836734693877,
                                         4.775510204081632,
                                         4.959183673469387,
                                         5.142857142857143,
                                         3.3061224489795915,
                                         3.428571428571428,
                                         3.551020408163265,
                                         3.6734693877551017,
                                         1.7755102040816326,
                                         1.8367346938775508,
                                         1.8979591836734693,
                                         1.9591836734693877,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         4.408163265306122,
                                         4.571428571428571,
                                         4.7346938775510194,
                                         4.8979591836734695,
                                         7.1020408163265305,
                                         7.346938775510203,
                                         7.591836734693876,
                                         7.83673469387755,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         8.081632653061224,
                                         8.326530612244897,
                                         8.57142857142857,
                                         8.816326530612246,
                                         5.7142857142857135,
                                         5.877551020408163,
                                         6.040816326530612,
                                         6.20408163265306,
                                         3.020408163265306,
                                         3.1020408163265305,
                                         3.183673469387755,
                                         3.2653061224489797,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         4.408163265306122,
                                         4.571428571428571,
                                         4.7346938775510194,
                                         4.8979591836734695,
                                         7.1020408163265305,
                                         7.346938775510203,
                                         7.591836734693876,
                                         7.83673469387755,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         8.081632653061224,
                                         8.326530612244897,
                                         8.57142857142857,
                                         8.816326530612246,
                                         5.7142857142857135,
                                         5.877551020408163,
                                         6.040816326530612,
                                         6.20408163265306,
                                         3.020408163265306,
                                         3.1020408163265305,
                                         3.183673469387755,
                                         3.2653061224489797,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         4.408163265306122,
                                         4.571428571428571,
                                         4.7346938775510194,
                                         4.8979591836734695,
                                         7.1020408163265305,
                                         7.346938775510203,
                                         7.591836734693876,
                                         7.83673469387755,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         8.081632653061224,
                                         8.326530612244897,
                                         8.57142857142857,
                                         8.816326530612246,
                                         5.7142857142857135,
                                         5.877551020408163,
                                         6.040816326530612,
                                         6.20408163265306,
                                         3.020408163265306,
                                         3.1020408163265305,
                                         3.183673469387755,
                                         3.2653061224489797,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         4.408163265306122,
                                         4.571428571428571,
                                         4.7346938775510194,
                                         4.8979591836734695,
                                         7.1020408163265305,
                                         7.346938775510203,
                                         7.591836734693876,
                                         7.83673469387755,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         8.081632653061224,
                                         8.326530612244897,
                                         8.57142857142857,
                                         8.816326530612246,
                                         5.7142857142857135,
                                         5.877551020408163,
                                         6.040816326530612,
                                         6.20408163265306,
                                         3.020408163265306,
                                         3.1020408163265305,
                                         3.183673469387755,
                                         3.2653061224489797,
                                         2.020408163265306,
                                         2.0816326530612246,
                                         2.1428571428571423,
                                         2.204081632653061,
                                         4.285714285714286,
                                         4.408163265306122,
                                         4.530612244897958,
                                         4.653061224489795,
                                         6.795918367346939,
                                         6.979591836734693,
                                         7.163265306122447,
                                         7.3469387755102025,
                                         9.551020408163264,
                                         9.795918367346937,
                                         10.04081632653061,
                                         10.285714285714285,
                                         9.551020408163264,
                                         9.795918367346937,
                                         10.04081632653061,
                                         10.285714285714285,
                                         9.551020408163264,
                                         9.795918367346937,
                                         10.04081632653061,
                                         10.285714285714285,
                                         9.551020408163264,
                                         9.795918367346937,
                                         10.04081632653061,
                                         10.285714285714285,
                                         7.530612244897959,
                                         7.714285714285714,
                                         7.897959183673468,
                                         8.081632653061224,
                                         5.26530612244898,
                                         5.387755102040816,
                                         5.5102040816326525,
                                         5.632653061224489,
                                         2.7551020408163263,
                                         2.816326530612245,
                                         2.877551020408163,
                                         2.9387755102040813,
                                         1.673469387755102,
                                         1.7142857142857144,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         3.5102040816326525,
                                         3.591836734693877,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.755102040816325,
                                         5.877551020408163,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         6.,
                                         6.122448979591836,
                                         6.244897959183673,
                                         6.367346938775509,
                                         4.163265306122449,
                                         4.244897959183673,
                                         4.326530612244897,
                                         4.408163265306122,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         0.9999999999999999,
                                         1.0204081632653061,
                                         1.040816326530612,
                                         1.0612244897959182,
                                         2.081632653061224,
                                         2.1224489795918364,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         3.244897959183673,
                                         3.3061224489795915,
                                         3.36734693877551,
                                         3.428571428571428,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         3.4897959183673466,
                                         3.5510204081632653,
                                         3.6122448979591835,
                                         3.6734693877551017,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         1.2448979591836733,
                                         1.2653061224489794,
                                         1.2857142857142856,
                                         1.3061224489795917};
  const std::array<int, 4> in_shape = {{1, 10, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.15218253968254,   8.794019274376419,  10.836082766439908,
      13.43846371882086,  14.767630385487529, 12.924773242630383,
      11.262471655328797, 9.729138321995464,  10.870209750566895,
      13.2671485260771,   16.213973922902493, 19.93064058956916,
      21.509807256235824, 18.69552154195011,  16.19988662131519,
      13.931859410430839, 16.22060657596372,  19.6889739229025,
      23.913577097505666, 29.196910430838997, 31.06774376417233,
      26.85345804988662,  23.163378684807256, 19.847732426303853,
      23.856320861678007, 28.838973922902497, 34.86357709750566,
      42.346910430839,    44.567743764172334, 38.35345804988661,
      32.96337868480725,  28.16201814058957,  34.48965419501134,
      41.47230725623584,  49.83024376417234,  60.113577097505676,
      62.33441043083901,  53.32012471655329,  45.59671201814059,
      38.7953514739229,   32.93013038548752,  39.54135487528345,
      47.43262471655329,  57.11595804988662,  58.98679138321995,
      50.372505668934245, 43.01575963718821,  36.557256235827666,
      30.61782879818594,  36.72905328798186,  44.0092120181406,
      52.925878684807266, 54.505045351473925, 46.49075963718821,
      39.66179138321995,  33.679478458049886, 27.76782879818594,
      33.287216553287976, 39.85308956916101,  47.884041950113385,
      49.21320861678005,  41.94178004535147,  35.75566893424036,
      30.344784580498867, 44.07227324263039,  52.658327664399096,
      62.80197845804989,  75.1262641723356,   76.45543083900225,
      64.89066893424037,  55.126780045351474, 46.64922902494332,
      54.734518140589564, 65.38179705215418,  77.95401927437642,
      93.22116213151926,  94.80032879818592,  80.43556689342404,
      68.31453514739228,  57.796167800453524, 68.18650226757369,
      81.4290192743764,   97.05679705215421,  116.02393990929704,
      117.89477324263036, 99.99667800453516,  84.90342403628118,
      71.81362811791385,  85.54412131519274,  102.1294954648526,
      121.69060657596374, 145.4177494331066,  147.6385827664399,
      125.18048752834468, 106.25390022675738, 89.84981859410433,
      96.17745464852605,  114.76282879818592, 136.6572732426304,
      163.18441609977324, 165.40524943310658, 140.14715419501135,
      118.8872335600907,  100.48315192743763, 84.89602607709752,
      101.28140022675736, 120.57584467120179, 143.94298752834467,
      145.813820861678,   123.51572562358277, 104.75580498866212,
      88.52315192743762,  74.48213718820863,  88.84370181405895,
      105.74925736961451, 126.21640022675736, 127.79556689342402,
      108.23080498866213, 91.77643990929704,  77.54378684807256,
      64.68791950113379,  77.15152494331065,  91.81898526077097,
      109.57184240362811, 110.90100907029478, 93.90767573696144,
      79.61997732426303,  67.26487528344671,  80.99236394557823,
      96.52263605442175,  114.76787414965986, 136.81406462585034,
      138.143231292517,   116.85656462585033, 98.99108843537414,
      83.56931972789114,  98.59882653061226,  117.49644557823129,
      139.69406462585036, 166.5116836734694,  168.09085034013606,
      142.17561224489796, 120.42918367346938, 101.66047619047617,
      120.1523979591837,  143.16906462585035, 170.20001700680274,
      202.85096938775513, 204.72180272108847, 173.1398979591837,
      146.64346938775512, 123.77952380952378, 147.2319217687075,
      175.42001700680274, 208.51763605442179, 248.48858843537417,
      250.7094217687075,  212.00751700680274, 179.54442176870748,
      151.537619047619,   157.86525510204083, 188.0533503401361,
      223.48430272108845, 266.25525510204085, 268.47608843537415,
      226.97418367346935, 192.1777551020408,  162.1709523809524,
      136.86192176870748, 163.02144557823132, 193.71906462585036,
      230.77001700680273, 232.64085034013604, 196.65894557823128,
      166.49585034013606, 140.48904761904762, 118.34644557823128,
      140.95835034013606, 167.48930272108845, 199.50692176870749,
      201.08608843537414, 169.97085034013605, 143.89108843537414,
      121.40809523809524, 101.60801020408164, 121.01583333333332,
      143.78488095238095, 171.25964285714286, 172.58880952380954,
      145.87357142857147, 123.48428571428573, 104.18496598639456};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612,  0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.04081632653061224,  0.08163265306122448,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.12244897959183673,  0.08163265306122448,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.12244897959183673,
      0.08163265306122448,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.12244897959183673,  0.08163265306122448,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.12244897959183673,  0.08163265306122448,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.12244897959183673,
      0.08163265306122448,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.12244897959183673,  0.061224489795918366,
      0.14285714285714285,  0.14285714285714285,  0.14285714285714285,
      0.14285714285714285,  0.14285714285714285,  0.14285714285714285,
      0.08163265306122448,  0.1020408163265306,   0.22448979591836732,
      0.22448979591836732,  0.22448979591836732,  0.22448979591836732,
      0.22448979591836732,  0.22448979591836732,  0.12244897959183673,
      0.24489795918367346,  0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.2857142857142857,   0.24489795918367346,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.2857142857142857,   0.24489795918367346,  0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.2857142857142857,
      0.24489795918367346,  0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.2857142857142857,   0.24489795918367346,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.2857142857142857,   0.24489795918367346,  0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.2857142857142857,
      0.14285714285714285,  0.30612244897959184,  0.30612244897959184,
      0.30612244897959184,  0.30612244897959184,  0.30612244897959184,
      0.30612244897959184,  0.16326530612244897,  0.18367346938775508,
      0.3877551020408163,   0.3877551020408163,   0.3877551020408163,
      0.3877551020408163,   0.3877551020408163,   0.3877551020408163,
      0.2040816326530612,   0.4081632653061224,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.44897959183673464,
      0.4081632653061224,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.44897959183673464,  0.4081632653061224,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.44897959183673464,  0.4081632653061224,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.44897959183673464,
      0.4081632653061224,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.44897959183673464,  0.4081632653061224,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.44897959183673464,  0.22448979591836732,  0.4693877551020408,
      0.4693877551020408,   0.4693877551020408,   0.4693877551020408,
      0.4693877551020408,   0.4693877551020408,   0.24489795918367346};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.72748866213152,  14.30436507936508,  16.90265873015873,
      17.588038548752838, 20.860198412698413, 21.672165532879816,
      25.91305555555556,  26.87692743764172,  28.571388888888887,
      29.535260770975057, 25.037579365079367, 25.849546485260767,
      21.839563492063494, 22.524943310657594, 18.88140022675737,
      19.458276643990928, 21.055039682539682, 21.74041950113379,
      25.720005668934242, 26.5342970521542,   31.46325963718821,
      32.42794784580499,  38.716116780045354, 39.86128117913832,
      41.874450113378686, 43.01961451247165,  36.426354875283444,
      37.39104308390022,  31.58548185941043,  32.39977324263038,
      27.17833900226757,  27.863718820861678, 31.629246031746028,
      32.44121315192744,  38.41325963718821,  39.377947845805,
      46.68429138321996,  47.82715419501133,  57.037148526077104,
      58.393820861677995, 60.77881519274377,  62.13548752834466,
      52.564053287981864, 53.70691609977324,  45.362069160997734,
      46.32675736961451,  38.88349773242631,  39.69546485260771,
      46.74876984126984,  47.712641723356015, 56.532783446712024,
      57.677947845804994, 68.37048185941043,  69.72715419501132,
      83.08333900226756,  84.693820861678,    87.52500566893423,
      89.13548752834467,  75.35024376417233,  76.70691609977322,
      64.78159297052154,  65.9267573696145,   55.360164399092966,
      56.32403628117914,  68.0154365079365,   68.97930839002268,
      81.79945011337868,  82.94461451247167,  98.30381519274377,
      99.66048752834467,  118.6166723356009,  120.22715419501135,
      123.05833900226756, 124.66882086167801, 105.28357709750567,
      106.64024943310658, 90.04825963718821,  91.19342403628119,
      76.62683106575963,  77.5907029478458,   65.04829365079365,
      65.86026077097505,  78.11802154195011,  79.0827097505669,
      93.7223866213152,   94.86524943310658,  112.87524376417234,
      114.23191609977324, 116.616910430839,   117.9735827664399,
      99.6021485260771,   100.74501133786849, 85.06683106575963,
      86.03151927437642,  72.30254535147392,  73.11451247165533,
      60.55027777777778,  61.23565759637188,  72.64381519274376,
      73.45810657596373,  87.0537358276644,   88.0184240362812,
      104.70659297052154, 105.85175736961453, 107.86492630385487,
      109.01009070294785, 92.01683106575963,  92.98151927437642,
      78.50929138321995,  79.3235827664399,   66.67357709750567,
      67.35895691609977,  54.95878117913832,  55.53565759637188,
      65.88905328798187,  66.57443310657595,  78.89421201814059,
      79.70617913832201,  94.80421201814059,  95.76808390022677,
      97.46254535147392,  98.4264172335601,   83.07159297052154,
      83.88356009070294,  70.82595804988662,  71.51133786848072,
      60.11269274376417,  60.689569160997735, 87.56767006802723,
      88.14454648526078,  104.63127551020408, 105.31665532879819,
      124.79198979591837, 125.60395691609978, 149.28865646258504,
      150.2525283446712,  151.9469897959184,  152.9108616780045,
      128.96937074829933, 129.78133786848073, 109.56818027210885,
      110.25356009070295, 92.72158163265307,  93.29845804988663,
      108.78365646258504, 109.46903628117913, 129.94930272108843,
      130.76359410430837, 154.94335034013608, 155.90803854875284,
      185.2971598639456,  186.44232426303853, 188.45549319727894,
      189.60065759637183, 159.90644557823128, 160.87113378684808,
      135.81477891156462, 136.62907029478455, 114.90695578231293,
      115.59233560090705, 135.561037414966,   136.37300453514737,
      161.89335034013604, 162.8580385487528,  192.97073129251703,
      194.11359410430842, 230.69120748299324, 232.04787981859408,
      234.43287414965988, 235.78954648526073, 198.8504931972789,
      199.9933560090703,  168.84215986394557, 169.80684807256236,
      142.81528911564627, 143.6272562358277,  170.12437074829933,
      171.08824263038548, 203.11382653061222, 204.2589909297052,
      242.02454081632655, 243.38121315192748, 289.2250170068028,
      290.8354988662132,  293.6666836734694,  295.2771655328798,
      249.00430272108838, 250.36097505668937, 211.36263605442173,
      212.50780045351476, 178.73576530612243, 179.69963718820867,
      191.391037414966,   192.3549092970521,  228.3804931972789,
      229.52565759637184, 271.95787414965986, 273.3145464852608,
      324.758350340136,   326.3688321995465,  329.2000170068026,
      330.81049886621315, 278.9376360544217,  280.2943083900227,
      236.6293027210884,  237.7744671201814,  200.0024319727891,
      200.96630385487526, 168.98008503401363, 169.79205215419503,
      201.59811224489795, 202.5628004535147,  240.00882653061225,
      241.15168934240359, 286.5293027210884,  287.88597505668935,
      290.2709693877551,  291.627641723356,   245.88858843537412,
      247.03145124716553, 208.54692176870748, 209.51160997732424,
      176.23433673469387, 177.04630385487525, 148.27889455782312,
      148.96427437641725, 176.87311224489798, 177.6874036281179,
      210.53382653061226, 211.49851473922902, 251.28763605442177,
      252.43280045351472, 254.4459693877551,  255.59113378684805,
      215.4969217687075,  216.46160997732426, 182.73858843537417,
      183.55287981859408, 154.402193877551,   155.0875736961451,
      128.79896258503402, 129.37583900226758, 153.6176700680272,
      154.3030498866213,  182.82600340136057, 183.63797052154194,
      218.17981292517007, 219.14368480725622, 220.8381462585034,
      221.80201814058955, 187.00338435374152, 187.81535147392287,
      158.55457482993197, 159.23995464852607, 133.95287414965986,
      134.52975056689343, 161.4078514739229,  161.98472789115647,
      192.35989229024943, 193.0452721088435,  228.72378117913829,
      229.53574829931972, 272.6642573696145,  273.62812925170067,
      275.3225907029479,  276.286462585034,   232.90116213151927,
      233.71312925170065, 197.29679705215418, 197.98217687074828,
      166.56176303854875, 167.13863945578228, 196.51227324263039,
      197.1976530612245,  234.17859977324264, 234.99289115646258,
      278.4234410430839,  279.3881292517007,  331.87820294784586,
      333.0233673469388,  335.0365362811792,  336.1817006802721,
      283.3865362811792,  284.3512244897959,  240.0440759637188,
      240.85836734693876, 202.63557256235828, 203.32095238095235,
      239.49282879818594, 240.3047959183674,  285.3734410430839,
      286.3381292517007,  339.2571712018142,  340.4000340136055,
      404.34526643990944, 405.70193877551026, 408.0869331065761,
      409.44360544217693, 345.13693310657607, 346.2797959183674,
      292.3222505668934,  293.28693877551024, 246.7470804988662,
      247.55904761904756, 293.49997165532875, 294.463843537415,
      349.6948696145124,  350.8400340136055,  415.6785997732427,
      417.03527210884357, 495.366695011338,   496.97717687074834,
      499.8083616780047,  501.418843537415,   422.65836167800467,
      424.0150340136055,  357.943679138322,   359.08884353741496,
      302.111366213152,   303.075238095238,   314.76663832199546,
      315.73051020408167, 374.9615362811792,  376.1067006802722,
      445.61193310657603, 446.9686054421769,  530.9000283446713,
      532.5105102040817,  535.3416950113381,  536.9521768707483,
      452.59169501133795, 453.9483673469387,  383.2103458049888,
      384.3555102040816,  323.3780328798186,  324.3419047619048,
      272.9118764172336,  273.72384353741495, 325.07820294784585,
      326.04289115646264, 386.29526643990937, 387.43812925170073,
      460.1833616780046,  461.54003401360546, 463.9250283446713,
      465.2817006802721,  392.1750283446713,  393.31789115646257,
      332.0270124716553,  332.9917006802721,  280.1661281179138,
      280.97809523809525, 236.00751133786846, 236.69289115646257,
      281.1024092970522,  281.91670068027213, 334.01391723356016,
      334.9786054421769,  397.86867913832214, 399.01384353741497,
      401.02701247165544, 402.1721768707483,  338.97701247165537,
      339.9417006802721,  286.9678854875283,  287.7821768707483,
      242.13081065759636, 242.81619047619049, 202.63914399092974,
      203.21602040816327, 241.34628684807257, 242.03166666666664,
      286.75779478458054, 287.5697619047619,  341.55541383219963,
      342.51928571428573, 344.21374716553294, 345.1776190476191,
      290.9351757369614,  291.74714285714293, 246.28319160997734,
      246.96857142857147, 207.79305555555555, 208.36993197278912};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.20408163265306123,
      0.24489795918367346, 0.12244897959183672, 0.16326530612244897,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.20408163265306123,
      0.24489795918367346, 0.1020408163265306,  0.12244897959183673,
      0.24489795918367346, 0.2857142857142857,  0.24489795918367346,
      0.2857142857142857,  0.24489795918367346, 0.2857142857142857,
      0.24489795918367346, 0.2857142857142857,  0.24489795918367346,
      0.2857142857142857,  0.24489795918367346, 0.2857142857142857,
      0.14285714285714285, 0.16326530612244897, 0.18367346938775508,
      0.2040816326530612,  0.4081632653061224,  0.44897959183673464,
      0.4081632653061224,  0.44897959183673464, 0.4081632653061224,
      0.44897959183673464, 0.4081632653061224,  0.44897959183673464,
      0.4081632653061224,  0.44897959183673464, 0.4081632653061224,
      0.44897959183673464, 0.22448979591836732, 0.24489795918367346,
      0.44897959183673464, 0.4897959183673469,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.5306122448979591,
      0.5714285714285714,  0.44897959183673464, 0.4897959183673469,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.5306122448979591,  0.5714285714285714,  0.44897959183673464,
      0.4897959183673469,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.5306122448979591,  0.5714285714285714,
      0.44897959183673464, 0.4897959183673469,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.5306122448979591,
      0.5714285714285714,  0.44897959183673464, 0.4897959183673469,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.5306122448979591,  0.5714285714285714,  0.44897959183673464,
      0.4897959183673469,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.5306122448979591,  0.5714285714285714,
      0.26530612244897955, 0.2857142857142857,  0.5714285714285714,
      0.6122448979591837,  0.5714285714285714,  0.6122448979591837,
      0.5714285714285714,  0.6122448979591837,  0.5714285714285714,
      0.6122448979591837,  0.5714285714285714,  0.6122448979591837,
      0.5714285714285714,  0.6122448979591837,  0.3061224489795918,
      0.32653061224489793, 0.3469387755102041,  0.36734693877551017,
      0.7346938775510203,  0.7755102040816326,  0.7346938775510203,
      0.7755102040816326,  0.7346938775510203,  0.7755102040816326,
      0.7346938775510203,  0.7755102040816326,  0.7346938775510203,
      0.7755102040816326,  0.7346938775510203,  0.7755102040816326,
      0.3877551020408163,  0.4081632653061224,  0.7755102040816326,
      0.8163265306122448,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  0.8571428571428571,  0.8979591836734693,
      0.7755102040816326,  0.8163265306122448,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  0.8571428571428571,
      0.8979591836734693,  0.7755102040816326,  0.8163265306122448,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      0.8571428571428571,  0.8979591836734693,  0.7755102040816326,
      0.8163265306122448,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  0.8571428571428571,  0.8979591836734693,
      0.7755102040816326,  0.8163265306122448,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  0.8571428571428571,
      0.8979591836734693,  0.7755102040816326,  0.8163265306122448,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      0.8571428571428571,  0.8979591836734693,  0.42857142857142855,
      0.44897959183673464, 0.8979591836734693,  0.9387755102040816,
      0.8979591836734693,  0.9387755102040816,  0.8979591836734693,
      0.9387755102040816,  0.8979591836734693,  0.9387755102040816,
      0.8979591836734693,  0.9387755102040816,  0.8979591836734693,
      0.9387755102040816,  0.4693877551020408,  0.4897959183673469};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907029477, 27.45497732426304,  28.031853741496597,
      28.60873015873016,  33.119937641723354, 33.80531746031746,
      34.49069727891156,  35.176077097505676, 40.90842970521542,
      41.720396825396826, 42.532363945578226, 43.34433106575963,
      50.862239229024944, 51.82611111111112,  52.78998299319728,
      53.75385487528344,  56.178905895691614, 57.14277777777777,
      58.10664965986395,  59.070521541950114, 49.263191609977326,
      50.07515873015873,  50.88712585034013,  51.699092970521534,
      42.993747165532874, 43.67912698412699,  44.36450680272108,
      45.04988662131519,  37.18592403628118,  37.76280045351474,
      38.33967687074829,  38.916553287981856, 41.42469954648526,
      42.110079365079365, 42.795459183673465, 43.48083900226758,
      50.62571995464852,  51.440011337868484, 52.25430272108843,
      53.0685941043084,   61.961831065759625, 62.92651927437642,
      63.89120748299319,  64.85589569160997,  76.28706916099772,
      77.43223356009071,  78.57739795918367,  79.72256235827663,
      82.6037358276644,   83.74890022675737,  84.89406462585035,
      86.0392290249433,   71.88802154195011,  72.85270975056689,
      73.81739795918367,  74.78208616780044,  62.356672335600905,
      63.17096371882086,  63.98525510204081,  64.79954648526076,
      53.67129818594104,  54.35667800453514,  55.04205782312925,
      55.727437641723355, 62.446524943310656, 63.258492063492056,
      64.07045918367346,  64.88242630385488,  75.86183106575963,
      76.82651927437642,  77.79120748299319,  78.75589569161,
      92.2257199546485,   93.36858276643991,  94.51144557823127,
      95.65430839002266,  112.71762471655326, 114.07429705215421,
      115.4309693877551,  116.78764172335599, 120.20095804988661,
      121.55763038548754, 122.91430272108843, 124.27097505668932,
      103.98524376417232, 105.12810657596373, 106.27096938775509,
      107.41383219954648, 89.75945011337868,  90.72413832199547,
      91.68882653061223,  92.65351473922902,  76.9550283446712,
      77.76699546485261,  78.578962585034,    79.39092970521541,
      92.53366780045351,  93.49753968253968,  94.46141156462583,
      95.42528344671203,  111.92040249433107, 113.06556689342405,
      114.21073129251698, 115.35589569160999, 135.38429138321993,
      136.74096371882086, 138.09763605442174, 139.45430839002265,
      164.5561961451247,  166.16667800453513, 167.77715986394557,
      169.387641723356,   173.43952947845804, 175.05001133786845,
      176.66049319727892, 178.27097505668934, 149.3438151927438,
      150.70048752834467, 152.05715986394554, 153.41383219954645,
      128.4180215419501,  129.5631859410431,  130.70835034013604,
      131.853514739229,   109.75645691609976, 110.72032879818593,
      111.68420068027211, 112.64807256235828, 135.06700113378685,
      136.030873015873,   136.99474489795915, 137.95861678004536,
      162.45373582766442, 163.59890022675737, 164.74406462585029,
      165.88922902494335, 195.25095804988663, 196.60763038548754,
      197.9643027210884,  199.32097505668935, 235.62286281179135,
      237.2333446712018,  238.8438265306122,  240.4543083900227,
      244.5061961451247,  246.11667800453512, 247.72715986394553,
      249.33764172335603, 209.21048185941046, 210.56715419501134,
      211.92382653061222, 213.28049886621315, 178.95135487528344,
      180.09651927437642, 181.24168367346937, 182.38684807256237,
      152.2897902494331,  153.25366213151926, 154.21753401360544,
      155.1814058956916,  129.2846201814059,  130.0965873015873,
      130.90855442176868, 131.7205215419501,  155.27135487528346,
      156.23604308390023, 157.20073129251696, 158.1654195011338,
      186.301910430839,   187.4447732426304,  188.58763605442172,
      189.73049886621317, 224.39381519274377, 225.75048752834468,
      227.10715986394555, 228.4638321995465,  231.8771485260771,
      233.233820861678,   234.59049319727885, 235.9471655328798,
      198.06143424036284, 199.2042970521542,  200.34715986394554,
      201.49002267573698, 169.1689739229025,  170.13366213151926,
      171.09835034013605, 172.06303854875284, 143.79312358276644,
      144.60509070294785, 145.41705782312928, 146.22902494331066,
      120.41517573696144, 121.10055555555556, 121.78593537414966,
      122.47131519274376, 144.47333900226758, 145.28763038548752,
      146.10192176870743, 146.91621315192745, 173.14278344671206,
      174.1074716553288,  175.07215986394553, 176.0368480725624,
      208.26802154195013, 209.41318594104308, 210.55835034013603,
      211.70351473922906, 214.5846882086168,  215.72985260770974,
      216.8750170068027,  218.0201814058957,  183.0689739229025,
      184.03366213151926, 184.99835034013603, 185.96303854875285,
      156.20429138321995, 157.0185827664399,  157.8328741496599,
      158.6471655328798,  132.6617743764172,  133.34715419501134,
      134.03253401360547, 134.71791383219954, 109.34068594104308,
      109.91756235827664, 110.49443877551022, 111.07131519274375,
      131.0927267573696,  131.77810657596373, 132.4634863945578,
      133.1488662131519,  156.9764569160998,  157.78842403628119,
      158.60039115646254, 159.41235827664403, 188.64455215419503,
      189.60842403628118, 190.5722959183673,  191.53616780045354,
      193.9612188208617,  194.92509070294784, 195.888962585034,
      196.8528344671202,  165.33121882086166, 166.14318594104307,
      166.9551530612245,  167.7671201814059,  140.96653628117912,
      141.65191609977325, 142.33729591836737, 143.02267573696145,
      119.64850907029479, 120.22538548752834, 120.8022619047619,
      121.37913832199547, 174.55846371882086, 175.13534013605445,
      175.712216553288,   176.28909297052155, 208.57717120181402,
      209.26255102040815, 209.9479308390023,  210.63331065759638,
      248.77201247165533, 249.58397959183674, 250.39594671201817,
      251.20791383219955, 297.6134410430839,  298.5773129251701,
      299.5411848072563,  300.5050566893424,  302.9301077097505,
      303.8939795918368,  304.85785147392295, 305.821723356009,
      257.1267743764172,  257.93874149659865, 258.75070861678006,
      259.56267573696147, 218.45098072562357, 219.1363605442177,
      219.82174036281177, 220.5071201814059,  184.86628684807255,
      185.44316326530614, 186.02003968253965, 186.59691609977327,
      216.88193310657596, 217.56731292517009, 218.2526927437642,
      218.93807256235826, 259.0843140589569,  259.89860544217686,
      260.71289682539685, 261.52718820861674, 308.9220124716553,
      309.88670068027216, 310.851388888889,   311.8160770975057,
      369.4491553287982,  370.5943197278912,  371.7394841269842,
      372.88464852607706, 375.76582199546476, 376.9109863945579,
      378.0561507936509,  379.20131519274366, 318.8482029478458,
      319.81289115646257, 320.7775793650794,  321.74226757369615,
      270.8152664399093,  271.62955782312923, 272.44384920634917,
      273.2581405895691,  229.1285317460317,  229.81391156462587,
      230.4992913832199,  231.1846712018141,  270.3101077097506,
      271.122074829932,   271.9340419501134,  272.74600907029475,
      322.82201247165534, 323.7867006802721,  324.75138888888887,
      325.7160770975056,  384.79859977324264, 385.94146258503406,
      387.0843253968255,  388.22718820861684, 460.02574263038554,
      461.38241496598647, 462.73908730158735, 464.09575963718817,
      467.5090759637188,  468.86574829931976, 470.2224206349207,
      471.57909297052146, 396.5581235827664,  397.7009863945578,
      398.8438492063492,  399.9867120181406,  336.7196315192744,
      337.68431972789114, 338.64900793650787, 339.6136961451247,
      284.81861111111107, 285.63057823129253, 286.4425453514739,
      287.2545124716554,  339.2848696145125,  340.24874149659865,
      341.21261337868486, 342.17648526077096, 405.08248866213154,
      406.22765306122443, 407.3728174603175,  408.5179818594104,
      482.69240929705217, 484.0490816326531,  485.40575396825403,
      486.76242630385497, 576.8395521541951,  578.4500340136055,
      580.0605158730159,  581.6709977324264,  585.7228854875283,
      587.3333673469388,  588.9438492063493,  590.5543310657596,
      496.651933106576,   498.00860544217676, 499.3652777777778,
      500.72195011337874, 421.5801077097506,  422.72527210884346,
      423.87043650793646, 425.0156009070295,  356.5076587301587,
      357.47153061224486, 358.435402494331,   359.39927437641734,
      381.8182029478458,  382.782074829932,   383.7459467120182,
      384.7098185941042,  455.6158219954648,  456.7609863945578,
      457.90615079365085, 459.0513151927437,  542.5590759637189,
      543.9157482993197,  545.2724206349206,  546.6290929705216,
      647.9062188208618,  649.516700680272,   651.1271825396827,
      652.737664399093,   656.7895521541951,  658.4000340136053,
      660.010515873016,   661.6209977324263,  556.5185997732426,
      557.8752721088434,  559.2319444444444,  560.5886167800454,
      472.11344104308387, 473.2586054421768,  474.4037698412698,
      475.5489342403628,  399.040992063492,   400.0048639455782,
      400.9687358276644,  401.9326077097505,  337.14820294784573,
      337.96017006802725, 338.77213718820866, 339.58410430839007,
      402.2315362811791,  403.1962244897959,  404.1609126984127,
      405.1256009070294,  478.87479024943303, 480.0176530612245,
      481.16051587301587, 482.30337868480717, 571.7019331065759,
      573.0586054421768,  574.4152777777779,  575.7719501133787,
      579.1852664399094,  580.5419387755102,  581.8986111111111,
      583.255283446712,   490.6343140589569,  491.77717687074824,
      492.9200396825397,  494.06290249433107, 416.12915532879816,
      417.09384353741495, 418.05853174603175, 419.0232199546485,
      351.6567063492063,  352.46867346938774, 353.28064058956915,
      354.0926077097505,  295.8724092970521,  296.55778911564624,
      297.2431689342404,  297.9285487528345,  352.93193310657597,
      353.74622448979596, 354.5605158730159,  355.3748072562358,
      420.1029648526076,  421.0676530612245,  422.03234126984125,
      422.99702947845805, 501.43010770975053, 502.57527210884354,
      503.72043650793654, 504.86560090702943, 507.7467743764172,
      508.8919387755102,  510.0371031746032,  511.1822675736961,
      430.02915532879814, 430.993843537415,   431.9585317460317,
      432.9232199546485,  364.6628854875283,  365.47717687074834,
      366.2914682539682,  367.10575963718816, 308.11900793650796,
      308.804387755102,   309.4897675736961,  310.1751473922902,
      257.0210487528344,  257.59792517006804, 258.1748015873016,
      258.75167800453517, 306.54996031746026, 307.2353401360544,
      307.9207199546485,  308.6060997732426,  364.8400396825396,
      365.65200680272113, 366.4639739229025,  367.2759410430839,
      435.3957539682539,  436.35962585034014, 437.3234977324263,
      438.28736961451244, 440.7124206349206,  441.6762925170068,
      442.64016439909295, 443.6040362811791,  373.19480158730147,
      374.00676870748305, 374.81873582766434, 375.63070294784575,
      316.4237698412698,  317.10914965986393, 317.794529478458,
      318.47990929705213, 267.3288718820861,  267.9057482993197,
      268.4826247165533,  269.05950113378685, 322.2388265306123,
      322.8157029478458,  323.3925793650793,  323.96945578231293,
      384.0344047619048,  384.71978458049887, 385.4051643990929,
      386.090544217687,   456.6355952380953,  457.44756235827657,
      458.259529478458,   459.07149659863944, 544.3646428571428,
      545.328514739229,   546.2923866213151,  547.2562585034013,
      549.6813095238095,  550.6451814058958,  551.6090532879819,
      552.572925170068,   464.9903571428571,  465.80232426303854,
      466.61429138322,    467.4262585034013,  393.90821428571434,
      394.59359410430835, 395.27897392290254, 395.96435374149655,
      332.54664965986393, 333.1235260770975,  333.70040249433106,
      334.27727891156457, 392.33916666666676, 393.02454648526077,
      393.7099263038548,  394.395306122449,   467.5429081632654,
      468.3571995464853,  469.1714909297051,  469.98578231292515,
      555.8821938775511,  556.8468820861679,  557.8115702947846,
      558.7762585034014,  662.6112414965986,  663.7564058956917,
      664.9015702947845,  666.0467346938776,  668.9279081632653,
      670.0730725623584,  671.2182369614512,  672.3634013605442,
      565.8083843537414,  566.7730725623584,  567.737760770975,
      568.7024489795918,  479.27386054421777, 480.0881519274376,
      480.90244331065765, 481.7167346938775,  404.5857653061225,
      405.27114512471655, 405.9565249433107,  406.6419047619047,
      478.1736904761906,  478.9856575963719,  479.7976247165532,
      480.6095918367348,  569.7821938775512,  570.7468820861678,
      571.7115702947845,  572.6762585034014,  677.3714795918369,
      678.5143424036283,  679.6572052154195,  680.800068027211,
      807.3338605442177,  808.6905328798189,  810.0472052154194,
      811.4038775510205,  814.8171938775512,  816.1738662131522,
      817.5305385487527,  818.8872108843539,  689.1310034013605,
      690.2738662131521,  691.4167290249432,  692.5595918367349,
      583.6798129251703,  584.6445011337868,  585.6091893424035,
      586.5738775510205,  492.6821938775511,  493.4941609977324,
      494.3061281179139,  495.1180952380951,  586.0360714285715,
      586.9999433106575,  587.9638151927437,  588.92768707483,
      698.2445748299322,  699.3897392290248,  700.5349036281178,
      701.680068027211,   830.0005272108845,  831.3571995464854,
      832.7138718820862,  834.0705442176871,  989.1229081632653,
      990.733390022676,   992.3438718820861,  993.9543537414967,
      998.0062414965987,  999.6167233560094,  1001.2272052154194,
      1002.83768707483,   843.9600510204081,  845.3167233560093,
      846.6733956916098,  848.030068027211,   714.7421938775511,
      715.887358276644,   717.0325226757368,  718.1776870748299,
      603.2588605442177,  604.222732426304,   605.1866043083901,
      606.150476190476,   628.5694047619046,  629.5332766439909,
      630.497148526077,   631.4610204081633,  748.7779081632652,
      749.9230725623584,  751.0682369614511,  752.2134013605444,
      889.8671938775509,  891.2238662131521,  892.5805385487527,
      893.9372108843538,  1060.1895748299319, 1061.8000566893427,
      1063.4105385487528, 1065.0210204081634, 1069.0729081632653,
      1070.6833900226761, 1072.293871882086,  1073.9043537414966,
      903.8267176870746,  905.1833900226759,  906.5400623582765,
      907.8967346938774,  765.2755272108842,  766.4206916099776,
      767.5658560090702,  768.7110204081632,  645.792193877551,
      646.7560657596372,  647.7199376417234,  648.6838095238096,
      545.0117857142857,  545.8237528344672,  546.6357199546485,
      547.4476870748299,  649.1917176870746,  650.1564058956917,
      651.1210941043083,  652.0857823129253,  771.4476700680272,
      772.5905328798187,  773.7333956916098,  774.8762585034015,
      919.0100510204079,  920.3667233560092,  921.7233956916099,
      923.0800680272109,  926.4933843537412,  927.8500566893426,
      929.2067290249432,  930.5634013605442,  783.2071938775508,
      784.3500566893426,  785.4929195011338,  786.6357823129251,
      663.0893367346938,  664.0540249433107,  665.0187131519274,
      665.9834013605442,  559.5202891156464,  560.3322562358276,
      561.1442233560091,  561.9561904761905,  471.32964285714286,
      472.01502267573693, 472.700402494331,   473.38578231292513,
      561.3905272108843,  562.2048185941044,  563.0191099773242,
      563.8334013605443,  667.0631462585033,  668.0278344671203,
      668.9925226757368,  669.9572108843538,  794.5921938775508,
      795.7373582766443,  796.8825226757368,  798.0276870748299,
      800.9088605442175,  802.0540249433109,  803.1991893424035,
      804.3443537414965,  676.9893367346938,  677.9540249433107,
      678.9187131519274,  679.8834013605442,  573.1214795918368,
      573.9357709750566,  574.7500623582766,  575.5643537414966,
      483.5762414965987,  484.2616213151927,  484.94700113378684,
      485.63238095238097, 404.70141156462586, 405.2782879818595,
      405.8551643990929,  406.43204081632655, 482.007193877551,
      482.69257369614513, 483.3779535147392,  484.0633333333333,
      572.7036224489794,  573.5155895691611,  574.3275566893424,
      575.1395238095238,  682.1469557823127,  683.1108276643993,
      684.0746995464851,  685.0385714285715,  687.4636224489794,
      688.4274943310659,  689.3913662131519,  690.3552380952382,
      581.0583843537415,  581.8703514739228,  582.6823185941043,
      583.4942857142859,  491.8810034013606,  492.5663832199547,
      493.2517630385487,  493.93714285714293, 415.00923469387754,
      415.5861111111111,  416.1629875283446,  416.73986394557824};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.1020408163265306,  0.12244897959183673,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.2857142857142857,  0.32653061224489793,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.36734693877551017, 0.40816326530612246, 0.44897959183673464,
      0.4897959183673469,  0.2040816326530612,  0.24489795918367344,
      0.2857142857142857,  0.32653061224489793, 0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.36734693877551017,
      0.40816326530612246, 0.44897959183673464, 0.4897959183673469,
      0.2040816326530612,  0.24489795918367344, 0.2857142857142857,
      0.32653061224489793, 0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.36734693877551017, 0.40816326530612246,
      0.44897959183673464, 0.4897959183673469,  0.2040816326530612,
      0.24489795918367344, 0.2857142857142857,  0.32653061224489793,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.36734693877551017, 0.40816326530612246, 0.44897959183673464,
      0.4897959183673469,  0.2040816326530612,  0.24489795918367344,
      0.2857142857142857,  0.32653061224489793, 0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.36734693877551017,
      0.40816326530612246, 0.44897959183673464, 0.4897959183673469,
      0.2040816326530612,  0.24489795918367344, 0.2857142857142857,
      0.32653061224489793, 0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.36734693877551017, 0.40816326530612246,
      0.44897959183673464, 0.4897959183673469,  0.18367346938775508,
      0.2040816326530612,  0.22448979591836732, 0.24489795918367346,
      0.44897959183673464, 0.4897959183673469,  0.5306122448979591,
      0.5714285714285714,  0.44897959183673464, 0.4897959183673469,
      0.5306122448979591,  0.5714285714285714,  0.44897959183673464,
      0.4897959183673469,  0.5306122448979591,  0.5714285714285714,
      0.44897959183673464, 0.4897959183673469,  0.5306122448979591,
      0.5714285714285714,  0.44897959183673464, 0.4897959183673469,
      0.5306122448979591,  0.5714285714285714,  0.44897959183673464,
      0.4897959183673469,  0.5306122448979591,  0.5714285714285714,
      0.26530612244897955, 0.2857142857142857,  0.3061224489795918,
      0.32653061224489793, 0.3469387755102041,  0.36734693877551017,
      0.3877551020408163,  0.4081632653061224,  0.7755102040816326,
      0.8163265306122448,  0.8571428571428571,  0.8979591836734693,
      0.7755102040816326,  0.8163265306122448,  0.8571428571428571,
      0.8979591836734693,  0.7755102040816326,  0.8163265306122448,
      0.8571428571428571,  0.8979591836734693,  0.7755102040816326,
      0.8163265306122448,  0.8571428571428571,  0.8979591836734693,
      0.7755102040816326,  0.8163265306122448,  0.8571428571428571,
      0.8979591836734693,  0.7755102040816326,  0.8163265306122448,
      0.8571428571428571,  0.8979591836734693,  0.42857142857142855,
      0.44897959183673464, 0.4693877551020408,  0.4897959183673469,
      0.8571428571428572,  0.8979591836734693,  0.9387755102040816,
      0.9795918367346939,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.0204081632653061,  1.0612244897959182,
      1.1020408163265305,  1.1428571428571428,  0.8571428571428572,
      0.8979591836734693,  0.9387755102040816,  0.9795918367346939,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.0204081632653061,  1.0612244897959182,  1.1020408163265305,
      1.1428571428571428,  0.8571428571428572,  0.8979591836734693,
      0.9387755102040816,  0.9795918367346939,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.0204081632653061,
      1.0612244897959182,  1.1020408163265305,  1.1428571428571428,
      0.8571428571428572,  0.8979591836734693,  0.9387755102040816,
      0.9795918367346939,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.0204081632653061,  1.0612244897959182,
      1.1020408163265305,  1.1428571428571428,  0.8571428571428572,
      0.8979591836734693,  0.9387755102040816,  0.9795918367346939,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.0204081632653061,  1.0612244897959182,  1.1020408163265305,
      1.1428571428571428,  0.8571428571428572,  0.8979591836734693,
      0.9387755102040816,  0.9795918367346939,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      2.0408163265306123,  2.1224489795918364,  1.0204081632653061,
      1.0612244897959182,  1.1020408163265305,  1.1428571428571428,
      0.5102040816326531,  0.5306122448979591,  0.5510204081632653,
      0.5714285714285714,  1.1020408163265305,  1.1428571428571428,
      1.183673469387755,   1.2244897959183674,  1.1020408163265305,
      1.1428571428571428,  1.183673469387755,   1.2244897959183674,
      1.1020408163265305,  1.1428571428571428,  1.183673469387755,
      1.2244897959183674,  1.1020408163265305,  1.1428571428571428,
      1.183673469387755,   1.2244897959183674,  1.1020408163265305,
      1.1428571428571428,  1.183673469387755,   1.2244897959183674,
      1.1020408163265305,  1.1428571428571428,  1.183673469387755,
      1.2244897959183674,  0.5918367346938775,  0.6122448979591836,
      0.6326530612244897,  0.6530612244897959,  0.673469387755102,
      0.6938775510204082,  0.7142857142857142,  0.7346938775510203,
      1.4285714285714284,  1.4693877551020407,  1.510204081632653,
      1.5510204081632653,  1.4285714285714284,  1.4693877551020407,
      1.510204081632653,   1.5510204081632653,  1.4285714285714284,
      1.4693877551020407,  1.510204081632653,   1.5510204081632653,
      1.4285714285714284,  1.4693877551020407,  1.510204081632653,
      1.5510204081632653,  1.4285714285714284,  1.4693877551020407,
      1.510204081632653,   1.5510204081632653,  1.4285714285714284,
      1.4693877551020407,  1.510204081632653,   1.5510204081632653,
      0.7551020408163265,  0.7755102040816326,  0.7959183673469387,
      0.8163265306122448,  1.510204081632653,   1.5510204081632653,
      1.5918367346938775,  1.6326530612244896,  3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   1.673469387755102,
      1.7142857142857142,  1.7551020408163263,  1.7959183673469385,
      1.510204081632653,   1.5510204081632653,  1.5918367346938775,
      1.6326530612244896,  3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   1.673469387755102,   1.7142857142857142,
      1.7551020408163263,  1.7959183673469385,  1.510204081632653,
      1.5510204081632653,  1.5918367346938775,  1.6326530612244896,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      1.673469387755102,   1.7142857142857142,  1.7551020408163263,
      1.7959183673469385,  1.510204081632653,   1.5510204081632653,
      1.5918367346938775,  1.6326530612244896,  3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   1.673469387755102,
      1.7142857142857142,  1.7551020408163263,  1.7959183673469385,
      1.510204081632653,   1.5510204081632653,  1.5918367346938775,
      1.6326530612244896,  3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   1.673469387755102,   1.7142857142857142,
      1.7551020408163263,  1.7959183673469385,  1.510204081632653,
      1.5510204081632653,  1.5918367346938775,  1.6326530612244896,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      1.673469387755102,   1.7142857142857142,  1.7551020408163263,
      1.7959183673469385,  0.836734693877551,   0.8571428571428571,
      0.8775510204081632,  0.8979591836734693,  1.7551020408163263,
      1.7959183673469385,  1.8367346938775508,  1.8775510204081631,
      1.7551020408163263,  1.7959183673469385,  1.8367346938775508,
      1.8775510204081631,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  1.7551020408163263,
      1.7959183673469385,  1.8367346938775508,  1.8775510204081631,
      1.7551020408163263,  1.7959183673469385,  1.8367346938775508,
      1.8775510204081631,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  0.9183673469387754,
      0.9387755102040816,  0.9591836734693877,  0.9795918367346939};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.882772108843537,  9.66202380952381,   11.549778911564626,
      13.87874716553288,  14.47124716553288,  16.30922335600907,
      14.486604308390024, 12.815856009070295, 11.036604308390022,
      12.034812925170067, 14.65079931972789,  17.395697278911566,
      20.748475056689344, 21.276689342403625, 23.63609410430839,
      20.884903628117918, 18.39782879818594,  15.781842403628119,
      18.0181462585034,   21.824608843537412, 25.783792517006805,
      30.581014739229026, 30.959229024943305, 34.001967120181405,
      29.9174433106576,   26.263701814058955, 22.457239229024943,
      26.56528911564626,  32.057465986394554, 37.73093537414966,
      44.561490929705215, 44.66970521541949,  48.62244331065759,
      42.63791950113379,  37.32703514739229,  31.834858276643992,
      38.52778911564626,  46.26996598639456,  54.193435374149665,
      63.64899092970522,  62.969705215419495, 67.7099433106576,
      59.10041950113378,  51.539535147392286, 43.79735827664399,
      36.81636054421769,  44.158537414965984, 51.653435374149666,
      60.57565759637188,  59.71637188208616,  63.996609977324255,
      55.78708616780045,  48.59763038548753,  41.25545351473922,
      34.2508843537415,   41.04544217687076,  47.968911564625856,
      56.19668934240362,  55.262403628117916, 59.08430839002267,
      51.458117913832204, 44.79247165532879,  37.99791383219955,
      31.075374149659865, 37.21687074829932,  43.46687074829933,
      50.88512471655329,  49.95083900226758,  53.315600907029484,
      46.40369614512471,  40.37070294784581,  34.22920634920635,
      49.417874149659866, 59.00937074829932,  68.70937074829932,
      80.15262471655328,  78.01083900226757,  82.58310090702949,
      71.64619614512472,  62.1632029478458,   52.571706349206345,
      61.38215986394559,  73.27977891156463,  85.30630952380952,
      99.48765873015871,  96.76730158730159,  102.3752777777778,
      88.79551587301589,  77.02680839002267,  65.12918934240362,
      76.47977891156464,  91.28215986394558,  106.2372619047619,
      123.86305555555553, 120.39269841269841, 127.28400793650795,
      110.37091269841271, 95.72125283446711,  80.91887188208617,
      95.96406462585034,  114.50930272108843, 133.23583333333332,
      155.29496031746032, 150.8346031746032,  159.35591269841274,
      138.14281746031747, 119.77887188208616, 101.23363378684807,
      107.92656462585033, 128.7218027210884,  149.69833333333335,
      174.3824603174603,  169.13460317460317, 178.4434126984127,
      154.60531746031745, 133.99137188208618, 113.19613378684808,
      95.27799319727889,  113.61608843537414, 132.10690476190476,
      153.8576984126984,  149.14984126984126, 157.2786507936508,
      136.24055555555557, 118.05518140589571, 99.71708616780047,
      83.59823129251699,  99.67442176870746,  115.8795238095238,
      134.935873015873,   130.75301587301587, 137.82349206349207,
      119.36873015873016, 103.42145124716554, 87.34526077097506,
      72.61047619047618,  86.56421768707482,  100.62646258503399,
      117.1590022675737,  113.49043083900226, 119.58947845804988,
      103.56328798185942, 89.71804988662133,  75.76430839002268,
      90.95297619047618,  108.35671768707482, 125.86896258503401,
      146.4265022675737,  141.55043083900227, 148.85697845804984,
      128.8057879818594,  111.51054988662132, 94.10680839002268,
      110.72950680272108, 131.90875850340134, 153.21692176870746,
      178.22684240362813, 172.25791383219953, 181.1144614512471,
      156.7061281179138,  135.65578798185942, 114.47653628117914,
      134.94141156462584, 160.73971088435374, 186.690731292517,
      217.14509637188212, 209.82616780045353, 220.56604875283443,
      190.8243820861678,  165.1788038548753,  139.3805045351474,
      165.3628401360544,  196.9611394557823,  228.74073129251698,
      266.02842970521544, 256.99950113378685, 270.0893820861678,
      233.64771541950114, 202.23070861678008, 170.63240929705216,
      177.3253401360544,  211.17363945578228, 245.203231292517,
      285.11592970521536, 275.29950113378686, 289.17688208616784,
      250.11021541950115, 216.44320861678005, 182.5949092970521,
      153.7396258503401,  183.0736394557823,  212.56037414965985,
      247.13973922902494, 238.58331065759634, 250.5606916099773,
      216.69402494331064, 187.51273242630384, 158.17871882086166,
      132.94557823129253, 158.30340136054423, 183.79013605442177,
      213.67505668934237, 206.24362811791383, 216.56267573696144,
      187.27934240362808, 162.05043083900222, 136.69260770975058,
      114.14557823129253, 135.91156462585036, 157.7860544217687,
      183.4328798185941,  177.03002267573694, 185.86335600907026,
      160.72287981859407, 139.06539682539682, 117.29941043083902};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.12244897959183673, 0.12244897959183673,  0.12244897959183673,
      0.12244897959183673, 0.10204081632653061,  0.061224489795918366,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.08163265306122448, 0.18367346938775508,  0.30612244897959184,
      0.30612244897959184, 0.30612244897959184,  0.30612244897959184,
      0.30612244897959184, 0.22448979591836732,  0.12244897959183673,
      0.14285714285714285, 0.30612244897959184,  0.4897959183673469,
      0.4897959183673469,  0.4897959183673469,   0.4897959183673469,
      0.4897959183673469,  0.346938775510204,    0.18367346938775508,
      0.346938775510204,   0.7346938775510203,   1.163265306122449,
      1.163265306122449,   1.163265306122449,    1.163265306122449,
      1.163265306122449,   0.8163265306122449,   0.42857142857142855,
      0.346938775510204,   0.7346938775510203,   1.163265306122449,
      1.163265306122449,   1.163265306122449,    1.163265306122449,
      1.163265306122449,   0.8163265306122449,   0.42857142857142855,
      0.346938775510204,   0.7346938775510203,   1.163265306122449,
      1.163265306122449,   1.163265306122449,    1.163265306122449,
      1.163265306122449,   0.8163265306122449,   0.42857142857142855,
      0.346938775510204,   0.7346938775510203,   1.163265306122449,
      1.163265306122449,   1.163265306122449,    1.163265306122449,
      1.163265306122449,   0.8163265306122449,   0.42857142857142855,
      0.346938775510204,   0.7346938775510203,   1.163265306122449,
      1.163265306122449,   1.163265306122449,    1.163265306122449,
      1.163265306122449,   0.8163265306122449,   0.42857142857142855,
      0.346938775510204,   0.7346938775510203,   1.163265306122449,
      1.163265306122449,   1.163265306122449,    1.163265306122449,
      1.163265306122449,   0.8163265306122449,   0.42857142857142855,
      0.2040816326530612,  0.4285714285714285,   0.6734693877551019,
      0.6734693877551019,  0.6734693877551019,   0.6734693877551019,
      0.6734693877551019,  0.4693877551020408,   0.24489795918367346,
      0.26530612244897955, 0.5510204081632653,   0.857142857142857,
      0.857142857142857,   0.857142857142857,    0.857142857142857,
      0.857142857142857,   0.5918367346938775,   0.3061224489795918,
      0.5918367346938775,  1.2244897959183672,   1.897959183673469,
      1.897959183673469,   1.897959183673469,    1.897959183673469,
      1.897959183673469,   1.3061224489795917,   0.6734693877551019,
      0.5918367346938775,  1.2244897959183672,   1.897959183673469,
      1.897959183673469,   1.897959183673469,    1.897959183673469,
      1.897959183673469,   1.3061224489795917,   0.6734693877551019,
      0.5918367346938775,  1.2244897959183672,   1.897959183673469,
      1.897959183673469,   1.897959183673469,    1.897959183673469,
      1.897959183673469,   1.3061224489795917,   0.6734693877551019,
      0.5918367346938775,  1.2244897959183672,   1.897959183673469,
      1.897959183673469,   1.897959183673469,    1.897959183673469,
      1.897959183673469,   1.3061224489795917,   0.6734693877551019,
      0.5918367346938775,  1.2244897959183672,   1.897959183673469,
      1.897959183673469,   1.897959183673469,    1.897959183673469,
      1.897959183673469,   1.3061224489795917,   0.6734693877551019,
      0.5918367346938775,  1.2244897959183672,   1.897959183673469,
      1.897959183673469,   1.897959183673469,    1.897959183673469,
      1.897959183673469,   1.3061224489795917,   0.6734693877551019,
      0.32653061224489793, 0.673469387755102,    1.0408163265306123,
      1.0408163265306123,  1.0408163265306123,   1.0408163265306123,
      1.0408163265306123,  0.7142857142857142,   0.36734693877551017};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.188667800453512, 15.765544217687074, 18.63866780045351,
      19.32404761904762,  22.3056746031746,   23.099557823129253,
      26.837023809523814, 27.75749433106576,  28.060000000000002,
      28.94249433106576,  31.697976190476187, 32.61844671201814,
      28.179325396825394, 28.97320861678005,  24.946332199546482,
      25.63171201814059,  21.496332199546483, 22.073208616780043,
      23.384246031746027, 24.069625850340135, 28.487307256235823,
      29.30159863945578,  33.84819160997732,  34.79139455782313,
      40.403350340136065, 41.49695011337869,  41.50489795918368,
      42.55337868480725,  46.17858843537415,  47.27218820861678,
      40.826604308390024, 41.769807256235836, 35.98136621315193,
      36.79565759637188,  30.878304988662126, 31.563684807256237,
      35.22432539682539,  36.0362925170068,   42.68452947845804,
      43.649217687074824, 50.45017573696144,  51.56758503401361,
      59.8664455782313,   61.16202947845805,  60.67632653061225,
      61.91845804988661,  66.70835034013605,  68.00393424036281,
      58.717477324263044, 59.8348866213152,   51.56271541950114,
      52.52740362811791,  44.10251133786848,  44.914478458049885,
      52.16670634920634,  53.13057823129252,  62.96976757369613,
      64.11493197278911,  74.13541383219955,  75.46187074829932,
      87.58501700680273,  89.12298185941043,  87.8648979591837,
      89.33941043083898,  95.70692176870749,  97.24488662131517,
      83.94938208616782,  85.27583900226757,  73.50890589569161,
      74.65407029478457,  62.70584467120181,  63.669716553287984,
      76.09170634920633,  77.05557823129251,  91.39476757369613,
      92.53993197278912,  107.06041383219953, 108.38687074829933,
      125.76001700680273, 127.29798185941044, 124.46489795918367,
      125.93941043083899, 133.88192176870749, 135.4198866213152,
      116.8743820861678,  118.20083900226756, 101.9339058956916,
      103.07907029478457, 86.63084467120181,  87.59471655328798,
      72.82075396825397,  73.63272108843537,  87.35238662131518,
      88.31707482993197,  102.18946145124715, 103.30687074829933,
      119.855731292517,   121.15131519274377, 118.19061224489795,
      119.43274376417232, 126.69763605442176, 127.99321995464851,
      110.45676303854874, 111.5741723356009,  96.23057256235828,
      97.19526077097505,  81.69893990929705,  82.51090702947845,
      67.8163888888889,   68.501768707483,    81.27659297052153,
      82.09088435374152,  94.99462018140588,  95.93782312925171,
      111.29977891156462, 112.39337868480725, 109.47632653061224,
      110.52480725623583, 117.07501700680271, 118.16861678004534,
      101.97303287981859, 102.91623582766441, 88.77065192743764,
      89.58494331065758,  75.31044784580499,  75.9958276643991,
      61.57387188208617,  62.15074829931973,  73.74836167800453,
      74.43374149659864,  86.13985827664398,  86.93374149659866,
      100.84977891156461, 101.77024943310659, 99.01918367346937,
      99.90167800453516,  105.710731292517,   106.63120181405897,
      92.01350907029477,  92.80739229024942,  80.0560260770975,
      80.74140589569161,  67.88153628117914,  68.4584126984127,
      98.25887188208615,  98.83574829931973,  117.33336167800454,
      118.01874149659864, 136.62485827664398, 137.41874149659864,
      159.3847789115646,  160.30524943310655, 155.13918367346935,
      156.02167800453515, 164.24573129251698, 165.16620181405898,
      142.4985090702948,  143.29239229024944, 123.64102607709751,
      124.3264058956916,  104.56653628117914, 105.14341269841269,
      122.07893990929703, 122.76431972789118, 145.7452664399093,
      146.55955782312927, 169.66941609977323, 170.61261904761903,
      197.88171768707483, 198.97531746031743, 192.48612244897956,
      193.53460317460318, 203.6569557823129,  204.7505555555556,
      176.64782879818597, 177.59103174603177, 153.23932539682542,
      154.05361678004533, 129.57299886621314, 130.25837868480724,
      152.14759070294784, 152.95955782312927, 181.59963151927437,
      182.56431972789116, 211.35711451247164, 212.4745238095238,
      246.43052721088435, 247.72611111111107, 239.54326530612244,
      240.78539682539682, 253.27243197278912, 254.5680158730159,
      219.6244160997733,  220.74182539682542, 190.4778174603175,
      191.44250566893422, 161.02577664399095, 161.83774376417233,
      190.9642573696145,  191.92812925170068, 227.8734410430839,
      229.01860544217686, 265.1452097505669,  266.47166666666664,
      309.05195578231286, 310.58992063492065, 300.194693877551,
      301.6692063492064,  317.1738605442177,  318.7118253968255,
      274.9591780045352,  276.28563492063495, 238.4125793650794,
      239.55774376417233, 201.50339569161,    202.46726757369615,
      214.8892573696145,  215.85312925170066, 256.29844104308387,
      257.4436054421768,  298.07020975056685, 299.3966666666667,
      347.2269557823129,  348.7649206349206,  336.7946938775511,
      338.26920634920634, 355.34886054421776, 356.8868253968254,
      307.8841780045352,  309.2106349206349,  266.83757936507936,
      267.98274376417237, 225.42839569160995, 226.39226757369616,
      189.74401927437646, 190.55598639455778, 226.26748866213154,
      227.23217687074828, 263.0964002267574,  264.2138095238095,
      306.4198129251701,  307.7153968253968,  297.05755102040814,
      298.2996825396825,  313.26171768707485, 314.5573015873016,
      271.3637018140589,  272.48111111111115, 235.1456746031746,
      236.11036281179142, 198.62220521541946, 199.43417233560095,
      166.51108276643993, 167.19646258503397, 198.53455215419504,
      199.34884353741492, 230.81584467120183, 231.7590476190476,
      268.77814625850345, 269.871746031746,   260.4575510204082,
      261.50603174603174, 274.5533843537415,  275.64698412698414,
      237.7942573696145,  238.73746031746032, 206.02861111111108,
      206.84290249433107, 174.005141723356,   174.69052154195012,
      144.64407596371882, 145.22095238095235, 172.4430555555556,
      173.12843537414963, 200.4590419501134,  201.25292517006798,
      233.39753401360545, 234.3180045351474,  226.0983673469388,
      226.98086167800452, 238.25848639455782, 239.17895691609976,
      206.33269274376414, 207.12657596371884, 178.7507199546485,
      179.43609977324266, 150.9517403628118,  151.52861678004535,
      181.32907596371885, 181.90595238095236, 216.0280555555555,
      216.71343537414964, 250.94404195011336, 251.73792517006802,
      291.93253401360545, 292.8530045351474,  282.2183673469388,
      283.10086167800455, 296.7934863945578,  297.7139569160997,
      256.81769274376416, 257.6115759637188,  222.33571995464854,
      223.02109977324264, 187.63674036281185, 188.21361678004536,
      220.7736337868481,  221.45901360544215, 263.0032256235827,
      263.8175170068027,  305.4906405895691,  306.43384353741493,
      355.36008503401365, 356.45368480725625, 343.4673469387755,
      344.51582766439907, 361.1353231292517,  362.2289229024942,
      312.46905328798186, 313.4122562358276,  270.4972845804989,
      271.31157596371884, 228.26769274376426, 228.95307256235827,
      269.0708560090703,  269.8828231292517,  320.5147335600907,
      321.4794217687075,  372.2640532879819,  373.381462585034,
      432.9946088435375,  434.29019274376424, 418.4102040816327,
      419.65233560090707, 439.8365136054422,  441.13209750566887,
      380.53135487528345, 381.6487641723356,  329.3929195011338,
      330.3576077097506,  277.94904195011344, 278.7610090702948,
      329.76180839002274, 330.7256802721088,  392.77711451247166,
      393.9222789115646,  456.1550056689343,  457.48146258503397,
      530.5188945578232,  532.0568594104309,  512.5244897959184,
      513.9990022675737,  538.6407993197279,  540.1787641723356,
      465.9689739229025,  467.2954308390023,  403.3162528344671,
      404.46141723356016, 340.3009467120182,  341.2648185941043,
      353.68680839002263, 354.6506802721088,  421.20211451247155,
      422.34727891156456, 489.0800056689343,  490.406462585034,
      568.6938945578232,  570.2318594104307,  549.1244897959184,
      550.5990022675737,  576.815799319728,   578.3537641723357,
      498.8939739229025,  500.2204308390023,  431.7412528344671,
      432.8864172335601,  364.2259467120182,  365.1898185941042,
      306.6672845804988,  307.4792517006802,  365.1825907029478,
      366.1472789115646,  424.0033390022676,  425.1207482993197,
      492.98389455782313, 494.2794784580499,  475.92448979591836,
      477.1666213151927,  499.8257993197278,  501.1213832199546,
      432.2706405895691,  433.3880498866213,  374.06077664399095,
      375.0254648526077,  315.5454705215419,  316.3574376417233,
      265.205776643991,   265.89115646258506, 315.79251133786846,
      316.60680272108846, 366.6370691609977,  367.58027210884353,
      426.25651360544214, 427.35011337868474, 411.43877551020404,
      412.48725623582766, 432.0317517006802,  433.1253514739229,
      373.6154818594104,  374.55868480725616, 323.2865702947846,
      324.10086167800443, 272.699835600907,   273.38521541950115,
      227.71428004535147, 228.29115646258506, 271.1377494331066,
      271.8231292517007,  314.7782256235828,  315.5721088435374,
      365.9452891156463,  366.8657596371882,  353.17755102040815,
      354.0600453514739,  370.8062414965986,  371.7267120181405,
      320.65187641723355, 321.44575963718813, 277.4454138321995,
      278.13079365079363, 234.02194444444444, 234.59882086167804};
  const std::array<int, 4> in_shape = {{3, 8, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.18367346938775508,
      0.24489795918367346, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.16326530612244897,
      0.20408163265306123, 0.1020408163265306,  0.12244897959183673,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.14285714285714285, 0.16326530612244897, 0.32653061224489793,
      0.36734693877551017, 0.5510204081632653,  0.6122448979591837,
      0.5510204081632653,  0.6122448979591837,  0.5510204081632653,
      0.6122448979591837,  0.5510204081632653,  0.6122448979591837,
      0.5510204081632653,  0.6122448979591837,  0.4081632653061224,
      0.44897959183673464, 0.22448979591836732, 0.24489795918367346,
      0.26530612244897955, 0.2857142857142857,  0.5714285714285714,
      0.6122448979591837,  0.9183673469387754,  0.9795918367346939,
      0.9183673469387754,  0.9795918367346939,  0.9183673469387754,
      0.9795918367346939,  0.9183673469387754,  0.9795918367346939,
      0.9183673469387754,  0.9795918367346939,  0.6530612244897959,
      0.693877551020408,   0.3469387755102041,  0.36734693877551017,
      0.6530612244897959,  0.693877551020408,   1.3877551020408163,
      1.4693877551020407,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.5510204081632653,
      1.6326530612244898,  0.8163265306122449,  0.8571428571428571,
      0.6530612244897959,  0.693877551020408,   1.3877551020408163,
      1.4693877551020407,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.5510204081632653,
      1.6326530612244898,  0.8163265306122449,  0.8571428571428571,
      0.6530612244897959,  0.693877551020408,   1.3877551020408163,
      1.4693877551020407,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.5510204081632653,
      1.6326530612244898,  0.8163265306122449,  0.8571428571428571,
      0.6530612244897959,  0.693877551020408,   1.3877551020408163,
      1.4693877551020407,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.5510204081632653,
      1.6326530612244898,  0.8163265306122449,  0.8571428571428571,
      0.6530612244897959,  0.693877551020408,   1.3877551020408163,
      1.4693877551020407,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.5510204081632653,
      1.6326530612244898,  0.8163265306122449,  0.8571428571428571,
      0.6530612244897959,  0.693877551020408,   1.3877551020408163,
      1.4693877551020407,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.5510204081632653,
      1.6326530612244898,  0.8163265306122449,  0.8571428571428571,
      0.3877551020408163,  0.4081632653061224,  0.8163265306122449,
      0.857142857142857,   1.2857142857142856,  1.3469387755102038,
      1.2857142857142856,  1.3469387755102038,  1.2857142857142856,
      1.3469387755102038,  1.2857142857142856,  1.3469387755102038,
      1.2857142857142856,  1.3469387755102038,  0.8979591836734693,
      0.9387755102040816,  0.4693877551020408,  0.4897959183673469,
      0.5102040816326531,  0.5306122448979591,  1.0612244897959182,
      1.1020408163265305,  1.6530612244897958,  1.714285714285714,
      1.6530612244897958,  1.714285714285714,   1.6530612244897958,
      1.714285714285714,   1.6530612244897958,  1.714285714285714,
      1.6530612244897958,  1.714285714285714,   1.1428571428571428,
      1.183673469387755,   0.5918367346938775,  0.6122448979591836,
      1.1428571428571428,  1.183673469387755,   2.36734693877551,
      2.4489795918367343,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   2.5306122448979593,
      2.6122448979591835,  1.3061224489795917,  1.3469387755102038,
      1.1428571428571428,  1.183673469387755,   2.36734693877551,
      2.4489795918367343,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   2.5306122448979593,
      2.6122448979591835,  1.3061224489795917,  1.3469387755102038,
      1.1428571428571428,  1.183673469387755,   2.36734693877551,
      2.4489795918367343,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   2.5306122448979593,
      2.6122448979591835,  1.3061224489795917,  1.3469387755102038,
      1.1428571428571428,  1.183673469387755,   2.36734693877551,
      2.4489795918367343,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   2.5306122448979593,
      2.6122448979591835,  1.3061224489795917,  1.3469387755102038,
      1.1428571428571428,  1.183673469387755,   2.36734693877551,
      2.4489795918367343,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   2.5306122448979593,
      2.6122448979591835,  1.3061224489795917,  1.3469387755102038,
      1.1428571428571428,  1.183673469387755,   2.36734693877551,
      2.4489795918367343,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   2.5306122448979593,
      2.6122448979591835,  1.3061224489795917,  1.3469387755102038,
      0.6326530612244897,  0.6530612244897959,  1.3061224489795917,
      1.346938775510204,   2.020408163265306,   2.0816326530612246,
      2.020408163265306,   2.0816326530612246,  2.020408163265306,
      2.0816326530612246,  2.020408163265306,   2.0816326530612246,
      2.020408163265306,   2.0816326530612246,  1.387755102040816,
      1.4285714285714284,  0.7142857142857142,  0.7346938775510203};
  const std::array<int, 4> in_shape = {{3, 8, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.800459183673464, 30.377335600907024, 30.954212018140588,
      31.531088435374148, 36.59195578231292,  37.27733560090702,
      37.96271541950113,  38.64809523809524,  43.81746598639456,
      44.6113492063492,   45.405232426303854, 46.199115646258505,
      52.75357709750567,  53.67404761904763,  54.594518140589564,
      55.51498866213152,  55.23750566893423,  56.120000000000005,
      57.00249433106575,  57.88498866213152,  62.47548185941042,
      63.39595238095237,  64.31642290249434,  65.23689342403628,
      55.56476757369614,  56.35865079365079,  57.15253401360544,
      57.9464172335601,   49.20728458049886,  49.892664399092965,
      50.57804421768707,  51.26342403628118,  42.4157879818594,
      42.992664399092966, 43.56954081632652,  44.146417233560086,
      46.08311224489796,  46.768492063492054, 47.45387188208617,
      48.13925170068027,  56.1603231292517,   56.974614512471646,
      57.788905895691606, 58.60319727891156,  66.75318027210885,
      67.69638321995464,  68.63958616780045,  69.58278911564626,
      79.71310090702949,  80.80670068027213,  81.90030045351473,
      82.99390022675738,  81.96131519274377,  83.00979591836736,
      84.05827664399091,  85.1067573696145,   91.26357709750566,
      92.3571768707483,   93.45077664399092,  94.54437641723356,
      80.71000566893422,  81.65320861678005,  82.59641156462584,
      83.53961451247167,  71.14844104308389,  71.96273242630386,
      72.7770238095238,   73.59131519274376,  61.07123015873015,
      61.75660997732425,  62.44198979591836,  63.127369614512475,
      69.63668367346938,  70.44865079365078,  71.26061791383219,
      72.0725850340136,   84.40437074829931,  85.36905895691608,
      86.33374716553288,  87.29843537414965,  99.78294217687076,
      100.90035147392288, 102.01776077097504, 103.13517006802722,
      118.43730725623585, 119.7328911564626,  121.02847505668933,
      122.3240589569161,  120.11052154195012, 121.3526530612245,
      122.59478458049884, 123.83691609977322, 132.12111678004533,
      133.4167006802721,  134.71228458049885, 136.00786848072562,
      116.3175453514739,  117.43495464852609, 118.55236394557821,
      119.6697732426304,  102.16074263038549, 103.12543083900228,
      104.09011904761903, 105.05480725623582, 87.39305555555555,
      88.20502267573696,  89.01698979591835,  89.82895691609977,
      103.36954081632652, 104.33341269841269, 105.29728458049885,
      106.26115646258503, 124.79437074829933, 125.93953514739226,
      127.08469954648525, 128.22986394557822, 146.94437074829932,
      148.2708276643991,  149.59728458049887, 150.92374149659864,
      173.63206916099776, 175.17003401360546, 176.7079988662131,
      178.24596371882086, 174.255283446712,   175.7297959183674,
      177.20430839002262, 178.67882086167796, 189.87587868480722,
      191.41384353741498, 192.95180839002265, 194.48977324263035,
      166.5723072562358,  167.89876417233563, 169.22522108843535,
      170.55167800453515, 145.87264739229025, 147.01781179138322,
      148.16297619047617, 149.30814058956915, 124.44781746031745,
      125.41168934240362, 126.37556122448976, 127.33943310657597,
      151.21954081632654, 152.18341269841267, 153.14728458049885,
      154.11115646258503, 181.64437074829937, 182.78953514739226,
      183.9346995464852,  185.07986394557824, 212.79437074829934,
      214.12082766439906, 215.44728458049886, 216.77374149659866,
      249.98206916099775, 251.52003401360545, 253.05799886621313,
      254.59596371882088, 247.45528344671206, 248.92979591836735,
      250.40430839002266, 251.87882086167798, 266.22587868480724,
      267.76384353741497, 269.30180839002264, 270.8397732426304,
      232.42230725623583, 233.7487641723356,  235.07522108843534,
      236.4016780045351,  202.72264739229024, 203.8678117913832,
      205.01297619047617, 206.15814058956914, 172.29781746031748,
      173.26168934240363, 174.22556122448978, 175.18943310657596,
      144.82954081632653, 145.64150793650794, 146.45347505668934,
      147.26544217687075, 173.74008503401365, 174.70477324263035,
      175.66946145124712, 176.63414965986394, 203.2615136054422,
      204.3789229024943,  205.49633219954646, 206.61374149659866,
      238.41587868480727, 239.711462585034,   241.00704648526076,
      242.30263038548753, 235.13909297052157, 236.3812244897959,
      237.62335600907025, 238.86548752834463, 252.09968820861678,
      253.39527210884353, 254.69085600907025, 255.98643990929702,
      219.79611678004537, 220.9135260770975,  222.03093537414964,
      223.1483446712018,  191.4964569160998,  192.46114512471655,
      193.42583333333332, 194.3905215419501,  162.5859126984127,
      163.3978798185941,  164.20984693877548, 165.0218140589569,
      134.9473979591837,  135.6327777777778,  136.31815759637186,
      137.003537414966,   161.73889455782316, 162.55318594104307,
      163.367477324263,   164.18176870748303, 189.046037414966,
      189.98924036281176, 190.93244331065756, 191.87564625850342,
      221.50595804988663, 222.59955782312923, 223.69315759637183,
      224.7867573696145,  217.90417233560095, 218.95265306122448,
      220.00113378684804, 221.04961451247166, 233.05643424036282,
      234.15003401360542, 235.24363378684805, 236.33723356009068,
      203.00286281179137, 203.94606575963718, 204.88926870748296,
      205.83247165532882, 176.72701247165534, 177.54130385487528,
      178.35559523809522, 179.16988662131516, 149.93551587301587,
      150.62089569160997, 151.30627551020405, 151.9916553287982,
      122.57086734693878, 123.14774376417235, 123.7246201814059,
      124.30149659863946, 146.81134353741498, 147.49672335600906,
      148.18210317460316, 148.86748299319729, 171.48583333333335,
      172.27971655328795, 173.07359977324262, 173.8674829931973,
      200.77908730158728, 201.69955782312923, 202.62002834467117,
      203.54049886621317, 197.15587301587303, 198.03836734693874,
      198.9208616780045,  199.8033560090703,  210.50099206349208,
      211.421462585034,   212.34193310657594, 213.26240362811794,
      183.2331349206349,  184.02701814058955, 184.82090136054418,
      185.61478458049885, 159.42667233560093, 160.112052154195,
      160.7974319727891,  161.48281179138323, 135.1861961451247,
      135.76307256235827, 136.33994897959184, 136.9168253968254,
      195.94086734693877, 196.5177437641723,  197.09462018140582,
      197.67149659863946, 233.98134353741494, 234.66672335600907,
      235.35210317460312, 236.03748299319727, 272.4558333333333,
      273.24971655328795, 274.0435997732426,  274.8374829931973,
      317.8490873015873,  318.7695578231292,  319.6900283446712,
      320.6104988662131,  309.39587301587306, 310.2783673469387,
      311.16086167800444, 312.0433560090703,  327.5709920634921,
      328.49146258503396, 329.41193310657593, 330.33240362811796,
      284.20313492063497, 284.9970181405896,  285.7909013605442,
      286.5847845804989,  246.59667233560094, 247.28205215419501,
      247.96743197278911, 248.6528117913832,  208.55619614512472,
      209.13307256235828, 209.70994897959184, 210.28682539682538,
      243.47250000000003, 244.15787981859407, 244.8432596371881,
      245.52863945578235, 290.6762414965986,  291.4905328798186,
      292.3048242630384,  293.11911564625854, 338.39562925170065,
      339.33883219954646, 340.2820351473922,  341.22523809523807,
      394.66983560090705, 395.76343537414965, 396.85703514739225,
      397.95063492063485, 383.9237641723356,  384.9722448979591,
      386.0207256235826,  387.06920634920635, 406.22031179138327,
      407.3139115646258,  408.4075113378684,  409.5011111111112,
      352.35245464852613, 353.29565759637194, 354.2388605442177,
      355.18206349206355, 305.6643594104308,  306.47865079365084,
      307.2929421768707,  308.10723356009066, 258.4606179138322,
      259.1459977324263,  259.8313775510204,  260.5167573696145,
      303.4832142857143,  304.2951814058957,  305.10714852607697,
      305.91911564625855, 362.23457482993194, 363.19926303854874,
      364.16395124716536, 365.1286394557823,  421.59681972789116,
      422.7142290249433,  423.83163832199534, 424.9490476190476,
      491.565470521542,   492.8610544217687,  494.1566383219954,
      495.45222222222213, 477.84439909297055, 479.08653061224487,
      480.3286621315191,  481.57079365079363, 505.24928004535155,
      506.54486394557824, 507.8404478458049,  509.1360317460318,
      438.1314229024944,  439.2488321995466,  440.3662414965986,
      441.48365079365084, 379.9909467120181,  380.955634920635,
      381.92032312925164, 382.88501133786843, 321.2395861678005,
      322.0515532879819,  322.86352040816325, 323.67548752834466,
      380.9646428571429,  381.928514739229,   382.8923866213151,
      383.85625850340136, 454.6017176870748,  455.7468820861678,
      456.8920464852606,  458.0372108843537,  528.963962585034,
      530.2904195011338,  531.6168764172335,  532.9433333333333,
      616.5659467120182,  618.1039115646257,  619.6418764172336,
      621.1798412698413,  598.9148752834468,  600.389387755102,
      601.8639002267572,  603.3384126984128,  632.8097562358278,
      634.3477210884354,  635.885685941043,   637.423650793651,
      548.5918990929706,  549.9183560090704,  551.2448129251701,
      552.5712698412699,  475.67999433106576, 476.8251587301588,
      477.9703231292516,  479.11548752834466, 402.04291950113384,
      403.00679138322,    403.9706632653061,  404.9345351473923,
      428.8146428571429,  429.778514739229,   430.7423866213152,
      431.70625850340133, 511.45171768707485, 512.5968820861677,
      513.7420464852606,  514.8872108843536,  594.8139625850341,
      596.1404195011337,  597.4668764172335,  598.7933333333334,
      692.9159467120182,  694.4539115646259,  695.9918764172336,
      697.5298412698412,  672.1148752834467,  673.5893877551022,
      675.0639002267573,  676.5384126984127,  709.1597562358277,
      710.6977210884355,  712.235685941043,   713.7736507936507,
      614.4418990929706,  615.7683560090704,  617.0948129251699,
      618.4212698412698,  532.5299943310658,  533.6751587301587,
      534.8203231292516,  535.9654875283447,  449.8929195011338,
      450.8567913832199,  451.820663265306,   452.7845351473923,
      378.67607142857145, 379.4880385487529,  380.3000056689342,
      381.11197278911555, 451.5702891156463,  452.5349773242631,
      453.4996655328798,  454.46435374149655, 525.0753911564626,
      526.1928004535148,  527.310209750567,   528.427619047619,
      611.5440419501134,  612.8396258503402,  614.1352097505669,
      615.4307936507936,  592.872970521542,   594.1151020408163,
      595.3572335600905,  596.599365079365,   625.227851473923,
      626.5234353741497,  627.8190192743763,  629.1146031746032,
      541.6099943310658,  542.7274036281178,  543.8448129251699,
      544.9622222222223,  469.32666099773246, 470.2913492063492,
      471.25603741496593, 472.22072562358284, 396.43244331065756,
      397.2444104308389,  398.0563775510203,  398.8683446712019,
      332.3367857142857,  333.02216553287985, 333.70754535147387,
      334.39292517006794, 396.2548129251701,  397.0691043083901,
      397.88339569160996, 398.69768707482984, 460.6884863945578,
      461.63168934240366, 462.5748922902494,  463.5180952380952,
      536.4626927437641,  537.5562925170069,  538.6498922902495,
      539.743492063492,   519.8666213151928,  520.9151020408164,
      521.9635827664398,  523.0120634920635,  548.0131689342404,
      549.106768707483,   550.2003684807255,  551.2939682539683,
      474.6453117913832,  475.588514739229,   476.5317176870748,
      477.47492063492064, 411.2429308390023,  412.05722222222215,
      412.87151360544215, 413.68580498866214, 347.3249036281179,
      348.010283446712,   348.6956632653061,  349.38104308390024,
      288.7112755102041,  289.28815192743764, 289.86502834467115,
      290.4419047619047,  344.20073129251705, 344.8861111111112,
      345.5714909297052,  346.25687074829926, 400.1242006802721,
      400.9180839002268,  401.7119671201813,  402.50585034013596,
      465.87459750566893, 466.7950680272109,  467.71553854875276,
      468.6360090702948,  451.3142403628118,  452.1967346938776,
      453.0792290249433,  453.96172335600903, 475.5965022675737,
      476.51697278911564, 477.4374433106575,  478.35791383219953,
      411.8715022675737,  412.6653854875283,  413.459268707483,
      414.25315192743767, 356.81606009070293, 357.501439909297,
      358.18681972789113, 358.8721995464853,  301.32660430838996,
      301.9034807256236,  302.48035714285714, 303.0572335600907,
      362.08127551020414, 362.6581519274377,  363.23502834467115,
      363.8119047619047,  431.370731292517,   432.056111111111,
      432.7414909297051,  433.4268707482993,  501.0942006802722,
      501.8880839002267,  502.68196712018135, 503.47585034013605,
      582.9445975056691,  583.8650680272109,  584.7855385487529,
      585.7060090702948,  563.5542403628118,  564.4367346938776,
      565.3192290249433,  566.2017233560091,  592.6665022675738,
      593.5869727891156,  594.5074433106577,  595.4279138321994,
      512.8415022675737,  513.6353854875283,  514.429268707483,
      515.2231519274376,  443.98606009070295, 444.6714399092971,
      445.3568197278912,  446.0421995464853,  374.69660430838996,
      375.2734807256237,  375.8503571428572,  376.4272335600907,
      440.8618877551021,  441.5472675736962,  442.23264739229023,
      442.9180272108843,  525.1921598639456,  526.0064512471654,
      526.8207426303853,  527.6350340136054,  610.0380782312926,
      610.9812811791383,  611.9244841269841,  612.8676870748299,
      709.6265702947846,  710.7201700680273,  711.81376984127,
      712.9073696145125,  685.8862131519273,  686.934693877551,
      687.9831746031746,  689.0316553287981,  721.1770464852608,
      722.2706462585033,  723.3642460317461,  724.4578458049884,
      623.9949036281178,  624.9381065759637,  625.8813095238094,
      626.8245124716552,  540.1802777777777,  540.9945691609978,
      541.8088605442177,  542.6231519274377,  455.85000566893416,
      456.5353854875285,  457.22076530612253, 457.90614512471655,
      537.3297448979592,  538.1417120181407,  538.9536791383221,
      539.7656462585034,  640.0647789115646,  641.0294671201814,
      641.994155328798,   642.958843537415,   743.4106972789117,
      744.5281065759638,  745.6455158730158,  746.762925170068,
      864.6936337868482,  865.989217687075,   867.2848015873017,
      868.5803854875285,  835.5782766439909,  836.8204081632654,
      838.0625396825396,  839.3046712018141,  878.3774433106577,
      879.6730272108844,  880.9686111111113,  882.2641950113377,
      759.9453004535146,  761.0627097505669,  762.180119047619,
      763.2975283446712,  657.8211507936508,  658.7858390022676,
      659.7505272108845,  660.7152154195012,  555.0861167800452,
      555.8980839002269,  556.7100510204083,  557.5220181405896,
      658.5597448979593,  659.5236167800455,  660.4874886621316,
      661.4513605442176,  784.4090646258504,  785.5542290249433,
      786.6993934240361,  787.8445578231292,  910.9835544217689,
      912.3100113378686,  913.6364682539682,  914.9629251700679,
      1059.4998242630388, 1061.0377891156463, 1062.575753968254,
      1064.1137188208618, 1023.5744671201815, 1025.0489795918368,
      1026.523492063492,  1027.9980045351474, 1075.7436337868482,
      1077.2815986394558, 1078.8195634920635, 1080.3575283446712,
      930.6114909297052,  931.937947845805,   933.2644047619046,
      934.5908616780046,  805.4873412698413,  806.6325056689342,
      807.7776700680273,  808.9228344671203,  679.63802154195,
      680.6018934240363,  681.5657653061226,  682.5296371882087,
      706.4097448979593,  707.3736167800453,  708.3374886621315,
      709.3013605442176,  841.2590646258506,  842.4042290249431,
      843.5493934240362,  844.6945578231291,  976.8335544217688,
      978.1600113378686,  979.4864682539684,  980.812925170068,
      1135.8498242630387, 1137.3877891156465, 1138.925753968254,
      1140.4637188208615, 1096.7744671201815, 1098.2489795918368,
      1099.7234920634921, 1101.1980045351474, 1152.0936337868482,
      1153.631598639456,  1155.1695634920636, 1156.7075283446713,
      996.4614909297052,  997.787947845805,   999.1144047619049,
      1000.4408616780046, 862.3373412698412,  863.4825056689342,
      864.6276700680273,  865.7728344671202,  727.4880215419502,
      728.4518934240364,  729.4157653061225,  730.3796371882084,
      612.5226020408164,  613.3345691609976,  614.1465362811791,
      614.9585034013604,  729.400493197279,   730.3651814058956,
      731.3298696145124,  732.2945578231293,  846.8892687074831,
      848.0066780045352,  849.1240873015872,  850.2414965986394,
      984.6722052154196,  985.9677891156463,  987.263373015873,
      988.5589569160998,  950.6068480725623,  951.8489795918367,
      953.091111111111,   954.3332426303854,  998.3560147392291,
      999.6515986394556,  1000.9471825396826, 1002.2427664399092,
      863.4238718820862,  864.5412811791382,  865.6586904761905,
      866.7760997732425,  747.1568650793652,  748.1215532879819,
      749.0862414965986,  750.0509297052154,  630.2789739229025,
      631.0909410430838,  631.9029081632655,  632.7148752834466,
      529.7261734693878,  530.411553287982,   531.0969331065759,
      531.7823129251701,  630.7707312925171,  631.5850226757369,
      632.399314058957,   633.2136054421769,  732.3309353741496,
      733.2741383219955,  734.2173412698413,  735.1605442176871,
      851.4194274376417,  852.5130272108843,  853.6066269841269,
      854.7002267573695,  821.8290702947846,  822.8775510204081,
      823.9260317460318,  824.9745124716553,  862.969903628118,
      864.0635034013604,  865.1571031746032,  866.2507029478458,
      746.2877607709751,  747.2309637188208,  748.1741666666668,
      749.1173696145123,  645.7588492063492,  646.5731405895692,
      647.3874319727892,  648.2017233560089,  544.7142913832199,
      545.399671201814,   546.0850510204082,  546.7704308390023,
      454.8516836734694,  455.42856009070294, 456.00543650793645,
      456.58231292517013, 541.5901190476189,  542.2754988662132,
      542.9608786848072,  543.6462585034014,  628.7625680272109,
      629.5564512471656,  630.3503344671201,  631.1442176870748,
      730.9701077097506,  731.8905782312926,  732.8110487528345,
      733.7315192743764,  705.4726077097506,  706.3551020408163,
      707.2375963718821,  708.1200907029478,  740.6920124716553,
      741.6124829931972,  742.5329535147393,  743.453424036281,
      640.5098696145126,  641.3037528344671,  642.0976360544219,
      642.8915192743763,  554.2054478458051,  554.890827664399,
      555.5762074829931,  556.2615873015873,  467.4670124716553,
      468.0438888888889,  468.6207653061225,  469.19764172335607};
  const std::array<int, 4> in_shape = {{3, 8, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.3061224489795918,  0.36734693877551017,
      0.42857142857142855, 0.4897959183673469,  0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.2857142857142857,  0.32653061224489793,
      0.36734693877551017, 0.40816326530612246, 0.18367346938775508,
      0.2040816326530612,  0.22448979591836732, 0.24489795918367346,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.26530612244897955, 0.2857142857142857,  0.3061224489795918,
      0.32653061224489793, 0.6122448979591837,  0.6530612244897959,
      0.693877551020408,   0.7346938775510203,  1.0408163265306123,
      1.1020408163265305,  1.1632653061224487,  1.2244897959183674,
      1.0408163265306123,  1.1020408163265305,  1.1632653061224487,
      1.2244897959183674,  1.0408163265306123,  1.1020408163265305,
      1.1632653061224487,  1.2244897959183674,  1.0408163265306123,
      1.1020408163265305,  1.1632653061224487,  1.2244897959183674,
      1.0408163265306123,  1.1020408163265305,  1.1632653061224487,
      1.2244897959183674,  0.7755102040816326,  0.8163265306122448,
      0.8571428571428571,  0.8979591836734693,  0.42857142857142855,
      0.44897959183673464, 0.4693877551020408,  0.4897959183673469,
      0.5102040816326531,  0.5306122448979591,  0.5510204081632653,
      0.5714285714285714,  1.1020408163265305,  1.1428571428571428,
      1.183673469387755,   1.2244897959183674,  1.7755102040816326,
      1.8367346938775508,  1.8979591836734693,  1.9591836734693877,
      1.7755102040816326,  1.8367346938775508,  1.8979591836734693,
      1.9591836734693877,  1.7755102040816326,  1.8367346938775508,
      1.8979591836734693,  1.9591836734693877,  1.7755102040816326,
      1.8367346938775508,  1.8979591836734693,  1.9591836734693877,
      1.7755102040816326,  1.8367346938775508,  1.8979591836734693,
      1.9591836734693877,  1.2653061224489797,  1.3061224489795917,
      1.3469387755102038,  1.387755102040816,   0.673469387755102,
      0.6938775510204082,  0.7142857142857142,  0.7346938775510203,
      1.2653061224489797,  1.3061224489795917,  1.3469387755102038,
      1.387755102040816,   2.693877551020408,   2.7755102040816326,
      2.8571428571428568,  2.9387755102040813,  4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   3.020408163265306,   3.1020408163265305,
      3.1836734693877546,  3.2653061224489797,  1.5918367346938775,
      1.6326530612244898,  1.673469387755102,   1.7142857142857142,
      1.2653061224489797,  1.3061224489795917,  1.3469387755102038,
      1.387755102040816,   2.693877551020408,   2.7755102040816326,
      2.8571428571428568,  2.9387755102040813,  4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   3.020408163265306,   3.1020408163265305,
      3.1836734693877546,  3.2653061224489797,  1.5918367346938775,
      1.6326530612244898,  1.673469387755102,   1.7142857142857142,
      1.2653061224489797,  1.3061224489795917,  1.3469387755102038,
      1.387755102040816,   2.693877551020408,   2.7755102040816326,
      2.8571428571428568,  2.9387755102040813,  4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   3.020408163265306,   3.1020408163265305,
      3.1836734693877546,  3.2653061224489797,  1.5918367346938775,
      1.6326530612244898,  1.673469387755102,   1.7142857142857142,
      1.2653061224489797,  1.3061224489795917,  1.3469387755102038,
      1.387755102040816,   2.693877551020408,   2.7755102040816326,
      2.8571428571428568,  2.9387755102040813,  4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   3.020408163265306,   3.1020408163265305,
      3.1836734693877546,  3.2653061224489797,  1.5918367346938775,
      1.6326530612244898,  1.673469387755102,   1.7142857142857142,
      1.2653061224489797,  1.3061224489795917,  1.3469387755102038,
      1.387755102040816,   2.693877551020408,   2.7755102040816326,
      2.8571428571428568,  2.9387755102040813,  4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   3.020408163265306,   3.1020408163265305,
      3.1836734693877546,  3.2653061224489797,  1.5918367346938775,
      1.6326530612244898,  1.673469387755102,   1.7142857142857142,
      1.2653061224489797,  1.3061224489795917,  1.3469387755102038,
      1.387755102040816,   2.693877551020408,   2.7755102040816326,
      2.8571428571428568,  2.9387755102040813,  4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   3.020408163265306,   3.1020408163265305,
      3.1836734693877546,  3.2653061224489797,  1.5918367346938775,
      1.6326530612244898,  1.673469387755102,   1.7142857142857142,
      0.7551020408163265,  0.7755102040816326,  0.7959183673469387,
      0.8163265306122448,  1.5918367346938775,  1.6326530612244898,
      1.673469387755102,   1.714285714285714,   2.510204081632653,
      2.571428571428571,   2.63265306122449,    2.6938775510204076,
      2.510204081632653,   2.571428571428571,   2.63265306122449,
      2.6938775510204076,  2.510204081632653,   2.571428571428571,
      2.63265306122449,    2.6938775510204076,  2.510204081632653,
      2.571428571428571,   2.63265306122449,    2.6938775510204076,
      2.510204081632653,   2.571428571428571,   2.63265306122449,
      2.6938775510204076,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  0.9183673469387754,
      0.9387755102040816,  0.9591836734693877,  0.9795918367346939,
      0.9999999999999999,  1.0204081632653061,  1.040816326530612,
      1.0612244897959182,  2.081632653061224,   2.1224489795918364,
      2.1632653061224487,  2.204081632653061,   3.244897959183673,
      3.3061224489795915,  3.36734693877551,    3.428571428571428,
      3.244897959183673,   3.3061224489795915,  3.36734693877551,
      3.428571428571428,   3.244897959183673,   3.3061224489795915,
      3.36734693877551,    3.428571428571428,   3.244897959183673,
      3.3061224489795915,  3.36734693877551,    3.428571428571428,
      3.244897959183673,   3.3061224489795915,  3.36734693877551,
      3.428571428571428,   2.2448979591836733,  2.2857142857142856,
      2.326530612244898,   2.36734693877551,    1.163265306122449,
      1.183673469387755,   1.2040816326530612,  1.2244897959183672,
      2.2448979591836733,  2.2857142857142856,  2.3265306122448974,
      2.36734693877551,    4.653061224489795,   4.73469387755102,
      4.816326530612244,   4.897959183673469,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   4.979591836734693,   5.061224489795919,
      5.142857142857142,   5.224489795918367,   2.571428571428571,
      2.6122448979591835,  2.6530612244897958,  2.6938775510204076,
      2.2448979591836733,  2.2857142857142856,  2.3265306122448974,
      2.36734693877551,    4.653061224489795,   4.73469387755102,
      4.816326530612244,   4.897959183673469,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   4.979591836734693,   5.061224489795919,
      5.142857142857142,   5.224489795918367,   2.571428571428571,
      2.6122448979591835,  2.6530612244897958,  2.6938775510204076,
      2.2448979591836733,  2.2857142857142856,  2.3265306122448974,
      2.36734693877551,    4.653061224489795,   4.73469387755102,
      4.816326530612244,   4.897959183673469,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   4.979591836734693,   5.061224489795919,
      5.142857142857142,   5.224489795918367,   2.571428571428571,
      2.6122448979591835,  2.6530612244897958,  2.6938775510204076,
      2.2448979591836733,  2.2857142857142856,  2.3265306122448974,
      2.36734693877551,    4.653061224489795,   4.73469387755102,
      4.816326530612244,   4.897959183673469,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   4.979591836734693,   5.061224489795919,
      5.142857142857142,   5.224489795918367,   2.571428571428571,
      2.6122448979591835,  2.6530612244897958,  2.6938775510204076,
      2.2448979591836733,  2.2857142857142856,  2.3265306122448974,
      2.36734693877551,    4.653061224489795,   4.73469387755102,
      4.816326530612244,   4.897959183673469,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   4.979591836734693,   5.061224489795919,
      5.142857142857142,   5.224489795918367,   2.571428571428571,
      2.6122448979591835,  2.6530612244897958,  2.6938775510204076,
      2.2448979591836733,  2.2857142857142856,  2.3265306122448974,
      2.36734693877551,    4.653061224489795,   4.73469387755102,
      4.816326530612244,   4.897959183673469,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   4.979591836734693,   5.061224489795919,
      5.142857142857142,   5.224489795918367,   2.571428571428571,
      2.6122448979591835,  2.6530612244897958,  2.6938775510204076,
      1.2448979591836733,  1.2653061224489794,  1.2857142857142856,
      1.3061224489795917,  2.571428571428571,   2.6122448979591835,
      2.6530612244897958,  2.693877551020408,   3.979591836734693,
      4.040816326530612,   4.1020408163265305,  4.163265306122449,
      3.979591836734693,   4.040816326530612,   4.1020408163265305,
      4.163265306122449,   3.979591836734693,   4.040816326530612,
      4.1020408163265305,  4.163265306122449,   3.979591836734693,
      4.040816326530612,   4.1020408163265305,  4.163265306122449,
      3.979591836734693,   4.040816326530612,   4.1020408163265305,
      4.163265306122449,   2.7346938775510203,  2.775510204081632,
      2.816326530612245,   2.8571428571428568,  1.4081632653061222,
      1.4285714285714284,  1.4489795918367345,  1.4693877551020407};
  const std::array<int, 4> in_shape = {{3, 8, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678004535,  10.5300283446712,
      12.555198412698413, 14.688871882086168,
      14.710102040816327, 15.773435374149658,
      18.094070294784576, 16.285907029478455,
      14.36924036281179,  12.344070294784583,
      13.199416099773241, 16.034450113378682,
      18.998395691609975, 22.091252834467117,
      21.791054421768706, 23.054387755102034,
      26.136927437641713, 23.430804988662125,
      20.595770975056684, 17.6318253968254,
      19.815685941043082, 23.960243764172333,
      28.257522675736958, 32.70752267573695,
      31.893435374149657, 33.390102040816316,
      37.50041950113378,  33.5085827664399,
      29.36402494331065,  25.06674603174603,
      29.274257369614514, 35.27595804988662,
      41.45895124716553,  47.82323696145123,
      46.225816326530605, 48.00248299319726,
      53.51280045351472,  47.692392290249416,
      41.690691609977314, 35.50769841269841,
      42.56592403628118,  51.06762471655329,
      59.7506179138322,   68.6149036281179,
      65.55914965986395,  67.33581632653059,
      74.3044671201814,   65.98405895691609,
      57.48235827664399,  48.79936507936508,
      40.702590702947845, 48.77571995464853,
      57.00157029478458,  65.380141723356,
      62.27438775510203,  63.7710544217687,
      70.17303854875283,  62.25263038548753,
      54.17950113378685,  45.953650793650795,
      37.883939909297055, 45.361831065759645,
      52.96863378684808,  60.704348072562354,
      57.69581632653061,  58.95914965986395,
      64.75002267573697,  57.40104308390023,
      49.92315192743765,  42.31634920634921,
      34.38291950113379,  41.14652494331066,
      48.01863378684808,  54.99924603174604,
      52.193095238095246, 53.25642857142858,
      58.40444444444445,  51.74934240362813,
      44.98573696145125,  38.113628117913834,
      54.763475056689344, 65.36041383219955,
      76.0658560090703,   86.87980158730159,
      81.83753968253968,  82.90087301587303,
      90.28500000000003,  79.79656462585037,
      69.19962585034015,  58.49418367346939,
      68.02980158730158,  81.17776077097506,
      94.45463151927437,  107.86041383219953,
      101.54434240362811, 102.80767573696146,
      111.90608843537416, 98.88704081632655,
      85.73908163265307,  72.46221088435374,
      84.77305555555554,  101.13530045351473,
      117.65026643990929, 134.3179535147392,
      126.37688208616778, 127.87354875283447,
      139.11085034013607, 122.90132653061225,
      106.53908163265307, 90.0241156462585,
      106.38400793650791, 126.88910997732424,
      147.57550453514742, 168.44319160997733,
      158.38545351473923, 160.1621201814059,
      174.13275510204085, 153.8089455782313,
      133.303843537415,   112.61744897959183,
      119.6756746031746,  142.6807766439909,
      165.86717120181405, 189.23485827664396,
      177.71878684807254, 179.4954535147392,
      194.92442176870748, 172.10061224489797,
      149.09551020408162, 125.90911564625848,
      105.6599603174603,  125.95077664399092,
      146.39431405895692, 166.99057256235827,
      156.7578344671202,  158.25450113378685,
      171.78346938775508, 151.64537414965986,
      131.35455782312926, 110.91102040816325,
      92.71432539682539,  110.505141723356,
      128.42486961451246, 146.47350907029477,
      137.44910430839002, 138.71243764172337,
      150.5191836734694,  132.85727891156463,
      115.06646258503402, 97.14673469387756,
      80.53303287981859,  95.976910430839,
      111.52929138321997, 127.19017573696146,
      119.3205328798186,  120.38386621315192,
      130.59537414965985, 115.26,
      99.81612244897958,  84.26374149659863,
      100.91358843537414, 120.19079931972787,
      139.57651360544216, 159.07073129251702,
      148.96497732426306, 150.02831065759634,
      162.47592970521544, 143.3072222222222,
      124.03001133786846, 104.64429705215417,
      122.86018707482992, 146.3210714285714,
      169.91086734693874, 193.62957482993198,
      181.29763038548757, 182.56096371882083,
      197.6752494331066,  174.34327664399092,
      150.8823922902494,  127.29259637188207,
      149.730425170068,   178.3103571428571,
      207.04301020408158, 235.92838435374148,
      220.86032879818595, 222.35699546485256,
      240.72128117913832, 212.29407029478455,
      183.71413832199542, 154.98148526077094,
      183.49375850340135, 218.50226190476187,
      253.6920578231292,  289.06314625850337,
      270.54509070294785, 272.3217573696145,
      294.7527097505669,  259.9254988662131,
      224.91699546485256, 189.72719954648522,
      196.78542517006807, 234.29392857142858,
      271.9837244897959,  309.85481292517005,
      289.8784240362812,  291.65509070294786,
      315.5443764172336,  278.2171655328798,
      240.70866213151922, 203.0188662131519,
      170.61732993197282, 203.12583333333336,
      235.78705782312923, 268.6010034013606,
      251.24128117913827, 252.737947845805,
      273.39390022675735, 241.03811791383217,
      208.52961451247162, 175.8683900226757,
      147.54471088435378, 175.6484523809524,
      203.88110544217685, 232.24267006802722,
      217.20239229024943, 218.46572562358276,
      236.28834467120183, 208.313514739229,
      180.20977324263035, 151.97712018140587,
      126.68314625850338, 150.80729591836734,
      175.03994897959183, 199.38110544217687,
      186.44797052154195, 187.51130385487525,
      202.78630385487526, 178.77065759637185,
      154.6465079365079,  130.41385487528345};
  const std::array<int, 4> in_shape = {{3, 8, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.20408163265306123, 0.20408163265306123,  0.20408163265306123,
      0.20408163265306123, 0.18367346938775508,  0.14285714285714285,
      0.08163265306122448, 0.12244897959183672,  0.2857142857142857,
      0.48979591836734687, 0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.6122448979591837,
      0.44897959183673464, 0.24489795918367346,  0.12244897959183672,
      0.2857142857142857,  0.48979591836734687,  0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.7346938775510203,
      0.6122448979591837,  0.44897959183673464,  0.24489795918367346,
      0.12244897959183672, 0.2857142857142857,   0.48979591836734687,
      0.7346938775510203,  0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.6122448979591837,   0.44897959183673464,
      0.24489795918367346, 0.12244897959183672,  0.2857142857142857,
      0.48979591836734687, 0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.6122448979591837,
      0.44897959183673464, 0.24489795918367346,  0.12244897959183672,
      0.2857142857142857,  0.48979591836734687,  0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.7346938775510203,
      0.6122448979591837,  0.44897959183673464,  0.24489795918367346,
      0.12244897959183672, 0.2857142857142857,   0.48979591836734687,
      0.7346938775510203,  0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.6122448979591837,   0.44897959183673464,
      0.24489795918367346, 0.1020408163265306,   0.22448979591836732,
      0.36734693877551017, 0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,  0.5306122448979591,   0.4285714285714285,
      0.30612244897959184, 0.16326530612244897,  0.18367346938775508,
      0.3877551020408163,  0.6122448979591837,   0.8571428571428572,
      0.8571428571428572,  0.8571428571428572,   0.8571428571428572,
      0.6734693877551019,  0.4693877551020408,   0.24489795918367346,
      0.44897959183673464, 0.9387755102040816,   1.4693877551020407,
      2.0408163265306123,  2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,  1.5918367346938773,   1.1020408163265305,
      0.5714285714285714,  0.44897959183673464,  0.9387755102040816,
      1.4693877551020407,  2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,  2.0408163265306123,   1.5918367346938773,
      1.1020408163265305,  0.5714285714285714,   0.44897959183673464,
      0.9387755102040816,  1.4693877551020407,   2.0408163265306123,
      2.0408163265306123,  2.0408163265306123,   2.0408163265306123,
      1.5918367346938773,  1.1020408163265305,   0.5714285714285714,
      0.44897959183673464, 0.9387755102040816,   1.4693877551020407,
      2.0408163265306123,  2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,  1.5918367346938773,   1.1020408163265305,
      0.5714285714285714,  0.44897959183673464,  0.9387755102040816,
      1.4693877551020407,  2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,  2.0408163265306123,   1.5918367346938773,
      1.1020408163265305,  0.5714285714285714,   0.44897959183673464,
      0.9387755102040816,  1.4693877551020407,   2.0408163265306123,
      2.0408163265306123,  2.0408163265306123,   2.0408163265306123,
      1.5918367346938773,  1.1020408163265305,   0.5714285714285714,
      0.26530612244897955, 0.5510204081632653,   0.857142857142857,
      1.1836734693877549,  1.1836734693877549,   1.1836734693877549,
      1.1836734693877549,  0.9183673469387754,   0.6326530612244897,
      0.32653061224489793, 0.3469387755102041,   0.7142857142857142,
      1.1020408163265305,  1.510204081632653,    1.510204081632653,
      1.510204081632653,   1.510204081632653,    1.163265306122449,
      0.7959183673469388,  0.4081632653061224,   0.7755102040816326,
      1.5918367346938775,  2.4489795918367343,   3.346938775510204,
      3.346938775510204,   3.346938775510204,    3.346938775510204,
      2.571428571428571,   1.7551020408163267,   0.8979591836734693,
      0.7755102040816326,  1.5918367346938775,   2.4489795918367343,
      3.346938775510204,   3.346938775510204,    3.346938775510204,
      3.346938775510204,   2.571428571428571,    1.7551020408163267,
      0.8979591836734693,  0.7755102040816326,   1.5918367346938775,
      2.4489795918367343,  3.346938775510204,    3.346938775510204,
      3.346938775510204,   3.346938775510204,    2.571428571428571,
      1.7551020408163267,  0.8979591836734693,   0.7755102040816326,
      1.5918367346938775,  2.4489795918367343,   3.346938775510204,
      3.346938775510204,   3.346938775510204,    3.346938775510204,
      2.571428571428571,   1.7551020408163267,   0.8979591836734693,
      0.7755102040816326,  1.5918367346938775,   2.4489795918367343,
      3.346938775510204,   3.346938775510204,    3.346938775510204,
      3.346938775510204,   2.571428571428571,    1.7551020408163267,
      0.8979591836734693,  0.7755102040816326,   1.5918367346938775,
      2.4489795918367343,  3.346938775510204,    3.346938775510204,
      3.346938775510204,   3.346938775510204,    2.571428571428571,
      1.7551020408163267,  0.8979591836734693,   0.42857142857142855,
      0.8775510204081631,  1.3469387755102038,   1.8367346938775508,
      1.8367346938775508,  1.8367346938775508,   1.8367346938775508,
      1.4081632653061225,  0.9591836734693877,   0.4897959183673469};
  const std::array<int, 4> in_shape = {{3, 8, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.64984693877551,
                                         17.22672335600907,
                                         20.374676870748296,
                                         21.0600566893424,
                                         24.31651360544218,
                                         25.110396825396826,
                                         28.475357142857142,
                                         29.377743764172337,
                                         28.581111111111106,
                                         29.420204081632654,
                                         30.707777777777775,
                                         31.546870748299316,
                                         35.285753968253964,
                                         36.18814058956915,
                                         31.77793083900226,
                                         32.57181405895691,
                                         28.053100907029474,
                                         28.73848072562358,
                                         24.111264172335602,
                                         24.688140589569166,
                                         25.713452380952383,
                                         26.398832199546483,
                                         31.25460884353741,
                                         32.068900226757364,
                                         37.053588435374145,
                                         37.99679138321995,
                                         43.11039115646258,
                                         44.18250566893423,
                                         42.58519274376416,
                                         43.58210884353741,
                                         45.11185941043083,
                                         46.10877551020407,
                                         51.20174036281178,
                                         52.273854875283426,
                                         45.918407029478445,
                                         46.86160997732425,
                                         40.377250566893416,
                                         41.19154195011337,
                                         34.57827097505669,
                                         35.2636507936508,
                                         38.819404761904764,
                                         39.631371882086164,
                                         46.95579931972788,
                                         47.920487528344665,
                                         55.39763605442177,
                                         56.515045351473916,
                                         64.14491496598639,
                                         65.4150453514739,
                                         62.60582766439907,
                                         63.786870748299314,
                                         65.59916099773243,
                                         66.78020408163263,
                                         73.73070861678003,
                                         75.00083900226755,
                                         65.89975623582765,
                                         67.0171655328798,
                                         57.76336167800453,
                                         58.7280498866213,
                                         49.321524943310656,
                                         50.13349206349206,
                                         57.58464285714285,
                                         58.54851473922903,
                                         69.40675170068026,
                                         70.55191609977324,
                                         81.5914455782313,
                                         82.91790249433106,
                                         94.13872448979592,
                                         95.64647392290246,
                                         91.0496371882086,
                                         92.45163265306121,
                                         94.60297052154196,
                                         96.00496598639452,
                                         105.5178514739229,
                                         107.02560090702944,
                                         94.05832766439909,
                                         95.38478458049883,
                                         82.23621882086168,
                                         83.38138321995463,
                                         70.05152494331065,
                                         71.01539682539682,
                                         84.1679761904762,
                                         85.13184807256236,
                                         100.9900850340136,
                                         102.13524943310658,
                                         118.17477891156463,
                                         119.5012358276644,
                                         135.72205782312926,
                                         137.2298072562358,
                                         129.7163038548753,
                                         131.1182993197279,
                                         133.2696371882086,
                                         134.67163265306118,
                                         147.10118480725623,
                                         148.6089342403628,
                                         130.6416609977324,
                                         131.96811791383217,
                                         113.81955215419498,
                                         114.96471655328799,
                                         96.63485827664397,
                                         97.59873015873016,
                                         80.59321428571428,
                                         81.40518140589569,
                                         96.58675170068028,
                                         97.55143990929706,
                                         112.88573129251701,
                                         114.00314058956916,
                                         129.4901530612245,
                                         130.760283446712,
                                         123.36773242630383,
                                         124.54877551020407,
                                         126.36106575963717,
                                         127.5421088435374,
                                         139.07594671201812,
                                         140.34607709750566,
                                         123.38785147392288,
                                         124.50526077097506,
                                         107.3943140589569,
                                         108.3590022675737,
                                         91.09533446712017,
                                         91.90730158730159,
                                         75.0825,
                                         75.76787981859411,
                                         89.90937074829932,
                                         90.72366213151929,
                                         104.99406462585034,
                                         105.93726757369616,
                                         120.33658163265305,
                                         121.40869614512471,
                                         114.39471655328798,
                                         115.39163265306122,
                                         116.92138321995462,
                                         117.9182993197279,
                                         128.42793083900224,
                                         129.50004535147394,
                                         113.85888321995462,
                                         114.80208616780045,
                                         99.0320124716553,
                                         99.8463038548753,
                                         83.9473185941043,
                                         84.63269841269842,
                                         68.188962585034,
                                         68.76583900226758,
                                         81.60767006802722,
                                         82.29304988662132,
                                         95.2433843537415,
                                         96.03726757369616,
                                         109.09610544217686,
                                         109.99849206349208,
                                         103.54709750566892,
                                         104.38619047619049,
                                         105.67376417233557,
                                         106.51285714285716,
                                         115.90650226757367,
                                         116.8088888888889,
                                         102.70480158730156,
                                         103.49868480725625,
                                         89.28609410430836,
                                         89.9714739229025,
                                         75.6503798185941,
                                         76.22725623582767,
                                         108.95007369614511,
                                         109.52695011337869,
                                         130.03544784580498,
                                         130.7208276643991,
                                         151.33782879818594,
                                         152.1317120181406,
                                         172.857216553288,
                                         173.75960317460317,
                                         162.83598639455784,
                                         163.67507936507937,
                                         164.9626530612245,
                                         165.80174603174606,
                                         179.6676133786848,
                                         180.57000000000005,
                                         158.79924603174604,
                                         159.59312925170073,
                                         137.71387188208615,
                                         138.3992517006803,
                                         116.41149092970522,
                                         116.98836734693877,
                                         135.37422335600905,
                                         136.05960317460315,
                                         161.54123015873017,
                                         162.3555215419501,
                                         187.96606009070297,
                                         188.90926303854874,
                                         214.64871315192747,
                                         215.72082766439905,
                                         202.09176870748303,
                                         203.08868480725621,
                                         204.6184353741497,
                                         205.6153514739229,
                                         222.74006235827665,
                                         223.81217687074832,
                                         196.8308786848073,
                                         197.7740816326531,
                                         170.66387188208617,
                                         171.47816326530614,
                                         144.2390419501134,
                                         144.92442176870748,
                                         168.73414399092968,
                                         169.5461111111111,
                                         201.3059126984127,
                                         202.27060090702946,
                                         234.18312358276646,
                                         235.30053287981858,
                                         267.36577664399096,
                                         268.6359070294784,
                                         251.5727210884354,
                                         252.75376417233556,
                                         254.56605442176874,
                                         255.74709750566893,
                                         276.95157029478463,
                                         278.22170068027214,
                                         244.68524376417236,
                                         245.8026530612245,
                                         212.11347505668934,
                                         213.07816326530613,
                                         179.2362641723356,
                                         180.048231292517,
                                         211.80414399092967,
                                         212.76801587301583,
                                         252.63305555555556,
                                         253.77821995464848,
                                         293.82455215419503,
                                         295.15100907029483,
                                         335.37863378684807,
                                         336.88638321995467,
                                         315.3689115646258,
                                         316.77090702947845,
                                         318.92224489795916,
                                         320.3242403628118,
                                         346.75776077097504,
                                         348.2655102040817,
                                         306.2914342403628,
                                         307.6178911564626,
                                         265.462522675737,
                                         266.60768707483,
                                         224.2710260770975,
                                         225.23489795918366,
                                         238.38747732426305,
                                         239.3513492063492,
                                         284.21638888888884,
                                         285.3615532879818,
                                         330.4078854875283,
                                         331.7343424036281,
                                         376.9619671201814,
                                         378.4697165532879,
                                         354.0355782312925,
                                         355.4375736961451,
                                         357.58891156462585,
                                         358.9909070294784,
                                         388.3410941043084,
                                         389.84884353741495,
                                         342.87476757369615,
                                         344.20122448979595,
                                         297.0458560090703,
                                         298.19102040816324,
                                         250.85435941043082,
                                         251.81823129251697,
                                         210.50795351473923,
                                         211.3199206349206,
                                         250.9368650793651,
                                         251.90155328798184,
                                         291.67121882086167,
                                         292.78862811791385,
                                         332.711014739229,
                                         333.98114512471653,
                                         312.3346258503401,
                                         313.5156689342404,
                                         315.3279591836735,
                                         316.5090022675737,
                                         342.29680839002265,
                                         343.56693877551015,
                                         302.17333900226754,
                                         303.2907482993197,
                                         261.74442743764166,
                                         262.7091156462585,
                                         221.0100736961451,
                                         221.8220408163265,
                                         184.7432709750567,
                                         185.42865079365077,
                                         220.19599206349207,
                                         221.010283446712,
                                         255.90653628117914,
                                         256.8497392290249,
                                         291.8749036281179,
                                         292.94701814058953,
                                         273.9012925170068,
                                         274.89820861678004,
                                         276.42795918367347,
                                         277.42487528344674,
                                         299.9662528344671,
                                         301.0383673469388,
                                         264.7713548752834,
                                         265.71455782312927,
                                         229.31863378684804,
                                         230.13292517006803,
                                         193.60808956916097,
                                         194.29346938775512,
                                         160.48918934240365,
                                         161.06606575963718,
                                         191.2684410430839,
                                         191.953820861678,
                                         222.26469954648528,
                                         223.05858276643994,
                                         253.4779648526077,
                                         254.38035147392293,
                                         237.80197278911564,
                                         238.6410657596372,
                                         239.9286394557823,
                                         240.76773242630384,
                                         260.28836167800455,
                                         261.1907482993197,
                                         229.72611678004532,
                                         230.52,
                                         198.94686507936504,
                                         199.63224489795917,
                                         167.9506065759637,
                                         168.52748299319725,
                                         201.2503004535147,
                                         201.82717687074827,
                                         239.69621882086165,
                                         240.38159863945575,
                                         278.35914399092974,
                                         279.1530272108843,
                                         317.23907596371885,
                                         318.14146258503405,
                                         297.09086167800456,
                                         297.9299546485261,
                                         299.2175283446712,
                                         300.0566213151927,
                                         324.0494727891157,
                                         324.95185941043087,
                                         285.8205612244898,
                                         286.6144444444444,
                                         247.37464285714282,
                                         248.06002267573692,
                                         208.71171768707478,
                                         209.28859410430834,
                                         245.03499433106572,
                                         245.72037414965985,
                                         291.82785147392286,
                                         292.6421428571428,
                                         338.8785317460318,
                                         339.8217346938775,
                                         386.18703514739235,
                                         387.25914965986397,
                                         361.59834467120186,
                                         362.59526077097513,
                                         364.1250113378685,
                                         365.12192743764166,
                                         394.2783843537416,
                                         395.3504988662132,
                                         347.74335034013603,
                                         348.68655328798184,
                                         300.95049319727883,
                                         301.7647845804988,
                                         253.89981292517,
                                         254.58519274376414,
                                         298.64888321995466,
                                         299.460850340136,
                                         355.6560260770975,
                                         356.6207142857142,
                                         412.9686111111112,
                                         414.08602040816317,
                                         470.58663832199557,
                                         471.85676870748296,
                                         440.5396145124717,
                                         441.7206575963719,
                                         443.532947845805,
                                         444.7139909297051,
                                         480.17243197278924,
                                         481.44256235827663,
                                         423.470731292517,
                                         424.5881405895691,
                                         366.46358843537405,
                                         367.42827664399084,
                                         309.15100340136047,
                                         309.9629705215419,
                                         366.0236451247165,
                                         366.9875170068027,
                                         435.8593594104308,
                                         437.00452380952373,
                                         506.05765873015883,
                                         507.3841156462584,
                                         576.6185430839004,
                                         578.1262925170067,
                                         539.688185941043,
                                         541.0901814058957,
                                         543.2415192743763,
                                         544.643514739229,
                                         587.9976700680273,
                                         589.5054195011338,
                                         518.5245408163265,
                                         519.8509977324262,
                                         448.6888265306122,
                                         449.8339909297051,
                                         378.4905272108843,
                                         379.45439909297045,
                                         392.60697845804975,
                                         393.57085034013613,
                                         467.44269274376416,
                                         468.58785714285716,
                                         542.640992063492,
                                         543.9674489795918,
                                         618.2018764172335,
                                         619.7096258503401,
                                         578.3548526077095,
                                         579.7568480725624,
                                         581.9081859410429,
                                         583.3101814058957,
                                         629.5810034013604,
                                         631.0887528344672,
                                         555.1078741496598,
                                         556.4343310657596,
                                         480.27215986394566,
                                         481.41732426303844,
                                         405.07386054421767,
                                         406.0377324263038,
                                         340.4226927437642,
                                         341.23465986394564,
                                         405.2869784580498,
                                         406.2516666666667,
                                         470.4567063492063,
                                         471.57411564625846,
                                         535.9318764172334,
                                         537.2020068027211,
                                         501.3015192743763,
                                         502.48256235827654,
                                         504.2948526077097,
                                         505.47589569161,
                                         545.5176700680272,
                                         546.7878004535147,
                                         480.95882653061227,
                                         482.07623582766433,
                                         416.0945408163265,
                                         417.05922902494325,
                                         350.9248129251701,
                                         351.7367800453514,
                                         294.40404195011337,
                                         295.08942176870755,
                                         350.4826133786848,
                                         351.2969047619048,
                                         406.8190079365079,
                                         407.7622108843537,
                                         463.41322562358266,
                                         464.48534013605445,
                                         433.40786848072565,
                                         434.40478458049887,
                                         435.93453514739235,
                                         436.9314512471655,
                                         471.504574829932,
                                         472.57668934240365,
                                         415.6838265306123,
                                         416.627029478458,
                                         359.60525510204087,
                                         360.4195464852607,
                                         303.26886054421766,
                                         303.95424036281173,
                                         252.78941609977323,
                                         253.36629251700677,
                                         300.9292120181406,
                                         301.6145918367347,
                                         349.286014739229,
                                         350.07989795918365,
                                         397.85982426303855,
                                         398.76221088435375,
                                         372.0568480725624,
                                         372.8959410430839,
                                         374.18351473922905,
                                         375.0226077097505,
                                         404.6702210884354,
                                         405.5726077097505,
                                         356.7474319727892,
                                         357.5413151927437,
                                         308.60763605442173,
                                         309.2930158730158,
                                         260.2508333333333,
                                         260.8277097505669};
  const std::array<int, 4> in_shape = {{3, 8, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.30612244897959184,
      0.36734693877551017, 0.24489795918367346, 0.2857142857142857,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.48979591836734687, 0.5714285714285714,
      0.8571428571428571,  0.9795918367346937,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.1020408163265305,  1.2244897959183674,
      0.8163265306122447,  0.8979591836734693,  0.44897959183673464,
      0.4897959183673469,  0.2040816326530612,  0.24489795918367344,
      0.48979591836734687, 0.5714285714285714,  0.8571428571428571,
      0.9795918367346937,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.1020408163265305,  1.2244897959183674,  0.8163265306122447,
      0.8979591836734693,  0.44897959183673464, 0.4897959183673469,
      0.2040816326530612,  0.24489795918367344, 0.48979591836734687,
      0.5714285714285714,  0.8571428571428571,  0.9795918367346937,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.1020408163265305,
      1.2244897959183674,  0.8163265306122447,  0.8979591836734693,
      0.44897959183673464, 0.4897959183673469,  0.2040816326530612,
      0.24489795918367344, 0.48979591836734687, 0.5714285714285714,
      0.8571428571428571,  0.9795918367346937,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.1020408163265305,  1.2244897959183674,
      0.8163265306122447,  0.8979591836734693,  0.44897959183673464,
      0.4897959183673469,  0.2040816326530612,  0.24489795918367344,
      0.48979591836734687, 0.5714285714285714,  0.8571428571428571,
      0.9795918367346937,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.1020408163265305,  1.2244897959183674,  0.8163265306122447,
      0.8979591836734693,  0.44897959183673464, 0.4897959183673469,
      0.2040816326530612,  0.24489795918367344, 0.48979591836734687,
      0.5714285714285714,  0.8571428571428571,  0.9795918367346937,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.1020408163265305,
      1.2244897959183674,  0.8163265306122447,  0.8979591836734693,
      0.44897959183673464, 0.4897959183673469,  0.18367346938775508,
      0.2040816326530612,  0.4081632653061224,  0.44897959183673464,
      0.6734693877551019,  0.7346938775510203,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.7959183673469387,  0.857142857142857,
      0.5714285714285714,  0.6122448979591837,  0.3061224489795918,
      0.32653061224489793, 0.3469387755102041,  0.36734693877551017,
      0.7346938775510203,  0.7755102040816326,  1.163265306122449,
      1.2244897959183674,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.2857142857142856,  1.3469387755102038,  0.8979591836734693,
      0.9387755102040816,  0.4693877551020408,  0.4897959183673469,
      0.8571428571428572,  0.8979591836734693,  1.7959183673469385,
      1.8775510204081631,  2.816326530612245,   2.9387755102040813,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.061224489795918,
      3.1836734693877546,  2.1224489795918364,  2.204081632653061,
      1.1020408163265305,  1.1428571428571428,  0.8571428571428572,
      0.8979591836734693,  1.7959183673469385,  1.8775510204081631,
      2.816326530612245,   2.9387755102040813,  3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.061224489795918,   3.1836734693877546,
      2.1224489795918364,  2.204081632653061,   1.1020408163265305,
      1.1428571428571428,  0.8571428571428572,  0.8979591836734693,
      1.7959183673469385,  1.8775510204081631,  2.816326530612245,
      2.9387755102040813,  3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.061224489795918,   3.1836734693877546,  2.1224489795918364,
      2.204081632653061,   1.1020408163265305,  1.1428571428571428,
      0.8571428571428572,  0.8979591836734693,  1.7959183673469385,
      1.8775510204081631,  2.816326530612245,   2.9387755102040813,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.061224489795918,
      3.1836734693877546,  2.1224489795918364,  2.204081632653061,
      1.1020408163265305,  1.1428571428571428,  0.8571428571428572,
      0.8979591836734693,  1.7959183673469385,  1.8775510204081631,
      2.816326530612245,   2.9387755102040813,  3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.061224489795918,   3.1836734693877546,
      2.1224489795918364,  2.204081632653061,   1.1020408163265305,
      1.1428571428571428,  0.8571428571428572,  0.8979591836734693,
      1.7959183673469385,  1.8775510204081631,  2.816326530612245,
      2.9387755102040813,  3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.061224489795918,   3.1836734693877546,  2.1224489795918364,
      2.204081632653061,   1.1020408163265305,  1.1428571428571428,
      0.5102040816326531,  0.5306122448979591,  1.0612244897959182,
      1.1020408163265305,  1.6530612244897958,  1.714285714285714,
      2.2857142857142856,  2.3673469387755097,  2.2857142857142856,
      2.3673469387755097,  2.2857142857142856,  2.3673469387755097,
      2.2857142857142856,  2.3673469387755097,  1.7755102040816326,
      1.8367346938775508,  1.2244897959183674,  1.2653061224489794,
      0.6326530612244897,  0.6530612244897959,  0.673469387755102,
      0.6938775510204082,  1.387755102040816,   1.4285714285714284,
      2.1428571428571423,  2.204081632653061,   2.938775510204081,
      3.020408163265306,   2.938775510204081,   3.020408163265306,
      2.938775510204081,   3.020408163265306,   2.938775510204081,
      3.020408163265306,   2.265306122448979,   2.326530612244898,
      1.5510204081632653,  1.5918367346938775,  0.7959183673469387,
      0.8163265306122448,  1.510204081632653,   1.5510204081632653,
      3.10204081632653,    3.183673469387755,   4.775510204081632,
      4.897959183673469,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      5.020408163265305,   5.142857142857142,   3.4285714285714284,
      3.5102040816326534,  1.7551020408163263,  1.7959183673469385,
      1.510204081632653,   1.5510204081632653,  3.10204081632653,
      3.183673469387755,   4.775510204081632,   4.897959183673469,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   5.020408163265305,
      5.142857142857142,   3.4285714285714284,  3.5102040816326534,
      1.7551020408163263,  1.7959183673469385,  1.510204081632653,
      1.5510204081632653,  3.10204081632653,    3.183673469387755,
      4.775510204081632,   4.897959183673469,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   5.020408163265305,   5.142857142857142,
      3.4285714285714284,  3.5102040816326534,  1.7551020408163263,
      1.7959183673469385,  1.510204081632653,   1.5510204081632653,
      3.10204081632653,    3.183673469387755,   4.775510204081632,
      4.897959183673469,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      5.020408163265305,   5.142857142857142,   3.4285714285714284,
      3.5102040816326534,  1.7551020408163263,  1.7959183673469385,
      1.510204081632653,   1.5510204081632653,  3.10204081632653,
      3.183673469387755,   4.775510204081632,   4.897959183673469,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   5.020408163265305,
      5.142857142857142,   3.4285714285714284,  3.5102040816326534,
      1.7551020408163263,  1.7959183673469385,  1.510204081632653,
      1.5510204081632653,  3.10204081632653,    3.183673469387755,
      4.775510204081632,   4.897959183673469,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   5.020408163265305,   5.142857142857142,
      3.4285714285714284,  3.5102040816326534,  1.7551020408163263,
      1.7959183673469385,  0.836734693877551,   0.8571428571428571,
      1.7142857142857142,  1.7551020408163263,  2.63265306122449,
      2.6938775510204076,  3.5918367346938775,  3.6734693877551017,
      3.5918367346938775,  3.6734693877551017,  3.5918367346938775,
      3.6734693877551017,  3.5918367346938775,  3.6734693877551017,
      2.7551020408163263,  2.816326530612245,   1.8775510204081631,
      1.9183673469387754,  0.9591836734693877,  0.9795918367346939};
  const std::array<int, 4> in_shape = {{3, 8, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {32.72281746031746,  33.29969387755102,
                                         33.876570294784585, 34.45344671201814,
                                         40.06397392290249,  40.74935374149659,
                                         41.434733560090706, 42.1201133786848,
                                         47.8391439909297,   48.63302721088436,
                                         49.426910430838994, 50.22079365079365,
                                         56.04832766439909,  56.950714285714284,
                                         57.853100907029464, 58.75548752834467,
                                         56.32312925170068,  57.16222222222221,
                                         58.00131519274377,  58.84040816326531,
                                         60.576462585034015, 61.41555555555555,
                                         62.254648526077105, 63.09374149659863,
                                         69.66912131519274,  70.57150793650793,
                                         71.47389455782313,  72.3762811791383,
                                         62.76197845804988,  63.55586167800452,
                                         64.34974489795918,  65.14362811791382,
                                         55.42082199546485,  56.10620181405895,
                                         56.79158163265306,  57.47696145124716,
                                         47.64565192743764,  48.222528344671204,
                                         48.79940476190476,  49.37628117913833,
                                         50.74152494331066,  51.426904761904765,
                                         52.112284580498866, 52.797664399092966,
                                         61.69492630385488,  62.50921768707482,
                                         63.32350907029478,  64.13780045351473,
                                         73.16397392290249,  74.10717687074829,
                                         75.0503798185941,   75.9935827664399,
                                         85.1486678004535,   86.22078231292517,
                                         87.2928968253968,   88.36501133786847,
                                         84.17346938775509,  85.17038548752832,
                                         86.1673015873016,   87.16421768707482,
                                         89.22680272108843,  90.22371882086166,
                                         91.22063492063492,  92.21755102040814,
                                         101.33136621315192, 102.40348072562357,
                                         103.47559523809524, 104.54770975056685,
                                         90.89361111111111,  91.83681405895689,
                                         92.78001700680272,  93.7232199546485,
                                         79.94020975056691,  80.75450113378683,
                                         81.56879251700681,  82.38308390022674,
                                         68.47116213151928,  69.15654195011338,
                                         69.84192176870748,  70.5273015873016,
                                         76.82684240362812,  77.63880952380953,
                                         78.45077664399093,  79.26274376417233,
                                         92.94691043083901,  93.91159863945576,
                                         94.87628684807257,  95.84097505668933,
                                         109.67786281179137, 110.79527210884353,
                                         111.91268140589568, 113.03009070294783,
                                         127.01969954648524, 128.28982993197278,
                                         129.55996031746028, 130.8300907029478,
                                         124.03061224489795, 125.21165532879814,
                                         126.39269841269842, 127.57374149659863,
                                         130.01727891156463, 131.19832199546485,
                                         132.37936507936507, 133.56040816326527,
                                         146.19128684807256, 147.46141723356007,
                                         148.73154761904763, 150.0016780045351,
                                         130.68210317460318, 131.7995124716553,
                                         132.91692176870748, 134.0343310657596,
                                         114.56203514739231, 115.52672335600906,
                                         116.49141156462585, 117.4560997732426,
                                         97.83108276643992,  98.64304988662131,
                                         99.4550170068027,   100.26698412698413,
                                         114.20541383219954, 115.1692857142857,
                                         116.1331575963719,  117.09702947845805,
                                         137.6683390022676,  138.81350340136052,
                                         139.95866780045353, 141.10383219954647,
                                         161.85643424036283, 163.1828911564626,
                                         164.50934807256235, 165.83580498866212,
                                         186.7696995464853,  188.27744897959184,
                                         189.78519841269838, 191.29294784580492,
                                         180.69727891156467, 182.0992743764172,
                                         183.50126984126985, 184.90326530612242,
                                         187.80394557823132, 189.20594104308393,
                                         190.6079365079365,  192.00993197278905,
                                         209.52795351473924, 211.0357029478458,
                                         212.54345238095237, 214.05120181405889,
                                         186.79019841269843, 188.11665532879817,
                                         189.44311224489795, 190.76956916099766,
                                         163.32727324263038, 164.47243764172336,
                                         165.6176020408163,  166.76276643990926,
                                         139.13917800453515, 140.1030498866213,
                                         141.06692176870746, 142.03079365079364,
                                         167.3720804988662,  168.3359523809524,
                                         169.29982426303857, 170.26369614512473,
                                         200.83500566893426, 201.9801700680272,
                                         203.12533446712015, 204.27049886621316,
                                         235.0231009070295,  236.34955782312926,
                                         237.676014739229,   239.0024716553288,
                                         269.936366213152,   271.4441156462585,
                                         272.951865079365,   274.4596145124716,
                                         258.030612244898,   259.4326077097506,
                                         260.83460317460316, 262.2365986394558,
                                         265.13727891156464, 266.5392743764172,
                                         267.94126984126984, 269.34326530612236,
                                         292.69462018140587, 294.20236961451246,
                                         295.71011904761906, 297.2178684807256,
                                         259.9568650793651,  261.2833219954648,
                                         262.6097789115646,  263.93623582766435,
                                         226.49393990929704, 227.63910430838996,
                                         228.78426870748302, 229.92943310657597,
                                         192.3058446712018,  193.26971655328794,
                                         194.23358843537414, 195.19746031746033,
                                         160.37446145124716, 161.18642857142856,
                                         161.99839569160997, 162.81036281179138,
                                         192.20881519274377, 193.17350340136056,
                                         194.1381916099773,  195.10287981859412,
                                         224.65405328798187, 225.77146258503402,
                                         226.88887188208614, 228.0062811791383,
                                         257.7101757369615,  258.980306122449,
                                         260.2504365079365,  261.520566893424,
                                         245.55442176870753, 246.73546485260766,
                                         247.9165079365079,  249.09755102040813,
                                         251.54108843537418, 252.72213151927434,
                                         253.9031746031746,  255.0842176870748,
                                         276.8817630385488,  278.15189342403625,
                                         279.4220238095238,  280.6921541950113,
                                         245.65829365079364, 246.77570294784576,
                                         247.89311224489796, 249.0105215419501,
                                         213.82393990929705, 214.7886281179138,
                                         215.7533163265306,  216.7180045351474,
                                         181.37870181405896, 182.19066893424034,
                                         183.00263605442177, 183.81460317460318,
                                         149.4796201814059,  150.165,
                                         150.8503798185941,  151.53575963718822,
                                         179.0044501133787,  179.81874149659865,
                                         180.6330328798186,  181.44732426303858,
                                         209.04492630385488, 209.98812925170068,
                                         210.93133219954646, 211.87453514739232,
                                         239.6010487528345,  240.6731632653061,
                                         241.74527777777774, 242.81739229024942,
                                         227.79251700680274, 228.78943310657596,
                                         229.7863492063492,  230.78326530612244,
                                         232.84585034013605, 233.84276643990924,
                                         234.83968253968254, 235.8365986394558,
                                         255.78374716553287, 256.8558616780045,
                                         257.9279761904762,  259.0000907029479,
                                         226.77456349206346, 227.71776643990924,
                                         228.6609693877551,  229.6041723356009,
                                         197.2497335600907,  198.0640249433106,
                                         198.87831632653064, 199.6926077097506,
                                         167.2092573696145,  167.8946371882086,
                                         168.5800170068027,  169.26539682539683,
                                         135.80104875283448, 136.377925170068,
                                         136.9548015873016,  137.53167800453517,
                                         162.5299603174603,  163.21534013605444,
                                         163.9007199546485,  164.58609977324264,
                                         189.69288548752832, 190.486768707483,
                                         191.28065192743765, 192.0745351473923,
                                         217.28982426303855, 218.19221088435373,
                                         219.09459750566893, 219.99698412698416,
                                         206.2551020408163,  207.09419501133783,
                                         207.93328798185942, 208.77238095238098,
                                         210.50843537414966, 211.34752834467113,
                                         212.18662131519278, 213.02571428571432,
                                         230.9106179138322,  231.81300453514734,
                                         232.7153911564626,  233.6177777777778,
                                         204.6157199546485,  205.40960317460312,
                                         206.20348639455787, 206.9973696145125,
                                         177.88680839002268, 178.57218820861672,
                                         179.2575680272109,  179.942947845805,
                                         150.72388321995464, 151.3007596371882,
                                         151.87763605442177, 152.45451247165533,
                                         217.3232709750567,  217.90014739229022,
                                         218.4770238095238,  219.05390022675738,
                                         259.38551587301583, 260.07089569160996,
                                         260.7562755102041,  261.4416553287982,
                                         301.88177437641724, 302.6756575963719,
                                         303.4695408163265,  304.2634240362812,
                                         344.8120464852608,  345.714433106576,
                                         346.6168197278911,  347.51920634920634,
                                         324.8328798185941,  325.67197278911567,
                                         326.5110657596372,  327.35015873015874,
                                         329.08621315192744, 329.925306122449,
                                         330.7643990929705,  331.6034920634921,
                                         358.4328401360544,  359.3352267573696,
                                         360.2376133786848,  361.1400000000001,
                                         316.80460884353744, 317.5984920634921,
                                         318.3923752834467,  319.18625850340146,
                                         274.74236394557823, 275.4277437641723,
                                         276.11312358276643, 276.7985034013606,
                                         232.24610544217686, 232.82298185941045,
                                         233.39985827664398, 233.97673469387755,
                                         270.06306689342404, 270.7484467120181,
                                         271.43382653061224, 272.1192063492063,
                                         322.26816893424035, 323.08246031746035,
                                         323.8967517006803,  324.7110430839002,
                                         374.98891723356013, 375.93212018140593,
                                         376.8753231292517,  377.8185260770975,
                                         428.22531179138326, 429.29742630385493,
                                         430.36954081632643, 431.4416553287981,
                                         403.1866213151927,  404.18353741496605,
                                         405.1804535147392,  406.17736961451243,
                                         408.23995464852607, 409.2368707482994,
                                         410.23378684807255, 411.2307029478458,
                                         444.40801020408156, 445.4801247165533,
                                         446.5522392290249,  447.62435374149663,
                                         392.7185544217687,  393.6617573696146,
                                         394.6049603174603,  395.5481632653062,
                                         340.51345238095234, 341.32774376417234,
                                         342.1420351473923,  342.9563265306123,
                                         287.7927040816326,  288.4780839002268,
                                         289.1634637188208,  289.84884353741495,
                                         336.656320861678,   337.46828798185936,
                                         338.2802551020408,  339.0922222222222,
                                         401.6471371882086,  402.6118253968254,
                                         403.5765136054422,  404.5412018140589,
                                         467.2488378684808,  468.3662471655329,
                                         469.48365646258503, 470.60106575963715,
                                         533.4614229024944,  534.7315532879819,
                                         536.0016836734693,  537.2718140589568,
                                         501.96439909297055, 503.1454421768708,
                                         504.32648526077094, 505.50752834467113,
                                         507.9510657596372,  509.1321088435375,
                                         510.3131519274376,  511.49419501133787,
                                         552.6330102040815,  553.9031405895693,
                                         555.1732709750567,  556.4434013605443,
                                         488.25307823129253, 489.3704875283447,
                                         490.48789682539683, 491.605306122449,
                                         423.2622619047619,  424.2269501133787,
                                         425.19163832199547, 426.15632653061226,
                                         357.66056122448975, 358.4725283446712,
                                         359.28449546485257, 360.096462585034,
                                         422.64441609977325, 423.60828798185935,
                                         424.57215986394556, 425.53603174603165,
                                         504.1209467120181,  505.2661111111111,
                                         506.4112755102041,  507.55643990929696,
                                         586.3226473922904,  587.6491043083901,
                                         588.9755612244896,  590.3020181405897,
                                         669.2495181405897,  670.7572675736961,
                                         672.2650170068025,  673.7727664399093,
                                         629.3358276643992,  630.7378231292516,
                                         632.1398185941042,  633.5418140589569,
                                         636.4424943310657,  637.8444897959183,
                                         639.2464852607709,  640.6484807256236,
                                         692.0077721088435,  693.5155215419501,
                                         695.0232709750567,  696.5310204081634,
                                         611.2564115646259,  612.5828684807256,
                                         613.9093253968255,  615.2357823129252,
                                         529.779880952381,   530.925045351474,
                                         532.070209750567,   533.21537414966,
                                         447.57818027210885, 448.542052154195,
                                         449.5059240362811,  450.4697959183673,
                                         475.81108276643994, 476.7749546485261,
                                         477.7388265306122,  478.7026984126984,
                                         567.2876133786848,  568.4327777777777,
                                         569.5779421768707,  570.7231065759636,
                                         659.489314058957,   660.8157709750566,
                                         662.1422278911565,  663.4686848072562,
                                         752.4161848072563,  753.9239342403628,
                                         755.4316836734694,  756.9394331065758,
                                         706.6691609977324,  708.071156462585,
                                         709.4731519274376,  710.8751473922902,
                                         713.7758276643991,  715.1778231292517,
                                         716.5798185941043,  717.9818140589568,
                                         775.1744387755102,  776.6821882086168,
                                         778.1899376417233,  779.6976870748299,
                                         684.4230782312925,  685.7495351473923,
                                         687.0759920634921,  688.4024489795919,
                                         592.9465476190476,  594.0917120181406,
                                         595.2368764172336,  596.3820408163265,
                                         500.7448469387754,  501.70871882086163,
                                         502.67259070294784, 503.63646258503394,
                                         420.20393990929705, 421.01590702947846,
                                         421.8278741496599,  422.6398412698412,
                                         500.90904195011336, 501.8737301587302,
                                         502.8384183673469,  503.8031065759637,
                                         582.2250283446713,  583.3424376417233,
                                         584.4598469387755,  585.5772562358277,
                                         664.1518990929706,  665.422029478458,
                                         666.6921598639456,  667.9622902494331,
                                         623.4882086167801,  624.6692517006802,
                                         625.8502947845803,  627.0313378684808,
                                         629.4748752834467,  630.655918367347,
                                         631.836961451247,   633.0180045351474,
                                         683.3234863945578,  684.5936167800453,
                                         685.8637471655328,  687.1338775510203,
                                         603.2292687074829,  604.3466780045351,
                                         605.4640873015873,  606.5814965986394,
                                         522.5241666666666,  523.4888548752833,
                                         524.4535430839003,  525.418231292517,
                                         441.2081802721088,  442.0201473922902,
                                         442.83211451247166, 443.644081632653,
                                         368.80116213151933, 369.4865419501134,
                                         370.17192176870753, 370.85730158730155,
                                         439.57769274376415, 440.39198412698414,
                                         441.20627551020414, 442.020566893424,
                                         510.8698696145125,  511.8130725623583,
                                         512.7562755102041,  513.6994784580498,
                                         582.6776927437642,  583.7498072562358,
                                         584.8219217687074,  585.8940362811791,
                                         546.8056689342404,  547.8025850340136,
                                         548.7995011337867,  549.7964172335601,
                                         551.8590022675737,  552.8559183673469,
                                         553.8528344671201,  554.8497505668935,
                                         598.8603911564626,  599.9325056689343,
                                         601.0046201814058,  602.0767346938776,
                                         528.5995068027211,  529.5427097505668,
                                         530.4859126984127,  531.4291156462585,
                                         457.82297619047614, 458.6372675736961,
                                         459.45155895691613, 460.26585034013607,
                                         386.53079931972786, 387.21617913832193,
                                         387.9015589569161,  388.58693877551025,
                                         320.4015022675737,  320.9783786848073,
                                         321.5552551020408,  322.13213151927437,
                                         381.85150226757366, 382.5368820861678,
                                         383.22226190476187, 383.907641723356,
                                         443.7355158730159,  444.52939909297055,
                                         445.32328231292513, 446.1171655328799,
                                         506.05354308390025, 506.9559297052154,
                                         507.8583163265306,  508.76070294784586,
                                         474.76485260770977, 475.6039455782313,
                                         476.44303854875284, 477.2821315192744,
                                         479.0181859410431,  479.8572789115646,
                                         480.6963718820861,  481.5354648526077,
                                         519.674336734694,   520.5767233560091,
                                         521.4791099773242,  522.3814965986394,
                                         458.65835034013605, 459.45223356009063,
                                         460.2461167800453,  461.04,
                                         397.208350340136,   397.8937301587301,
                                         398.5791099773243,  399.26448979591834,
                                         335.3243367346938,  335.9012131519274,
                                         336.478089569161,   337.0549659863945,
                                         401.9237244897959,  402.5006009070294,
                                         403.077477324263,   403.65435374149655,
                                         478.7070578231293,  479.3924376417233,
                                         480.0778174603174,  480.7631972789115,
                                         555.9244047619048,  556.7182879818595,
                                         557.512171201814,   558.3060544217686,
                                         633.5757653061227,  634.4781519274377,
                                         635.380538548753,   636.2829251700681,
                                         593.3426303854876,  594.1817233560091,
                                         595.0208163265306,  595.8599092970522,
                                         597.5959637188209,  598.4350566893424,
                                         599.2741496598638,  600.1132426303853,
                                         647.1965589569162,  648.0989455782315,
                                         649.0013321995465,  649.9037188208617,
                                         570.8472392290249,  571.6411224489796,
                                         572.4350056689342,  573.2288888888888,
                                         494.0639058956917,  494.74928571428563,
                                         495.43466553287976, 496.12004535147383,
                                         416.8465589569161,  417.42343537414956,
                                         418.0003117913831,  418.5771882086167,
                                         489.38460884353736, 490.06998866213144,
                                         490.75536848072556, 491.4407482993197,
                                         582.8414115646258,  583.6557029478457,
                                         584.4699943310657,  585.2842857142856,
                                         676.8138605442177,  677.7570634920636,
                                         678.7002664399092,  679.643469387755,
                                         771.3019557823131,  772.3740702947847,
                                         773.4461848072564,  774.5182993197279,
                                         722.1997732426305,  723.1966893424037,
                                         724.1936054421769,  725.1905215419503,
                                         727.2531065759638,  728.250022675737,
                                         729.2469387755102,  730.2438548752833,
                                         787.4846541950112,  788.5567687074832,
                                         789.6288832199547,  790.7009977324263,
                                         694.5434977324262,  695.4867006802721,
                                         696.4299036281179,  697.3731065759637,
                                         601.0866950113378,  601.9009863945577,
                                         602.7152777777778,  603.5295691609977,
                                         507.11424603174606, 507.79962585034,
                                         508.4850056689341,  509.1703854875283,
                                         596.4857993197279,  597.2977664399093,
                                         598.1097335600907,  598.921700680272,
                                         710.3473639455782,  711.312052154195,
                                         712.2767403628118,  713.2414285714284,
                                         824.8198129251701,  825.9372222222224,
                                         827.0546315192744,  828.1720408163263,
                                         939.9031462585036,  941.1732766439911,
                                         942.4434070294786,  943.7135374149659,
                                         879.8981859410433,  881.0792290249434,
                                         882.2602721088437,  883.4413151927438,
                                         885.88485260771,    887.06589569161,
                                         888.2469387755102,  889.4279818594102,
                                         959.0747335600906,  960.3448639455785,
                                         961.6149943310658,  962.8851247165533,
                                         845.8240532879818,  846.941462585034,
                                         848.0588718820861,  849.1762811791382,
                                         731.9624886621315,  732.9271768707481,
                                         733.8918650793651,  734.8565532879817,
                                         617.4900396825398,  618.3020068027209,
                                         619.1139739229023,  619.9259410430838,
                                         731.0834183673469,  732.047290249433,
                                         733.0111621315193,  733.9750340136054,
                                         870.5735544217686,  871.7187188208616,
                                         872.8638832199547,  874.0090476190475,
                                         1010.7888605442176, 1012.1153174603177,
                                         1013.4417743764172, 1014.7682312925168,
                                         1151.7293367346942, 1153.2370861678007,
                                         1154.7448356009074, 1156.2525850340135,
                                         1077.9743764172335, 1079.376371882086,
                                         1080.778367346939,  1082.1803628117914,
                                         1085.0810430839003, 1086.4830385487526,
                                         1087.8850340136053, 1089.287029478458,
                                         1174.4875907029477, 1175.9953401360547,
                                         1177.503089569161,  1179.0108390022676,
                                         1035.7226247165531, 1037.049081632653,
                                         1038.3755385487527, 1039.7019954648524,
                                         896.2324886621315,  897.3776530612244,
                                         898.5228174603175,  899.6679818594102,
                                         756.0171825396826,  756.9810544217686,
                                         757.9449263038548,  758.9087981859409,
                                         784.2500850340135,  785.2139569160995,
                                         786.1778287981859,  787.1417006802723,
                                         933.7402210884352,  934.8853854875283,
                                         936.0305498866214,  937.1757142857143,
                                         1083.9555272108844, 1085.281984126984,
                                         1086.6084410430838, 1087.9348979591837,
                                         1234.8960034013605, 1236.403752834467,
                                         1237.9115022675737, 1239.4192517006802,
                                         1155.3077097505668, 1156.709705215419,
                                         1158.1117006802722, 1159.5136961451249,
                                         1162.4143764172336, 1163.8163718820858,
                                         1165.218367346939,  1166.6203628117914,
                                         1257.6542573696147, 1259.1620068027207,
                                         1260.6697562358277, 1262.1775056689344,
                                         1108.8892913832199, 1110.2157482993196,
                                         1111.5422052154195, 1112.8686621315192,
                                         959.3991553287981,  960.5443197278913,
                                         961.6894841269841,  962.8346485260769,
                                         809.1838492063491,  810.1477210884353,
                                         811.1115929705217,  812.0754648526076,
                                         680.0334183673469,  680.8453854875283,
                                         681.6573526077098,  682.4693197278913,
                                         809.609268707483,   810.5739569160996,
                                         811.5386451247166,  812.5033333333334,
                                         939.7960034013604,  940.9134126984126,
                                         942.030821995465,   943.1482312925169,
                                         1070.5936224489794, 1071.8637528344668,
                                         1073.1338832199547, 1074.4040136054423,
                                         1001.4219954648524, 1002.6030385487526,
                                         1003.7840816326532, 1004.9651247165531,
                                         1007.4086621315191, 1008.5897052154194,
                                         1009.7707482993197, 1010.95179138322,
                                         1089.7652097505668, 1091.0353401360544,
                                         1092.305470521542,  1093.5756009070294,
                                         960.8002437641723,  961.9176530612245,
                                         963.0350623582767,  964.1524716553287,
                                         831.2243934240363,  832.189081632653,
                                         833.1537698412699,  834.1184580498865,
                                         701.0376587301587,  701.8496258503402,
                                         702.6615929705216,  703.4735600907028,
                                         588.1227040816327,  588.8080839002267,
                                         589.4934637188207,  590.1788435374151,
                                         700.1509353741496,  700.9652267573696,
                                         701.7795181405895,  702.5938095238096,
                                         812.69481292517,    813.6380158730158,
                                         814.5812188208617,  815.5244217687074,
                                         925.7543367346939,  926.8264512471653,
                                         927.8985657596372,  928.9706802721089,
                                         865.8188208616779,  866.8157369614513,
                                         867.8126530612245,  868.8095691609977,
                                         870.8721541950114,  871.8690702947847,
                                         872.8659863945578,  873.862902494331,
                                         941.9370351473923,  943.009149659864,
                                         944.0812641723356,  945.1533786848073,
                                         830.4244501133787,  831.3676530612246,
                                         832.3108560090704,  833.254058956916,
                                         718.3962188208617,  719.2105102040817,
                                         720.0248015873016,  720.8390929705214,
                                         605.8523412698413,  606.5377210884353,
                                         607.2231009070294,  607.9084807256235,
                                         505.0019557823129,  505.57883219954647,
                                         506.1557086167801,  506.73258503401354,
                                         601.173044217687,   601.8584240362812,
                                         602.5438038548753,  603.2291836734694,
                                         697.7781462585034,  698.572029478458,
                                         699.3659126984128,  700.1597959183673,
                                         794.8172619047618,  795.7196485260771,
                                         796.6220351473924,  797.5244217687075,
                                         743.274603174603,   744.1136961451248,
                                         744.9527891156463,  745.7918820861678,
                                         747.5279365079364,  748.3670294784581,
                                         749.2061224489796,  750.045215419501,
                                         808.4380555555555,  809.3404421768709,
                                         810.242828798186,   811.145215419501,
                                         712.7009807256235,  713.4948639455783,
                                         714.2887471655329,  715.0826303854874,
                                         616.5298922902494,  617.2152721088435,
                                         617.9006519274376,  618.5860317460316,
                                         519.9247902494332,  520.5016666666666,
                                         521.0785430839002,  521.6554195011338};
  const std::array<int, 4> in_shape = {{3, 8, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.04081632653061224,
                                         0.061224489795918366,
                                         0.08163265306122448,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.3061224489795918,
                                         0.36734693877551017,
                                         0.42857142857142855,
                                         0.4897959183673469,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5510204081632653,
                                         0.6122448979591837,
                                         0.6734693877551019,
                                         0.7346938775510203,
                                         0.44897959183673464,
                                         0.4897959183673469,
                                         0.5306122448979591,
                                         0.5714285714285714,
                                         0.26530612244897955,
                                         0.2857142857142857,
                                         0.3061224489795918,
                                         0.32653061224489793,
                                         0.3673469387755102,
                                         0.4081632653061224,
                                         0.4489795918367347,
                                         0.48979591836734687,
                                         0.8979591836734693,
                                         0.9795918367346937,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.5918367346938775,
                                         1.7142857142857142,
                                         1.8367346938775508,
                                         1.9591836734693875,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.0816326530612246,
                                         2.204081632653061,
                                         2.326530612244898,
                                         2.4489795918367347,
                                         1.5510204081632653,
                                         1.6326530612244894,
                                         1.714285714285714,
                                         1.7959183673469385,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         0.3673469387755102,
                                         0.4081632653061224,
                                         0.4489795918367347,
                                         0.48979591836734687,
                                         0.8979591836734693,
                                         0.9795918367346937,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.5918367346938775,
                                         1.7142857142857142,
                                         1.8367346938775508,
                                         1.9591836734693875,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.0816326530612246,
                                         2.204081632653061,
                                         2.326530612244898,
                                         2.4489795918367347,
                                         1.5510204081632653,
                                         1.6326530612244894,
                                         1.714285714285714,
                                         1.7959183673469385,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         0.3673469387755102,
                                         0.4081632653061224,
                                         0.4489795918367347,
                                         0.48979591836734687,
                                         0.8979591836734693,
                                         0.9795918367346937,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.5918367346938775,
                                         1.7142857142857142,
                                         1.8367346938775508,
                                         1.9591836734693875,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.0816326530612246,
                                         2.204081632653061,
                                         2.326530612244898,
                                         2.4489795918367347,
                                         1.5510204081632653,
                                         1.6326530612244894,
                                         1.714285714285714,
                                         1.7959183673469385,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         0.3673469387755102,
                                         0.4081632653061224,
                                         0.4489795918367347,
                                         0.48979591836734687,
                                         0.8979591836734693,
                                         0.9795918367346937,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.5918367346938775,
                                         1.7142857142857142,
                                         1.8367346938775508,
                                         1.9591836734693875,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.0816326530612246,
                                         2.204081632653061,
                                         2.326530612244898,
                                         2.4489795918367347,
                                         1.5510204081632653,
                                         1.6326530612244894,
                                         1.714285714285714,
                                         1.7959183673469385,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         0.3673469387755102,
                                         0.4081632653061224,
                                         0.4489795918367347,
                                         0.48979591836734687,
                                         0.8979591836734693,
                                         0.9795918367346937,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.5918367346938775,
                                         1.7142857142857142,
                                         1.8367346938775508,
                                         1.9591836734693875,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.0816326530612246,
                                         2.204081632653061,
                                         2.326530612244898,
                                         2.4489795918367347,
                                         1.5510204081632653,
                                         1.6326530612244894,
                                         1.714285714285714,
                                         1.7959183673469385,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         0.3673469387755102,
                                         0.4081632653061224,
                                         0.4489795918367347,
                                         0.48979591836734687,
                                         0.8979591836734693,
                                         0.9795918367346937,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.5918367346938775,
                                         1.7142857142857142,
                                         1.8367346938775508,
                                         1.9591836734693875,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.0816326530612246,
                                         2.204081632653061,
                                         2.326530612244898,
                                         2.4489795918367347,
                                         1.5510204081632653,
                                         1.6326530612244894,
                                         1.714285714285714,
                                         1.7959183673469385,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         0.3469387755102041,
                                         0.36734693877551017,
                                         0.3877551020408163,
                                         0.4081632653061224,
                                         0.7755102040816326,
                                         0.8163265306122448,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         1.2857142857142856,
                                         1.3469387755102038,
                                         1.4081632653061225,
                                         1.4693877551020407,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.530612244897959,
                                         1.5918367346938773,
                                         1.6530612244897958,
                                         1.714285714285714,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         0.5918367346938775,
                                         0.6122448979591836,
                                         0.6326530612244897,
                                         0.6530612244897959,
                                         0.673469387755102,
                                         0.6938775510204082,
                                         0.7142857142857142,
                                         0.7346938775510203,
                                         1.4285714285714284,
                                         1.4693877551020407,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         2.265306122448979,
                                         2.326530612244898,
                                         2.387755102040816,
                                         2.4489795918367347,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         2.510204081632653,
                                         2.571428571428571,
                                         2.63265306122449,
                                         2.6938775510204076,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         1.8367346938775508,
                                         1.8775510204081631,
                                         0.9183673469387754,
                                         0.9387755102040816,
                                         0.9591836734693877,
                                         0.9795918367346939,
                                         1.673469387755102,
                                         1.7142857142857144,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         3.5102040816326525,
                                         3.591836734693877,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.755102040816325,
                                         5.877551020408163,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         6.,
                                         6.122448979591836,
                                         6.244897959183673,
                                         6.367346938775509,
                                         4.163265306122449,
                                         4.244897959183673,
                                         4.326530612244897,
                                         4.408163265306122,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         1.673469387755102,
                                         1.7142857142857144,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         3.5102040816326525,
                                         3.591836734693877,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.755102040816325,
                                         5.877551020408163,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         6.,
                                         6.122448979591836,
                                         6.244897959183673,
                                         6.367346938775509,
                                         4.163265306122449,
                                         4.244897959183673,
                                         4.326530612244897,
                                         4.408163265306122,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         1.673469387755102,
                                         1.7142857142857144,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         3.5102040816326525,
                                         3.591836734693877,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.755102040816325,
                                         5.877551020408163,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         6.,
                                         6.122448979591836,
                                         6.244897959183673,
                                         6.367346938775509,
                                         4.163265306122449,
                                         4.244897959183673,
                                         4.326530612244897,
                                         4.408163265306122,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         1.673469387755102,
                                         1.7142857142857144,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         3.5102040816326525,
                                         3.591836734693877,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.755102040816325,
                                         5.877551020408163,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         6.,
                                         6.122448979591836,
                                         6.244897959183673,
                                         6.367346938775509,
                                         4.163265306122449,
                                         4.244897959183673,
                                         4.326530612244897,
                                         4.408163265306122,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         1.673469387755102,
                                         1.7142857142857144,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         3.5102040816326525,
                                         3.591836734693877,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.755102040816325,
                                         5.877551020408163,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         6.,
                                         6.122448979591836,
                                         6.244897959183673,
                                         6.367346938775509,
                                         4.163265306122449,
                                         4.244897959183673,
                                         4.326530612244897,
                                         4.408163265306122,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         1.673469387755102,
                                         1.7142857142857144,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         3.5102040816326525,
                                         3.591836734693877,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.755102040816325,
                                         5.877551020408163,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         6.,
                                         6.122448979591836,
                                         6.244897959183673,
                                         6.367346938775509,
                                         4.163265306122449,
                                         4.244897959183673,
                                         4.326530612244897,
                                         4.408163265306122,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         0.9999999999999999,
                                         1.0204081632653061,
                                         1.040816326530612,
                                         1.0612244897959182,
                                         2.081632653061224,
                                         2.1224489795918364,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         3.244897959183673,
                                         3.3061224489795915,
                                         3.36734693877551,
                                         3.428571428571428,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         3.4897959183673466,
                                         3.5510204081632653,
                                         3.6122448979591835,
                                         3.6734693877551017,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         1.2448979591836733,
                                         1.2653061224489794,
                                         1.2857142857142856,
                                         1.3061224489795917,
                                         1.3265306122448979,
                                         1.346938775510204,
                                         1.3673469387755102,
                                         1.3877551020408163,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         4.224489795918367,
                                         4.285714285714285,
                                         4.346938775510204,
                                         4.408163265306122,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         4.469387755102041,
                                         4.530612244897958,
                                         4.591836734693877,
                                         4.653061224489796,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         3.1428571428571423,
                                         3.183673469387755,
                                         1.5714285714285714,
                                         1.5918367346938773,
                                         1.6122448979591835,
                                         1.6326530612244896,
                                         2.9795918367346936,
                                         3.020408163265306,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         6.122448979591836,
                                         6.20408163265306,
                                         6.285714285714285,
                                         6.36734693877551,
                                         9.428571428571427,
                                         9.551020408163264,
                                         9.673469387755102,
                                         9.795918367346937,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         9.918367346938775,
                                         10.04081632653061,
                                         10.163265306122447,
                                         10.285714285714285,
                                         6.775510204081632,
                                         6.857142857142857,
                                         6.9387755102040805,
                                         7.020408163265307,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         2.9795918367346936,
                                         3.020408163265306,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         6.122448979591836,
                                         6.20408163265306,
                                         6.285714285714285,
                                         6.36734693877551,
                                         9.428571428571427,
                                         9.551020408163264,
                                         9.673469387755102,
                                         9.795918367346937,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         9.918367346938775,
                                         10.04081632653061,
                                         10.163265306122447,
                                         10.285714285714285,
                                         6.775510204081632,
                                         6.857142857142857,
                                         6.9387755102040805,
                                         7.020408163265307,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         2.9795918367346936,
                                         3.020408163265306,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         6.122448979591836,
                                         6.20408163265306,
                                         6.285714285714285,
                                         6.36734693877551,
                                         9.428571428571427,
                                         9.551020408163264,
                                         9.673469387755102,
                                         9.795918367346937,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         9.918367346938775,
                                         10.04081632653061,
                                         10.163265306122447,
                                         10.285714285714285,
                                         6.775510204081632,
                                         6.857142857142857,
                                         6.9387755102040805,
                                         7.020408163265307,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         2.9795918367346936,
                                         3.020408163265306,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         6.122448979591836,
                                         6.20408163265306,
                                         6.285714285714285,
                                         6.36734693877551,
                                         9.428571428571427,
                                         9.551020408163264,
                                         9.673469387755102,
                                         9.795918367346937,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         9.918367346938775,
                                         10.04081632653061,
                                         10.163265306122447,
                                         10.285714285714285,
                                         6.775510204081632,
                                         6.857142857142857,
                                         6.9387755102040805,
                                         7.020408163265307,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         2.9795918367346936,
                                         3.020408163265306,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         6.122448979591836,
                                         6.20408163265306,
                                         6.285714285714285,
                                         6.36734693877551,
                                         9.428571428571427,
                                         9.551020408163264,
                                         9.673469387755102,
                                         9.795918367346937,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         9.918367346938775,
                                         10.04081632653061,
                                         10.163265306122447,
                                         10.285714285714285,
                                         6.775510204081632,
                                         6.857142857142857,
                                         6.9387755102040805,
                                         7.020408163265307,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         2.9795918367346936,
                                         3.020408163265306,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         6.122448979591836,
                                         6.20408163265306,
                                         6.285714285714285,
                                         6.36734693877551,
                                         9.428571428571427,
                                         9.551020408163264,
                                         9.673469387755102,
                                         9.795918367346937,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         9.918367346938775,
                                         10.04081632653061,
                                         10.163265306122447,
                                         10.285714285714285,
                                         6.775510204081632,
                                         6.857142857142857,
                                         6.9387755102040805,
                                         7.020408163265307,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         1.6530612244897958,
                                         1.673469387755102,
                                         1.693877551020408,
                                         1.7142857142857142,
                                         3.387755102040816,
                                         3.4285714285714284,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         5.204081632653061,
                                         5.26530612244898,
                                         5.326530612244897,
                                         5.387755102040815,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         5.448979591836735,
                                         5.5102040816326525,
                                         5.571428571428571,
                                         5.63265306122449,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         3.7959183673469385,
                                         3.836734693877551,
                                         1.8979591836734693,
                                         1.9183673469387754,
                                         1.9387755102040816,
                                         1.9591836734693877};
  const std::array<int, 4> in_shape = {{3, 8, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.15218253968254,   8.794019274376419,  10.836082766439908,
      13.43846371882086,  14.767630385487529, 12.924773242630383,
      11.262471655328797, 9.729138321995464,  10.870209750566895,
      13.2671485260771,   16.213973922902493, 19.93064058956916,
      21.509807256235824, 18.69552154195011,  16.19988662131519,
      13.931859410430839, 15.456264172335601, 18.77157029478458,
      22.813633786848072, 27.873157596371875, 29.70232426303854,
      25.68803854875283,  22.168594104308387, 19.002607709750567,
      21.81935941043084,  26.396570294784585, 31.938633786848076,
      38.83149092970521,  40.95232426303855,  35.271371882086164,
      30.33526077097505,  25.931179138321994, 30.23995464852608,
      36.381451247165536, 43.7401814058957,   52.803038548752845,
      54.836371882086176, 46.93541950113379,  40.157641723356015,
      34.18213151927438,  41.26316893424036,  49.49752267573696,
      59.306252834467124, 71.31910997732427,  73.4399433106576,
      62.638990929705216, 53.43621315192744,  45.37498866213151,
      38.95086734693877,  46.68522108843537,  55.88284013605442,
      67.12903061224489,  68.95819727891156,  58.75724489795918,
      50.08224489795918,  42.497210884353734, 36.10086734693878,
      43.2433843537415,   51.72671768707483,  62.087193877551016,
      63.66636054421768,  54.20826530612245,  46.176122448979584,
      39.16251700680272,  32.38284013605442,  38.770255102040814,
      46.348826530612236, 55.59501700680271,  56.92418367346938,
      48.43751700680272,  41.23870748299319,  34.95979591836735,
      48.687284580498854, 58.14136621315192,  69.29771541950115,
      82.83723922902495,  84.16640589569161,  71.38640589569158,
      60.60981859410431,  51.2642403628118,   60.21755668934239,
      71.89612811791383,  85.67152494331067,  102.38247732426305,
      103.96164399092972, 88.15307256235826,  74.82886621315194,
      63.279206349206355, 72.61585600907028,  86.68218253968254,
      103.26710317460319, 123.37805555555558, 125.20722222222224,
      106.14150793650794, 90.07920634920637,  76.16219954648528,
      88.09323696145124,  105.13575396825398, 125.22067460317463,
      149.56496031746033, 151.68579365079367, 128.5534126984127,
      109.07444444444447, 92.20505668934243,  93.77954648526078,
      111.87206349206349, 133.1736507936508,  158.96793650793654,
      161.0012698412699,  136.3688888888889,  115.64825396825398,
      97.72172335600906,  107.53704648526077, 128.23670634920634,
      152.58829365079362, 182.05257936507937, 184.1734126984127,
      155.92103174603173, 132.17539682539683, 111.64886621315195,
      96.11045918367348,  114.59583333333333, 136.33630952380955,
      162.63392857142856, 164.46309523809524, 139.2107142857143,
      117.99285714285715, 99.65680272108845,  85.44821428571429,
      101.87236394557824, 121.184268707483,   144.5390306122449,
      146.11819727891157, 123.66581632653063, 104.80510204081634,
      88.50986394557825,  73.91794217687075,  88.11760204081635,
      104.81045918367349, 124.99379251700684, 126.3229591836735,
      106.89914965986397, 90.58605442176872,  76.49489795918367,
      90.2223866213152,   107.48871315192743, 127.75934807256235,
      152.236014739229,   153.56518140589566, 129.8480385487528,
      109.95716553287981, 92.79934240362812,  109.56490362811792,
      130.52510770975056, 155.12907596371883, 184.83431405895692,
      186.41348072562357, 157.61062358276644, 133.45784580498866,
      112.62655328798185, 129.775447845805,   154.59279478458052,
      183.7205725623583,  218.88295351473926, 220.7121201814059,
      186.59497732426306, 157.98981859410432, 133.32179138321993,
      154.36711451247163, 183.87493764172336, 218.50271541950116,
      260.2984297052154,  262.4192630385487,  221.8354535147392,
      187.81362811791385, 158.4789342403628,  157.3191383219955,
      187.36267573696145, 222.60712018140592, 265.1328344671202,
      267.16616780045354, 225.80235827664396, 191.1388662131519,
      161.26131519274378, 173.8109240362812,  206.97589002267577,
      245.87033446712022, 292.78604875283446, 294.9068820861678,
      249.2030725623583,  210.91458049886623, 177.92274376417234,
      153.27005102040818, 182.5064455782313,  216.78977891156464,
      258.1388265306123,  259.96799319727893, 219.66418367346938,
      185.9034693877551,  156.81639455782312, 134.7955612244898,
      160.50134353741495, 190.64181972789115, 226.9908673469388,
      228.57003401360546, 193.12336734693875, 163.43408163265303,
      137.85721088435375, 115.45304421768707, 137.46494897959184,
      163.27209183673466, 194.39256802721084, 195.72173469387752,
      165.36078231292515, 139.93340136054422, 118.03};
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612,  0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.04081632653061224,  0.08163265306122448,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.12244897959183673,  0.18367346938775508,  0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.24489795918367346,
      0.18367346938775508,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.24489795918367346,  0.18367346938775508,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.24489795918367346,  0.18367346938775508,  0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.24489795918367346,
      0.18367346938775508,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.24489795918367346,  0.16326530612244897,
      0.36734693877551017,  0.36734693877551017,  0.36734693877551017,
      0.36734693877551017,  0.36734693877551017,  0.36734693877551017,
      0.20408163265306123,  0.1020408163265306,   0.22448979591836732,
      0.22448979591836732,  0.22448979591836732,  0.22448979591836732,
      0.22448979591836732,  0.22448979591836732,  0.12244897959183673,
      0.14285714285714285,  0.30612244897959184,  0.30612244897959184,
      0.30612244897959184,  0.30612244897959184,  0.30612244897959184,
      0.30612244897959184,  0.16326530612244897,  0.32653061224489793,
      0.6938775510204082,   0.6938775510204082,   0.6938775510204082,
      0.6938775510204082,   0.6938775510204082,   0.6938775510204082,
      0.36734693877551017,  0.5510204081632653,   1.163265306122449,
      1.163265306122449,    1.163265306122449,    1.163265306122449,
      1.163265306122449,    1.163265306122449,    0.6122448979591837,
      0.5510204081632653,   1.163265306122449,    1.163265306122449,
      1.163265306122449,    1.163265306122449,    1.163265306122449,
      1.163265306122449,    0.6122448979591837,   0.5510204081632653,
      1.163265306122449,    1.163265306122449,    1.163265306122449,
      1.163265306122449,    1.163265306122449,    1.163265306122449,
      0.6122448979591837,   0.5510204081632653,   1.163265306122449,
      1.163265306122449,    1.163265306122449,    1.163265306122449,
      1.163265306122449,    1.163265306122449,    0.6122448979591837,
      0.5510204081632653,   1.163265306122449,    1.163265306122449,
      1.163265306122449,    1.163265306122449,    1.163265306122449,
      1.163265306122449,    0.6122448979591837,   0.4081632653061224,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.44897959183673464,  0.22448979591836732,  0.4693877551020408,
      0.4693877551020408,   0.4693877551020408,   0.4693877551020408,
      0.4693877551020408,   0.4693877551020408,   0.24489795918367346,
      0.26530612244897955,  0.5510204081632653,   0.5510204081632653,
      0.5510204081632653,   0.5510204081632653,   0.5510204081632653,
      0.5510204081632653,   0.2857142857142857,   0.5714285714285714,
      1.1836734693877549,   1.1836734693877549,   1.1836734693877549,
      1.1836734693877549,   1.1836734693877549,   1.1836734693877549,
      0.6122448979591837,   0.9183673469387754,   1.897959183673469,
      1.897959183673469,    1.897959183673469,    1.897959183673469,
      1.897959183673469,    1.897959183673469,    0.9795918367346939,
      0.9183673469387754,   1.897959183673469,    1.897959183673469,
      1.897959183673469,    1.897959183673469,    1.897959183673469,
      1.897959183673469,    0.9795918367346939,   0.9183673469387754,
      1.897959183673469,    1.897959183673469,    1.897959183673469,
      1.897959183673469,    1.897959183673469,    1.897959183673469,
      0.9795918367346939,   0.9183673469387754,   1.897959183673469,
      1.897959183673469,    1.897959183673469,    1.897959183673469,
      1.897959183673469,    1.897959183673469,    0.9795918367346939,
      0.9183673469387754,   1.897959183673469,    1.897959183673469,
      1.897959183673469,    1.897959183673469,    1.897959183673469,
      1.897959183673469,    0.9795918367346939,   0.6530612244897959,
      1.346938775510204,    1.346938775510204,    1.346938775510204,
      1.346938775510204,    1.346938775510204,    1.346938775510204,
      0.693877551020408,    0.3469387755102041,   0.7142857142857142,
      0.7142857142857142,   0.7142857142857142,   0.7142857142857142,
      0.7142857142857142,   0.7142857142857142,   0.36734693877551017};
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.72748866213152,  14.30436507936508,  16.90265873015873,
      17.588038548752838, 20.860198412698413, 21.672165532879816,
      25.91305555555556,  26.87692743764172,  28.571388888888887,
      29.535260770975057, 25.037579365079367, 25.849546485260767,
      21.839563492063494, 22.524943310657594, 18.88140022675737,
      19.458276643990928, 21.055039682539682, 21.74041950113379,
      25.720005668934242, 26.5342970521542,   31.46325963718821,
      32.42794784580499,  38.716116780045354, 39.86128117913832,
      41.874450113378686, 43.01961451247165,  36.426354875283444,
      37.39104308390022,  31.58548185941043,  32.39977324263038,
      27.17833900226757,  27.863718820861678, 30.11864512471655,
      30.912528344671202, 36.59993764172336,  37.54314058956916,
      44.509858276643996, 45.627267573696145, 54.419858276644,
      55.74631519274375,  58.07819160997733,  59.40464852607708,
      50.258667800453516, 51.37607709750566,  43.393985260770975,
      44.33718820861677,  37.21133219954648,  38.005215419501134,
      42.71824829931972,  43.63871882086168,  51.699540816326525,
      52.79314058956917,  62.581683673469385, 63.87726757369615,
      76.12501700680274,  77.66298185941042,  80.3666836734694,
      81.9046485260771,   69.24715986394558,  70.54274376417233,
      59.57692176870748,  60.6705215419501,   50.94188775510204,
      51.86235827664399,  59.59741496598638,  60.47990929705216,
      71.71442176870748,  72.76290249433107,  86.238231292517,
      87.4803628117914,   104.13156462585036, 105.60607709750569,
      108.19823129251701, 109.67274376417235, 92.62870748299319,
      93.87083900226757,  79.26680272108842,  80.31528344671203,
      67.48176870748298,  68.36426303854876,  81.60586734693877,
      82.52633786848072,  97.90144557823128,  98.99504535147392,
      117.31692176870747, 118.61250566893425, 141.10025510204082,
      142.63821995464855, 145.3419217687075,  146.8798866213152,
      123.98239795918367, 125.27798185941043, 105.77882653061222,
      106.87242630385488, 89.82950680272108,  90.74997732426301,
      77.10785147392289,  77.90173469387754,  92.42723922902492,
      93.37044217687074,  110.64827097505669, 111.76568027210884,
      132.93160430839,    134.25806122448978, 136.58993764172334,
      137.9163945578231,  116.3970804988662,  117.51448979591837,
      99.22128684807255,  100.16448979591836, 84.20053854875285,
      84.99442176870747,  71.51635487528345,  72.20173469387755,
      85.67247732426303,  86.486768707483,    102.48874716553287,
      103.45343537414966, 123.02922335600907, 124.17438775510203,
      126.18755668934239, 127.33272108843536, 107.45184240362812,
      108.4165306122449,  91.53795351473923,  92.35224489795917,
      77.63965419501133,  78.32503401360545,  64.18880385487529,
      64.76568027210884,  76.85513038548753,  77.54051020408163,
      91.88568594104308,  92.69765306122447,  110.22616213151927,
      111.19003401360543, 112.8844954648526,  113.84836734693876,
      96.06306689342404,  96.87503401360544,  81.79203514739228,
      82.47741496598638,  69.34271541950113,  69.9195918367347,
      96.79769274376416,  97.37456916099771,  115.59735260770975,
      116.28273242630384, 137.78346371882085, 138.5954308390023,
      164.71060657596374, 165.6744784580499,  167.36893990929707,
      168.33281179138322, 141.9608446712018,  142.77281179138316,
      120.53425736961451, 121.21963718820862, 101.95160430839002,
      102.5284807256236,  119.74973356009068, 120.43511337868478,
      142.9779648526077,  143.79225623582767, 170.37836167800455,
      171.34304988662134, 203.61979024943315, 204.7649546485261,
      206.77812358276648, 207.92328798185943, 175.3414569160998,
      176.30614512471652, 148.8434410430839,  149.65773242630388,
      125.87303287981858, 126.55841269841271, 144.43782879818593,
      145.23171201814057, 172.42116213151928, 173.3643650793651,
      205.41679705215424, 206.53420634920639, 245.4296541950114,
      246.75611111111115, 249.08798752834474, 250.41444444444448,
      211.16560657596375, 212.28301587301587, 179.2152097505669,
      180.15841269841275, 151.53051587301587, 152.32439909297057,
      175.2660034013605,  176.18647392290248, 209.17790816326527,
      210.27150793650796, 249.14576530612246, 250.44134920634926,
      297.59195578231305, 299.12992063492067, 301.8336224489797,
      303.37158730158734, 255.81124149659865, 257.1068253968254,
      217.05528911564627, 218.14888888888893, 183.48964285714285,
      184.41011337868485, 186.6765986394557,  187.55909297052156,
      222.69564625850336, 223.74412698412698, 265.1051700680272,
      266.3473015873016,  316.46136054421765, 317.9358730158731,
      320.5280272108843,  322.0025396825398,  271.4956462585034,
      272.7377777777778,  230.24802721088432, 231.29650793650796,
      194.5609523809524,  195.44344671201813, 214.15362244897955,
      215.07409297052155, 255.37981292517,    256.4734126984127,
      303.88100340136054, 305.17658730158723, 362.567193877551,
      364.10515873015873, 366.8088605442177,  368.3468253968254,
      310.54647959183666, 311.84206349206346, 263.257193877551,
      264.35079365079366, 222.3772619047619,  223.2977324263039,
      191.42703514739227, 192.22091836734697, 228.24846371882083,
      229.19166666666666, 271.55520975056686, 272.6726190476191,
      323.9414002267573,  325.2678571428571,  327.59973356009067,
      328.92619047619047, 277.3040192743764,  278.4214285714286,
      235.0425113378685,  235.9857142857143,  198.5197222222222,
      199.3136054421769,  170.21104875283444, 170.89642857142857,
      202.9304365079365,  203.7447278911565,  241.40384920634918,
      242.368537414966,   287.9328968253968,  289.0780612244898,
      291.0912301587302,  292.23639455782313, 246.36694444444444,
      247.33163265306126, 208.7959126984127,  209.61020408163267,
      176.33434807256236, 177.0197278911565,  147.25900793650794,
      147.8358843537415,  175.54982426303854, 176.2352040816327,
      208.8089512471655,  209.62091836734697, 249.0237131519274,
      249.98758503401368, 251.68204648526077, 252.645918367347,
      212.9863321995465,  213.79829931972793, 180.48672902494332,
      181.17210884353744, 152.41291950113379, 152.98979591836735,
      179.8678968253968,  180.4447732426304,  214.29204648526073,
      214.97742630385486, 254.70672902494326, 255.5186961451247,
      303.5081575963719,  304.472029478458,   306.16649092970516,
      307.1303628117913,  258.8841099773243,  259.6960770975056,
      219.22895124716553, 219.91433106575963, 185.02180839002267,
      185.59868480725623, 218.4444274376417,  219.12980725623584,
      260.2359240362811,  261.0502154195011,  309.2934637188208,
      310.25815192743767, 368.5234637188209,  369.66862811791384,
      371.68179705215414, 372.82696145124714, 314.2565589569161,
      315.2212471655329,  266.10140022675733, 266.91569160997733,
      224.5677267573696,  225.2531065759637,  258.7570124716553,
      259.55089569161,    308.2423866213152,  309.18558956916104,
      366.32373582766445, 367.4411451247166,  436.43945011337877,
      437.7659070294785,  440.09778344671207, 441.4242403628118,
      372.07254535147393, 373.1899546485261,  315.03643424036284,
      315.97963718820864, 265.8496995464853,  266.64358276643986,
      307.8137585034013,  308.73422902494326, 366.656275510204,
      367.7498752834467,  435.7098469387755,  437.0054308390023,
      519.0588945578231,  520.5968594104309,  523.3005612244898,
      524.8385260770974,  442.3753231292517,  443.6709070294784,
      374.53365646258504, 375.6272562358277,  316.0373979591837,
      316.9578684807256,  313.75578231292513, 314.638276643991,
      373.6768707482993,  374.7253514739229,  443.9721088435374,
      445.21424036281184, 528.7911564625851,  530.2656689342404,
      532.8578231292516,  534.3323356009071,  450.36258503401353,
      451.6047165532879,  381.22925170068027, 382.2777324263038,
      321.6401360544217,  322.52263038548756, 346.70137755102036,
      347.6218480725624,  412.8581802721088,  413.95178004535154,
      490.44508503401363, 491.74066893424043, 584.0341326530612,
      585.5720975056689,  588.2757993197279,  589.8137641723356,
      497.1105612244898,  498.4061451247166,  420.73556122448974,
      421.82916099773246, 354.9250170068027,  355.8454875283447,
      305.74621882086166, 306.54010204081635, 364.0696882086168,
      365.0128911564626,  432.4621485260771,  433.5795578231293,
      514.9511961451248,  516.2776530612246,  518.609529478458,
      519.9359863945579,  438.2109580498866,  439.32836734693876,
      370.86373582766436, 371.8069387755102,  312.8389058956916,
      313.63278911564623, 268.9057426303855,  269.5911224489796,
      320.18839569160997, 321.0026870748299,  380.31895124716556,
      381.2836394557823,  452.83657029478456, 453.9817346938776,
      455.99490362811787, 457.14006802721093, 385.28204648526076,
      386.2467346938775,  326.0538718820862,  326.86816326530607,
      275.02904195011337, 275.7144217687075,  230.3292120181406,
      230.90608843537413, 274.2445181405896,  274.9298979591837,
      325.732216553288,   326.5441836734693,  387.8212641723356,
      388.7851360544217,  390.47959750566895, 391.44346938775504,
      329.90959750566896, 330.7215646258503,  279.1814229024943,
      279.86680272108845, 235.48312358276644, 236.06};
  const std::array<int, 4> in_shape = {{3, 9, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.42857142857142855,
      0.4897959183673469,  0.3061224489795918,  0.36734693877551017,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.42857142857142855, 0.4897959183673469,  0.3061224489795918,
      0.36734693877551017, 0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.42857142857142855,
      0.4897959183673469,  0.2857142857142857,  0.32653061224489793,
      0.6530612244897959,  0.7346938775510203,  0.6530612244897959,
      0.7346938775510203,  0.6530612244897959,  0.7346938775510203,
      0.6530612244897959,  0.7346938775510203,  0.6530612244897959,
      0.7346938775510203,  0.6530612244897959,  0.7346938775510203,
      0.36734693877551017, 0.40816326530612246, 0.18367346938775508,
      0.2040816326530612,  0.4081632653061224,  0.44897959183673464,
      0.4081632653061224,  0.44897959183673464, 0.4081632653061224,
      0.44897959183673464, 0.4081632653061224,  0.44897959183673464,
      0.4081632653061224,  0.44897959183673464, 0.4081632653061224,
      0.44897959183673464, 0.22448979591836732, 0.24489795918367346,
      0.26530612244897955, 0.2857142857142857,  0.5714285714285714,
      0.6122448979591837,  0.5714285714285714,  0.6122448979591837,
      0.5714285714285714,  0.6122448979591837,  0.5714285714285714,
      0.6122448979591837,  0.5714285714285714,  0.6122448979591837,
      0.5714285714285714,  0.6122448979591837,  0.3061224489795918,
      0.32653061224489793, 0.6122448979591837,  0.6530612244897959,
      1.3061224489795917,  1.3877551020408163,  1.3061224489795917,
      1.3877551020408163,  1.3061224489795917,  1.3877551020408163,
      1.3061224489795917,  1.3877551020408163,  1.3061224489795917,
      1.3877551020408163,  1.3061224489795917,  1.3877551020408163,
      0.693877551020408,   0.7346938775510203,  1.0408163265306123,
      1.1020408163265305,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   1.1632653061224487,  1.2244897959183674,
      1.0408163265306123,  1.1020408163265305,  2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.1632653061224487,
      1.2244897959183674,  1.0408163265306123,  1.1020408163265305,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      1.1632653061224487,  1.2244897959183674,  1.0408163265306123,
      1.1020408163265305,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   1.1632653061224487,  1.2244897959183674,
      1.0408163265306123,  1.1020408163265305,  2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.1632653061224487,
      1.2244897959183674,  0.7755102040816326,  0.8163265306122448,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      0.8571428571428571,  0.8979591836734693,  0.42857142857142855,
      0.44897959183673464, 0.8979591836734693,  0.9387755102040816,
      0.8979591836734693,  0.9387755102040816,  0.8979591836734693,
      0.9387755102040816,  0.8979591836734693,  0.9387755102040816,
      0.8979591836734693,  0.9387755102040816,  0.8979591836734693,
      0.9387755102040816,  0.4693877551020408,  0.4897959183673469,
      0.5102040816326531,  0.5306122448979591,  1.0612244897959182,
      1.1020408163265305,  1.0612244897959182,  1.1020408163265305,
      1.0612244897959182,  1.1020408163265305,  1.0612244897959182,
      1.1020408163265305,  1.0612244897959182,  1.1020408163265305,
      1.0612244897959182,  1.1020408163265305,  0.5510204081632653,
      0.5714285714285714,  1.1020408163265305,  1.1428571428571428,
      2.2857142857142856,  2.3673469387755097,  2.2857142857142856,
      2.3673469387755097,  2.2857142857142856,  2.3673469387755097,
      2.2857142857142856,  2.3673469387755097,  2.2857142857142856,
      2.3673469387755097,  2.2857142857142856,  2.3673469387755097,
      1.183673469387755,   1.2244897959183674,  1.7755102040816326,
      1.8367346938775508,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   1.8979591836734693,  1.9591836734693877,
      1.7755102040816326,  1.8367346938775508,  3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   1.8979591836734693,
      1.9591836734693877,  1.7755102040816326,  1.8367346938775508,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      1.8979591836734693,  1.9591836734693877,  1.7755102040816326,
      1.8367346938775508,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   1.8979591836734693,  1.9591836734693877,
      1.7755102040816326,  1.8367346938775508,  3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   1.8979591836734693,
      1.9591836734693877,  1.2653061224489797,  1.3061224489795917,
      2.612244897959184,   2.693877551020408,   2.612244897959184,
      2.693877551020408,   2.612244897959184,   2.693877551020408,
      2.612244897959184,   2.693877551020408,   2.612244897959184,
      2.693877551020408,   2.612244897959184,   2.693877551020408,
      1.3469387755102038,  1.387755102040816,   0.673469387755102,
      0.6938775510204082,  1.387755102040816,   1.4285714285714284,
      1.387755102040816,   1.4285714285714284,  1.387755102040816,
      1.4285714285714284,  1.387755102040816,   1.4285714285714284,
      1.387755102040816,   1.4285714285714284,  1.387755102040816,
      1.4285714285714284,  0.7142857142857142,  0.7346938775510203};
  const std::array<int, 4> in_shape = {{3, 9, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907029477, 27.45497732426304,  28.031853741496597,
      28.60873015873016,  33.119937641723354, 33.80531746031746,
      34.49069727891156,  35.176077097505676, 40.90842970521542,
      41.720396825396826, 42.532363945578226, 43.34433106575963,
      50.862239229024944, 51.82611111111112,  52.78998299319728,
      53.75385487528344,  56.178905895691614, 57.14277777777777,
      58.10664965986395,  59.070521541950114, 49.263191609977326,
      50.07515873015873,  50.88712585034013,  51.699092970521534,
      42.993747165532874, 43.67912698412699,  44.36450680272108,
      45.04988662131519,  37.18592403628118,  37.76280045351474,
      38.33967687074829,  38.916553287981856, 41.42469954648526,
      42.110079365079365, 42.795459183673465, 43.48083900226758,
      50.62571995464852,  51.440011337868484, 52.25430272108843,
      53.0685941043084,   61.961831065759625, 62.92651927437642,
      63.89120748299319,  64.85589569160997,  76.28706916099772,
      77.43223356009071,  78.57739795918367,  79.72256235827663,
      82.6037358276644,   83.74890022675737,  84.89406462585035,
      86.0392290249433,   71.88802154195011,  72.85270975056689,
      73.81739795918367,  74.78208616780044,  62.356672335600905,
      63.17096371882086,  63.98525510204081,  64.79954648526076,
      53.67129818594104,  54.35667800453514,  55.04205782312925,
      55.727437641723355, 59.44340702947846,  60.2372902494331,
      61.031173469387745, 61.825056689342404, 72.2566723356009,
      73.19987528344672,  74.1430782312925,   75.08628117913833,
      87.9023072562358,   89.01971655328799,  90.13712585034013,
      91.25453514739229,  107.51325963718818, 108.839716553288,
      110.16617346938774, 111.4926303854875,  114.82992630385486,
      116.15638321995466, 117.48284013605442, 118.80929705215416,
      99.39992630385487,  100.51733560090703, 101.63474489795917,
      102.75215419501131, 85.84476757369615,  86.78797052154195,
      87.73117346938774,  88.67437641723355,  73.62878117913833,
      74.42266439909297,  75.21654761904762,  76.01043083900227,
      84.5160260770975,   85.43649659863944,  86.35696712018138,
      87.27743764172337,  102.30548185941042, 103.39908163265305,
      104.49268140589568, 105.58628117913834, 123.867783446712,
      125.16336734693877, 126.45895124716553, 127.7545351473923,
      150.7120691609977,  152.25003401360547, 153.78799886621314,
      155.32596371882084, 159.19540249433103, 160.7333673469388,
      162.27133219954646, 163.8092970521542,  137.1987358276644,
      138.49431972789117, 139.78990362811788, 141.08548752834466,
      118.06024376417234, 119.15384353741496, 120.24744331065759,
      121.3410430839002,  100.96330498866214, 101.88377551020407,
      102.80424603174603, 103.72471655328798, 118.31233560090702,
      119.19482993197276, 120.07732426303852, 120.95981859410432,
      142.38036281179137, 143.42884353741496, 144.47732426303853,
      145.52580498866214, 171.23433106575962, 172.476462585034,
      173.71859410430838, 174.9607256235828,  206.78861678004532,
      208.26312925170072, 209.73764172335598, 211.21215419501138,
      214.92195011337864, 216.39646258503402, 217.8709750566893,
      219.3454875283447,  184.01528344671203, 185.25741496598638,
      186.49954648526074, 187.74167800453515, 157.48512471655332,
      158.53360544217685, 159.5820861678004,  160.63056689342406,
      134.08104308390025, 134.96353741496597, 135.84603174603174,
      136.7285260770975,  162.29126417233562, 163.21173469387753,
      164.13220521541948, 165.05267573696145, 194.70929138321995,
      195.80289115646255, 196.8964909297052,  197.99009070294784,
      233.3382596371882,  234.63384353741495, 235.92942743764172,
      237.2250113378685,  280.6625453514739,  282.20051020408164,
      283.7384750566893,  285.2764399092971,  289.14587868480726,
      290.683843537415,   292.2218083900226,  293.7597732426304,
      246.6692120181406,  247.96479591836734, 249.2603798185941,
      250.55596371882086, 210.4640532879819,  211.55765306122444,
      212.65125283446713, 213.74485260770976, 178.73854308390025,
      179.65901360544217, 180.57948412698414, 181.49995464852603,
      153.42181972789115, 154.21570294784578, 155.00958616780042,
      155.8034693877551,  183.91127551020406, 184.85447845804984,
      185.79768140589567, 186.74088435374148, 220.1791326530612,
      221.29654195011338, 222.41395124716553, 223.53136054421768,
      264.53675170068027, 265.86320861678,    267.1896655328798,
      268.51612244897956, 271.853418367347,   273.1798752834467,
      274.5063321995465,  275.8327891156462,  231.67675170068028,
      232.7941609977324,  233.91157029478455, 235.02897959183673,
      197.49937074829933, 198.4425736961451,  199.38577664399094,
      200.3289795918367,  167.60719387755103, 168.4010770975057,
      169.19496031746033, 169.98884353741494, 142.34732993197278,
      143.0327097505669,  143.71808956916098, 144.4034693877551,
      170.53066326530612, 171.34495464852606, 172.15924603174602,
      172.973537414966,   204.01280612244898, 204.97749433106574,
      205.94218253968253, 206.90687074829933, 244.91328231292516,
      246.05844671201814, 247.20361111111106, 248.34877551020406,
      251.22994897959185, 252.37511337868477, 253.52027777777775,
      254.66544217687073, 213.93899659863948, 214.90368480725624,
      215.868373015873,   216.8330612244898,  182.26161564625852,
      183.07590702947846, 183.89019841269842, 184.70448979591833,
      154.5939285714286,  155.27930839002266, 155.96468820861676,
      156.6500680272109,  127.80073129251701, 128.37760770975058,
      128.9544841269841,  129.53136054421768, 153.02488095238095,
      153.71026077097505, 154.39564058956915, 155.08102040816325,
      182.95940476190475, 183.77137188208616, 184.5833390022676,
      185.39530612244894, 219.4884523809524,  220.45232426303855,
      221.41619614512473, 222.38006802721085, 224.80511904761906,
      225.7689909297052,  226.7328628117914,  227.69673469387752,
      191.31416666666667, 192.12613378684807, 192.93810090702948,
      193.7500680272109,  162.8986904761905,  163.58407029478457,
      164.2694501133787,  164.95482993197277, 138.1085544217687,
      138.68543083900227, 139.26230725623583, 139.8391836734694,
      193.01850907029478, 193.59538548752832, 194.1722619047619,
      194.74913832199542, 230.5093253968254,  231.1947052154195,
      231.88008503401363, 232.56546485260768, 274.7549603174604,
      275.5669274376417,  276.3788945578232,  277.1908616780046,
      328.4573412698413,  329.4212131519275,  330.3850850340137,
      331.3489569160998,  333.7740079365079,  334.73787981859414,
      335.70175170068035, 336.66562358276644, 283.1097222222223,
      283.9216893424036,  284.73365646258503, 285.5456235827663,
      240.3831349206349,  241.06851473922902, 241.75389455782314,
      242.43927437641725, 203.32633219954647, 203.90320861678003,
      204.48008503401363, 205.0569614512472,  238.8140873015873,
      239.49946712018135, 240.1848469387755,  240.87022675736955,
      285.1416383219954,  285.9559297052154,  286.7702210884354,
      287.58451247165533, 339.79203514739237, 340.7567233560091,
      341.7214115646259,  342.6860997732427,  406.0944160997733,
      407.2395804988663,  408.3847448979593,  409.5299092970522,
      412.4110827664399,  413.55624716553297, 414.70141156462597,
      415.84657596371886, 349.71822562358284, 350.6829138321996,
      351.64760204081637, 352.61229024943304, 296.8725907029479,
      297.6868820861678,  298.50117346938777, 299.31546485260776,
      251.06068594104306, 251.74606575963716, 252.43144557823132,
      253.11682539682542, 288.08177437641723, 288.87565759637187,
      289.66954081632656, 290.46342403628114, 343.8991213151927,
      344.84232426303856, 345.78552721088437, 346.7287301587302,
      409.7161848072563,  410.8335941043085,  411.9510034013606,
      413.06841269841277, 489.532851473923,   490.8593083900228,
      492.18576530612256, 493.5122222222223,  496.84951814058957,
      498.1759750566895,  499.5024319727892,  500.82888888888897,
      421.21380385487544, 422.3312131519275,  423.4486224489796,
      424.56603174603174, 357.4872165532881,  358.4304195011338,
      359.3736224489796,  360.3168253968255,  302.2671485260771,
      303.06103174603174, 303.8549149659864,  304.64879818594113,
      349.61153628117916, 350.532006802721,   351.4524773242631,
      352.37294784580496, 417.26221655328794, 418.35581632653054,
      419.4494160997733,  420.5430158730159,  496.9959467120182,
      498.2915306122449,  499.5871145124717,  500.8826984126985,
      593.6459467120183,  595.1839115646261,  596.7218764172337,
      598.2598412698413,  602.1292800453515,  603.6672448979594,
      605.205209750567,   606.7431746031747,  510.3268990929706,
      511.6224829931973,  512.9180668934241,  514.2136507936508,
      433.01697845804995, 434.11057823129255, 435.20417800453515,
      436.29777777777787, 366.05881519274374, 366.9792857142857,
      367.8997562358277,  368.8202267573697,  372.4707029478458,
      373.3531972789114,  374.2356916099773,  375.1181859410431,
      444.3428117913832,  445.3912925170067,  446.4397732426304,
      447.48825396825396, 528.9682086167801,  530.2103401360544,
      531.4524716553288,  532.6946031746032,  631.44820861678,
      632.9227210884353,  634.3972335600905,  635.8717460317462,
      639.5815419501134,  641.0560544217686,  642.530566893424,
      644.0050793650796,  541.7491609977324,  542.9912925170069,
      544.2334240362811,  545.4755555555556,  459.44757369614507,
      460.49605442176863, 461.5445351473922,  462.59301587301593,
      388.2394104308389,  389.1219047619048,  390.0043990929705,
      390.88689342403626, 427.38677437641724, 428.3072448979591,
      429.2277154195011,  430.1481859410431,  509.66602607709746,
      510.75962585034,    511.8532256235828,  512.9468253968254,
      606.4664229024943,  607.7620068027211,  609.0575907029478,
      610.3531746031745,  723.5964229024944,  725.134387755102,
      726.6723526077096,  728.2103174603175,  732.0797562358276,
      733.6177210884354,  735.155685941043,   736.6936507936508,
      619.7973752834467,  621.0929591836733,  622.3885430839002,
      623.6841269841269,  525.4207879818593,  526.514387755102,
      527.6079875283447,  528.7015873015873,  443.8340532879819,
      444.7545238095238,  445.6749943310657,  446.5954648526078,
      382.06018707482997, 382.85407029478455, 383.64795351473924,
      384.44183673469394, 455.5537244897959,  456.49692743764166,
      457.4401303854875,  458.3833333333333,  541.9930102040815,
      543.1104195011337,  544.227828798186,   545.3452380952382,
      646.5563435374148,  647.8828004535146,  649.2092573696144,
      650.5357142857142,  653.8730102040815,  655.1994671201813,
      656.5259240362813,  657.8523809523809,  553.4906292517007,
      554.6080385487528,  555.725447845805,   556.8428571428572,
      469.1418197278912,  470.085022675737,   471.0282256235827,
      471.9714285714286,  396.24556122448985, 397.0394444444444,
      397.833327664399,   398.6272108843538,  339.7367176870749,
      340.4220975056689,  341.107477324263,   341.79285714285714,
      405.0465816326531,  405.860873015873,   406.675164399093,
      407.489455782313,   481.8430102040816,  482.80769841269836,
      483.77238662131515, 484.737074829932,   574.7206292517006,
      575.8657936507936,  577.0109580498865,  578.1561224489795,
      581.0372959183674,  582.1824603174604,  583.3276247165531,
      584.4727891156463,  491.7692006802722,  492.7338888888889,
      493.6985770975056,  494.6632653061225,  416.77753401360553,
      417.5918253968254,  418.4061167800453,  419.22040816326535,
      351.98331632653066, 352.6686961451247,  353.35407596371886,
      354.039455782313,   293.9411394557824,  294.5180158730159,
      295.09489229024945, 295.671768707483,   350.414268707483,
      351.0996485260771,  351.78502834467116, 352.4704081632654,
      416.8059353741497,  417.617902494331,   418.4298696145124,
      419.24183673469395, 497.0835544217687,  498.0474263038548,
      499.01129818594103, 499.97517006802735, 502.40022108843544,
      503.36409297052154, 504.32796485260764, 505.291836734694,
      425.1606972789116,  425.972664399093,   426.7846315192744,
      427.59659863945586, 360.2880782312925,  360.97345804988663,
      361.65883786848076, 362.3442176870749,  304.24896258503395,
      304.82583900226757, 305.40271541950113, 305.9795918367347,
      359.1589172335601,  359.7357936507936,  360.3126700680271,
      360.8895464852608,  427.89871315192744, 428.58409297052145,
      429.2694727891155,  429.9548526077097,  508.60149092970516,
      509.4134580498865,  510.2254251700679,  511.0373922902494,
      606.0524433106575,  607.0163151927438,  607.9801870748299,
      608.944058956916,   611.3691099773242,  612.3329818594103,
      613.2968537414965,  614.2607256235826,  516.9562528344671,
      517.7682199546485,  518.5801870748298,  519.3921541950112,
      437.7725226757369,  438.45790249433105, 439.1432823129251,
      439.82866213151925, 369.4667403628118,  370.04361678004534,
      370.62049319727885, 371.19736961451247, 436.2034750566894,
      436.8888548752834,  437.57423469387743, 438.25961451247167,
      519.6575566893424,  520.4718480725622,  521.2861394557822,
      522.1004308390022,  617.6222392290249,  618.5869274376416,
      619.5516156462584,  620.5163038548753,  735.9017630385486,
      737.0469274376418,  738.1920918367347,  739.3372562358277,
      742.2184297052153,  743.3635941043083,  744.5087585034013,
      745.6539229024943,  627.5484297052154,  628.5131179138322,
      629.4778061224489,  630.4424943310657,  531.3885090702947,
      532.2028004535147,  533.0170918367346,  533.8313832199547,
      448.4500736961451,  449.1354535147392,  449.82083333333327,
      450.5062131519274,  516.720141723356,   517.5140249433106,
      518.3079081632652,  519.10179138322,    615.5415702947846,
      616.4847732426304,  617.4279761904761,  618.3711791383221,
      731.5300623582766,  732.6474716553289,  733.7648809523808,
      734.8822902494333,  871.5524433106574,  872.8789002267575,
      874.2053571428571,  875.531814058957,   878.8691099773241,
      880.1955668934241,  881.5220238095237,  882.8484807256236,
      743.0276814058957,  744.1450907029479,  745.2624999999999,
      746.3799092970522,  629.1296655328798,  630.0728684807257,
      631.0160714285713,  631.9592743764173,  530.9055158730158,
      531.6993990929706,  532.4932823129251,  533.2871655328797,
      614.7070464852608,  615.6275170068026,  616.5479875283446,
      617.4684580498865,  732.2189512471655,  733.312551020408,
      734.4061507936507,  735.4997505668935,  870.1241099773241,
      871.419693877551,   872.7152777777776,  874.0108616780046,
      1036.5798242630383, 1038.1177891156462, 1039.655753968254,
      1041.1937188208617, 1045.0631575963716, 1046.6011224489796,
      1048.139087301587,  1049.6770521541948, 883.4550623582766,
      884.7506462585034,  886.0462301587299,  887.3418140589569,
      747.9737131519273,  749.0673129251701,  750.1609126984124,
      751.2545124716554,  631.1543253968252,  632.0747959183674,
      632.9952664399091,  633.9157369614512,  626.6290702947846,
      627.5115646258503,  628.3940589569161,  629.276553287982,
      746.305260770975,   747.3537414965986,  748.4022222222221,
      749.4507029478458,  886.7020861678004,  887.9442176870748,
      889.1863492063491,  890.4284807256237,  1056.1078004535148,
      1057.5823129251703, 1059.0568253968252, 1060.5313378684807,
      1064.241133786848,  1065.7156462585033, 1067.1901587301584,
      1068.6646712018141, 899.4830385487528,  900.7251700680271,
      901.9673015873012,  903.2094331065758,  761.4100226757367,
      762.4585034013605,  763.506984126984,   764.5554648526077,
      642.3977777777778,  643.2802721088434,  644.1627664399092,
      645.0452607709751,  692.4822845804988,  693.4027551020407,
      694.3232256235827,  695.2436961451248,  824.622760770975,
      825.7163605442177,  826.8099603174604,  827.9035600907031,
      979.5945861678002,  980.8901700680273,  982.1857539682537,
      983.4813378684809,  1166.5303004535147, 1168.0682653061224,
      1169.6062301587299, 1171.1441950113378, 1175.0136337868482,
      1176.5515986394557, 1178.0895634920635, 1179.6275283446712,
      992.9255385487527,  994.2211224489796,  995.5167063492063,
      996.8122902494332,  840.3775226757369,  841.4711224489795,
      842.5647222222223,  843.6583219954649,  708.9295634920635,
      709.8500340136054,  710.7705045351474,  711.6909750566894,
      610.6985544217687,  611.4924376417233,  612.286320861678,
      613.0802040816327,  727.1961734693876,  728.1393764172336,
      729.0825793650794,  730.0257823129252,  863.806887755102,
      864.9242970521542,  866.0417063492063,  867.1591156462586,
      1028.5759353741494, 1029.9023922902495, 1031.2288492063492,
      1032.555306122449,  1035.8926020408162, 1037.219058956916,
      1038.5455158730158, 1039.8719727891157, 875.304506802721,
      876.4219160997732,  877.5393253968255,  878.6567346938775,
      740.784268707483,   741.7274716553287,  742.6706746031746,
      743.6138775510204,  624.8839285714286,  625.6778117913832,
      626.4716950113379,  627.2655782312925,  537.1261054421768,
      537.811485260771,   538.4968650793651,  539.1822448979592,
      639.5624999999999,  640.3767913832199,  641.1910827664398,
      642.0053741496598,  759.6732142857142,  760.6379024943311,
      761.6025907029479,  762.5672789115646,  904.5279761904761,
      905.6731405895691,  906.8183049886621,  907.9634693877553,
      910.8446428571427,  911.9898072562357,  913.1349716553289,
      914.2801360544219,  769.5994047619048,  770.5640929705215,
      771.5287811791384,  772.493469387755,   651.2934523809523,
      652.1077437641724,  652.9220351473923,  653.7363265306121,
      549.3727040816327,  550.0580839002267,  550.7434637188209,
      551.428843537415,   460.0815476190476,  460.6584240362812,
      461.2353004535147,  461.81217687074826, 547.803656462585,
      548.4890362811792,  549.1744160997731,  549.8597959183674,
      650.6524659863944,  651.464433106576,   652.2764002267573,
      653.0883673469386,  774.678656462585,   775.6425283446712,
      776.6064002267574,  777.5702721088434,  779.9953231292516,
      780.9591950113379,  781.9230668934241,  782.8869387755101,
      659.0072278911565,  659.8191950113379,  660.6311621315192,
      661.4431292517006,  557.6774659863945,  558.3628458049886,
      559.0482256235828,  559.7336054421769,  470.38937074829937,
      470.9662471655329,  471.54312358276644, 472.12};
  const std::array<int, 4> in_shape = {{3, 9, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.12244897959183672,
      0.16326530612244897, 0.20408163265306123, 0.24489795918367346,
      0.12244897959183672, 0.16326530612244897, 0.20408163265306123,
      0.24489795918367346, 0.1020408163265306,  0.12244897959183673,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.2857142857142857,  0.32653061224489793,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.36734693877551017, 0.40816326530612246, 0.44897959183673464,
      0.4897959183673469,  0.5510204081632653,  0.6122448979591836,
      0.673469387755102,   0.7346938775510203,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  0.7959183673469388,
      0.8571428571428571,  0.9183673469387754,  0.9795918367346939,
      0.5510204081632653,  0.6122448979591836,  0.673469387755102,
      0.7346938775510203,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  0.7959183673469388,  0.8571428571428571,
      0.9183673469387754,  0.9795918367346939,  0.5510204081632653,
      0.6122448979591836,  0.673469387755102,   0.7346938775510203,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      0.7959183673469388,  0.8571428571428571,  0.9183673469387754,
      0.9795918367346939,  0.5510204081632653,  0.6122448979591836,
      0.673469387755102,   0.7346938775510203,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  0.7959183673469388,
      0.8571428571428571,  0.9183673469387754,  0.9795918367346939,
      0.5510204081632653,  0.6122448979591836,  0.673469387755102,
      0.7346938775510203,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  0.7959183673469388,  0.8571428571428571,
      0.9183673469387754,  0.9795918367346939,  0.5306122448979591,
      0.5714285714285714,  0.6122448979591837,  0.6530612244897959,
      1.2244897959183674,  1.3061224489795917,  1.387755102040816,
      1.4693877551020407,  1.2244897959183674,  1.3061224489795917,
      1.387755102040816,   1.4693877551020407,  1.2244897959183674,
      1.3061224489795917,  1.387755102040816,   1.4693877551020407,
      1.2244897959183674,  1.3061224489795917,  1.387755102040816,
      1.4693877551020407,  1.2244897959183674,  1.3061224489795917,
      1.387755102040816,   1.4693877551020407,  1.2244897959183674,
      1.3061224489795917,  1.387755102040816,   1.4693877551020407,
      0.693877551020408,   0.7346938775510203,  0.7755102040816326,
      0.8163265306122449,  0.3469387755102041,  0.36734693877551017,
      0.3877551020408163,  0.4081632653061224,  0.7755102040816326,
      0.8163265306122448,  0.8571428571428571,  0.8979591836734693,
      0.7755102040816326,  0.8163265306122448,  0.8571428571428571,
      0.8979591836734693,  0.7755102040816326,  0.8163265306122448,
      0.8571428571428571,  0.8979591836734693,  0.7755102040816326,
      0.8163265306122448,  0.8571428571428571,  0.8979591836734693,
      0.7755102040816326,  0.8163265306122448,  0.8571428571428571,
      0.8979591836734693,  0.7755102040816326,  0.8163265306122448,
      0.8571428571428571,  0.8979591836734693,  0.42857142857142855,
      0.44897959183673464, 0.4693877551020408,  0.4897959183673469,
      0.5102040816326531,  0.5306122448979591,  0.5510204081632653,
      0.5714285714285714,  1.1020408163265305,  1.1428571428571428,
      1.183673469387755,   1.2244897959183674,  1.1020408163265305,
      1.1428571428571428,  1.183673469387755,   1.2244897959183674,
      1.1020408163265305,  1.1428571428571428,  1.183673469387755,
      1.2244897959183674,  1.1020408163265305,  1.1428571428571428,
      1.183673469387755,   1.2244897959183674,  1.1020408163265305,
      1.1428571428571428,  1.183673469387755,   1.2244897959183674,
      1.1020408163265305,  1.1428571428571428,  1.183673469387755,
      1.2244897959183674,  0.5918367346938775,  0.6122448979591836,
      0.6326530612244897,  0.6530612244897959,  1.183673469387755,
      1.2244897959183674,  1.2653061224489794,  1.3061224489795917,
      2.5306122448979593,  2.6122448979591835,  2.693877551020408,
      2.7755102040816326,  2.5306122448979593,  2.6122448979591835,
      2.693877551020408,   2.7755102040816326,  2.5306122448979593,
      2.6122448979591835,  2.693877551020408,   2.7755102040816326,
      2.5306122448979593,  2.6122448979591835,  2.693877551020408,
      2.7755102040816326,  2.5306122448979593,  2.6122448979591835,
      2.693877551020408,   2.7755102040816326,  2.5306122448979593,
      2.6122448979591835,  2.693877551020408,   2.7755102040816326,
      1.346938775510204,   1.387755102040816,   1.4285714285714284,
      1.4693877551020407,  2.020408163265306,   2.0816326530612246,
      2.142857142857143,   2.204081632653061,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   2.2653061224489797,
      2.3265306122448974,  2.387755102040816,   2.4489795918367347,
      2.020408163265306,   2.0816326530612246,  2.142857142857143,
      2.204081632653061,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   2.2653061224489797,  2.3265306122448974,
      2.387755102040816,   2.4489795918367347,  2.020408163265306,
      2.0816326530612246,  2.142857142857143,   2.204081632653061,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      2.2653061224489797,  2.3265306122448974,  2.387755102040816,
      2.4489795918367347,  2.020408163265306,   2.0816326530612246,
      2.142857142857143,   2.204081632653061,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   2.2653061224489797,
      2.3265306122448974,  2.387755102040816,   2.4489795918367347,
      2.020408163265306,   2.0816326530612246,  2.142857142857143,
      2.204081632653061,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   2.2653061224489797,  2.3265306122448974,
      2.387755102040816,   2.4489795918367347,  1.510204081632653,
      1.5510204081632653,  1.5918367346938775,  1.6326530612244896,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      1.673469387755102,   1.7142857142857142,  1.7551020408163263,
      1.7959183673469385,  0.836734693877551,   0.8571428571428571,
      0.8775510204081632,  0.8979591836734693,  1.7551020408163263,
      1.7959183673469385,  1.8367346938775508,  1.8775510204081631,
      1.7551020408163263,  1.7959183673469385,  1.8367346938775508,
      1.8775510204081631,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  1.7551020408163263,
      1.7959183673469385,  1.8367346938775508,  1.8775510204081631,
      1.7551020408163263,  1.7959183673469385,  1.8367346938775508,
      1.8775510204081631,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  0.9183673469387754,
      0.9387755102040816,  0.9591836734693877,  0.9795918367346939,
      0.9999999999999999,  1.0204081632653061,  1.040816326530612,
      1.0612244897959182,  2.081632653061224,   2.1224489795918364,
      2.1632653061224487,  2.204081632653061,   2.081632653061224,
      2.1224489795918364,  2.1632653061224487,  2.204081632653061,
      2.081632653061224,   2.1224489795918364,  2.1632653061224487,
      2.204081632653061,   2.081632653061224,   2.1224489795918364,
      2.1632653061224487,  2.204081632653061,   2.081632653061224,
      2.1224489795918364,  2.1632653061224487,  2.204081632653061,
      2.081632653061224,   2.1224489795918364,  2.1632653061224487,
      2.204081632653061,   1.0816326530612244,  1.1020408163265305,
      1.1224489795918366,  1.1428571428571428,  2.1632653061224487,
      2.204081632653061,   2.2448979591836733,  2.2857142857142856,
      4.489795918367346,   4.571428571428571,   4.653061224489796,
      4.7346938775510194,  4.489795918367346,   4.571428571428571,
      4.653061224489796,   4.7346938775510194,  4.489795918367346,
      4.571428571428571,   4.653061224489796,   4.7346938775510194,
      4.489795918367346,   4.571428571428571,   4.653061224489796,
      4.7346938775510194,  4.489795918367346,   4.571428571428571,
      4.653061224489796,   4.7346938775510194,  4.489795918367346,
      4.571428571428571,   4.653061224489796,   4.7346938775510194,
      2.3265306122448974,  2.36734693877551,    2.408163265306122,
      2.4489795918367347,  3.4897959183673466,  3.5510204081632653,
      3.6122448979591835,  3.6734693877551017,  7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   3.7346938775510194,
      3.7959183673469385,  3.8571428571428568,  3.9183673469387754,
      3.4897959183673466,  3.5510204081632653,  3.6122448979591835,
      3.6734693877551017,  7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   3.7346938775510194,  3.7959183673469385,
      3.8571428571428568,  3.9183673469387754,  3.4897959183673466,
      3.5510204081632653,  3.6122448979591835,  3.6734693877551017,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      3.7346938775510194,  3.7959183673469385,  3.8571428571428568,
      3.9183673469387754,  3.4897959183673466,  3.5510204081632653,
      3.6122448979591835,  3.6734693877551017,  7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   3.7346938775510194,
      3.7959183673469385,  3.8571428571428568,  3.9183673469387754,
      3.4897959183673466,  3.5510204081632653,  3.6122448979591835,
      3.6734693877551017,  7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   3.7346938775510194,  3.7959183673469385,
      3.8571428571428568,  3.9183673469387754,  2.4897959183673466,
      2.5306122448979593,  2.571428571428571,   2.6122448979591835,
      5.142857142857142,   5.224489795918368,   5.3061224489795915,
      5.387755102040816,   5.142857142857142,   5.224489795918368,
      5.3061224489795915,  5.387755102040816,   5.142857142857142,
      5.224489795918368,   5.3061224489795915,  5.387755102040816,
      5.142857142857142,   5.224489795918368,   5.3061224489795915,
      5.387755102040816,   5.142857142857142,   5.224489795918368,
      5.3061224489795915,  5.387755102040816,   5.142857142857142,
      5.224489795918368,   5.3061224489795915,  5.387755102040816,
      2.6530612244897958,  2.6938775510204076,  2.7346938775510203,
      2.775510204081632,   1.3265306122448979,  1.346938775510204,
      1.3673469387755102,  1.3877551020408163,  2.7346938775510203,
      2.775510204081632,   2.816326530612245,   2.8571428571428568,
      2.7346938775510203,  2.775510204081632,   2.816326530612245,
      2.8571428571428568,  2.7346938775510203,  2.775510204081632,
      2.816326530612245,   2.8571428571428568,  2.7346938775510203,
      2.775510204081632,   2.816326530612245,   2.8571428571428568,
      2.7346938775510203,  2.775510204081632,   2.816326530612245,
      2.8571428571428568,  2.7346938775510203,  2.775510204081632,
      2.816326530612245,   2.8571428571428568,  1.4081632653061222,
      1.4285714285714284,  1.4489795918367345,  1.4693877551020407};
  const std::array<int, 4> in_shape = {{3, 9, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.882772108843537,  9.66202380952381,   11.549778911564626,
      13.87874716553288,  14.47124716553288,  16.30922335600907,
      14.486604308390024, 12.815856009070295, 11.036604308390022,
      12.034812925170067, 14.65079931972789,  17.395697278911566,
      20.748475056689344, 21.276689342403625, 23.63609410430839,
      20.884903628117918, 18.39782879818594,  15.781842403628119,
      17.163384353741495, 20.799778911564623, 24.58549319727891,
      29.176366213151926, 29.57600907029478,  32.52112811791383,
      28.627080498866217, 25.14000566893424,  21.50361111111111,
      24.286003401360542, 29.327159863945575, 34.54144557823129,
      40.826763038548755, 41.001405895691605, 44.70485827664399,
      39.227477324263035, 34.359450113378685, 29.318293650793645,
      33.76993197278911,  40.57537414965986,  47.54680272108843,
      55.87378684807257,  55.35092970521542,  59.59188208616779,
      52.039501133786835, 45.40004535147391,  38.59460317460317,
      46.16028911564626,  55.31573129251701,  64.64430272108844,
      75.7296201814059,   74.46426303854875,  79.60771541950113,
      69.33033446712017,  60.34802154195011,  51.19257936507936,
      43.59481292517007,  52.20263605442177,  60.95977891156462,
      71.35065192743765,  70.0102947845805,   74.69541383219953,
      65.00136621315193,  56.54286281179137,  47.935039682539674,
      40.419302721088435, 48.374064625850345, 56.457738095238085,
      66.0390873015873,   64.69873015873014,  68.92670634920634,
      59.94694444444444,  52.12109410430838,  44.16633219954649,
      36.2672619047619,   43.385289115646266, 50.61181972789116,
      59.169359410430836, 57.89328798185941,  61.59983560090703,
      53.54864512471655,  46.539121315192745, 39.421094104308395,
      54.60976190476192,  65.17778911564626,  75.85431972789115,
      88.43685941043083,  85.9532879818594,   90.86733560090704,
      78.79114512471655,  68.33162131519275,  57.763594104308396,
      67.55057823129252,  80.60840136054424,  93.79513605442176,
      109.33005668934238, 106.20362811791384, 112.21767573696147,
      97.2843424036281,   84.35543083900227,  71.29760770975057,
      81.46792517006803,  97.19921768707485,  113.07982993197278,
      131.78141723356006, 127.94784580498866, 135.12617913832202,
      117.12141723356007, 101.53944444444444, 85.80815192743763,
      98.8441156462585,   117.90874149659865, 137.14649659863946,
      159.79252834467118, 155.05895691609982, 163.6706235827665,
      141.8325283446712,  122.94103174603174, 103.8764058956916,
      105.25197278911564, 125.50231292517007, 145.9186394557823,
      169.93133786848074, 164.7027664399093,  173.64943310657597,
      150.41133786848073, 130.32698412698412, 110.0766439909297,
      120.71840136054422, 143.89731292517007, 167.24935374149658,
      194.6953854875283,  188.5218140589569,  198.57348072562357,
      171.93538548752832, 148.92960317460316, 125.75069160997732,
      107.8993537414966,  128.60207482993198, 149.4541156462585,
      173.95570294784577, 168.38213151927437, 177.3004648526077,
      153.49570294784579, 132.94230158730159, 112.2395804988662,
      95.93506802721089,  114.33166666666668, 132.8571768707483,
      154.62066893424034, 149.62566893424037, 157.5082879818594,
      136.34638321995465, 118.07869614512472, 99.68209750566893,
      82.99425170068028,  98.9010544217687,   114.9163605442177,
      133.7274716553288,  129.37532879818596, 136.15794784580498,
      117.8531859410431,  102.05488662131519, 86.14808390022675,
      101.33675170068027, 120.6935544217687,  140.1588605442177,
      162.99497165532878, 157.43532879818596, 165.42544784580502,
      143.0956859410431,  123.84738662131518, 104.49058390022677,
      123.06634353741497, 146.56600340136052, 170.19457482993198,
      197.91163832199544, 191.13056689342403, 200.7992573696145,
      173.6837811791383,  150.31303287981856, 126.81337301587303,
      145.77246598639454, 173.59865646258498, 201.57416666666666,
      234.38646825396822, 226.31968253968253, 237.73123015873017,
      205.61575396825396, 177.93888321995465, 150.1126927437642,
      173.40222789115646, 206.49032312925166, 239.7515476190476,
      278.75829365079363, 269.1165079365079,  282.6363888888889,
      244.43757936507936, 211.5226133786848,  178.4345181405896,
      176.73401360544221, 210.42925170068034, 244.29047619047623,
      283.98888888888894, 274.05460317460324, 287.70698412698414,
      248.78317460317461, 215.25392290249434, 181.5586848072562,
      195.27651360544218, 232.47889455782317, 269.8544047619048,
      313.66115079365085, 302.5793650793651,  317.5392460317461,
      274.5404365079365,  237.51118480725617, 200.30880385487526,
      172.20389455782313, 205.0015136054422,  237.94845238095243,
      276.560753968254,   266.75396825396825, 279.9055158730158,
      241.99003968253965, 209.34174036281175, 176.5441213151927,
      151.45083333333332, 180.289268707483,   209.2566156462585,
      243.20225056689344, 234.55260770975053, 246.08986961451242,
      212.7458219954648,  184.036298185941,   155.1978628117914,
      129.72124149659862, 154.41681972789115, 179.22090136054422,
      208.28558390022675, 200.85736961451246, 210.7160600907029,
      182.1577267573696,  157.57065192743764, 132.87507369614514};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.061224489795918366,
                                         0.12244897959183673,
                                         0.12244897959183673,
                                         0.12244897959183673,
                                         0.12244897959183673,
                                         0.12244897959183673,
                                         0.10204081632653061,
                                         0.061224489795918366,
                                         0.1020408163265306,
                                         0.24489795918367346,
                                         0.4285714285714286,
                                         0.4285714285714286,
                                         0.4285714285714286,
                                         0.4285714285714286,
                                         0.4285714285714286,
                                         0.326530612244898,
                                         0.18367346938775508,
                                         0.24489795918367346,
                                         0.5510204081632653,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.673469387755102,
                                         0.36734693877551017,
                                         0.24489795918367346,
                                         0.5510204081632653,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.673469387755102,
                                         0.36734693877551017,
                                         0.24489795918367346,
                                         0.5510204081632653,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.673469387755102,
                                         0.36734693877551017,
                                         0.24489795918367346,
                                         0.5510204081632653,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.673469387755102,
                                         0.36734693877551017,
                                         0.24489795918367346,
                                         0.5510204081632653,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.9183673469387754,
                                         0.673469387755102,
                                         0.36734693877551017,
                                         0.22448979591836732,
                                         0.4897959183673469,
                                         0.7959183673469388,
                                         0.7959183673469388,
                                         0.7959183673469388,
                                         0.7959183673469388,
                                         0.7959183673469388,
                                         0.5714285714285714,
                                         0.30612244897959184,
                                         0.14285714285714285,
                                         0.30612244897959184,
                                         0.4897959183673469,
                                         0.4897959183673469,
                                         0.4897959183673469,
                                         0.4897959183673469,
                                         0.4897959183673469,
                                         0.346938775510204,
                                         0.18367346938775508,
                                         0.2040816326530612,
                                         0.4285714285714285,
                                         0.6734693877551019,
                                         0.6734693877551019,
                                         0.6734693877551019,
                                         0.6734693877551019,
                                         0.6734693877551019,
                                         0.4693877551020408,
                                         0.24489795918367346,
                                         0.4693877551020408,
                                         0.9795918367346937,
                                         1.5306122448979589,
                                         1.5306122448979589,
                                         1.5306122448979589,
                                         1.5306122448979589,
                                         1.5306122448979589,
                                         1.0612244897959182,
                                         0.5510204081632653,
                                         0.7959183673469388,
                                         1.6530612244897958,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         1.7755102040816324,
                                         0.9183673469387754,
                                         0.7959183673469388,
                                         1.6530612244897958,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         1.7755102040816324,
                                         0.9183673469387754,
                                         0.7959183673469388,
                                         1.6530612244897958,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         1.7755102040816324,
                                         0.9183673469387754,
                                         0.7959183673469388,
                                         1.6530612244897958,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         1.7755102040816324,
                                         0.9183673469387754,
                                         0.7959183673469388,
                                         1.6530612244897958,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         1.7755102040816324,
                                         0.9183673469387754,
                                         0.5918367346938775,
                                         1.2244897959183672,
                                         1.897959183673469,
                                         1.897959183673469,
                                         1.897959183673469,
                                         1.897959183673469,
                                         1.897959183673469,
                                         1.3061224489795917,
                                         0.6734693877551019,
                                         0.32653061224489793,
                                         0.673469387755102,
                                         1.0408163265306123,
                                         1.0408163265306123,
                                         1.0408163265306123,
                                         1.0408163265306123,
                                         1.0408163265306123,
                                         0.7142857142857142,
                                         0.36734693877551017,
                                         0.3877551020408163,
                                         0.7959183673469388,
                                         1.2244897959183674,
                                         1.2244897959183674,
                                         1.2244897959183674,
                                         1.2244897959183674,
                                         1.2244897959183674,
                                         0.836734693877551,
                                         0.42857142857142855,
                                         0.836734693877551,
                                         1.714285714285714,
                                         2.63265306122449,
                                         2.63265306122449,
                                         2.63265306122449,
                                         2.63265306122449,
                                         2.63265306122449,
                                         1.7959183673469385,
                                         0.9183673469387754,
                                         1.346938775510204,
                                         2.7551020408163263,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         2.8775510204081627,
                                         1.4693877551020407,
                                         1.346938775510204,
                                         2.7551020408163263,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         2.8775510204081627,
                                         1.4693877551020407,
                                         1.346938775510204,
                                         2.7551020408163263,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         2.8775510204081627,
                                         1.4693877551020407,
                                         1.346938775510204,
                                         2.7551020408163263,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         2.8775510204081627,
                                         1.4693877551020407,
                                         1.346938775510204,
                                         2.7551020408163263,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         4.224489795918367,
                                         2.8775510204081627,
                                         1.4693877551020407,
                                         0.9591836734693877,
                                         1.9591836734693875,
                                         3.,
                                         3.,
                                         3.,
                                         3.,
                                         3.,
                                         2.040816326530612,
                                         1.0408163265306123,
                                         0.5102040816326531,
                                         1.0408163265306123,
                                         1.5918367346938775,
                                         1.5918367346938775,
                                         1.5918367346938775,
                                         1.5918367346938775,
                                         1.5918367346938775,
                                         1.0816326530612244,
                                         0.5510204081632653};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.188667800453512, 15.765544217687074, 18.63866780045351,
      19.32404761904762,  22.3056746031746,   23.099557823129253,
      26.837023809523814, 27.75749433106576,  28.060000000000002,
      28.94249433106576,  31.697976190476187, 32.61844671201814,
      28.179325396825394, 28.97320861678005,  24.946332199546482,
      25.63171201814059,  21.496332199546483, 22.073208616780043,
      23.384246031746027, 24.069625850340135, 28.487307256235823,
      29.30159863945578,  33.84819160997732,  34.79139455782313,
      40.403350340136065, 41.49695011337869,  41.50489795918368,
      42.55337868480725,  46.17858843537415,  47.27218820861678,
      40.826604308390024, 41.769807256235836, 35.98136621315193,
      36.79565759637188,  30.878304988662126, 31.563684807256237,
      33.53288548752834,  34.32676870748299,  40.65635487528344,
      41.599557823129246, 48.078463718820856, 49.17098639455782,
      57.08600340136055,  58.35273242630385,  57.937551020408165,
      59.15201814058956,  63.77552721088435,  65.04225623582767,
      56.16163832199546,  57.254160997732434, 49.336808390022675,
      50.28001133786848,  42.21333900226756,  43.00722222222222,
      47.65153628117913,  48.572006802721084, 57.56071995464852,
      58.65431972789115,  67.81616213151926,  69.08289115646258,
      80.18481292517008,  81.65352607709751,  80.59469387755102,
      82.00281179138321,  87.94100340136053,  89.40971655328798,
      77.18822562358275,  78.45495464852607,  67.62530045351474,
      68.71890022675737,  57.71611678004534,  58.63658730158729,
      66.65736961451248,  67.53986394557822,  80.10226757369614,
      81.15074829931972,  93.87913832199544,  95.09360544217687,
      110.33945578231291, 111.74757369614514, 109.35183673469386,
      110.70185941043084, 117.77564625850339, 119.18376417233559,
      102.86453514739229, 104.07900226757367, 89.75160997732426,
      90.80009070294783,  76.30671201814059,  77.18920634920634,
      91.40010770975054,  92.32057823129252,  109.53786281179136,
      110.63146258503401, 128.02187641723353, 129.28860544217687,
      149.99052721088432, 151.4592403628118,  147.52040816326524,
      148.9285260770975,  157.74671768707478, 159.21543083900227,
      137.39393990929705, 138.66066893424033, 119.60244331065762,
      120.69604308390022, 101.46468820861679, 102.38515873015872,
      86.39574263038547,  87.18962585034014,  103.46206916099773,
      104.40527210884353, 120.82703514739227, 121.91955782312924,
      141.4345748299319,  142.7013038548753,  138.80612244897955,
      140.020589569161,   148.12409863945575, 149.39082766439907,
      128.91020975056688, 130.00273242630385, 112.14252267573697,
      113.08572562358275, 95.07619614512473,  95.87007936507935,
      80.15322562358276,  80.83860544217687,  95.9338378684807,
      96.74812925170069,  111.97227324263038, 112.91547619047617,
      130.98457482993197, 132.0781746031746,  128.34897959183675,
      129.3974603174603,  136.75981292517008, 137.85341269841268,
      118.95068594104309, 119.89388888888888, 103.42789682539683,
      104.24218820861677, 87.64728458049886,  88.33266439909298,
      71.95764739229024,  72.5345238095238,   86.08519841269838,
      86.77057823129253,  100.42975623582764, 101.22363945578232,
      117.41824829931971, 118.33871882086167, 114.90408163265303,
      115.78657596371882, 122.2792006802721,  123.19967120181406,
      106.30340702947845, 107.0972902494331,  92.39286281179139,
      93.07824263038549,  78.26531179138321,  78.84218820861679,
      108.64264739229024, 109.21952380952384, 129.67019841269843,
      130.35557823129253, 150.91475623582767, 151.7086394557823,
      175.95324829931974, 176.87371882086165, 171.0240816326531,
      171.9065759637188,  180.81420068027214, 181.73467120181408,
      156.78840702947846, 157.5822902494331,  135.97786281179137,
      136.6632426303855,  114.9503117913832,  115.52718820861679,
      134.4157766439909,  135.10115646258504, 160.4025113378685,
      161.21680272108847, 186.64706916099775, 187.59027210884352,
      217.5665136054422,  218.66011337868477, 211.3587755102041,
      212.40725623582767, 223.34175170068028, 224.43535147392294,
      193.62548185941046, 194.5686848072562,  167.89657029478457,
      168.71086167800453, 141.909835600907,   142.59521541950113,
      162.14196712018136, 162.93585034013606, 193.45523242630387,
      194.3984353741497,  225.06713718820862, 226.15965986394556,
      262.2961054421769,  263.5628344671201,  254.68122448979594,
      255.89569160997732, 268.98562925170063, 270.25235827664403,
      233.15031179138325, 234.24283446712013, 202.13568594104308,
      203.07888888888888, 170.8224206349206,  171.61630385487527,
      196.767760770975,   197.688231292517,   234.72388321995464,
      235.8174829931973,  273.02626417233563, 274.2929931972789,
      318.11634353741505, 319.58505668934237, 308.7097959183674,
      310.11791383219963, 325.8725340136054,  327.341247165533,
      282.39832766439906, 283.6650566893424,  244.78846371882088,
      245.88206349206348, 206.83234126984127, 207.7528117913832,
      209.62145124716548, 210.50394557823128, 249.9561451247165,
      251.00462585034015, 290.6228117913831,  291.8372789115646,
      338.45455782312916, 339.8626757369615,  328.05551020408154,
      329.4055328798186,  345.8907482993197,  347.29886621315194,
      299.6082086167801,  300.82267573696146, 259.60548752834467,
      260.65396825396823, 219.27079365079365, 220.1532879818594,
      240.5163321995465,  241.43680272108844, 286.7010260770975,
      287.79462585034014, 333.2319784580498,  334.49870748299315,
      387.9220578231292,  389.3907709750566,  375.63551020408164,
      377.0436281179138,  395.67824829931976, 397.14696145124714,
      342.60404195011347, 343.87077097505664, 296.7656065759638,
      297.8592063492063,  250.5809126984127,  251.50138321995465,
      215.0048242630385,  215.7987074829932,  256.2609467120181,
      257.20414965986396, 297.81570861678,    298.908231292517,
      346.64467687074824, 347.91140589569153, 335.5497959183674,
      336.76426303854873, 353.3342006802721,  354.6009297052154,
      305.89888321995466, 306.99140589569157, 264.9414002267574,
      265.88460317460317, 223.6852777777778,  224.4791609977324,
      191.18475623582765, 191.87013605442178, 227.84904195011336,
      228.66333333333336, 264.77115079365075, 265.7143537414966,
      308.1477380952381,  309.2413378684807,  298.20285714285706,
      299.25133786848073, 313.9229761904763,  315.0165759637188,
      271.7495634920635,  272.6927664399093,  235.34310090702948,
      236.15739229024945, 198.67881519274377, 199.36419501133787,
      165.41162698412697, 165.98850340136056, 197.11672902494328,
      197.8021088435374,  229.03883786848073, 229.8327210884354,
      266.5344727891156,  267.4549433106576,  257.8681632653061,
      258.7506575963719,  271.39542517006805, 272.31589569160997,
      234.9124886621315,  235.7063718820862,  203.42439342403628,
      204.10977324263038, 171.71929138321997, 172.2961678004535,
      202.096626984127,   202.67350340136053, 240.70172902494326,
      241.3871088435374,  279.52383786848077, 280.3177210884354,
      325.0694727891156,  325.98994331065757, 313.98816326530607,
      314.8706575963719,  329.93042517006796, 330.85089569161005,
      285.3974886621315,  286.1913718820862,  247.00939342403626,
      247.69477324263036, 208.40429138321997, 208.98116780045353,
      245.44730725623583, 246.13268707482993, 292.31771541950104,
      293.13200680272104, 339.44594671201816, 340.38914965986396,
      394.7296768707482,  395.8232766439909,  381.2126530612244,
      382.26113378684806, 400.5049149659863,  401.598514739229,
      346.4243594104308,  347.3675623582766,  299.8117743764172,
      300.62606575963713, 252.94136621315192, 253.62674603174605,
      290.75104875283444, 291.5449319727891,  346.25410997732416,
      347.19731292516997, 402.0558106575964,  403.1483333333333,
      467.50620748299315, 468.77293650793644, 451.4248979591836,
      452.63936507936506, 474.195731292517,   475.46246031746034,
      410.138985260771,   411.2315079365079,  354.93456349206355,
      355.8777664399093,  299.43150226757376, 300.2253854875284,
      345.883985260771,   346.8044557823129,  411.8870464852607,
      412.9806462585033,  478.236366213152,   479.5030952380952,
      556.0478741496598,  557.5165873015873,  536.8248979591837,
      538.2330158730158,  563.8040646258504,  565.2727777777778,
      487.60842970521537, 488.8751587301587,  421.95162698412696,
      423.0452267573696,  355.9485657596372,  356.8690362811792,
      352.5855328798187,  353.46802721088443, 419.81002267573706,
      420.8585034013607,  487.366485260771,   488.58095238095245,
      566.5696598639456,  567.9777777777779,  546.7591836734694,
      548.1092063492065,  574.005850340136,   575.4139682539683,
      496.35188208616785, 497.56634920634923, 429.459365079365,
      430.5078458049887,  362.2348752834467,  363.1173696145124,
      389.6325566893425,  390.55302721088435, 463.8641893424037,
      464.95778911564634, 538.4420804988663,  539.7088095238096,
      625.8535884353743,  627.3223015873017,  603.750612244898,
      605.1587301587302,  633.6097789115647,  635.0784920634921,
      547.8141439909297,  549.080873015873,   473.9287698412698,
      475.02236961451234, 399.6971371882086,  400.61760770975053,
      343.61390589569163, 344.40778911564627, 409.05982426303854,
      410.0030272108844,  474.8043820861678,  475.89690476190486,
      551.8547789115646,  553.121507936508,   532.2934693877552,
      533.5079365079365,  558.5443027210885,  559.8110317460316,
      482.88755668934243, 483.9800793650793,  417.7402777777778,
      418.6834807256235,  352.29435941043084, 353.0882426303854,
      302.21628684807257, 302.90166666666664, 359.76424603174604,
      360.578537414966,   417.5700283446712,  418.513231292517,
      485.3109013605442,  486.4045011337869,  468.05673469387756,
      469.10521541950106, 491.0861394557823,  492.17973922902485,
      424.5484410430839,  425.4916439909296,  367.2583049886621,
      368.072596371882,   309.71034580498866, 310.3957256235828,
      258.8656065759637,  259.44248299319725, 308.1482596371882,
      308.8336394557823,  357.64791950113374, 358.44180272108844,
      415.65069727891154, 416.5711678004535,  400.8322448979592,
      401.71473922902493, 420.5116496598639,  421.4321201814058,
      363.52157029478457, 364.3154535147392,  314.45592403628115,
      315.1413038548753,  265.17327097505665, 265.7501473922903};
  const std::array<int, 4> in_shape = {{3, 9, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.04081632653061224,
                                         0.08163265306122448,
                                         0.12244897959183673,
                                         0.18367346938775508,
                                         0.24489795918367346,
                                         0.18367346938775508,
                                         0.24489795918367346,
                                         0.18367346938775508,
                                         0.24489795918367346,
                                         0.18367346938775508,
                                         0.24489795918367346,
                                         0.18367346938775508,
                                         0.24489795918367346,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.1020408163265306,
                                         0.12244897959183673,
                                         0.16326530612244897,
                                         0.2040816326530612,
                                         0.4081632653061224,
                                         0.4897959183673469,
                                         0.7346938775510203,
                                         0.8571428571428572,
                                         0.7346938775510203,
                                         0.8571428571428572,
                                         0.7346938775510203,
                                         0.8571428571428572,
                                         0.7346938775510203,
                                         0.8571428571428572,
                                         0.7346938775510203,
                                         0.8571428571428572,
                                         0.5714285714285714,
                                         0.653061224489796,
                                         0.32653061224489793,
                                         0.36734693877551017,
                                         0.4285714285714285,
                                         0.4897959183673469,
                                         0.9795918367346936,
                                         1.1020408163265305,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.2244897959183672,
                                         1.346938775510204,
                                         0.673469387755102,
                                         0.7346938775510203,
                                         0.4285714285714285,
                                         0.4897959183673469,
                                         0.9795918367346936,
                                         1.1020408163265305,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.2244897959183672,
                                         1.346938775510204,
                                         0.673469387755102,
                                         0.7346938775510203,
                                         0.4285714285714285,
                                         0.4897959183673469,
                                         0.9795918367346936,
                                         1.1020408163265305,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.2244897959183672,
                                         1.346938775510204,
                                         0.673469387755102,
                                         0.7346938775510203,
                                         0.4285714285714285,
                                         0.4897959183673469,
                                         0.9795918367346936,
                                         1.1020408163265305,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.2244897959183672,
                                         1.346938775510204,
                                         0.673469387755102,
                                         0.7346938775510203,
                                         0.4285714285714285,
                                         0.4897959183673469,
                                         0.9795918367346936,
                                         1.1020408163265305,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.6530612244897958,
                                         1.8367346938775508,
                                         1.2244897959183672,
                                         1.346938775510204,
                                         0.673469387755102,
                                         0.7346938775510203,
                                         0.4081632653061224,
                                         0.44897959183673464,
                                         0.8979591836734693,
                                         0.9795918367346939,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         0.5714285714285714,
                                         0.6122448979591837,
                                         0.26530612244897955,
                                         0.2857142857142857,
                                         0.5714285714285714,
                                         0.6122448979591837,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         0.6530612244897959,
                                         0.693877551020408,
                                         0.3469387755102041,
                                         0.36734693877551017,
                                         0.3877551020408163,
                                         0.4081632653061224,
                                         0.8163265306122449,
                                         0.857142857142857,
                                         1.2857142857142856,
                                         1.3469387755102038,
                                         1.2857142857142856,
                                         1.3469387755102038,
                                         1.2857142857142856,
                                         1.3469387755102038,
                                         1.2857142857142856,
                                         1.3469387755102038,
                                         1.2857142857142856,
                                         1.3469387755102038,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.4693877551020408,
                                         0.4897959183673469,
                                         0.8979591836734694,
                                         0.9387755102040816,
                                         1.8775510204081631,
                                         1.9591836734693875,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         2.040816326530612,
                                         2.1224489795918364,
                                         1.0612244897959182,
                                         1.1020408163265305,
                                         1.530612244897959,
                                         1.5918367346938775,
                                         3.183673469387755,
                                         3.3061224489795915,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         3.428571428571428,
                                         3.551020408163265,
                                         1.7755102040816324,
                                         1.8367346938775508,
                                         1.530612244897959,
                                         1.5918367346938775,
                                         3.183673469387755,
                                         3.3061224489795915,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         3.428571428571428,
                                         3.551020408163265,
                                         1.7755102040816324,
                                         1.8367346938775508,
                                         1.530612244897959,
                                         1.5918367346938775,
                                         3.183673469387755,
                                         3.3061224489795915,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         3.428571428571428,
                                         3.551020408163265,
                                         1.7755102040816324,
                                         1.8367346938775508,
                                         1.530612244897959,
                                         1.5918367346938775,
                                         3.183673469387755,
                                         3.3061224489795915,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         3.428571428571428,
                                         3.551020408163265,
                                         1.7755102040816324,
                                         1.8367346938775508,
                                         1.530612244897959,
                                         1.5918367346938775,
                                         3.183673469387755,
                                         3.3061224489795915,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         4.959183673469387,
                                         5.142857142857142,
                                         3.428571428571428,
                                         3.551020408163265,
                                         1.7755102040816324,
                                         1.8367346938775508,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         2.36734693877551,
                                         2.4489795918367343,
                                         3.6734693877551017,
                                         3.795918367346938,
                                         3.6734693877551017,
                                         3.795918367346938,
                                         3.6734693877551017,
                                         3.795918367346938,
                                         3.6734693877551017,
                                         3.795918367346938,
                                         3.6734693877551017,
                                         3.795918367346938,
                                         2.5306122448979593,
                                         2.6122448979591835,
                                         1.3061224489795917,
                                         1.3469387755102038,
                                         0.6326530612244897,
                                         0.6530612244897959,
                                         1.3061224489795917,
                                         1.346938775510204,
                                         2.020408163265306,
                                         2.0816326530612246,
                                         2.020408163265306,
                                         2.0816326530612246,
                                         2.020408163265306,
                                         2.0816326530612246,
                                         2.020408163265306,
                                         2.0816326530612246,
                                         2.020408163265306,
                                         2.0816326530612246,
                                         1.387755102040816,
                                         1.4285714285714284,
                                         0.7142857142857142,
                                         0.7346938775510203,
                                         0.7551020408163265,
                                         0.7755102040816326,
                                         1.5510204081632653,
                                         1.5918367346938775,
                                         2.387755102040816,
                                         2.4489795918367347,
                                         2.387755102040816,
                                         2.4489795918367347,
                                         2.387755102040816,
                                         2.4489795918367347,
                                         2.387755102040816,
                                         2.4489795918367347,
                                         2.387755102040816,
                                         2.4489795918367347,
                                         1.6326530612244896,
                                         1.673469387755102,
                                         0.836734693877551,
                                         0.8571428571428571,
                                         1.6326530612244898,
                                         1.673469387755102,
                                         3.346938775510204,
                                         3.428571428571428,
                                         5.142857142857142,
                                         5.26530612244898,
                                         5.142857142857142,
                                         5.26530612244898,
                                         5.142857142857142,
                                         5.26530612244898,
                                         5.142857142857142,
                                         5.26530612244898,
                                         5.142857142857142,
                                         5.26530612244898,
                                         3.510204081632653,
                                         3.591836734693877,
                                         1.7959183673469385,
                                         1.8367346938775508,
                                         2.63265306122449,
                                         2.693877551020408,
                                         5.387755102040815,
                                         5.5102040816326525,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         5.63265306122449,
                                         5.755102040816325,
                                         2.8775510204081627,
                                         2.9387755102040813,
                                         2.63265306122449,
                                         2.693877551020408,
                                         5.387755102040815,
                                         5.5102040816326525,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         5.63265306122449,
                                         5.755102040816325,
                                         2.8775510204081627,
                                         2.9387755102040813,
                                         2.63265306122449,
                                         2.693877551020408,
                                         5.387755102040815,
                                         5.5102040816326525,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         5.63265306122449,
                                         5.755102040816325,
                                         2.8775510204081627,
                                         2.9387755102040813,
                                         2.63265306122449,
                                         2.693877551020408,
                                         5.387755102040815,
                                         5.5102040816326525,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         5.63265306122449,
                                         5.755102040816325,
                                         2.8775510204081627,
                                         2.9387755102040813,
                                         2.63265306122449,
                                         2.693877551020408,
                                         5.387755102040815,
                                         5.5102040816326525,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         8.265306122448978,
                                         8.448979591836734,
                                         5.63265306122449,
                                         5.755102040816325,
                                         2.8775510204081627,
                                         2.9387755102040813,
                                         1.8775510204081631,
                                         1.9183673469387754,
                                         3.836734693877551,
                                         3.918367346938775,
                                         5.877551020408163,
                                         6.,
                                         5.877551020408163,
                                         6.,
                                         5.877551020408163,
                                         6.,
                                         5.877551020408163,
                                         6.,
                                         5.877551020408163,
                                         6.,
                                         4.,
                                         4.081632653061224,
                                         2.040816326530612,
                                         2.0816326530612246,
                                         0.9999999999999999,
                                         1.0204081632653061,
                                         2.040816326530612,
                                         2.0816326530612246,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         2.1224489795918364,
                                         2.1632653061224487,
                                         1.0816326530612244,
                                         1.1020408163265305};
  const std::array<int, 4> in_shape = {{3, 9, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.800459183673464, 30.377335600907024, 30.954212018140588,
      31.531088435374148, 36.59195578231292,  37.27733560090702,
      37.96271541950113,  38.64809523809524,  43.81746598639456,
      44.6113492063492,   45.405232426303854, 46.199115646258505,
      52.75357709750567,  53.67404761904763,  54.594518140589564,
      55.51498866213152,  55.23750566893423,  56.120000000000005,
      57.00249433106575,  57.88498866213152,  62.47548185941042,
      63.39595238095237,  64.31642290249434,  65.23689342403628,
      55.56476757369614,  56.35865079365079,  57.15253401360544,
      57.9464172335601,   49.20728458049886,  49.892664399092965,
      50.57804421768707,  51.26342403628118,  42.4157879818594,
      42.992664399092966, 43.56954081632652,  44.146417233560086,
      46.08311224489796,  46.768492063492054, 47.45387188208617,
      48.13925170068027,  56.1603231292517,   56.974614512471646,
      57.788905895691606, 58.60319727891156,  66.75318027210885,
      67.69638321995464,  68.63958616780045,  69.58278911564626,
      79.71310090702949,  80.80670068027213,  81.90030045351473,
      82.99390022675738,  81.96131519274377,  83.00979591836736,
      84.05827664399091,  85.1067573696145,   91.26357709750566,
      92.3571768707483,   93.45077664399092,  94.54437641723356,
      80.71000566893422,  81.65320861678005,  82.59641156462584,
      83.53961451247167,  71.14844104308389,  71.96273242630386,
      72.7770238095238,   73.59131519274376,  61.07123015873015,
      61.75660997732425,  62.44198979591836,  63.127369614512475,
      66.27188775510204,  67.06577097505668,  67.85965419501134,
      68.65353741496598,  80.36950680272109,  81.31270975056688,
      82.2559126984127,   83.19911564625849,  95.06440476190477,
      96.15692743764171,  97.24945011337869,  98.34197278911564,
      112.90527777777778, 114.1720068027211,  115.4387358276644,
      116.7054648526077,  114.66063492063493, 115.87510204081633,
      117.08956916099771, 118.30403628117912, 126.2843253968254,
      127.5510544217687,  128.817783446712,   130.08451247165533,
      111.23075396825395, 112.32327664399092, 113.41579931972788,
      114.50832199546487, 97.73041383219955,  98.67361678004535,
      99.61681972789114,  100.56002267573696, 83.6327947845805,
      84.42667800453512,  85.22056122448978,  86.01444444444444,
      94.38260204081632,  95.30307256235827,  96.22354308390024,
      97.14401360544217,  114.02784013605442, 115.12143990929704,
      116.2150396825397,  117.3086394557823,  134.36559523809524,
      135.63232426303853, 136.89905328798187, 138.16578231292516,
      158.90091269841272, 160.36962585034016, 161.83833900226756,
      163.30705215419502, 159.78126984126985, 161.18938775510205,
      162.5975056689342,  164.00562358276642, 174.41329365079366,
      175.88200680272107, 177.35071995464853, 178.81943310657596,
      153.1097222222222,  154.3764512471655,  155.64318027210885,
      156.90990929705214, 134.15700113378685, 135.25060090702948,
      136.3442006802721,  137.43780045351474, 114.51176303854875,
      115.43223356009068, 116.35270408163264, 117.27317460317458,
      132.4322448979592,  133.31473922902495, 134.1972335600907,
      135.07972789115644, 159.15605442176872, 160.20453514739228,
      161.25301587301584, 162.30149659863943, 186.54380952380956,
      187.75827664399088, 188.97274376417235, 190.18721088435373,
      219.27079365079368, 220.67891156462582, 222.08702947845805,
      223.49514739229028, 217.35365079365081, 218.70367346938772,
      220.0536961451247,  221.40371882086168, 234.1431746031746,
      235.55129251700677, 236.959410430839,   238.36752834467117,
      204.51460317460317, 205.72907029478458, 206.943537414966,
      208.15800453514734, 178.45473922902494, 179.50321995464853,
      180.5517006802721,  181.60018140589565, 151.73092970521543,
      152.61342403628117, 153.49591836734692, 154.3784126984127,
      181.87974489795917, 182.8002154195011,  183.7206859410431,
      184.64115646258503, 217.98212585034014, 219.0757256235827,
      220.1693253968254,  221.26292517006803, 254.77702380952383,
      256.04375283446706, 257.31048185941046, 258.57721088435375,
      298.51234126984133, 299.98105442176865, 301.44976757369614,
      302.9184807256236,  293.63269841269846, 295.0408163265305,
      296.44893424036275, 297.857052154195,   314.0247222222223,
      315.49343537414956, 316.96214852607704, 318.43086167800453,
      273.5211507936508,  274.7878798185941,  276.05460884353744,
      277.32133786848067, 238.11128684807255, 239.20488662131524,
      240.2984863945578,  241.39208616780044, 202.00890589569156,
      202.92937641723358, 203.8498469387755,  204.77031746031744,
      171.99760204081633, 172.79148526077094, 173.58536848072566,
      174.37925170068027, 205.98093537414968, 206.92413832199546,
      207.8673412698413,  208.81054421768707, 240.56154761904762,
      241.65407029478453, 242.74659297052153, 243.83911564625848,
      281.60242063492063, 282.8691496598638,  284.13587868480727,
      285.4026077097506,  276.3977777777778,  277.6122448979591,
      278.8267120181406,  280.041179138322,   294.9814682539683,
      296.2481972789115,  297.5149263038549,  298.78165532879814,
      256.7278968253968,  257.82041950113376, 258.91294217687073,
      260.0054648526077,  223.34184240362808, 224.28504535147394,
      225.22824829931972, 226.1714512471655,  189.35850907029476,
      190.15239229024945, 190.94627551020406, 191.7401587301587,
      159.62107142857144, 160.3064512471655,  160.99183106575964,
      161.67721088435374, 191.0533843537415,  191.8676757369614,
      192.6819671201814,  193.49625850340138, 223.00134353741495,
      223.94454648526076, 224.8877494331066,  225.83095238095234,
      260.8755498866213,  261.96914965986394, 263.0627494331066,
      264.1563492063492,  255.64947845804986, 256.6979591836735,
      257.74643990929707, 258.7949206349206,  272.4260260770975,
      273.51962585034016, 274.6132256235828,  275.70682539682537,
      236.95816893424032, 237.90137188208618, 238.844574829932,
      239.78777777777776, 206.04150226757363, 206.85579365079366,
      207.6700850340136,  208.48437641723353, 174.6091893424036,
      175.29456916099772, 175.97994897959182, 176.66532879818595,
      143.33841836734695, 143.91529478458048, 144.49217120181407,
      145.0690476190476,  171.4850170068027,  172.17039682539675,
      172.85577664399096, 173.54115646258506, 200.06562925170067,
      200.85951247165528, 201.65339569161003, 202.44727891156464,
      233.91602607709748, 234.83649659863943, 235.75696712018146,
      236.67743764172334, 228.92566893424032, 229.80816326530606,
      230.69065759637192, 231.57315192743764, 243.63793083900222,
      244.5584013605442,  245.4788718820862,  246.3993424036281,
      211.8129308390022,  212.6068140589569,  213.4006972789116,
      214.1945804988662,  184.10034580498862, 184.78572562358278,
      185.47110544217685, 186.15648526077098, 155.9537471655329,
      156.53062358276642, 157.1075,           157.68437641723358,
      216.70841836734698, 217.2852947845805,  217.862171201814,
      218.43904761904767, 258.6550170068027,  259.34039682539685,
      260.0257766439909,  260.71115646258505, 301.0356292517007,
      301.82951247165533, 302.6233956916099,  303.4172789115646,
      350.98602607709756, 351.9064965986395,  352.8269671201814,
      353.7474376417233,  341.16566893424033, 342.0481632653062,
      342.9306575963718,  343.8131519274376,  360.70793083900224,
      361.6284013605443,  362.54887188208613, 363.46934240362816,
      312.7829308390023,  313.5768140589569,  314.3706972789116,
      315.1645804988662,  271.27034580498866, 271.95572562358274,
      272.64110544217687, 273.326485260771,   229.3237471655329,
      229.9006235827664,  230.47749999999996, 231.05437641723358,
      268.14617346938775, 268.8315532879818,  269.5169331065759,
      270.2023129251701,  319.990731292517,   320.805022675737,
      321.6193140589569,  322.43360544217694, 372.3509353741497,
      373.2941383219955,  374.2373412698412,  375.18054421768704,
      434.0394274376418,  435.1330272108844,  436.22662698412694,
      437.32022675736954, 421.66907029478455, 422.7175510204082,
      423.7660317460317,  424.81451247165535, 445.5899036281179,
      446.68350340136055, 447.77710317460316, 448.87070294784587,
      386.3077607709751,  387.2509637188209,  388.1941666666667,
      389.1373696145124,  334.97884920634925, 335.79314058956913,
      336.60743197278913, 337.42172335600907, 283.13429138322,
      283.819671201814,   284.50505102040813, 285.19043083900226,
      323.49005102040815, 324.2839342403627,  325.07781746031736,
      325.8717006802721,  385.9672619047619,  386.91046485260773,
      387.8536678004535,  388.7968707482994,  449.0417517006803,
      450.13427437641724, 451.2267970521541,  452.3193197278911,
      523.3254818594105,  524.5922108843538,  525.858939909297,
      527.1256689342403,  508.1479818594104,  509.3624489795919,
      510.5769160997732,  511.79138321995464, 536.7045294784581,
      537.9712585034013,  539.2379875283447,  540.5047165532881,
      465.2081009070296,  466.3006235827665,  467.39314625850346,
      468.48566893424027, 403.32816893424047, 404.27137188208616,
      405.214574829932,   406.15777777777777, 340.8509580498867,
      341.6448412698412,  342.4387244897959,  343.23260770975054,
      392.6150510204082,  393.53552154195,    394.455992063492,
      395.376462585034,   468.35416666666674, 469.4477664399093,
      470.5413662131519,  471.6349659863946,  544.7857993197281,
      546.0525283446713,  547.3192573696144,  548.5859863945578,
      634.7639739229026,  636.2326870748301,  637.7014002267573,
      639.1701133786847,  616.0114739229025,  617.4195918367348,
      618.8277097505668,  620.2358276643993,  650.2763548752836,
      651.7450680272108,  653.2137811791383,  654.682494331066,
      563.529926303855,   564.7966553287981,  566.0633843537415,
      567.3301133786848,  488.48332766439916, 489.57692743764176,
      490.67052721088436, 491.76412698412696, 412.7442120181406,
      413.66468253968253, 414.5851530612245,  415.5056235827664,
      418.3604081632654,  419.24290249433096, 420.1253968253968,
      421.00789115646256, 498.8638095238096,  499.912290249433,
      500.9607709750567,  502.0092517006803,  580.0311564625852,
      581.2456235827663,  582.4600907029478,  583.6745578231292,
      675.5009977324264,  676.9091156462583,  678.3172335600908,
      679.725351473923,   654.7609977324264,  656.1110204081631,
      657.4610430839003,  658.8110657596372,  690.3733786848073,
      691.7814965986394,  693.1896145124717,  694.5977324263039,
      598.0019501133787,  599.2164172335602,  600.4308843537415,
      601.6453514739229,  518.1624943310658,  519.2109750566893,
      520.2594557823129,  521.3079365079365,  437.65909297052156,
      438.5415873015873,  439.424081632653,   440.3065759637188,
      480.112193877551,   481.032664399093,   481.9531349206349,
      482.8736054421769,  572.3084523809523,  573.402052154195,
      574.4956519274376,  575.5892517006803,  665.1972278911566,
      666.4639569160996,  667.7306859410431,  668.9974149659863,
      774.3754024943311,  775.8441156462584,  777.312828798186,
      778.7815419501133,  749.8629024943309,  751.2710204081633,
      752.6791383219955,  754.0872562358276,  789.887783446712,
      791.3564965986395,  792.8252097505668,  794.2939229024943,
      683.9413548752833,  685.2080839002269,  686.4748129251701,
      687.7415419501133,  592.4376133786847,  593.5312131519275,
      594.62481292517,    595.7184126984126,  500.24135487528343,
      501.1618253968254,  502.08229591836727, 503.0027664399093,
      429.2157653061224,  430.009648526077,   430.80353174603175,
      431.5974149659864,  511.57869047619045, 512.5218934240362,
      513.465096371882,   514.4082993197279,  594.5388945578231,
      595.63141723356,    596.7239399092971,  597.816462585034,
      692.0226247165533,  693.2893537414965,  694.55608276644,
      695.8228117913831,  669.8851247165532,  671.0995918367348,
      672.3140589569161,  673.5285260770975,  705.4016723356007,
      706.6684013605442,  707.9351303854875,  709.2018594104308,
      610.7052437641721,  611.7977664399093,  612.8902891156462,
      613.9828117913831,  528.9395975056689,  529.8828004535148,
      530.8260034013605,  531.7692063492063,  446.5766723356009,
      447.3705555555556,  448.1644387755102,  448.9583219954648,
      381.6841326530612,  382.3695124716553,  383.0548922902494,
      383.74027210884356, 454.8837925170067,  455.6980839002267,
      456.51237528344666, 457.3266666666667,  528.5990986394557,
      529.5423015873015,  530.4855045351474,  531.4287074829932,
      615.2018764172335,  616.2954761904762,  617.3890759637188,
      618.4826757369614,  595.3572335600907,  596.4057142857141,
      597.4541950113377,  598.5026757369615,  626.7523526077096,
      627.8459523809526,  628.939552154195,   630.0331519274376,
      542.5559240362811,  543.499126984127,   544.4423299319728,
      545.3855328798186,  469.87191043083897, 470.68620181405896,
      471.50049319727896, 472.3147845804989,  396.6722505668934,
      397.35763038548754, 398.0430102040816,  398.72839002267574,
      330.24637755102043, 330.82325396825394, 331.4001303854875,
      331.9770068027211,  393.54807823129255, 394.23345804988656,
      394.9188378684807,  395.6042176870748,  457.2837925170068,
      458.07767573696145, 458.8715589569161,  459.6654421768708,
      532.1484750566892,  533.0689455782313,  533.9894160997733,
      534.9098866213152,  514.8538321995464,  515.7363265306122,
      516.6188208616779,  517.5013151927438,  541.8703798185941,
      542.7908503401361,  543.711320861678,   544.6317913832199,
      469.03109410430835, 469.824977324263,   470.6188605442177,
      471.4127437641724,  406.16340702947844, 406.84878684807256,
      407.5341666666667,  408.21954648526076, 342.8617063492063,
      343.43858276643994, 344.01545918367344, 344.592335600907,
      403.61637755102043, 404.193253968254,   404.7701303854875,
      405.34700680272107, 480.71807823129257, 481.4034580498865,
      482.08883786848065, 482.7742176870748,  558.2537925170069,
      559.0476757369615,  559.8415589569162,  560.6354421768708,
      649.2184750566894,  650.1389455782312,  651.0594160997733,
      651.9798866213151,  627.0938321995465,  627.9763265306121,
      628.8588208616778,  629.7413151927439,  658.9403798185941,
      659.8608503401359,  660.781320861678,   661.7017913832201,
      570.0010941043084,  570.794977324263,   571.5888605442177,
      572.3827437641723,  493.33340702947845, 494.0187868480725,
      494.7041666666666,  495.3895464852607,  416.2317063492063,
      416.80858276643994, 417.38545918367345, 417.96233560090707,
      490.20923469387753, 490.89461451247166, 491.57999433106573,
      492.26537414965986, 583.8211394557824,  584.6354308390021,
      585.4497222222221,  586.2640136054421,  677.9486904761906,
      678.8918934240363,  679.8350963718821,  680.7782993197279,
      788.365753968254,   789.4593537414964,  790.5529535147392,
      791.6465532879818,  761.3768253968253,  762.4253061224488,
      763.4737868480723,  764.5222675736961,  799.9162301587302,
      801.0098299319726,  802.1034297052154,  803.197029478458,
      691.9055158730158,  692.8487188208616,  693.7919217687075,
      694.7351247165532,  598.8092573696146,  599.6235487528344,
      600.4378401360544,  601.2521315192743,  505.1973526077097,
      505.88273242630385, 506.5681122448979,  507.2534920634921,
      580.7082142857142,  581.5020975056689,  582.2959807256235,
      583.0898639455781,  691.5650170068027,  692.5082199546483,
      693.4514229024943,  694.3946258503399,  803.0190986394558,
      804.1116213151928,  805.2041439909298,  806.2966666666666,
      933.7456859410431,  935.0124149659863,  936.2791439909298,
      937.5458730158729,  901.6353287981858,  902.8497959183672,
      904.0642630385486,  905.2787301587301,  947.1247335600907,
      948.391462585034,   949.6581916099773,  950.9249206349207,
      819.1854478458049,  820.277970521542,   821.370493197279,
      822.4630158730158,  708.9259240362812,  709.8691269841271,
      710.8123299319728,  711.7555328798186,  598.0691213151928,
      598.8630045351475,  599.6568877551019,  600.4507709750568,
      690.8475,           691.767970521542,   692.6884410430838,
      693.6089115646258,  822.6804931972789,  823.7740929705215,
      824.8676927437641,  825.9612925170067,  955.2060034013606,
      956.472732426304,   957.7394614512472,  959.0061904761905,
      1110.6270351473922, 1112.0957482993197, 1113.5644614512473,
      1115.0331746031745, 1072.241678004535,  1073.6497959183673,
      1075.0579138321993, 1076.4660317460316, 1126.1394160997731,
      1127.6081292517008, 1129.076842403628,  1130.5455555555557,
      973.9501303854875,  975.2168594104307,  976.4835884353743,
      977.7503174603174,  842.8096541950114,  843.9032539682539,
      844.9968537414967,  846.0904535147392,  710.9766609977324,
      711.8971315192744,  712.8176020408163,  713.7380725623584,
      704.2885714285715,  705.1710657596374,  706.0535600907028,
      706.9360544217689,  838.5715646258502,  839.6200453514741,
      840.6685260770975,  841.7170068027214,  973.5185034013604,
      974.732970521542,   975.9474376417234,  977.1619047619049,
      1131.7312018140587, 1133.1393197278912, 1134.5474376417233,
      1135.9555555555557, 1092.1683446712018, 1093.5183673469387,
      1094.8683900226758, 1096.218412698413,  1146.60358276644,
      1148.011700680272,  1149.4198185941045, 1150.8279365079366,
      991.4892970521541,  992.7037641723357,  993.9182312925171,
      995.1326984126985,  857.8702494331066,  858.91873015873,
      859.9672108843537,  861.0156916099774,  723.5872562358276,
      724.4697505668934,  725.3522448979592,  726.2347392290249,
      778.3446428571427,  779.265113378685,   780.1855839002267,
      781.1060544217687,  926.6347789115646,  927.7283786848074,
      928.8219784580498,  929.9155782312927,  1075.617431972789,
      1076.8841609977326, 1078.1508900226756, 1079.4176190476192,
      1250.2384637188209, 1251.7071768707485, 1253.175890022676,
      1254.6446031746034, 1206.0931065759637, 1207.501224489796,
      1208.909342403628,  1210.3174603174605, 1265.7508446712018,
      1267.2195578231294, 1268.6882709750566, 1270.1569841269843,
      1094.361558956916,  1095.6282879818593, 1096.8950170068026,
      1098.161746031746,  946.763939909297,   947.8575396825396,
      948.9511394557824,  950.0447392290247,  798.4738038548751,
      799.3942743764172,  800.314744897959,   801.2352154195011,
      686.4339285714284,  687.2278117913833,  688.0216950113378,
      688.8155782312925,  817.1764455782313,  818.1196485260771,
      819.0628514739228,  820.0060544217688,  948.5162414965986,
      949.6087641723356,  950.7012868480724,  951.7938095238097,
      1102.442828798186,  1103.7095578231292, 1104.9762868480723,
      1106.243015873016,  1063.3724716553288, 1064.5869387755104,
      1065.8014058956915, 1067.015873015873,  1115.8218764172334,
      1117.088605442177,  1118.3553344671202, 1119.6220634920633,
      964.6825907029478,  965.7751133786849,  966.8676360544216,
      967.9601587301586,  834.5373526077096,  835.4805555555556,
      836.4237585034014,  837.366961451247,   703.7948356009069,
      704.5887188208617,  705.3826020408163,  706.1764852607708,
      603.747193877551,   604.4325736961451,  605.1179535147393,
      605.8033333333333,  718.714200680272,   719.5284920634921,
      720.3427834467121,  721.157074829932,   834.1968537414965,
      835.1400566893424,  836.0832596371881,  837.026462585034,
      969.5282029478458,  970.6218027210884,  971.715402494331,
      972.8090022675738,  935.0649886621314,  936.1134693877551,
      937.1619501133787,  938.2104308390021,  981.078679138322,
      982.1722789115646,  983.2658786848073,  984.3594784580497,
      848.1536791383219,  849.0968820861679,  850.0400850340136,
      850.9832879818592,  733.7023185941043,  734.5166099773242,
      735.3309013605442,  736.145192743764,   618.7353117913833,
      619.4206916099773,  620.1060714285713,  620.7914512471656,
      517.1543367346939,  517.7312131519274,  518.308089569161,
      518.8849659863945,  615.6111394557823,  616.2965192743764,
      616.9818990929706,  617.6672789115646,  714.5019557823128,
      715.2958390022675,  716.0897222222222,  716.8836054421769,
      830.3809240362812,  831.3013945578231,  832.221865079365,
      833.142335600907,   800.7819954648525,  801.6644897959184,
      802.5469841269841,  803.4294784580499,  840.1028287981859,
      841.0232993197278,  841.9437698412698,  842.8642403628116,
      726.2492573696145,  727.0431405895691,  727.8370238095239,
      728.6309070294784,  628.2264682539683,  628.9118480725623,
      629.5972278911564,  630.2826077097506,  529.7696655328798,
      530.3465419501133,  530.9234183673469,  531.5002947845805};
  const std::array<int, 4> in_shape = {{3, 9, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.04081632653061224,
                                         0.061224489795918366,
                                         0.08163265306122448,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.3061224489795918,
                                         0.36734693877551017,
                                         0.42857142857142855,
                                         0.4897959183673469,
                                         0.3061224489795918,
                                         0.36734693877551017,
                                         0.42857142857142855,
                                         0.4897959183673469,
                                         0.3061224489795918,
                                         0.36734693877551017,
                                         0.42857142857142855,
                                         0.4897959183673469,
                                         0.3061224489795918,
                                         0.36734693877551017,
                                         0.42857142857142855,
                                         0.4897959183673469,
                                         0.3061224489795918,
                                         0.36734693877551017,
                                         0.42857142857142855,
                                         0.4897959183673469,
                                         0.2857142857142857,
                                         0.32653061224489793,
                                         0.36734693877551017,
                                         0.40816326530612246,
                                         0.18367346938775508,
                                         0.2040816326530612,
                                         0.22448979591836732,
                                         0.24489795918367346,
                                         0.2857142857142857,
                                         0.32653061224489793,
                                         0.36734693877551017,
                                         0.4081632653061224,
                                         0.7346938775510203,
                                         0.8163265306122448,
                                         0.8979591836734693,
                                         0.9795918367346939,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.0612244897959184,
                                         1.1428571428571428,
                                         1.2244897959183674,
                                         1.306122448979592,
                                         0.6122448979591837,
                                         0.6530612244897959,
                                         0.693877551020408,
                                         0.7346938775510203,
                                         0.7959183673469388,
                                         0.857142857142857,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         1.8367346938775508,
                                         1.9591836734693873,
                                         2.081632653061224,
                                         2.204081632653061,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.693877551020408,
                                         1.2857142857142856,
                                         1.346938775510204,
                                         1.4081632653061222,
                                         1.4693877551020407,
                                         0.7959183673469388,
                                         0.857142857142857,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         1.8367346938775508,
                                         1.9591836734693873,
                                         2.081632653061224,
                                         2.204081632653061,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.693877551020408,
                                         1.2857142857142856,
                                         1.346938775510204,
                                         1.4081632653061222,
                                         1.4693877551020407,
                                         0.7959183673469388,
                                         0.857142857142857,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         1.8367346938775508,
                                         1.9591836734693873,
                                         2.081632653061224,
                                         2.204081632653061,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.693877551020408,
                                         1.2857142857142856,
                                         1.346938775510204,
                                         1.4081632653061222,
                                         1.4693877551020407,
                                         0.7959183673469388,
                                         0.857142857142857,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         1.8367346938775508,
                                         1.9591836734693873,
                                         2.081632653061224,
                                         2.204081632653061,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.693877551020408,
                                         1.2857142857142856,
                                         1.346938775510204,
                                         1.4081632653061222,
                                         1.4693877551020407,
                                         0.7959183673469388,
                                         0.857142857142857,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         1.8367346938775508,
                                         1.9591836734693873,
                                         2.081632653061224,
                                         2.204081632653061,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         3.122448979591837,
                                         3.3061224489795915,
                                         3.4897959183673466,
                                         3.6734693877551017,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.693877551020408,
                                         1.2857142857142856,
                                         1.346938775510204,
                                         1.4081632653061222,
                                         1.4693877551020407,
                                         0.7755102040816326,
                                         0.8163265306122448,
                                         0.857142857142857,
                                         0.8979591836734693,
                                         1.7142857142857144,
                                         1.7959183673469385,
                                         1.8775510204081631,
                                         1.9591836734693877,
                                         2.816326530612245,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         3.183673469387755,
                                         2.816326530612245,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         3.183673469387755,
                                         2.816326530612245,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         3.183673469387755,
                                         2.816326530612245,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         3.183673469387755,
                                         2.816326530612245,
                                         2.9387755102040813,
                                         3.0612244897959178,
                                         3.183673469387755,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         0.5102040816326531,
                                         0.5306122448979591,
                                         0.5510204081632653,
                                         0.5714285714285714,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         1.7755102040816326,
                                         1.8367346938775508,
                                         1.8979591836734693,
                                         1.9591836734693877,
                                         1.7755102040816326,
                                         1.8367346938775508,
                                         1.8979591836734693,
                                         1.9591836734693877,
                                         1.7755102040816326,
                                         1.8367346938775508,
                                         1.8979591836734693,
                                         1.9591836734693877,
                                         1.7755102040816326,
                                         1.8367346938775508,
                                         1.8979591836734693,
                                         1.9591836734693877,
                                         1.7755102040816326,
                                         1.8367346938775508,
                                         1.8979591836734693,
                                         1.9591836734693877,
                                         1.2653061224489797,
                                         1.3061224489795917,
                                         1.3469387755102038,
                                         1.387755102040816,
                                         0.673469387755102,
                                         0.6938775510204082,
                                         0.7142857142857142,
                                         0.7346938775510203,
                                         0.7551020408163265,
                                         0.7755102040816326,
                                         0.7959183673469387,
                                         0.8163265306122448,
                                         1.5918367346938775,
                                         1.6326530612244898,
                                         1.673469387755102,
                                         1.714285714285714,
                                         2.510204081632653,
                                         2.571428571428571,
                                         2.63265306122449,
                                         2.6938775510204076,
                                         2.510204081632653,
                                         2.571428571428571,
                                         2.63265306122449,
                                         2.6938775510204076,
                                         2.510204081632653,
                                         2.571428571428571,
                                         2.63265306122449,
                                         2.6938775510204076,
                                         2.510204081632653,
                                         2.571428571428571,
                                         2.63265306122449,
                                         2.6938775510204076,
                                         2.510204081632653,
                                         2.571428571428571,
                                         2.63265306122449,
                                         2.6938775510204076,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         1.8367346938775508,
                                         1.8775510204081631,
                                         0.9183673469387754,
                                         0.9387755102040816,
                                         0.9591836734693877,
                                         0.9795918367346939,
                                         1.7551020408163263,
                                         1.7959183673469388,
                                         1.8367346938775508,
                                         1.8775510204081631,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         3.836734693877551,
                                         3.918367346938775,
                                         5.755102040816326,
                                         5.877551020408163,
                                         5.999999999999999,
                                         6.1224489795918355,
                                         5.755102040816326,
                                         5.877551020408163,
                                         5.999999999999999,
                                         6.1224489795918355,
                                         5.755102040816326,
                                         5.877551020408163,
                                         5.999999999999999,
                                         6.1224489795918355,
                                         5.755102040816326,
                                         5.877551020408163,
                                         5.999999999999999,
                                         6.1224489795918355,
                                         5.755102040816326,
                                         5.877551020408163,
                                         5.999999999999999,
                                         6.1224489795918355,
                                         4.,
                                         4.081632653061224,
                                         4.163265306122448,
                                         4.244897959183673,
                                         2.0816326530612246,
                                         2.1224489795918364,
                                         2.163265306122449,
                                         2.204081632653061,
                                         2.9999999999999996,
                                         3.061224489795918,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367347,
                                         6.612244897959183,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         6.73469387755102,
                                         6.857142857142856,
                                         6.979591836734693,
                                         7.10204081632653,
                                         3.4897959183673466,
                                         3.551020408163265,
                                         3.612244897959184,
                                         3.6734693877551017,
                                         2.9999999999999996,
                                         3.061224489795918,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367347,
                                         6.612244897959183,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         6.73469387755102,
                                         6.857142857142856,
                                         6.979591836734693,
                                         7.10204081632653,
                                         3.4897959183673466,
                                         3.551020408163265,
                                         3.612244897959184,
                                         3.6734693877551017,
                                         2.9999999999999996,
                                         3.061224489795918,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367347,
                                         6.612244897959183,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         6.73469387755102,
                                         6.857142857142856,
                                         6.979591836734693,
                                         7.10204081632653,
                                         3.4897959183673466,
                                         3.551020408163265,
                                         3.612244897959184,
                                         3.6734693877551017,
                                         2.9999999999999996,
                                         3.061224489795918,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367347,
                                         6.612244897959183,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         6.73469387755102,
                                         6.857142857142856,
                                         6.979591836734693,
                                         7.10204081632653,
                                         3.4897959183673466,
                                         3.551020408163265,
                                         3.612244897959184,
                                         3.6734693877551017,
                                         2.9999999999999996,
                                         3.061224489795918,
                                         3.1224489795918364,
                                         3.183673469387755,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367347,
                                         6.612244897959183,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         9.73469387755102,
                                         9.918367346938775,
                                         10.102040816326529,
                                         10.285714285714285,
                                         6.73469387755102,
                                         6.857142857142856,
                                         6.979591836734693,
                                         7.10204081632653,
                                         3.4897959183673466,
                                         3.551020408163265,
                                         3.612244897959184,
                                         3.6734693877551017,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         2.3265306122448974,
                                         2.36734693877551,
                                         4.653061224489795,
                                         4.73469387755102,
                                         4.816326530612244,
                                         4.897959183673469,
                                         7.224489795918366,
                                         7.346938775510203,
                                         7.469387755102041,
                                         7.591836734693876,
                                         7.224489795918366,
                                         7.346938775510203,
                                         7.469387755102041,
                                         7.591836734693876,
                                         7.224489795918366,
                                         7.346938775510203,
                                         7.469387755102041,
                                         7.591836734693876,
                                         7.224489795918366,
                                         7.346938775510203,
                                         7.469387755102041,
                                         7.591836734693876,
                                         7.224489795918366,
                                         7.346938775510203,
                                         7.469387755102041,
                                         7.591836734693876,
                                         4.979591836734693,
                                         5.061224489795919,
                                         5.142857142857142,
                                         5.224489795918367,
                                         2.571428571428571,
                                         2.6122448979591835,
                                         2.6530612244897958,
                                         2.6938775510204076,
                                         1.2448979591836733,
                                         1.2653061224489794,
                                         1.2857142857142856,
                                         1.3061224489795917,
                                         2.571428571428571,
                                         2.6122448979591835,
                                         2.6530612244897958,
                                         2.693877551020408,
                                         3.979591836734693,
                                         4.040816326530612,
                                         4.1020408163265305,
                                         4.163265306122449,
                                         3.979591836734693,
                                         4.040816326530612,
                                         4.1020408163265305,
                                         4.163265306122449,
                                         3.979591836734693,
                                         4.040816326530612,
                                         4.1020408163265305,
                                         4.163265306122449,
                                         3.979591836734693,
                                         4.040816326530612,
                                         4.1020408163265305,
                                         4.163265306122449,
                                         3.979591836734693,
                                         4.040816326530612,
                                         4.1020408163265305,
                                         4.163265306122449,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         1.4081632653061222,
                                         1.4285714285714284,
                                         1.4489795918367345,
                                         1.4693877551020407,
                                         1.4897959183673468,
                                         1.510204081632653,
                                         1.530612244897959,
                                         1.5510204081632653,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         3.1428571428571423,
                                         3.183673469387755,
                                         4.7142857142857135,
                                         4.775510204081632,
                                         4.836734693877551,
                                         4.8979591836734695,
                                         4.7142857142857135,
                                         4.775510204081632,
                                         4.836734693877551,
                                         4.8979591836734695,
                                         4.7142857142857135,
                                         4.775510204081632,
                                         4.836734693877551,
                                         4.8979591836734695,
                                         4.7142857142857135,
                                         4.775510204081632,
                                         4.836734693877551,
                                         4.8979591836734695,
                                         4.7142857142857135,
                                         4.775510204081632,
                                         4.836734693877551,
                                         4.8979591836734695,
                                         3.224489795918367,
                                         3.265306122448979,
                                         3.3061224489795915,
                                         3.346938775510204,
                                         1.6530612244897958,
                                         1.673469387755102,
                                         1.693877551020408,
                                         1.7142857142857142,
                                         3.224489795918367,
                                         3.2653061224489797,
                                         3.3061224489795915,
                                         3.346938775510204,
                                         6.612244897959184,
                                         6.693877551020408,
                                         6.775510204081631,
                                         6.857142857142856,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         6.938775510204081,
                                         7.020408163265306,
                                         7.10204081632653,
                                         7.183673469387754,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         3.63265306122449,
                                         3.6734693877551017,
                                         5.204081632653061,
                                         5.26530612244898,
                                         5.326530612244897,
                                         5.387755102040816,
                                         10.653061224489797,
                                         10.77551020408163,
                                         10.897959183673468,
                                         11.020408163265305,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         11.142857142857142,
                                         11.26530612244898,
                                         11.387755102040817,
                                         11.51020408163265,
                                         5.6938775510204085,
                                         5.755102040816325,
                                         5.816326530612245,
                                         5.877551020408163,
                                         5.204081632653061,
                                         5.26530612244898,
                                         5.326530612244897,
                                         5.387755102040816,
                                         10.653061224489797,
                                         10.77551020408163,
                                         10.897959183673468,
                                         11.020408163265305,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         11.142857142857142,
                                         11.26530612244898,
                                         11.387755102040817,
                                         11.51020408163265,
                                         5.6938775510204085,
                                         5.755102040816325,
                                         5.816326530612245,
                                         5.877551020408163,
                                         5.204081632653061,
                                         5.26530612244898,
                                         5.326530612244897,
                                         5.387755102040816,
                                         10.653061224489797,
                                         10.77551020408163,
                                         10.897959183673468,
                                         11.020408163265305,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         11.142857142857142,
                                         11.26530612244898,
                                         11.387755102040817,
                                         11.51020408163265,
                                         5.6938775510204085,
                                         5.755102040816325,
                                         5.816326530612245,
                                         5.877551020408163,
                                         5.204081632653061,
                                         5.26530612244898,
                                         5.326530612244897,
                                         5.387755102040816,
                                         10.653061224489797,
                                         10.77551020408163,
                                         10.897959183673468,
                                         11.020408163265305,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         11.142857142857142,
                                         11.26530612244898,
                                         11.387755102040817,
                                         11.51020408163265,
                                         5.6938775510204085,
                                         5.755102040816325,
                                         5.816326530612245,
                                         5.877551020408163,
                                         5.204081632653061,
                                         5.26530612244898,
                                         5.326530612244897,
                                         5.387755102040816,
                                         10.653061224489797,
                                         10.77551020408163,
                                         10.897959183673468,
                                         11.020408163265305,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         11.142857142857142,
                                         11.26530612244898,
                                         11.387755102040817,
                                         11.51020408163265,
                                         5.6938775510204085,
                                         5.755102040816325,
                                         5.816326530612245,
                                         5.877551020408163,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         3.795918367346938,
                                         3.836734693877551,
                                         7.591836734693878,
                                         7.673469387755102,
                                         7.755102040816325,
                                         7.83673469387755,
                                         11.63265306122449,
                                         11.755102040816325,
                                         11.877551020408163,
                                         12.,
                                         11.63265306122449,
                                         11.755102040816325,
                                         11.877551020408163,
                                         12.,
                                         11.63265306122449,
                                         11.755102040816325,
                                         11.877551020408163,
                                         12.,
                                         11.63265306122449,
                                         11.755102040816325,
                                         11.877551020408163,
                                         12.,
                                         11.63265306122449,
                                         11.755102040816325,
                                         11.877551020408163,
                                         12.,
                                         7.9183673469387745,
                                         8.,
                                         8.081632653061224,
                                         8.163265306122447,
                                         4.040816326530612,
                                         4.081632653061224,
                                         4.122448979591836,
                                         4.163265306122449,
                                         1.9795918367346936,
                                         1.9999999999999998,
                                         2.020408163265306,
                                         2.0408163265306123,
                                         4.040816326530612,
                                         4.081632653061224,
                                         4.122448979591836,
                                         4.163265306122449,
                                         6.183673469387754,
                                         6.244897959183673,
                                         6.3061224489795915,
                                         6.36734693877551,
                                         6.183673469387754,
                                         6.244897959183673,
                                         6.3061224489795915,
                                         6.36734693877551,
                                         6.183673469387754,
                                         6.244897959183673,
                                         6.3061224489795915,
                                         6.36734693877551,
                                         6.183673469387754,
                                         6.244897959183673,
                                         6.3061224489795915,
                                         6.36734693877551,
                                         6.183673469387754,
                                         6.244897959183673,
                                         6.3061224489795915,
                                         6.36734693877551,
                                         4.204081632653061,
                                         4.244897959183673,
                                         4.285714285714286,
                                         4.326530612244897,
                                         2.142857142857143,
                                         2.1632653061224487,
                                         2.183673469387755,
                                         2.204081632653061};
  const std::array<int, 4> in_shape = {{3, 9, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678004535,  10.5300283446712,   12.555198412698413,
      14.688871882086168, 14.710102040816327, 15.773435374149658,
      18.094070294784576, 16.285907029478455, 14.36924036281179,
      12.344070294784583, 13.199416099773241, 16.034450113378682,
      18.998395691609975, 22.091252834467117, 21.791054421768706,
      23.054387755102034, 26.136927437641713, 23.430804988662125,
      20.595770975056684, 17.6318253968254,   18.87050453514739,
      22.82798752834467,  26.93479024943311,  31.1909126984127,
      30.450238095238095, 31.913571428571423, 35.877063492063485,
      32.068900226757364, 28.111417233560083, 24.004614512471655,
      26.75264739229025,  32.25774943310658,  37.93598072562358,
      43.78734126984127,  42.39388888888889,  44.09055555555555,
      49.220714285714266, 43.88874149659863,  38.3836394557823,
      32.705408163265304, 37.29990929705215,  44.7692970521542,
      52.404671201814054, 60.20603174603175,  57.59174603174603,
      59.21841269841269,  65.4152380952381,   58.11183673469387,
      50.64244897959183,  43.00707482993198,  51.05740929705215,
      61.13393990929706,  71.38359977324264,  81.80638888888889,
      77.74626984126985,  79.44293650793652,  87.23976190476192,
      77.33636054421768,  67.25982993197279,  57.01017006802721,
      48.238758503401364, 57.72005102040817,  67.35066326530612,
      77.13059523809525,  73.16769841269843,  74.63103174603175,
      81.81674603174604,  72.48477324263038,  63.00348072562359,
      53.37286848072563,  44.7377380952381,   53.504744897959185,
      62.40066326530612,  71.42549319727893,  67.66497732426305,
      68.92831065759638,  75.47116780045353,  66.83307256235827,
      58.06606575963718,  49.17014739229025,  40.151683673469385,
      48.000323129251704, 55.95746598639456,  64.02311224489797,
      60.58402494331066,  61.647358276643985, 67.42831065759637,
      59.688174603174595, 51.83953514739229,  43.882392290249435,
      60.532239229024945, 72.21421201814059,  84.00468820861677,
      95.90366780045349,  90.22846938775508,  91.29180272108842,
      99.3088662131519,   87.7353968253968,   76.05342403628117,
      64.26294784580499,  74.88359977324264,  89.32067460317461,
      103.88666099773242, 118.58155895691608, 111.51350340136054,
      112.77683673469387, 122.62723356009069, 108.31907029478457,
      93.88199546485261,  79.3160090702948,   90.31999433106576,
      107.71625283446713, 125.26183106575962, 142.9567290249433,
      134.37676870748297, 135.8401020408163,  147.6428798185941,
      130.39594104308387, 112.99968253968254, 95.45410430839003,
      109.59499433106576, 130.68172902494334, 151.94159297052153,
      173.37458616780043, 162.89184807256234, 164.58851473922903,
      178.8079591836735,  157.8943537414966,  136.80761904761903,
      115.54775510204082, 116.72439909297053, 139.13256235827666,
      161.7067120181406,  184.44684807256237, 173.11827664399092,
      174.7449433106576,  189.6560544217687,  167.41387755102036,
      145.00571428571428, 122.43156462585033, 133.89975623582765,
      159.55791950113377, 185.3892120181406,  211.39363378684808,
      198.24422902494328, 199.9408956916099,  216.82700680272106,
      191.3419727891156,  165.68380952380951, 139.8525170068027,
      119.68824829931972, 142.60831632653063, 165.67770408163267,
      188.89641156462588, 177.09422902494333, 178.55756235827664,
      193.58256235827662, 170.81181405895688, 147.89174603174604,
      124.822358276644,   106.42192176870748, 126.79096938775508,
      147.28892857142856, 167.9157993197279,  157.38742630385485,
      158.65075963718817, 171.96147392290248, 151.7213378684807,
      131.3522902494331,  110.85433106575964, 92.07056122448978,
      109.68450680272107, 127.4069557823129,  145.2379081632653,
      136.1023922902494,  137.16572562358274, 148.6431065759637,
      131.13766439909298, 113.52371882086169, 95.80126984126986,
      112.45111678004535, 133.89839569160995, 155.45417800453512,
      177.1184637188208,  165.74683673469383, 166.81017006802716,
      180.52366213151922, 159.18488662131514, 137.73760770975056,
      116.18182539682539, 136.567783446712,   162.6068990929705,
      188.77492630385487, 215.07186507936504, 201.23595238095234,
      202.49928571428566, 219.11753968253964, 193.207335600907,
      167.16821995464852, 141.00019274376416, 161.7694841269841,
      192.60451814058953, 223.58887188208615, 254.72254535147388,
      238.30329931972784, 239.76663265306115, 259.4086961451247,
      228.7229818594104,  197.887947845805,   166.90359410430838,
      192.43734126984123, 229.10570861678,    265.94720521541944,
      302.96183106575955, 283.38980725623577, 285.0864739229024,
      308.39520408163264, 271.89996598639453, 235.2315986394558,
      198.39010204081632, 196.1488888888889,  233.49582766439906,
      271.0087528344671,  308.68766439909297, 288.6448072562358,
      290.2714739229025,  313.8968707482993,  276.71591836734694,
      239.36897959183676, 201.8560544217687,  216.7421031746032,
      257.98189909297054, 299.3948242630386,  340.9808786848073,
      318.7421882086168,  320.4388548752834,  346.4142517006803,
      305.3475850340136,  264.10778911564626, 222.6948639455782,
      191.1377380952381,  227.4965816326531,  264.0047448979592,
      300.66222789115653, 281.02075963718823, 282.48409297052154,
      305.34837868480724, 269.1388548752834,  232.78001133786844,
      196.27184807256234, 168.10610544217687, 200.077193877551,
      232.17719387755102, 264.4061054421769,  247.10987528344668,
      248.37320861678003, 268.4517800453514,  236.60960317460317,
      204.63851473922898, 172.538514739229,   143.9894387755102,
      171.3686904761905,  198.8564455782313,  226.45270408163265,
      211.6207596371882,  212.6840929705215,  229.85790249433103,
      202.58715419501132, 175.20790249433102, 147.72014739229024};
  const std::array<int, 4> in_shape = {{3, 9, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.20408163265306123, 0.20408163265306123,  0.20408163265306123,
      0.20408163265306123, 0.18367346938775508,  0.14285714285714285,
      0.08163265306122448, 0.12244897959183672,  0.2857142857142857,
      0.48979591836734687, 0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,  0.7346938775510203,   0.6122448979591837,
      0.44897959183673464, 0.24489795918367346,  0.3061224489795918,
      0.673469387755102,   1.1020408163265305,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.2857142857142858,  0.9183673469387754,   0.4897959183673469,
      0.3061224489795918,  0.673469387755102,    1.1020408163265305,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.2857142857142858,   0.9183673469387754,
      0.4897959183673469,  0.3061224489795918,   0.673469387755102,
      1.1020408163265305,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.2857142857142858,
      0.9183673469387754,  0.4897959183673469,   0.3061224489795918,
      0.673469387755102,   1.1020408163265305,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.2857142857142858,  0.9183673469387754,   0.4897959183673469,
      0.3061224489795918,  0.673469387755102,    1.1020408163265305,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.2857142857142858,   0.9183673469387754,
      0.4897959183673469,  0.2857142857142857,   0.6122448979591836,
      0.9795918367346939,  1.3877551020408163,   1.3877551020408163,
      1.3877551020408163,  1.3877551020408163,   1.1020408163265305,
      0.7755102040816326,  0.40816326530612246,  0.18367346938775508,
      0.3877551020408163,  0.6122448979591837,   0.8571428571428572,
      0.8571428571428572,  0.8571428571428572,   0.8571428571428572,
      0.6734693877551019,  0.4693877551020408,   0.24489795918367346,
      0.26530612244897955, 0.5510204081632653,   0.857142857142857,
      1.1836734693877549,  1.1836734693877549,   1.1836734693877549,
      1.1836734693877549,  0.9183673469387754,   0.6326530612244897,
      0.32653061224489793, 0.6122448979591837,   1.2653061224489794,
      1.9591836734693875,  2.693877551020408,    2.693877551020408,
      2.693877551020408,   2.693877551020408,    2.081632653061224,
      1.4285714285714284,  0.7346938775510203,   1.0408163265306123,
      2.142857142857143,   3.3061224489795915,   4.530612244897958,
      4.530612244897958,   4.530612244897958,    4.530612244897958,
      3.4897959183673466,  2.387755102040816,    1.2244897959183674,
      1.0408163265306123,  2.142857142857143,    3.3061224489795915,
      4.530612244897958,   4.530612244897958,    4.530612244897958,
      4.530612244897958,   3.4897959183673466,   2.387755102040816,
      1.2244897959183674,  1.0408163265306123,   2.142857142857143,
      3.3061224489795915,  4.530612244897958,    4.530612244897958,
      4.530612244897958,   4.530612244897958,    3.4897959183673466,
      2.387755102040816,   1.2244897959183674,   1.0408163265306123,
      2.142857142857143,   3.3061224489795915,   4.530612244897958,
      4.530612244897958,   4.530612244897958,    4.530612244897958,
      3.4897959183673466,  2.387755102040816,    1.2244897959183674,
      1.0408163265306123,  2.142857142857143,    3.3061224489795915,
      4.530612244897958,   4.530612244897958,    4.530612244897958,
      4.530612244897958,   3.4897959183673466,   2.387755102040816,
      1.2244897959183674,  0.7755102040816326,   1.5918367346938775,
      2.4489795918367343,  3.346938775510204,    3.346938775510204,
      3.346938775510204,   3.346938775510204,    2.571428571428571,
      1.7551020408163267,  0.8979591836734693,   0.42857142857142855,
      0.8775510204081631,  1.3469387755102038,   1.8367346938775508,
      1.8367346938775508,  1.8367346938775508,   1.8367346938775508,
      1.4081632653061225,  0.9591836734693877,   0.4897959183673469,
      0.5102040816326531,  1.0408163265306123,   1.5918367346938775,
      2.163265306122449,   2.163265306122449,    2.163265306122449,
      2.163265306122449,   1.6530612244897958,   1.1224489795918366,
      0.5714285714285714,  1.1020408163265305,   2.2448979591836733,
      3.4285714285714284,  4.653061224489796,    4.653061224489796,
      4.653061224489796,   4.653061224489796,    3.551020408163265,
      2.408163265306122,   1.2244897959183674,   1.7755102040816326,
      3.6122448979591835,  5.510204081632653,    7.469387755102041,
      7.469387755102041,   7.469387755102041,    7.469387755102041,
      5.693877551020408,   3.8571428571428568,   1.9591836734693877,
      1.7755102040816326,  3.6122448979591835,   5.510204081632653,
      7.469387755102041,   7.469387755102041,    7.469387755102041,
      7.469387755102041,   5.693877551020408,    3.8571428571428568,
      1.9591836734693877,  1.7755102040816326,   3.6122448979591835,
      5.510204081632653,   7.469387755102041,    7.469387755102041,
      7.469387755102041,   7.469387755102041,    5.693877551020408,
      3.8571428571428568,  1.9591836734693877,   1.7755102040816326,
      3.6122448979591835,  5.510204081632653,    7.469387755102041,
      7.469387755102041,   7.469387755102041,    7.469387755102041,
      5.693877551020408,   3.8571428571428568,   1.9591836734693877,
      1.7755102040816326,  3.6122448979591835,   5.510204081632653,
      7.469387755102041,   7.469387755102041,    7.469387755102041,
      7.469387755102041,   5.693877551020408,    3.8571428571428568,
      1.9591836734693877,  1.2653061224489797,   2.571428571428571,
      3.9183673469387754,  5.3061224489795915,   5.3061224489795915,
      5.3061224489795915,  5.3061224489795915,   4.040816326530612,
      2.7346938775510203,  1.387755102040816,    0.673469387755102,
      1.3673469387755102,  2.0816326530612246,   2.816326530612245,
      2.816326530612245,   2.816326530612245,    2.816326530612245,
      2.142857142857143,   1.4489795918367345,   0.7346938775510203};
  const std::array<int, 4> in_shape = {{3, 9, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.64984693877551,  17.22672335600907,  20.374676870748296,
      21.0600566893424,   24.31651360544218,  25.110396825396826,
      28.475357142857142, 29.377743764172337, 28.581111111111106,
      29.420204081632654, 30.707777777777775, 31.546870748299316,
      35.285753968253964, 36.18814058956915,  31.77793083900226,
      32.57181405895691,  28.053100907029474, 28.73848072562358,
      24.111264172335602, 24.688140589569166, 25.713452380952383,
      26.398832199546483, 31.25460884353741,  32.068900226757364,
      37.053588435374145, 37.99679138321995,  43.11039115646258,
      44.18250566893423,  42.58519274376416,  43.58210884353741,
      45.11185941043083,  46.10877551020407,  51.20174036281178,
      52.273854875283426, 45.918407029478445, 46.86160997732425,
      40.377250566893416, 41.19154195011337,  34.57827097505669,
      35.2636507936508,   36.947125850340136, 37.74100907029478,
      44.71277210884353,  45.65597505668934,  52.77705782312924,
      53.86958049886622,  61.13998299319727,  62.3818253968254,
      59.745736961451236, 60.90047619047619,  62.672403628117905,
      63.827142857142846, 70.51228458049886,  71.75412698412697,
      63.04527777777776,  64.13780045351473,  55.27963151927437,
      56.222834467120165, 47.215345804988665, 48.00922902494331,
      52.58482426303855,  53.5052947845805,   63.42189909297051,
      64.51549886621316,  74.60523242630384,  75.87196145124716,
      86.13482426303854,  87.57468253968254,  83.44891156462585,
      84.78777777777778,  86.84224489795918,  88.1811111111111,
      97.00157029478457,  98.44142857142853,  86.51075396825397,
      87.77748299319725,  75.67367913832199,  76.7672789115646,
      64.49034580498866,  65.41081632653061,  73.71732426303855,
      74.5998185941043,   88.4901133786848,   89.5385941043084,
      103.59487528344668, 104.80934240362811, 119.03160997732424,
      120.4120634920635,  113.89986394557822, 115.18349206349205,
      117.15319727891155, 118.43682539682538, 129.45002267573693,
      130.8304761904762,  115.00920634920634, 116.22367346938773,
      100.23641723356009, 101.28489795918367, 85.13165532879819,
      86.01414965986396,  101.19434807256235, 102.1148185941043,
      121.17428004535147, 122.26787981859412, 141.50047052154196,
      142.76719954648527, 162.17291950113375, 163.61277777777778,
      154.15367346938774, 155.4925396825397,  157.54700680272106,
      158.88587301587305, 173.03966553287978, 174.47952380952384,
      153.40599206349205, 154.67272108843537, 133.42606009070295,
      134.51965986394558, 113.09986961451249, 114.02034013605441,
      95.68363378684808,  96.47751700680273,  114.49689909297052,
      115.44010204081634, 133.60880385487528, 134.70132653061225,
      153.01934807256234, 154.2611904761905,  145.18065759637187,
      146.33539682539686, 148.10732426303852, 149.2620634920635,
      162.39164965986393, 163.63349206349207, 143.87702380952382,
      144.96954648526076, 125.06375850340137, 126.00696145124718,
      105.95185374149659, 106.74573696145126, 88.79009637188209,
      89.4754761904762,   106.1951984126984,  107.00948979591837,
      123.85812358276644, 124.80132653061224, 141.77887188208615,
      142.85098639455785, 134.33303854875282, 135.3299546485261,
      136.8597052154195,  137.85662131519277, 149.87022108843536,
      150.94233560090706, 132.72294217687076, 133.66614512471654,
      115.31784013605443, 116.13213151927437, 97.65491496598639,
      98.3402947845805,   79.72649092970521,  80.30336734693877,
      95.31526643990931,  96.00064625850341,  111.12104875283448,
      111.91493197278912, 127.14383786848073, 128.04622448979595,
      120.3289569160998,  121.16804988662132, 122.45562358276645,
      123.29471655328797, 133.95423469387757, 134.85662131519274,
      118.58246598639457, 119.37634920634919, 102.99369047619048,
      103.67907029478458, 87.1879081632653,   87.76478458049887,
      120.48760204081634, 121.06447845804989, 143.74304421768707,
      144.42842403628117, 167.2154931972789,  168.00937641723354,
      190.90494897959184, 191.80733560090698, 179.61784580498866,
      180.45693877551017, 181.74451247165536, 182.58360544217683,
      197.71534580498866, 198.6177324263038,  174.67691043083903,
      175.4707936507936,  151.42146825396827, 152.10684807256234,
      127.94901927437643, 128.52589569160997, 149.08181972789117,
      149.76719954648527, 177.82705782312925, 178.64134920634922,
      206.83011904761904, 207.77332199546484, 236.09100340136055,
      237.16311791383217, 222.03009070294783, 223.02700680272108,
      224.55675736961453, 225.55367346938775, 244.18235260770976,
      245.25446712018137, 215.69493764172339, 216.63814058956913,
      186.94969954648528, 187.76399092970522, 157.94663832199547,
      158.6320181405896,  179.84610544217688, 180.63998866213151,
      214.48930272108842, 215.43250566893425, 249.43113945578227,
      250.52366213151925, 284.67161564625854, 285.9134580498866,
      267.598798185941,   268.75353741496593, 270.5254648526077,
      271.6802040816326,  294.0439172335601,  295.2857596371882,
      259.6993594104309,  260.79188208616773, 225.05616213151927,
      225.99936507936508, 190.1143253968254,  190.90820861678006,
      218.26951814058955, 219.18998866213153, 260.26985827664396,
      261.3634580498867,  302.61645691609976, 303.88318594104305,
      345.309314058957,   346.74917233560086, 324.4448299319728,
      325.7836961451247,  327.8381632653061,  329.17702947845805,
      356.17606009070295, 357.615918367347,   314.52197845804994,
      315.7887074829932,  272.5216383219955,  273.61523809523806,
      230.17503968253968, 231.09551020408165, 232.5663038548753,
      233.44879818594106, 277.21664399092964, 278.2651247165533,
      322.1989569160997,  323.4134240362812,  367.51324263038543,
      368.89369614512475, 344.95292517006806, 346.23655328798185,
      348.2062585034014,  349.4898866213152,  377.93165532879823,
      379.3121088435374,  333.61328798185946, 334.8277551020407,
      288.962947845805,   290.01142857142855, 243.98063492063488,
      244.86312925170066, 266.87904195011345, 267.7995124716553,
      318.022239229025,   319.11583900226753, 369.51169501133785,
      370.7784240362812,  421.34740929705214, 422.78726757369617,
      395.14959183673466, 396.48845804988656, 398.54292517006814,
      399.8817913832198,  432.2141553287982,  433.6540136054421,
      381.417216553288,   382.6839455782312,  330.27401927437637,
      331.36761904761903, 278.7845634920634,  279.7050340136054,
      238.5826133786848,  239.37649659863945, 284.27342970521545,
      285.21663265306125, 330.2628854875283,  331.35540816326534,
      376.5509807256236,  377.79282312925176, 353.0337188208617,
      354.18845804988666, 355.9603854875284,  357.1151247165533,
      385.92328231292515, 387.16512471655324, 340.5311054421768,
      341.62362811791377, 294.84028911564616, 295.7834920634921,
      248.85083333333327, 249.644716553288,   212.15846371882085,
      212.84384353741495, 252.76764739229026, 253.58193877551017,
      293.6346541950114,  294.5778571428571,  334.75948412698415,
      335.8315986394558,  313.77793650793654, 314.7748526077097,
      316.30460317460313, 317.30151927437635, 342.8508333333333,
      343.92294784580497, 302.4994727891156,  303.4426757369614,
      261.89028911564617, 262.7045804988662,  221.02328231292515,
      221.70866213151928, 183.56424603174602, 184.14112244897956,
      218.6836337868481,  219.36901360544215, 254.0200283446712,
      254.8139115646258,  289.5734297052154,  290.4758163265306,
      271.3656916099773,  272.2047845804988,  273.4923582766439,
      274.3314512471655,  296.3838265306122,  297.2862131519274,
      261.4814455782313,  262.27532879818597, 226.36205782312922,
      227.04743764172338, 191.02566326530612, 191.6025396825397,
      224.32535714285714, 224.9022335600907,  267.1114115646258,
      267.7967913832199,  310.1144727891156,  310.90835600907025,
      353.33454081632647, 354.2369274376416,  330.65458049886615,
      331.49367346938766, 332.7812471655328,  333.6203401360543,
      360.1449376417233,  361.04732426303843, 317.57589002267565,
      318.3697732426303,  274.7898356009071,  275.4752154195011,
      231.78677437641727, 232.36365079365078, 272.4501870748299,
      273.135566893424,   324.399506802721,   325.213798185941,
      376.6066496598639,  377.54985260770974, 429.0716156462584,
      430.1437301587301,  401.4749886621314,  402.4719047619047,
      404.0016553287981,  404.9985714285713,  437.1629648526077,
      438.2350793650793,  385.4714682539682,  386.414671201814,
      333.5221485260772,  334.33643990929704, 281.3150056689343,
      282.0003854875283,  322.7450850340135,  323.5389682539682,
      384.26583333333326, 385.20903628117907, 446.0852210884352,
      447.1777437641723,  508.20324829931957, 509.44509070294777,
      475.45185941043064, 476.6065986394557,  478.3785260770974,
      479.5332653061223,  517.5755498866213,  518.8173922902494,
      456.3534410430838,  457.4459637188208,  394.83269274376426,
      395.77589569161,    333.0133049886622,  333.80718820861676,
      383.95421201814054, 384.87468253968245, 457.11781746031744,
      458.21141723356,    530.6276814058955,  531.8944104308389,
      604.483803854875,   605.9236621315191,  565.4407482993195,
      566.7796145124715,  568.8340816326529,  570.1729478458049,
      615.3505498866211,  616.7904081632653,  542.5332029478458,
      543.7999319727891,  469.36959750566905, 470.4631972789116,
      395.8597335600908,  396.78020408163263, 391.415283446712,
      392.2977777777778,  465.9431746031746,  466.9916553287981,
      540.8030385487527,  542.0175056689342,  615.9948752834466,
      617.3753287981859,  576.0059863945578,  577.2896145124716,
      579.259319727891,   580.542947845805,   626.4132879818594,
      627.7937414965986,  552.2173696145126,  553.4318367346939,
      477.6894784580499,  478.7379591836735,  402.8296145124716,
      403.7121088435374,  432.56373582766435, 433.4842063492064,
      514.8701984126983,  515.9637981859411,  597.5229195011337,
      598.7896485260771,  680.5218990929706,  681.9617573696146,
      636.1455102040816,  637.4843764172336,  639.5388435374149,
      640.8777097505669,  691.3886451247165,  692.8285034013606,
      609.4284410430839,  610.6951700680272,  527.12197845805,
      528.2155782312925,  444.4692573696145,  445.3897278911564,
      381.4815929705215,  382.2754761904762,  454.04996031746026,
      454.9931632653062,  526.9169671201814,  528.0094897959184,
      600.0826133786848,  601.3244557823131,  560.8867800453514,
      562.0415192743765,  563.8134467120182,  564.9681859410431,
      609.4549149659864,  610.6967573696145,  537.1851870748301,
      538.2777097505668,  464.61681972789114, 465.5600226757369,
      391.74981292517003, 392.54369614512467, 335.52683106575967,
      336.21221088435374, 399.34009637188205, 400.154387755102,
      463.4111848072562,  464.35438775510204, 527.740096371882,
      528.8122108843538,  493.22283446712015, 494.21975056689337,
      495.7495011337869,  496.74641723356007, 535.8314455782313,
      536.9035600907029,  472.2760034013606,  473.21920634920633,
      408.4627380952381,  409.27702947845796, 344.39164965986396,
      345.077029478458,   287.4020011337869,  287.9788775510204,
      342.05200113378686, 342.737380952381,   396.91900793650797,
      397.7128911564626,  452.00302154195015, 452.9054081632653,
      422.40242630385495, 423.2415192743764,  424.52909297052156,
      425.368185941043,   458.81341836734697, 459.71580498866206,
      404.38042517006807, 405.17430839002265, 349.73042517006803,
      350.41580498866205, 294.8634183673469,  295.4402947845805};
  const std::array<int, 4> in_shape = {{3, 9, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.30612244897959184,
      0.36734693877551017, 0.24489795918367346, 0.2857142857142857,
      0.14285714285714285, 0.16326530612244897, 0.2040816326530612,
      0.24489795918367344, 0.48979591836734687, 0.5714285714285714,
      0.8571428571428571,  0.9795918367346937,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.1020408163265305,  1.2244897959183674,
      0.8163265306122447,  0.8979591836734693,  0.44897959183673464,
      0.4897959183673469,  0.5510204081632653,  0.6122448979591836,
      1.2244897959183674,  1.346938775510204,   2.020408163265306,
      2.204081632653061,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.387755102040816,   2.5714285714285716,  1.714285714285714,
      1.8367346938775508,  0.9183673469387754,  0.9795918367346939,
      0.5510204081632653,  0.6122448979591836,  1.2244897959183674,
      1.346938775510204,   2.020408163265306,   2.204081632653061,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.387755102040816,
      2.5714285714285716,  1.714285714285714,   1.8367346938775508,
      0.9183673469387754,  0.9795918367346939,  0.5510204081632653,
      0.6122448979591836,  1.2244897959183674,  1.346938775510204,
      2.020408163265306,   2.204081632653061,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.387755102040816,   2.5714285714285716,
      1.714285714285714,   1.8367346938775508,  0.9183673469387754,
      0.9795918367346939,  0.5510204081632653,  0.6122448979591836,
      1.2244897959183674,  1.346938775510204,   2.020408163265306,
      2.204081632653061,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.387755102040816,   2.5714285714285716,  1.714285714285714,
      1.8367346938775508,  0.9183673469387754,  0.9795918367346939,
      0.5510204081632653,  0.6122448979591836,  1.2244897959183674,
      1.346938775510204,   2.020408163265306,   2.204081632653061,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.387755102040816,
      2.5714285714285716,  1.714285714285714,   1.8367346938775508,
      0.9183673469387754,  0.9795918367346939,  0.5306122448979591,
      0.5714285714285714,  1.1428571428571428,  1.2244897959183672,
      1.8367346938775508,  1.9591836734693877,  2.612244897959183,
      2.7755102040816326,  2.612244897959183,   2.7755102040816326,
      2.612244897959183,   2.7755102040816326,  2.612244897959183,
      2.7755102040816326,  2.0816326530612246,  2.204081632653061,
      1.4693877551020407,  1.5510204081632653,  0.7755102040816326,
      0.8163265306122449,  0.3469387755102041,  0.36734693877551017,
      0.7346938775510203,  0.7755102040816326,  1.163265306122449,
      1.2244897959183674,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.2857142857142856,  1.3469387755102038,  0.8979591836734693,
      0.9387755102040816,  0.4693877551020408,  0.4897959183673469,
      0.5102040816326531,  0.5306122448979591,  1.0612244897959182,
      1.1020408163265305,  1.6530612244897958,  1.714285714285714,
      2.2857142857142856,  2.3673469387755097,  2.2857142857142856,
      2.3673469387755097,  2.2857142857142856,  2.3673469387755097,
      2.2857142857142856,  2.3673469387755097,  1.7755102040816326,
      1.8367346938775508,  1.2244897959183674,  1.2653061224489794,
      0.6326530612244897,  0.6530612244897959,  1.183673469387755,
      1.2244897959183674,  2.4489795918367347,  2.530612244897959,
      3.795918367346938,   3.918367346938775,   5.224489795918367,
      5.387755102040816,   5.224489795918367,   5.387755102040816,
      5.224489795918367,   5.387755102040816,   5.224489795918367,
      5.387755102040816,   4.040816326530612,   4.163265306122448,
      2.7755102040816326,  2.8571428571428568,  1.4285714285714284,
      1.4693877551020407,  2.020408163265306,   2.0816326530612246,
      4.163265306122449,   4.285714285714286,   6.428571428571428,
      6.612244897959183,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      6.795918367346939,   6.979591836734693,   4.653061224489796,
      4.775510204081632,   2.387755102040816,   2.4489795918367347,
      2.020408163265306,   2.0816326530612246,  4.163265306122449,
      4.285714285714286,   6.428571428571428,   6.612244897959183,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   6.795918367346939,
      6.979591836734693,   4.653061224489796,   4.775510204081632,
      2.387755102040816,   2.4489795918367347,  2.020408163265306,
      2.0816326530612246,  4.163265306122449,   4.285714285714286,
      6.428571428571428,   6.612244897959183,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   6.795918367346939,   6.979591836734693,
      4.653061224489796,   4.775510204081632,   2.387755102040816,
      2.4489795918367347,  2.020408163265306,   2.0816326530612246,
      4.163265306122449,   4.285714285714286,   6.428571428571428,
      6.612244897959183,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      6.795918367346939,   6.979591836734693,   4.653061224489796,
      4.775510204081632,   2.387755102040816,   2.4489795918367347,
      2.020408163265306,   2.0816326530612246,  4.163265306122449,
      4.285714285714286,   6.428571428571428,   6.612244897959183,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   6.795918367346939,
      6.979591836734693,   4.653061224489796,   4.775510204081632,
      2.387755102040816,   2.4489795918367347,  1.510204081632653,
      1.5510204081632653,  3.10204081632653,    3.183673469387755,
      4.775510204081632,   4.897959183673469,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   5.020408163265305,   5.142857142857142,
      3.4285714285714284,  3.5102040816326534,  1.7551020408163263,
      1.7959183673469385,  0.836734693877551,   0.8571428571428571,
      1.7142857142857142,  1.7551020408163263,  2.63265306122449,
      2.6938775510204076,  3.5918367346938775,  3.6734693877551017,
      3.5918367346938775,  3.6734693877551017,  3.5918367346938775,
      3.6734693877551017,  3.5918367346938775,  3.6734693877551017,
      2.7551020408163263,  2.816326530612245,   1.8775510204081631,
      1.9183673469387754,  0.9591836734693877,  0.9795918367346939,
      0.9999999999999999,  1.0204081632653061,  2.040816326530612,
      2.0816326530612246,  3.1224489795918364,  3.183673469387755,
      4.244897959183673,   4.326530612244898,   4.244897959183673,
      4.326530612244898,   4.244897959183673,   4.326530612244898,
      4.244897959183673,   4.326530612244898,   3.244897959183673,
      3.3061224489795915,  2.204081632653061,   2.2448979591836733,
      1.1224489795918366,  1.1428571428571428,  2.1632653061224487,
      2.204081632653061,   4.408163265306122,   4.489795918367347,
      6.73469387755102,    6.857142857142857,   9.142857142857142,
      9.306122448979592,   9.142857142857142,   9.306122448979592,
      9.142857142857142,   9.306122448979592,   9.142857142857142,
      9.306122448979592,   6.979591836734692,   7.10204081632653,
      4.73469387755102,    4.816326530612244,   2.408163265306122,
      2.4489795918367347,  3.4897959183673466,  3.5510204081632653,
      7.1020408163265305,  7.224489795918367,   10.83673469387755,
      11.020408163265307,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      11.20408163265306,   11.387755102040815,  7.591836734693877,
      7.7142857142857135,  3.8571428571428568,  3.9183673469387754,
      3.4897959183673466,  3.5510204081632653,  7.1020408163265305,
      7.224489795918367,   10.83673469387755,   11.020408163265307,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  11.20408163265306,
      11.387755102040815,  7.591836734693877,   7.7142857142857135,
      3.8571428571428568,  3.9183673469387754,  3.4897959183673466,
      3.5510204081632653,  7.1020408163265305,  7.224489795918367,
      10.83673469387755,   11.020408163265307,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  11.20408163265306,   11.387755102040815,
      7.591836734693877,   7.7142857142857135,  3.8571428571428568,
      3.9183673469387754,  3.4897959183673466,  3.5510204081632653,
      7.1020408163265305,  7.224489795918367,   10.83673469387755,
      11.020408163265307,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      11.20408163265306,   11.387755102040815,  7.591836734693877,
      7.7142857142857135,  3.8571428571428568,  3.9183673469387754,
      3.4897959183673466,  3.5510204081632653,  7.1020408163265305,
      7.224489795918367,   10.83673469387755,   11.020408163265307,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  11.20408163265306,
      11.387755102040815,  7.591836734693877,   7.7142857142857135,
      3.8571428571428568,  3.9183673469387754,  2.4897959183673466,
      2.5306122448979593,  5.061224489795919,   5.142857142857142,
      7.7142857142857135,  7.836734693877551,   10.448979591836734,
      10.612244897959183,  10.448979591836734,  10.612244897959183,
      10.448979591836734,  10.612244897959183,  10.448979591836734,
      10.612244897959183,  7.959183673469387,   8.081632653061224,
      5.387755102040816,   5.469387755102041,   2.7346938775510203,
      2.775510204081632,   1.3265306122448979,  1.346938775510204,
      2.693877551020408,   2.7346938775510203,  4.1020408163265305,
      4.163265306122449,   5.551020408163265,   5.63265306122449,
      5.551020408163265,   5.63265306122449,    5.551020408163265,
      5.63265306122449,    5.551020408163265,   5.63265306122449,
      4.224489795918367,   4.285714285714286,   2.8571428571428568,
      2.897959183673469,   1.4489795918367345,  1.4693877551020407};
  const std::array<int, 4> in_shape = {{3, 9, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.72281746031746,  33.29969387755102,  33.876570294784585,
      34.45344671201814,  40.06397392290249,  40.74935374149659,
      41.434733560090706, 42.1201133786848,   47.8391439909297,
      48.63302721088436,  49.426910430838994, 50.22079365079365,
      56.04832766439909,  56.950714285714284, 57.853100907029464,
      58.75548752834467,  56.32312925170068,  57.16222222222221,
      58.00131519274377,  58.84040816326531,  60.576462585034015,
      61.41555555555555,  62.254648526077105, 63.09374149659863,
      69.66912131519274,  70.57150793650793,  71.47389455782313,
      72.3762811791383,   62.76197845804988,  63.55586167800452,
      64.34974489795918,  65.14362811791382,  55.42082199546485,
      56.10620181405895,  56.79158163265306,  57.47696145124716,
      47.64565192743764,  48.222528344671204, 48.79940476190476,
      49.37628117913833,  50.74152494331066,  51.426904761904765,
      52.112284580498866, 52.797664399092966, 61.69492630385488,
      62.50921768707482,  63.32350907029478,  64.13780045351473,
      73.16397392290249,  74.10717687074829,  75.0503798185941,
      75.9935827664399,   85.1486678004535,   86.22078231292517,
      87.2928968253968,   88.36501133786847,  84.17346938775509,
      85.17038548752832,  86.1673015873016,   87.16421768707482,
      89.22680272108843,  90.22371882086166,  91.22063492063492,
      92.21755102040814,  101.33136621315192, 102.40348072562357,
      103.47559523809524, 104.54770975056685, 90.89361111111111,
      91.83681405895689,  92.78001700680272,  93.7232199546485,
      79.94020975056691,  80.75450113378683,  81.56879251700681,
      82.38308390022674,  68.47116213151928,  69.15654195011338,
      69.84192176870748,  70.5273015873016,   73.10036848072562,
      73.89425170068027,  74.68813492063491,  75.48201814058956,
      88.48234126984129,  89.42554421768706,  90.36874716553288,
      91.31195011337869,  104.46159297052155, 105.55411564625848,
      106.64663832199544, 107.73916099773244, 121.03812358276642,
      122.27996598639454, 123.52180839002263, 124.7636507936508,
      118.33673469387755, 119.49147392290247, 120.64621315192743,
      121.80095238095238, 124.19006802721088, 125.34480725623581,
      126.49954648526077, 127.65428571428569, 139.7827267573696,
      141.02456916099771, 142.26641156462583, 143.50825396825394,
      124.99803287981858, 126.09055555555553, 127.18307823129251,
      128.27560090702946, 109.61606009070294, 110.55926303854874,
      111.50246598639455, 112.44566893424033, 93.63680839002267,
      94.43069160997733,  95.22457482993195,  96.01845804988662,
      104.24917800453515, 105.1696485260771,  106.09011904761904,
      107.010589569161,   125.75019841269844, 126.84379818594103,
      127.93739795918367, 129.03099773242633, 147.94373582766443,
      149.21046485260769, 150.477193877551,   151.74392290249432,
      170.82979024943305, 172.26964852607708, 173.70950680272102,
      175.14936507936508, 165.55895691609976, 166.8978231292517,
      168.23668934240362, 169.57555555555555, 172.34562358276642,
      173.68448979591835, 175.02335600907028, 176.3622222222222,
      192.56328231292514, 194.00314058956914, 195.44299886621312,
      196.88285714285706, 171.75477891156459, 173.02150793650793,
      174.28823696145122, 175.5549659863945,  150.25375850340134,
      151.34735827664397, 152.4409580498866,  153.5345578231292,
      128.06022108843536, 128.98069160997733, 129.90116213151924,
      130.82163265306122, 146.55215419501133, 147.4346485260771,
      148.31714285714284, 149.1996371882086,  175.93174603174606,
      176.9802267573696,  178.02870748299316, 179.0771882086168,
      205.97528344671204, 207.18975056689337, 208.40421768707478,
      209.61868480725622, 236.6827664399093,  238.06321995464847,
      239.4436734693877,  240.824126984127,   226.51609977324264,
      227.79972789115644, 229.08335600907026, 230.3669841269841,
      233.02276643990933, 234.3063945578231,  235.59002267573692,
      236.87365079365077, 257.5195918367347,  258.90004535147386,
      260.2804988662131,  261.6609523809524,  228.8039455782313,
      230.01841269841267, 231.23287981859409, 232.44734693877547,
      199.4243537414966,  200.47283446712018, 201.5213151927437,
      202.56979591836733, 169.3808163265306,  170.26331065759638,
      171.1458049886621,  172.02829931972792, 201.46822562358278,
      202.3886961451247,  203.30916666666664, 204.2296371882086,
      241.25496031746036, 242.34856009070293, 243.44215986394553,
      244.53575963718825, 281.7342120181406,  283.0009410430839,
      284.26767006802714, 285.53439909297055, 322.9059807256236,
      324.3458390022675,  325.7856972789116,  327.22555555555556,
      306.96848072562364, 308.3073469387755,  309.6462131519274,
      310.9850793650794,  313.75514739229027, 315.0940136054421,
      316.4328798185941,  317.7717460317461,  344.63947278911564,
      346.07933106575956, 347.5191893424036,  348.9590476190477,
      305.54525510204076, 306.8119841269841,  308.07871315192745,
      309.34544217687073, 265.75852040816324, 266.8521201814059,
      267.94571995464844, 269.03931972789115, 225.279268707483,
      226.19973922902497, 227.12020975056686, 228.04068027210883,
      190.5733843537415,  191.36726757369615, 192.1611507936508,
      192.95503401360546, 228.05059523809524, 228.99379818594105,
      229.9370011337868,  230.88020408163268, 266.1250850340136,
      267.21760770975055, 268.31013038548747, 269.4026530612245,
      304.7968537414966,  306.0386961451247,  307.2805385487528,
      308.522380952381,   289.2065759637188,  290.36131519274375,
      291.51605442176873, 292.6707936507937,  295.0599092970521,
      296.21464852607704, 297.36938775510197, 298.524126984127,
      323.5414569160997,  324.78329931972786, 326.02514172335594,
      327.26698412698414, 286.6615249433106,  287.75404761904764,
      288.84657029478456, 289.93909297052153, 249.1843140589569,
      250.12751700680275, 251.0707199546485,  252.01392290249436,
      211.10982426303852, 211.90370748299318, 212.69759070294782,
      213.49147392290251, 176.89481292517007, 177.58019274376417,
      178.26557256235827, 178.9509523809524,  211.57610544217687,
      212.3903968253968,  213.20468820861677, 214.01897959183674,
      246.77304421768704, 247.71624716553288, 248.65945011337865,
      249.6026530612245,  282.4856292517007,  283.5577437641723,
      284.629858276644,   285.7019727891157,  267.66916099773243,
      268.66607709750565, 269.66299319727887, 270.6599092970522,
      272.7224943310657,  273.719410430839,   274.71632653061226,
      275.71324263038554, 298.6683276643991,  299.7404421768707,
      300.8125566893424,  301.8846712018141,  264.5026814058957,
      265.4458843537415,  266.3890873015873,  267.3322902494331,
      229.82138888888886, 230.63568027210886, 231.44997165532877,
      232.26426303854873, 194.62445011337869, 195.30982993197279,
      195.99520975056686, 196.680589569161,   158.87610544217688,
      159.45298185941041, 160.029858276644,   160.60673469387754,
      189.94515306122446, 190.63053287981862, 191.3159126984127,
      192.00129251700682, 221.44821428571424, 222.24209750566897,
      223.03598072562357, 223.82986394557824, 253.38528911564626,
      254.28767573696146, 255.19006235827663, 256.0924489795919,
      239.81882086167798, 240.6579138321996,  241.49700680272107,
      242.33609977324264, 244.0721541950113,  244.9112471655329,
      245.7503401360544,  246.58943310657594, 267.0060827664399,
      267.90846938775513, 268.8108560090703,  269.7132426303855,
      236.37104875283444, 237.16493197278913, 237.95881519274374,
      238.75269841269838, 205.30200113378683, 205.98738095238096,
      206.67276077097503, 207.35814058956916, 173.79893990929705,
      174.3758163265306,  174.95269274376415, 175.52956916099774,
      240.3983276643991,  240.97520408163268, 241.55208049886622,
      242.12895691609978, 286.80070861678007, 287.48608843537414,
      288.17146825396827, 288.85684807256234, 333.6371031746032,
      334.4309863945578,  335.22486961451244, 336.0187528344671,
      380.90751133786847, 381.8098979591837,  382.7122845804988,
      383.61467120181396, 358.39659863945576, 359.2356916099773,
      360.0747845804988,  360.91387755102033, 362.64993197278915,
      363.4890249433107,  364.32811791383216, 365.16721088435366,
      394.52830498866206, 395.4306916099773,  396.3330782312924,
      397.2354648526076,  348.55993764172337, 349.35382086167806,
      350.14770408163264, 350.9415873015872,  302.15755668934236,
      302.84293650793654, 303.5283163265306,  304.2136961451247,
      255.32116213151923, 255.89803854875285, 256.47491496598644,
      257.05179138321995, 297.4782596371882,  298.16363945578235,
      298.8490192743765,  299.53439909297055, 354.8398242630385,
      355.6541156462585,  356.46840702947856, 357.28269841269844,
      412.71703514739227, 413.66023809523807, 414.60344104308393,
      415.5466439909297,  471.1098922902494,  472.1820068027211,
      473.2541213151928,  474.32623582766433, 443.0632653061224,
      444.06018140589566, 445.0570975056689,  446.05401360544215,
      448.11659863945573, 449.11351473922906, 450.1104308390022,
      451.1073469387755,  487.2925907029478,  488.3647052154195,
      489.436819727891,   490.50893424036275, 430.4466723356009,
      431.38987528344677, 432.33307823129246, 433.27628117913827,
      373.0851077097505,  373.89939909297055, 374.71369047619044,
      375.52798185941043, 315.2078968253968,  315.89327664399093,
      316.57865646258506, 317.2640362811792,  358.8983276643991,
      359.69221088435376, 360.4860941043084,  361.27997732426303,
      428.03540249433104, 428.97860544217684, 429.9218083900227,
      430.8650113378685,  497.76975623582763, 498.86227891156454,
      499.9548015873016,  501.0473242630385,  568.1013888888889,
      569.3432312925171,  570.5850736961452,  571.8269160997731,
      534.0428571428571,  535.197596371882,   536.3523356009069,
      537.5070748299319,  539.8961904761904,  541.0509297052154,
      542.2056689342403,  543.3604081632652,  586.8459920634921,
      588.0878344671202,  589.3296768707481,  590.5715192743764,
      518.3061961451247,  519.3987188208617,  520.4912414965986,
      521.5837641723355,  449.1691213151926,  450.11232426303854,
      451.05552721088435, 451.99873015873015, 379.4347675736961,
      380.2286507936508,  381.0225340136055,  381.8164172335601,
      435.61856575963725, 436.5390362811791,  437.45950680272114,
      438.37997732426305, 519.4461167800454,  520.5397165532879,
      521.6333163265307,  522.7269160997733,  603.9661848072561,
      605.2329138321995,  606.4996428571427,  607.7663718820861,
      689.1787698412697,  690.618628117914,   692.0584863945578,
      693.4983446712017,  647.5507936507935,  648.8896598639456,
      650.2285260770974,  651.5673922902494,  654.3374603174602,
      655.6763265306122,  657.015192743764,   658.3540589569161,
      710.9122619047619,  712.3521201814059,  713.7919784580497,
      715.231836734694,   627.7772278911564,  629.0439569160999,
      630.3106859410431,  631.5774149659863,  543.9496768707481,
      545.043276643991,   546.1368764172336,  547.2304761904761,
      459.4296088435374,  460.35007936507935, 461.2705498866214,
      462.1910204081633,  464.25011337868483, 465.1326077097506,
      466.0151020408163,  466.8975963718821,  553.384807256236,
      554.4332879818593,  555.4817687074828,  556.5302494331066,
      643.183446712018,   644.3979138321994,  645.612380952381,
      646.8268480725624,  733.6460317460316,  735.0264852607709,
      736.4069387755102,  737.7873922902495,  688.622222222222,
      689.9058503401361,  691.18947845805,    692.4731065759637,
      695.1288888888887,  696.4125170068028,  697.6961451247165,
      698.9797732426304,  754.4828571428569,  755.8633106575965,
      757.2437641723357,  758.6242176870747,  666.0121088435374,
      667.2265759637189,  668.4410430839004,  669.6555102040815,
      576.8774149659864,  577.92589569161,    578.9743764172337,
      580.0228571428571,  487.0787755102041,  487.96126984126977,
      488.8437641723357,  489.7262585034013,  532.8376133786848,
      533.7580839002269,  534.6785544217687,  535.5990249433106,
      634.9508786848073,  636.04447845805,    637.1380782312924,
      638.2316780045351,  737.7566609977325,  739.0233900226757,
      740.290119047619,   741.5568480725624,  841.2549603174602,
      842.6948185941043,  844.1346768707482,  845.5745351473923,
      788.9603174603175,  790.2991836734693,  791.6380498866212,
      792.9769160997731,  795.746984126984,   797.0858503401363,
      798.4247165532879,  799.7635827664396,  862.9884523809523,
      864.4283106575964,  865.8681689342404,  867.3080272108842,
      761.5677040816327,  762.834433106576,   764.1011621315193,
      765.3678911564624,  659.4544387755102,  660.5480385487527,
      661.6416383219955,  662.7352380952381,  556.6486564625851,
      557.5691269841268,  558.489597505669,   559.4100680272109,
      476.37134353741493, 477.1652267573696,  477.95910997732426,
      478.7529931972789,  567.603656462585,   568.5468594104309,
      569.4900623582765,  570.4332653061225,  659.4332482993198,
      660.5257709750566,  661.6182936507935,  662.7108163265307,
      751.8601190476192,  753.1019614512472,  754.3438038548752,
      755.5856462585035,  704.9126984126984,  706.0674376417234,
      707.2221768707483,  708.3769160997733,  710.7660317460317,
      711.9207709750568,  713.0755102040816,  714.2302494331066,
      770.6047222222222,  771.8465646258503,  773.0884070294785,
      774.3302494331065,  679.969688208617,   681.0622108843536,
      682.1547335600907,  683.2472562358275,  588.7373752834468,
      589.6805782312923,  590.6237811791384,  591.5669841269842,
      496.9077834467121,  497.70166666666654, 498.4955498866213,
      499.289433106576,   423.6315476190476,  424.3169274376417,
      425.00230725623584, 425.6876870748299,  504.7210034013606,
      505.5352947845805,  506.3495861678005,  507.16387755102033,
      586.3261054421769,  587.2693083900228,  588.2125113378684,
      589.1557142857142,  668.4468537414967,  669.5189682539683,
      670.5910827664399,  671.6631972789116,  626.5589569160996,
      627.5558730158731,  628.5527891156463,  629.5497052154194,
      631.612290249433,   632.6092063492063,  633.6061224489797,
      634.6030385487527,  684.629552154195,   685.7016666666666,
      686.7737811791384,  687.8458956916099,  604.0557426303856,
      604.9989455782312,  605.9421485260771,  606.8853514739228,
      522.9662868480725,  523.7805782312923,  524.5948696145124,
      525.4091609977324,  441.3611848072563,  442.0465646258503,
      442.7319444444444,  443.41732426303855, 366.55161564625854,
      367.12849206349205, 367.70536848072567, 368.2822448979591,
      436.681887755102,   437.3672675736962,  438.0526473922903,
      438.7380272108843,  507.2461734693877,  508.0400566893424,
      508.83393990929704, 509.6278231292516,  578.2444727891157,
      579.1468594104308,  580.0492460317461,  580.9516326530612,
      541.892290249433,   542.7313832199546,  543.5704761904761,
      544.4095691609976,  546.1456235827665,  546.9847165532879,
      547.8238095238095,  548.662902494331,   591.8652664399094,
      592.7676530612245,  593.6700396825397,  594.5724263038549,
      522.169007936508,   522.9628911564625,  523.7567743764172,
      524.5506575963719,  452.0387358276644,  452.72411564625844,
      453.40949546485257, 454.09487528344675, 381.4744501133787,
      382.05132653061224, 382.6282029478458,  383.2050793650794,
      448.0738378684807,  448.6507142857143,  449.2275907029478,
      449.8044671201814,  533.5374433106576,  534.2228231292517,
      534.9082029478458,  535.5935827664398,  619.4350623582766,
      620.2289455782312,  621.022828798186,   621.8167120181405,
      705.7666950113377,  706.6690816326529,  707.5714682539681,
      708.4738548752832,  660.4700680272108,  661.3091609977323,
      662.1482539682538,  662.9873469387753,  664.7234013605441,
      665.5624943310656,  666.4015873015871,  667.2406802721086,
      719.3874886621315,  720.2898752834466,  721.1922619047617,
      722.0946485260769,  634.3578968253968,  635.1517800453513,
      635.9456632653059,  636.7395464852606,  548.89429138322,
      549.5796712018142,  550.265051020408,   550.9504308390023,
      462.9966723356009,  463.57354875283454, 464.15042517006805,
      464.72730158730155, 544.2149943310657,  544.9003741496598,
      545.5857539682539,  546.271133786848,   647.9847222222222,
      648.799013605442,   649.6133049886622,  650.427596371882,
      752.270096371882,   753.2132993197278,  754.1565022675738,
      755.0997052154195,  857.0711167800451,  858.1432312925168,
      859.2153458049886,  860.2874603174602,  801.9530612244897,
      802.9499773242628,  803.9468934240361,  804.9438095238094,
      807.006394557823,   808.0033106575962,  809.0002267573694,
      809.9971428571426,  873.2538151927438,  874.3259297052153,
      875.3980442176869,  876.4701587301586,  769.9997335600907,
      770.9429365079365,  771.8861394557821,  772.829342403628,
      666.2300056689343,  667.0442970521544,  667.8585884353739,
      668.6728798185941,  561.9446315192744,  562.6300113378686,
      563.3153911564626,  564.0007709750566,  644.6962868480724,
      645.490170068027,   646.2840532879817,  647.0779365079364,
      767.5884637188208,  768.5316666666665,  769.4748696145124,
      770.4180725623581,  891.0779195011336,  892.1704421768704,
      893.2629648526076,  894.3554875283446,  1015.164654195011,
      1016.4064965986391, 1017.6483390022673, 1018.8901814058955,
      949.7489795918366,  950.9037188208613,  952.0584580498863,
      953.2131972789114,  955.6023129251698,  956.7570521541948,
      957.9117913832197,  959.0665306122446,  1033.9092573696144,
      1035.1510997732425, 1036.3929421768705, 1037.6347845804987,
      911.6143594104308,  912.7068820861676,  913.7994047619045,
      914.8919274376416,  788.7221825396825,  789.6653854875285,
      790.6085884353739,  791.55179138322,    665.2327267573696,
      666.0266099773244,  666.820493197279,   667.6143764172335,
      766.9879535147389,  767.9084240362811,  768.8288945578229,
      769.7493650793649,  913.1420351473921,  914.2356349206349,
      915.3292346938774,  916.42283446712,    1059.9886337868477,
      1061.255362811791,  1062.5220918367345, 1063.7888208616778,
      1207.5277494331067, 1208.96760770975,   1210.4074659863943,
      1211.8473242630382, 1129.5426303854874, 1130.881496598639,
      1132.2203628117911, 1133.559229024943,  1136.3292970521538,
      1137.6681632653058, 1139.0070294784578, 1140.3458956916097,
      1229.2612414965986, 1230.7010997732423, 1232.1409580498866,
      1233.5808163265306, 1083.7996768707483, 1085.0664058956916,
      1086.3331349206348, 1087.5998639455781, 937.6455952380952,
      938.7391950113381,  939.8327947845803,  940.9263945578232,
      790.7989965986394,  791.7194671201815,  792.6399376417235,
      793.5604081632653,  781.9480725623582,  782.830566893424,
      783.7130612244897,  784.5955555555556,  930.8378684807254,
      931.8863492063492,  932.9348299319726,  933.9833106575962,
      1080.3916099773242, 1081.6060770975055, 1082.8205442176868,
      1084.0350113378684, 1230.609297052154,  1231.9897505668932,
      1233.3702040816327, 1234.7506575963719, 1150.7283446712017,
      1152.0119727891156, 1153.2956009070292, 1154.5792290249433,
      1157.2350113378682, 1158.518639455782,  1159.802267573696,
      1161.08589569161,   1251.4461224489792, 1252.8265759637188,
      1254.207029478458,  1255.5874829931972, 1103.2202721088431,
      1104.4347392290251, 1105.6492063492065, 1106.8636734693878,
      954.3304761904762,  955.3789569160998,  956.4274376417235,
      957.475918367347,   804.7767346938775,  805.6592290249432,
      806.5417233560091,  807.4242176870748,  864.207001133787,
      865.1274716553287,  866.0479421768707,  866.9684126984127,
      1028.6467970521542, 1029.7403968253966, 1030.8339965986395,
      1031.9275963718821, 1193.7791099773237, 1195.0458390022675,
      1196.3125680272108, 1197.5792970521543, 1359.6039399092967,
      1361.0437981859411, 1362.483656462585,  1363.9235147392292,
      1270.9521541950112, 1272.2910204081631, 1273.6298866213153,
      1274.9687528344673, 1277.738820861678,  1279.0776870748298,
      1280.416553287982,  1281.7554195011337, 1381.337431972789,
      1382.777290249433,  1384.2171485260774, 1385.6570068027213,
      1217.5901530612246, 1218.8568820861678, 1220.1236111111111,
      1221.3903401360544, 1053.150357142857,  1054.2439569161,
      1055.3375566893424, 1056.431156462585,  888.0180442176871,
      888.938514739229,   889.8589852607711,  890.7794557823128,
      762.1693027210886,  762.963185941043,   763.7570691609977,
      764.5509523809524,  907.1567176870749,  908.0999206349205,
      909.0431235827665,  909.9863265306124,  1052.7414115646259,
      1053.8339342403629, 1054.9264569160998, 1056.0189795918368,
      1198.9233843537413, 1200.1652267573695, 1201.407069160998,
      1202.6489115646261, 1120.6188208616782, 1121.7735600907029,
      1122.928299319728,  1124.083038548753,  1126.4721541950114,
      1127.6268934240363, 1128.7816326530613, 1129.9363718820862,
      1217.6679875283448, 1218.9098299319728, 1220.1516723356008,
      1221.393514739229,  1073.2778514739227, 1074.3703741496602,
      1075.462896825397,  1076.5554195011337, 928.2904365079365,
      929.2336394557823,  930.1768424036281,  931.1200453514738,
      782.7057426303857,  783.4996258503401,  784.2935090702949,
      785.0873922902493,  670.3682823129252,  671.0536621315193,
      671.7390419501133,  672.4244217687075,  797.8659013605443,
      798.6801927437641,  799.494484126984,   800.308775510204,
      925.8791666666667,  926.8223696145124,  927.7655725623582,
      928.7087755102041,  1054.4080782312926, 1055.480192743764,
      1056.5523072562357, 1057.6244217687076, 985.4487528344672,
      986.4456689342403,  987.4425850340137,  988.4395011337867,
      990.5020861678005,  991.4990022675738,  992.4959183673469,
      993.4928344671201,  1070.590776643991,  1071.6628911564626,
      1072.7350056689343, 1073.8071201814057, 943.6088038548753,
      944.5520068027212,  945.4952097505668,  946.4384126984127,
      816.1111848072563,  816.9254761904762,  817.7397675736961,
      818.5540589569159,  688.0979195011338,  688.7832993197279,
      689.4686791383219,  690.154058956916,   574.2271258503401,
      574.8040022675738,  575.3808786848073,  575.9577551020408,
      683.4186224489796,  684.1040022675737,  684.7893820861677,
      685.474761904762,   793.0441326530612,  793.8380158730159,
      794.6318990929705,  795.4257823129252,  903.1036564625851,
      904.0060430839003,  904.9084297052153,  905.8108163265306,
      843.9657596371882,  844.8048526077099,  845.6439455782313,
      846.4830385487528,  848.2190929705216,  849.0581859410431,
      849.8972789115645,  850.736371882086,   916.7244501133788,
      917.6268367346939,  918.5292233560091,  919.4316099773241,
      807.9669671201814,  808.7608503401361,  809.5547335600907,
      810.3486167800453,  698.7754705215419,  699.4608503401361,
      700.1462301587302,  700.8316099773241,  589.1499603174603,
      589.7268367346938,  590.3037131519274,  590.880589569161};
  const std::array<int, 4> in_shape = {{3, 9, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  0.7346938775510203,
      0.8163265306122449,  0.5510204081632653,  0.6122448979591837,
      0.6734693877551019,  0.7346938775510203,  0.44897959183673464,
      0.4897959183673469,  0.5306122448979591,  0.5714285714285714,
      0.26530612244897955, 0.2857142857142857,  0.3061224489795918,
      0.32653061224489793, 0.3673469387755102,  0.4081632653061224,
      0.4489795918367347,  0.48979591836734687, 0.8979591836734693,
      0.9795918367346937,  1.0612244897959182,  1.1428571428571428,
      1.5918367346938775,  1.7142857142857142,  1.8367346938775508,
      1.9591836734693875,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.4489795918367347,
      2.6122448979591835,  2.7755102040816326,  2.9387755102040813,
      2.4489795918367347,  2.6122448979591835,  2.7755102040816326,
      2.9387755102040813,  2.4489795918367347,  2.6122448979591835,
      2.7755102040816326,  2.9387755102040813,  2.0816326530612246,
      2.204081632653061,   2.326530612244898,   2.4489795918367347,
      1.5510204081632653,  1.6326530612244894,  1.714285714285714,
      1.7959183673469385,  0.8571428571428571,  0.8979591836734693,
      0.9387755102040816,  0.9795918367346939,  1.0408163265306123,
      1.1020408163265305,  1.163265306122449,   1.2244897959183672,
      2.3265306122448974,  2.4489795918367347,  2.571428571428571,
      2.693877551020408,   3.8571428571428568,  4.040816326530612,
      4.224489795918367,   4.408163265306122,   5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      4.591836734693877,   4.775510204081632,   4.959183673469387,
      5.142857142857143,   3.3061224489795915,  3.428571428571428,
      3.551020408163265,   3.6734693877551017,  1.7755102040816326,
      1.8367346938775508,  1.8979591836734693,  1.9591836734693877,
      1.0408163265306123,  1.1020408163265305,  1.163265306122449,
      1.2244897959183672,  2.3265306122448974,  2.4489795918367347,
      2.571428571428571,   2.693877551020408,   3.8571428571428568,
      4.040816326530612,   4.224489795918367,   4.408163265306122,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.591836734693877,   4.775510204081632,
      4.959183673469387,   5.142857142857143,   3.3061224489795915,
      3.428571428571428,   3.551020408163265,   3.6734693877551017,
      1.7755102040816326,  1.8367346938775508,  1.8979591836734693,
      1.9591836734693877,  1.0408163265306123,  1.1020408163265305,
      1.163265306122449,   1.2244897959183672,  2.3265306122448974,
      2.4489795918367347,  2.571428571428571,   2.693877551020408,
      3.8571428571428568,  4.040816326530612,   4.224489795918367,
      4.408163265306122,   5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    4.591836734693877,
      4.775510204081632,   4.959183673469387,   5.142857142857143,
      3.3061224489795915,  3.428571428571428,   3.551020408163265,
      3.6734693877551017,  1.7755102040816326,  1.8367346938775508,
      1.8979591836734693,  1.9591836734693877,  1.0408163265306123,
      1.1020408163265305,  1.163265306122449,   1.2244897959183672,
      2.3265306122448974,  2.4489795918367347,  2.571428571428571,
      2.693877551020408,   3.8571428571428568,  4.040816326530612,
      4.224489795918367,   4.408163265306122,   5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      4.591836734693877,   4.775510204081632,   4.959183673469387,
      5.142857142857143,   3.3061224489795915,  3.428571428571428,
      3.551020408163265,   3.6734693877551017,  1.7755102040816326,
      1.8367346938775508,  1.8979591836734693,  1.9591836734693877,
      1.0408163265306123,  1.1020408163265305,  1.163265306122449,
      1.2244897959183672,  2.3265306122448974,  2.4489795918367347,
      2.571428571428571,   2.693877551020408,   3.8571428571428568,
      4.040816326530612,   4.224489795918367,   4.408163265306122,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.591836734693877,   4.775510204081632,
      4.959183673469387,   5.142857142857143,   3.3061224489795915,
      3.428571428571428,   3.551020408163265,   3.6734693877551017,
      1.7755102040816326,  1.8367346938775508,  1.8979591836734693,
      1.9591836734693877,  1.0204081632653061,  1.0612244897959182,
      1.1020408163265305,  1.1428571428571428,  2.204081632653061,
      2.2857142857142856,  2.3673469387755097,  2.4489795918367343,
      3.5510204081632653,  3.6734693877551017,  3.795918367346938,
      3.9183673469387754,  5.061224489795918,   5.224489795918366,
      5.387755102040815,   5.551020408163265,   5.061224489795918,
      5.224489795918366,   5.387755102040815,   5.551020408163265,
      5.061224489795918,   5.224489795918366,   5.387755102040815,
      5.551020408163265,   5.061224489795918,   5.224489795918366,
      5.387755102040815,   5.551020408163265,   4.040816326530612,
      4.163265306122449,   4.285714285714285,   4.408163265306122,
      2.8571428571428568,  2.9387755102040813,  3.020408163265306,
      3.1020408163265305,  1.510204081632653,   1.5510204081632653,
      1.5918367346938775,  1.6326530612244898,  0.673469387755102,
      0.6938775510204082,  0.7142857142857142,  0.7346938775510203,
      1.4285714285714284,  1.4693877551020407,  1.510204081632653,
      1.5510204081632653,  2.265306122448979,   2.326530612244898,
      2.387755102040816,   2.4489795918367347,  3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  3.346938775510204,   3.428571428571429,
      2.510204081632653,   2.571428571428571,   2.63265306122449,
      2.6938775510204076,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  0.9183673469387754,
      0.9387755102040816,  0.9591836734693877,  0.9795918367346939,
      0.9999999999999999,  1.0204081632653061,  1.040816326530612,
      1.0612244897959182,  2.081632653061224,   2.1224489795918364,
      2.1632653061224487,  2.204081632653061,   3.244897959183673,
      3.3061224489795915,  3.36734693877551,    3.428571428571428,
      4.489795918367346,   4.571428571428571,   4.653061224489796,
      4.7346938775510194,  4.489795918367346,   4.571428571428571,
      4.653061224489796,   4.7346938775510194,  4.489795918367346,
      4.571428571428571,   4.653061224489796,   4.7346938775510194,
      4.489795918367346,   4.571428571428571,   4.653061224489796,
      4.7346938775510194,  3.4897959183673466,  3.5510204081632653,
      3.6122448979591835,  3.6734693877551017,  2.408163265306122,
      2.4489795918367347,  2.4897959183673466,  2.530612244897959,
      1.2448979591836733,  1.2653061224489794,  1.2857142857142856,
      1.3061224489795917,  2.326530612244898,   2.36734693877551,
      2.408163265306122,   2.4489795918367347,  4.816326530612244,
      4.8979591836734695,  4.979591836734693,   5.061224489795918,
      7.46938775510204,    7.591836734693876,   7.714285714285714,
      7.83673469387755,    10.285714285714285,  10.448979591836734,
      10.612244897959183,  10.775510204081632,  10.285714285714285,
      10.448979591836734,  10.612244897959183,  10.775510204081632,
      10.285714285714285,  10.448979591836734,  10.612244897959183,
      10.775510204081632,  10.285714285714285,  10.448979591836734,
      10.612244897959183,  10.775510204081632,  7.959183673469386,
      8.081632653061224,   8.204081632653061,   8.326530612244897,
      5.46938775510204,    5.551020408163265,   5.63265306122449,
      5.7142857142857135,  2.816326530612245,   2.8571428571428568,
      2.897959183673469,   2.9387755102040813,  3.9795918367346936,
      4.040816326530612,   4.1020408163265305,  4.163265306122449,
      8.204081632653061,   8.326530612244898,   8.448979591836734,
      8.571428571428571,   12.6734693877551,    12.857142857142856,
      13.040816326530612,  13.224489795918366,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      13.40816326530612,   13.591836734693878,  13.775510204081632,
      13.959183673469386,  9.183673469387754,   9.306122448979592,
      9.428571428571429,   9.551020408163264,   4.714285714285714,
      4.775510204081632,   4.836734693877551,   4.8979591836734695,
      3.9795918367346936,  4.040816326530612,   4.1020408163265305,
      4.163265306122449,   8.204081632653061,   8.326530612244898,
      8.448979591836734,   8.571428571428571,   12.6734693877551,
      12.857142857142856,  13.040816326530612,  13.224489795918366,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  13.40816326530612,   13.591836734693878,
      13.775510204081632,  13.959183673469386,  9.183673469387754,
      9.306122448979592,   9.428571428571429,   9.551020408163264,
      4.714285714285714,   4.775510204081632,   4.836734693877551,
      4.8979591836734695,  3.9795918367346936,  4.040816326530612,
      4.1020408163265305,  4.163265306122449,   8.204081632653061,
      8.326530612244898,   8.448979591836734,   8.571428571428571,
      12.6734693877551,    12.857142857142856,  13.040816326530612,
      13.224489795918366,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  13.40816326530612,
      13.591836734693878,  13.775510204081632,  13.959183673469386,
      9.183673469387754,   9.306122448979592,   9.428571428571429,
      9.551020408163264,   4.714285714285714,   4.775510204081632,
      4.836734693877551,   4.8979591836734695,  3.9795918367346936,
      4.040816326530612,   4.1020408163265305,  4.163265306122449,
      8.204081632653061,   8.326530612244898,   8.448979591836734,
      8.571428571428571,   12.6734693877551,    12.857142857142856,
      13.040816326530612,  13.224489795918366,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      13.40816326530612,   13.591836734693878,  13.775510204081632,
      13.959183673469386,  9.183673469387754,   9.306122448979592,
      9.428571428571429,   9.551020408163264,   4.714285714285714,
      4.775510204081632,   4.836734693877551,   4.8979591836734695,
      3.9795918367346936,  4.040816326530612,   4.1020408163265305,
      4.163265306122449,   8.204081632653061,   8.326530612244898,
      8.448979591836734,   8.571428571428571,   12.6734693877551,
      12.857142857142856,  13.040816326530612,  13.224489795918366,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  13.40816326530612,   13.591836734693878,
      13.775510204081632,  13.959183673469386,  9.183673469387754,
      9.306122448979592,   9.428571428571429,   9.551020408163264,
      4.714285714285714,   4.775510204081632,   4.836734693877551,
      4.8979591836734695,  2.9795918367346936,  3.020408163265306,
      3.061224489795918,   3.1020408163265305,  6.122448979591836,
      6.20408163265306,    6.285714285714285,   6.36734693877551,
      9.428571428571427,   9.551020408163264,   9.673469387755102,
      9.795918367346937,   12.897959183673468,  13.061224489795915,
      13.224489795918368,  13.387755102040815,  12.897959183673468,
      13.061224489795915,  13.224489795918368,  13.387755102040815,
      12.897959183673468,  13.061224489795915,  13.224489795918368,
      13.387755102040815,  12.897959183673468,  13.061224489795915,
      13.224489795918368,  13.387755102040815,  9.918367346938775,
      10.04081632653061,   10.163265306122447,  10.285714285714285,
      6.775510204081632,   6.857142857142857,   6.9387755102040805,
      7.020408163265307,   3.4693877551020407,  3.5102040816326525,
      3.5510204081632653,  3.591836734693877,   1.6530612244897958,
      1.673469387755102,   1.693877551020408,   1.7142857142857142,
      3.387755102040816,   3.4285714285714284,  3.4693877551020407,
      3.5102040816326525,  5.204081632653061,   5.26530612244898,
      5.326530612244897,   5.387755102040815,   7.1020408163265305,
      7.183673469387755,   7.265306122448979,   7.346938775510203,
      7.1020408163265305,  7.183673469387755,   7.265306122448979,
      7.346938775510203,   7.1020408163265305,  7.183673469387755,
      7.265306122448979,   7.346938775510203,   7.1020408163265305,
      7.183673469387755,   7.265306122448979,   7.346938775510203,
      5.448979591836735,   5.5102040816326525,  5.571428571428571,
      5.63265306122449,    3.714285714285714,   3.7551020408163263,
      3.7959183673469385,  3.836734693877551,   1.8979591836734693,
      1.9183673469387754,  1.9387755102040816,  1.9591836734693877,
      1.9795918367346936,  1.9999999999999998,  2.020408163265306,
      2.0408163265306123,  4.040816326530612,   4.081632653061224,
      4.122448979591836,   4.163265306122449,   6.183673469387754,
      6.244897959183673,   6.3061224489795915,  6.36734693877551,
      8.408163265306122,   8.489795918367346,   8.571428571428571,
      8.653061224489797,   8.408163265306122,   8.489795918367346,
      8.571428571428571,   8.653061224489797,   8.408163265306122,
      8.489795918367346,   8.571428571428571,   8.653061224489797,
      8.408163265306122,   8.489795918367346,   8.571428571428571,
      8.653061224489797,   6.428571428571429,   6.489795918367346,
      6.551020408163264,   6.612244897959183,   4.36734693877551,
      4.408163265306122,   4.448979591836734,   4.489795918367347,
      2.2244897959183674,  2.2448979591836733,  2.265306122448979,
      2.2857142857142856,  4.285714285714285,   4.326530612244897,
      4.36734693877551,    4.408163265306122,   8.73469387755102,
      8.816326530612244,   8.89795918367347,    8.979591836734693,
      13.346938775510203,  13.46938775510204,   13.591836734693876,
      13.714285714285714,  18.122448979591834,  18.285714285714285,
      18.448979591836732,  18.612244897959183,  18.122448979591834,
      18.285714285714285,  18.448979591836732,  18.612244897959183,
      18.122448979591834,  18.285714285714285,  18.448979591836732,
      18.612244897959183,  18.122448979591834,  18.285714285714285,
      18.448979591836732,  18.612244897959183,  13.836734693877549,
      13.959183673469385,  14.081632653061224,  14.20408163265306,
      9.387755102040817,   9.46938775510204,    9.551020408163264,
      9.632653061224488,   4.775510204081632,   4.816326530612244,
      4.857142857142857,   4.8979591836734695,  6.9183673469387745,
      6.979591836734693,   7.040816326530612,   7.1020408163265305,
      14.081632653061224,  14.204081632653061,  14.326530612244898,
      14.448979591836734,  21.489795918367346,  21.6734693877551,
      21.857142857142854,  22.040816326530614,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      22.224489795918366,  22.40816326530612,   22.591836734693874,
      22.77551020408163,   15.061224489795919,  15.183673469387754,
      15.30612244897959,   15.428571428571427,  7.653061224489795,
      7.7142857142857135,  7.775510204081632,   7.836734693877551,
      6.9183673469387745,  6.979591836734693,   7.040816326530612,
      7.1020408163265305,  14.081632653061224,  14.204081632653061,
      14.326530612244898,  14.448979591836734,  21.489795918367346,
      21.6734693877551,    21.857142857142854,  22.040816326530614,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  22.224489795918366,  22.40816326530612,
      22.591836734693874,  22.77551020408163,   15.061224489795919,
      15.183673469387754,  15.30612244897959,   15.428571428571427,
      7.653061224489795,   7.7142857142857135,  7.775510204081632,
      7.836734693877551,   6.9183673469387745,  6.979591836734693,
      7.040816326530612,   7.1020408163265305,  14.081632653061224,
      14.204081632653061,  14.326530612244898,  14.448979591836734,
      21.489795918367346,  21.6734693877551,    21.857142857142854,
      22.040816326530614,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  22.224489795918366,
      22.40816326530612,   22.591836734693874,  22.77551020408163,
      15.061224489795919,  15.183673469387754,  15.30612244897959,
      15.428571428571427,  7.653061224489795,   7.7142857142857135,
      7.775510204081632,   7.836734693877551,   6.9183673469387745,
      6.979591836734693,   7.040816326530612,   7.1020408163265305,
      14.081632653061224,  14.204081632653061,  14.326530612244898,
      14.448979591836734,  21.489795918367346,  21.6734693877551,
      21.857142857142854,  22.040816326530614,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      22.224489795918366,  22.40816326530612,   22.591836734693874,
      22.77551020408163,   15.061224489795919,  15.183673469387754,
      15.30612244897959,   15.428571428571427,  7.653061224489795,
      7.7142857142857135,  7.775510204081632,   7.836734693877551,
      6.9183673469387745,  6.979591836734693,   7.040816326530612,
      7.1020408163265305,  14.081632653061224,  14.204081632653061,
      14.326530612244898,  14.448979591836734,  21.489795918367346,
      21.6734693877551,    21.857142857142854,  22.040816326530614,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  22.224489795918366,  22.40816326530612,
      22.591836734693874,  22.77551020408163,   15.061224489795919,
      15.183673469387754,  15.30612244897959,   15.428571428571427,
      7.653061224489795,   7.7142857142857135,  7.775510204081632,
      7.836734693877551,   4.938775510204081,   4.979591836734693,
      5.020408163265305,   5.061224489795919,   10.04081632653061,
      10.122448979591837,  10.204081632653061,  10.285714285714285,
      15.30612244897959,   15.428571428571427,  15.551020408163263,
      15.673469387755102,  20.734693877551017,  20.897959183673468,
      21.061224489795915,  21.224489795918366,  20.734693877551017,
      20.897959183673468,  21.061224489795915,  21.224489795918366,
      20.734693877551017,  20.897959183673468,  21.061224489795915,
      21.224489795918366,  20.734693877551017,  20.897959183673468,
      21.061224489795915,  21.224489795918366,  15.795918367346937,
      15.918367346938775,  16.04081632653061,   16.163265306122447,
      10.693877551020407,  10.775510204081632,  10.857142857142858,
      10.938775510204081,  5.428571428571429,   5.469387755102041,
      5.5102040816326525,  5.551020408163264,   2.6326530612244894,
      2.6530612244897958,  2.6734693877551017,  2.693877551020408,
      5.346938775510203,   5.387755102040816,   5.428571428571428,
      5.469387755102041,   8.142857142857142,   8.204081632653061,
      8.26530612244898,    8.326530612244898,   11.020408163265305,
      11.10204081632653,   11.183673469387756,  11.26530612244898,
      11.020408163265305,  11.10204081632653,   11.183673469387756,
      11.26530612244898,   11.020408163265305,  11.10204081632653,
      11.183673469387756,  11.26530612244898,   11.020408163265305,
      11.10204081632653,   11.183673469387756,  11.26530612244898,
      8.387755102040815,   8.448979591836734,   8.510204081632653,
      8.571428571428571,   5.673469387755102,   5.7142857142857135,
      5.755102040816326,   5.795918367346938,   2.877551020408163,
      2.897959183673469,   2.9183673469387754,  2.9387755102040813};
  const std::array<int, 4> in_shape = {{3, 9, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.15218253968254,   8.794019274376419,  10.836082766439908,
      13.43846371882086,  14.767630385487529, 12.924773242630383,
      11.262471655328797, 9.729138321995464,  10.870209750566895,
      13.2671485260771,   16.213973922902493, 19.93064058956916,
      21.509807256235824, 18.69552154195011,  16.19988662131519,
      13.931859410430839, 15.456264172335601, 18.77157029478458,
      22.813633786848072, 27.873157596371875, 29.70232426303854,
      25.68803854875283,  22.168594104308387, 19.002607709750567,
      20.910345804988662, 25.307284580498866, 30.63506235827664,
      37.266014739229014, 39.34518140589568,  33.902324263038544,
      29.168594104308387, 24.94138321995465,  27.855782312925168,
      33.5265306122449,   40.32653061224489,  48.70748299319727,
      50.6408163265306,   43.364625850340126, 37.117006802721086,
      31.604081632653063, 36.36244897959183,  43.63319727891156,
      52.299863945578224, 62.9208163265306,   64.85414965986392,
      55.33795918367347,  47.223673469387755, 40.11074829931973,
      48.15193310657597,  57.672681405895695, 68.97823696145124,
      82.78252267573696,  84.86168934240362,  72.24549886621315,
      61.53399092970521,  52.182970521541954, 45.301933106575966,
      54.230844671201815, 64.82211451247166,  77.74068594104308,
      79.56985260770976,  67.69651927437643,  57.627868480725624,
      48.84827664399093,  41.583905895691615, 49.75771541950113,
      59.44422335600907,  71.24850907029479,  72.82767573696145,
      61.92577097505669,  52.69045351473923,  44.64555555555556,
      36.9978514739229,   44.25329365079365,  52.8445634920635,
      63.30599206349206,  64.63515873015874,  54.93325396825397,
      46.72174603174604,  39.57480725623583,  53.30229591836735,
      63.62440476190475,  75.79345238095239,  90.54821428571428,
      91.87738095238096,  77.88214285714288,  66.09285714285714,
      55.87925170068027,  65.70059523809525,  78.41045918367345,
      93.38903061224491,  111.5437925170068,  113.12295918367349,
      95.87057823129255,  81.34319727891157,  68.76224489795919,
      78.96692176870748,  94.22780612244895,  112.20637755102041,
      133.98971088435374, 135.81887755102042, 115.08078231292521,
      97.6248299319728,   82.51326530612246,  93.10127551020408,
      111.07644557823126, 132.24549319727893, 157.88596938775515,
      159.96513605442183, 135.51275510204084, 114.93775510204082,
      97.13231292517008,  94.98321995464852,  113.27981859410428,
      134.809977324263,   160.86712018140594, 162.80045351473925,
      137.84807256235828, 116.8702947845805,  98.73151927437641,
      103.4898866213152,  123.38648526077097, 146.78331065759636,
      175.08045351473925, 177.01378684807258, 149.8214058956916,
      126.97696145124715, 107.23818594104307, 120.34286281179138,
      143.44184240362816, 170.58866780045352, 203.40247732426303,
      205.4816439909297,  173.85592970521546, 147.30315192743763,
      124.37390022675736, 108.81259070294784, 129.6870804988662,
      154.21485827664404, 183.85723922902494, 185.6864058956916,
      157.08926303854872, 133.08410430839,    112.35893424036281,
      96.41429138321996,  114.90102607709751, 136.61928004535147,
      162.86166099773246, 164.4408276643991,  139.10082766439908,
      117.8337641723356,  99.4759410430839,   83.1479648526077,
      99.08367913832198,  117.80193310657596, 140.4157426303855,
      141.74490929705215, 119.89062358276642, 101.55213151927437,
      85.72492063492064,  99.45240929705217,  118.45479024943313,
      140.7508219954649,  167.65796485260773, 168.9871315192744,
      142.83951247165533, 120.92324263038549, 102.02936507936508,
      120.53098072562359, 143.55376984126985, 170.56408730158734,
      203.15694444444446, 204.73611111111114, 173.0456349206349,
      146.48650793650793, 123.59263038548751, 142.47757936507938,
      169.68404195011337, 201.59912131519275, 240.10626417233559,
      241.93543083900227, 204.47352607709746, 173.08106575963714,
      146.0239229024943,  165.29220521541953, 196.84560657596373,
      233.8559240362812,  278.50592403628116, 280.5850907029478,
      237.12318594104306, 200.70691609977322, 169.32324263038547,
      162.1106575963719,  193.03310657596373, 229.29342403628115,
      273.02675736961453, 274.9600907029478,  232.3315192743764,
      196.6235827664399,  165.85895691609977, 170.61732426303854,
      203.13977324263035, 241.26675736961448, 287.2400907029479,
      289.17342403628123, 244.30485260770973, 206.73024943310656,
      174.36562358276643, 192.53379251700673, 229.21100340136047,
      272.1990986394557,  324.0224319727891,  326.1015986394558,
      275.46636054421765, 233.07231292517002, 196.56482993197278,
      172.3232482993197,  205.14331632653057, 243.60760204081626,
      289.97379251700676, 291.8029591836734,  246.48200680272103,
      208.5403401360544,  175.86959183673468, 151.24467687074826,
      180.04433673469384, 213.79433673469384, 254.47481292517,
      256.05397959183665, 216.27588435374145, 182.97707482993198,
      154.3063265306122,  129.29807823129252, 153.91406462585036,
      182.7593027210884,  217.52549319727888, 218.85465986394553,
      184.84799319727887, 156.3825170068027,  131.87503401360544};
  const std::array<int, 4> in_shape = {{3, 10, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612,  0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.061224489795918366, 0.061224489795918366,
      0.061224489795918366, 0.04081632653061224,  0.08163265306122448,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.20408163265306123,  0.20408163265306123,  0.20408163265306123,
      0.12244897959183673,  0.18367346938775508,  0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,   0.4285714285714286,   0.24489795918367346,
      0.32653061224489793,  0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.40816326530612246,  0.32653061224489793,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.40816326530612246,  0.32653061224489793,  0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.40816326530612246,
      0.32653061224489793,  0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.7346938775510203,   0.7346938775510203,
      0.7346938775510203,   0.40816326530612246,  0.30612244897959184,
      0.6734693877551019,   0.6734693877551019,   0.6734693877551019,
      0.6734693877551019,   0.6734693877551019,   0.6734693877551019,
      0.36734693877551017,  0.24489795918367346,  0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.5306122448979591,
      0.5306122448979591,   0.5306122448979591,   0.2857142857142857,
      0.14285714285714285,  0.30612244897959184,  0.30612244897959184,
      0.30612244897959184,  0.30612244897959184,  0.30612244897959184,
      0.30612244897959184,  0.16326530612244897,  0.18367346938775508,
      0.3877551020408163,   0.3877551020408163,   0.3877551020408163,
      0.3877551020408163,   0.3877551020408163,   0.3877551020408163,
      0.2040816326530612,   0.4081632653061224,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.8571428571428572,
      0.8571428571428572,   0.8571428571428572,   0.44897959183673464,
      0.6734693877551019,   1.4081632653061225,   1.4081632653061225,
      1.4081632653061225,   1.4081632653061225,   1.4081632653061225,
      1.4081632653061225,   0.7346938775510203,   0.9795918367346936,
      2.0408163265306123,   2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,   2.0408163265306123,   2.0408163265306123,
      1.0612244897959182,   0.9795918367346936,   2.0408163265306123,
      2.0408163265306123,   2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,   2.0408163265306123,   1.0612244897959182,
      0.9795918367346936,   2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,   2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,   1.0612244897959182,   0.9795918367346936,
      2.0408163265306123,   2.0408163265306123,   2.0408163265306123,
      2.0408163265306123,   2.0408163265306123,   2.0408163265306123,
      1.0612244897959182,   0.7959183673469387,   1.6530612244897955,
      1.6530612244897955,   1.6530612244897955,   1.6530612244897955,
      1.6530612244897955,   1.6530612244897955,   0.857142857142857,
      0.5714285714285714,   1.1836734693877549,   1.1836734693877549,
      1.1836734693877549,   1.1836734693877549,   1.1836734693877549,
      1.1836734693877549,   0.6122448979591837,   0.3061224489795918,
      0.6326530612244897,   0.6326530612244897,   0.6326530612244897,
      0.6326530612244897,   0.6326530612244897,   0.6326530612244897,
      0.32653061224489793,  0.3469387755102041,   0.7142857142857142,
      0.7142857142857142,   0.7142857142857142,   0.7142857142857142,
      0.7142857142857142,   0.7142857142857142,   0.36734693877551017,
      0.7346938775510203,   1.510204081632653,    1.510204081632653,
      1.510204081632653,    1.510204081632653,    1.510204081632653,
      1.510204081632653,    0.7755102040816326,   1.163265306122449,
      2.387755102040816,    2.387755102040816,    2.387755102040816,
      2.387755102040816,    2.387755102040816,    2.387755102040816,
      1.2244897959183674,   1.6326530612244898,   3.346938775510204,
      3.346938775510204,    3.346938775510204,    3.346938775510204,
      3.346938775510204,    3.346938775510204,    1.7142857142857144,
      1.6326530612244898,   3.346938775510204,    3.346938775510204,
      3.346938775510204,    3.346938775510204,    3.346938775510204,
      3.346938775510204,    1.7142857142857144,   1.6326530612244898,
      3.346938775510204,    3.346938775510204,    3.346938775510204,
      3.346938775510204,    3.346938775510204,    3.346938775510204,
      1.7142857142857144,   1.6326530612244898,   3.346938775510204,
      3.346938775510204,    3.346938775510204,    3.346938775510204,
      3.346938775510204,    3.346938775510204,    1.7142857142857144,
      1.2857142857142856,   2.63265306122449,     2.63265306122449,
      2.63265306122449,     2.63265306122449,     2.63265306122449,
      2.63265306122449,     1.3469387755102038,   0.8979591836734693,
      1.8367346938775508,   1.8367346938775508,   1.8367346938775508,
      1.8367346938775508,   1.8367346938775508,   1.8367346938775508,
      0.9387755102040816,   0.4693877551020408,   0.9591836734693877,
      0.9591836734693877,   0.9591836734693877,   0.9591836734693877,
      0.9591836734693877,   0.9591836734693877,   0.4897959183673469};
  const std::array<int, 4> in_shape = {{3, 10, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.72748866213152,  14.30436507936508,  16.90265873015873,
      17.588038548752838, 20.860198412698413, 21.672165532879816,
      25.91305555555556,  26.87692743764172,  28.571388888888887,
      29.535260770975057, 25.037579365079367, 25.849546485260767,
      21.839563492063494, 22.524943310657594, 18.88140022675737,
      19.458276643990928, 21.055039682539682, 21.74041950113379,
      25.720005668934242, 26.5342970521542,   31.46325963718821,
      32.42794784580499,  38.716116780045354, 39.86128117913832,
      41.874450113378686, 43.01961451247165,  36.426354875283444,
      37.39104308390022,  31.58548185941043,  32.39977324263038,
      27.17833900226757,  27.863718820861678, 30.11864512471655,
      30.912528344671202, 36.59993764172336,  37.54314058956916,
      44.509858276643996, 45.627267573696145, 54.419858276644,
      55.74631519274375,  58.07819160997733,  59.40464852607708,
      50.258667800453516, 51.37607709750566,  43.393985260770975,
      44.33718820861677,  37.21133219954648,  38.005215419501134,
      40.91830498866213,  41.820691609977324, 49.54245464852608,
      50.61456916099773,  59.999994331065764, 61.27012471655328,
      73.02428004535149,  74.53202947845803,  77.1826133786848,
      78.69036281179136,  66.53451814058957,  67.80464852607709,
      57.26507369614513,  58.33718820861677,  48.98037981859411,
      49.8827664399093,   54.8724716553288,   55.711564625850336,
      66.05614512471656,  67.0530612244898,   79.47201814058958,
      80.65306122448978,  96.01297052154196,  97.41496598639453,
      99.87963718820862,  101.2816326530612,  85.54820861678004,
      86.72925170068025,  73.23709750566894,  74.23401360544217,
      62.36907029478458,  63.208163265306126, 71.88580498866214,
      72.72489795918366,  86.26947845804989,  87.26639455782312,
      103.41868480725623, 104.59972789115645, 124.43963718820861,
      125.8416326530612,  128.30630385487527, 129.70829931972784,
      109.49487528344675, 110.67591836734694, 93.45043083900227,
      94.44734693877551,  79.3824036281179,   80.22149659863946,
      95.40147959183673,  96.30386621315193,  114.27324829931972,
      115.34536281179139, 136.68634353741498, 137.9564739229025,
      164.05729591836737, 165.5650453514739,  168.2156292517007,
      169.72337868480724, 143.22086734693877, 144.4909977324263,
      121.99586734693874, 123.06798185941042, 103.46355442176869,
      104.36594104308391, 89.80998299319727,  90.60386621315193,
      107.51848639455781, 108.46168934240363, 128.52681972789117,
      129.64422902494331, 154.15491496598642, 155.48137188208617,
      157.81324829931975, 159.13970521541953, 134.27562925170065,
      135.39303854875286, 114.31253401360541, 115.25573696145125,
      96.90267006802718,  97.69655328798186,  82.48243197278912,
      83.16781179138323,  98.7011394557823,   99.51543083900226,
      117.92375850340134, 118.88844671201814, 141.35185374149657,
      142.49701814058957, 144.5101870748299,  145.6553514739229,
      122.88685374149657, 123.85154195011339, 104.56661564625847,
      105.38090702947846, 88.60573129251699,  89.29111111111112,
      73.41882653061224,  73.9957029478458,   87.82120748299317,
      88.5065873015873,   104.87715986394555, 105.689126984127,
      125.64811224489793, 126.61198412698413, 128.30644557823126,
      129.27031746031747, 109.0545408163265,  109.86650793650794,
      92.75811224489793,  93.44349206349207,  78.5727380952381,
      79.14961451247166,  106.02771541950113, 106.6045918367347,
      126.56342970521543, 127.2488095238095,  150.77493764172337,
      151.58690476190478, 180.13255668934247, 181.09642857142856,
      182.79089002267577, 183.75476190476192, 154.95231859410433,
      155.76428571428576, 131.50033446712018, 132.18571428571428,
      111.18162698412698, 111.75850340136054, 130.71581065759636,
      131.4011904761905,  156.00662698412702, 156.8209183673469,
      185.81337301587305, 186.77806122448982, 221.94242063492072,
      223.0875850340136,  225.10075396825403, 226.24591836734697,
      190.7764682539683,  191.7411564625851,  161.87210317460318,
      162.68639455782315, 136.83910997732426, 137.52448979591838,
      157.13996031746032, 157.93384353741496, 187.51240929705222,
      188.4556122448979,  223.29534580498873, 224.41275510204082,
      266.65296485260785, 267.9794217687075,  270.3112981859411,
      271.63775510204084, 229.04415532879824, 230.16156462585042,
      194.3064569160998,  195.2496598639456,  164.23264739229026,
      165.02653061224493, 185.30016439909298, 186.20255102040815,
      221.080776643991,   222.15289115646252, 263.22085600907036,
      264.49098639455786, 314.26418934240377, 315.7719387755103,
      318.422522675737,   319.93027210884367, 269.7553798185942,
      271.0255102040817,  228.80339569160998, 229.87551020408165,
      193.36223922902494, 194.26462585034017, 189.12734693877547,
      189.96643990929704, 225.56272108843535, 226.55963718820857,
      268.4389115646258,  269.619954648526,   320.3322448979593,
      321.7342403628119,  324.1989115646259,  325.6009070294785,
      274.5151020408163,  275.69614512471657, 232.74367346938772,
      233.740589569161,   196.62394557823126, 197.46303854875282,
      206.14068027210882, 206.9797732426304,  245.77605442176866,
      246.77297052154194, 292.38557823129247, 293.5666213151927,
      348.75891156462575, 350.1609070294785,  352.6255782312924,
      354.02757369614517, 298.461768707483,   299.6428117913832,
      252.9570068027211,  253.9539229024943,  213.63727891156464,
      214.47637188208614, 239.78333900226752, 240.68572562358275,
      285.81157029478453, 286.8836848072563,  339.9072052154195,
      341.17733560090704, 405.2972052154195,  406.80495464852606,
      409.4555385487528,  410.9632879818594,  346.4417290249433,
      347.7118594104309,  293.5341893424037,  294.60630385487525,
      247.84541383219957, 248.7478004535147,  216.831298185941,
      217.6251814058957,  258.4309580498866,  259.3741609977324,
      307.3123072562358,  308.4297165532881,  366.38802154195014,
      367.7144784580499,  370.04635487528344, 371.3728117913832,
      313.0611167800454,  314.17852607709744, 265.2250056689342,
      266.16820861678,    223.92398526077093, 224.71786848072563,
      192.1432029478458,  192.82858276643992, 228.98776077097503,
      229.80205215419502, 272.27387188208615, 273.23856009070295,
      324.5781575963719,  325.7233219954649,  327.7364909297052,
      328.8816553287982,  277.23696712018136, 278.20165532879815,
      234.85323696145122, 235.6675283446712,  198.26650226757366,
      198.9518820861678,  165.71905328798186, 166.2959297052154,
      197.48197845804987, 198.16735827664397, 234.7918990929705,
      235.60386621315192, 279.86761337868484, 280.831485260771,
      282.52594671201814, 283.4898185941043,  238.96928004535147,
      239.78124716553285, 202.41888321995464, 203.10426303854874,
      170.8729648526077,  171.44984126984127, 198.32794217687072,
      198.90481859410434, 236.2242006802721,  236.90958049886626,
      280.6896768707484,  281.5016439909298,  334.3520578231294,
      335.31592970521547, 337.01039115646273, 337.9742630385488,
      284.8670578231293,  285.67902494331065, 241.16110544217688,
      241.84648526077098, 203.48185374149656, 204.05873015873016,
      240.37658163265303, 241.06196145124719, 286.2932482993197,
      287.1075396825397,  340.16348639455794, 341.12817460317467,
      405.16872448979615, 406.3138888888889,  408.32705782312945,
      409.4722222222223,  345.12658163265314, 346.0912698412698,
      292.158724489796,   292.97301587301587, 246.49988095238092,
      247.18526077097502, 284.16127551020406, 284.95515873015876,
      338.42488095238093, 339.36808390022674, 402.08083333333343,
      403.1982426303855,  478.88607142857165, 480.21252834467117,
      482.54440476190496, 483.87086167800453, 407.8296428571429,
      408.9470521541949,  345.2189285714286,  346.1621315192743,
      291.253962585034,   292.0478458049886,  329.68202380952386,
      330.58441043083906, 392.61909863945584, 393.69121315192746,
      466.441717687075,   467.7118480725624,  555.504098639456,
      557.0118480725623,  559.6624319727892,  561.1701814058956,
      472.9762414965988,  474.2463718820861,  400.34171768707495,
      401.41383219954645, 337.74409863945584, 338.64648526077093,
      323.38222222222225, 324.2213151927438,  385.0692970521543,
      386.06621315192746, 457.4058049886622,  458.5868480725623,
      544.6515192743766,  546.0535147392291,  548.5181859410433,
      549.9201814058956,  463.4819954648527,  464.6630385487528,
      392.25024943310666, 393.2471655328798,  330.878820861678,
      331.71791383219954, 340.3955555555556,  341.2346485260771,
      405.2826303854876,  406.2795464852607,  481.35247165532894,
      482.53351473922896, 573.0781859410432,  574.4801814058958,
      576.9448526077098,  578.3468480725625,  487.42866213151933,
      488.60970521541947, 412.46358276643986, 413.46049886621313,
      347.89215419501136, 348.73124716553286, 384.1651984126985,
      385.06758503401346, 457.3498922902495,  458.42200680272094,
      543.128066893424,   544.3981972789114,  646.5371145124717,
      648.0448639455782,  650.6954478458049,  652.2031972789116,
      549.6625907029479,  550.9327210884353,  465.07251133786855,
      466.14462585034005, 392.22727324263036, 393.12965986394556,
      343.8526133786848,  344.6464965986394,  409.3434297052155,
      410.28663265306113, 486.09779478458057, 487.2152040816325,
      578.6211281179138,  579.9475850340135,  582.2794614512472,
      583.6059183673468,  491.84660430839006, 492.96401360544206,
      416.13747732426305, 417.0806802721088,  350.9453004535148,
      351.73918367346937, 301.8039739229025,  302.48935374149653,
      359.27438208616786, 360.0886734693877,  426.62398526077106,
      427.5886734693877,  507.80446145124733, 508.94962585034,
      510.96279478458064, 512.1079591836733,  431.5870804988662,
      432.5517687074829,  365.139858276644,   365.95414965986396,
      307.9272732426304,  308.6126530612244,  258.0192800453514,
      258.59615646258504, 307.14274943310653, 307.8281292517007,
      364.7066383219955,  365.5186054421768,  434.0871145124717,
      435.05098639455775, 436.7454478458051,  437.70931972789106,
      368.88401927437644, 369.69598639455774, 312.07965419501136,
      312.7650340136054,  263.1731916099773,  263.7500680272109};
  const std::array<int, 4> in_shape = {{3, 10, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.08163265306122448,
      0.12244897959183673, 0.08163265306122448, 0.12244897959183673,
      0.08163265306122448, 0.12244897959183673, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.32653061224489793, 0.40816326530612246, 0.32653061224489793,
      0.40816326530612246, 0.32653061224489793, 0.40816326530612246,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.42857142857142855, 0.4897959183673469,
      0.5714285714285714,  0.6530612244897959,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  0.7346938775510203,
      0.8163265306122449,  0.5714285714285714,  0.6530612244897959,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      0.7346938775510203,  0.8163265306122449,  0.5714285714285714,
      0.6530612244897959,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  0.7346938775510203,  0.8163265306122449,
      0.5714285714285714,  0.6530612244897959,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  1.3061224489795917,
      1.4693877551020407,  1.3061224489795917,  1.4693877551020407,
      1.3061224489795917,  1.4693877551020407,  0.7346938775510203,
      0.8163265306122449,  0.5510204081632653,  0.6122448979591837,
      1.2244897959183672,  1.3469387755102038,  1.2244897959183672,
      1.3469387755102038,  1.2244897959183672,  1.3469387755102038,
      1.2244897959183672,  1.3469387755102038,  1.2244897959183672,
      1.3469387755102038,  1.2244897959183672,  1.3469387755102038,
      0.6734693877551019,  0.7346938775510203,  0.44897959183673464,
      0.4897959183673469,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.9795918367346936,  1.0612244897959182,
      0.9795918367346936,  1.0612244897959182,  0.9795918367346936,
      1.0612244897959182,  0.5306122448979591,  0.5714285714285714,
      0.26530612244897955, 0.2857142857142857,  0.5714285714285714,
      0.6122448979591837,  0.5714285714285714,  0.6122448979591837,
      0.5714285714285714,  0.6122448979591837,  0.5714285714285714,
      0.6122448979591837,  0.5714285714285714,  0.6122448979591837,
      0.5714285714285714,  0.6122448979591837,  0.3061224489795918,
      0.32653061224489793, 0.3469387755102041,  0.36734693877551017,
      0.7346938775510203,  0.7755102040816326,  0.7346938775510203,
      0.7755102040816326,  0.7346938775510203,  0.7755102040816326,
      0.7346938775510203,  0.7755102040816326,  0.7346938775510203,
      0.7755102040816326,  0.7346938775510203,  0.7755102040816326,
      0.3877551020408163,  0.4081632653061224,  0.7755102040816326,
      0.8163265306122448,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  1.6326530612244898,  1.7142857142857144,
      1.6326530612244898,  1.7142857142857144,  1.6326530612244898,
      1.7142857142857144,  0.8571428571428571,  0.8979591836734693,
      1.2857142857142856,  1.3469387755102038,  2.693877551020408,
      2.816326530612245,   2.693877551020408,   2.816326530612245,
      2.693877551020408,   2.816326530612245,   2.693877551020408,
      2.816326530612245,   2.693877551020408,   2.816326530612245,
      2.693877551020408,   2.816326530612245,   1.4081632653061225,
      1.4693877551020407,  1.8775510204081631,  1.9591836734693873,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      2.0408163265306123,  2.1224489795918364,  1.8775510204081631,
      1.9591836734693873,  3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   2.0408163265306123,  2.1224489795918364,
      1.8775510204081631,  1.9591836734693873,  3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   2.0408163265306123,
      2.1224489795918364,  1.8775510204081631,  1.9591836734693873,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      3.9183673469387754,  4.081632653061225,   3.9183673469387754,
      4.081632653061225,   3.9183673469387754,  4.081632653061225,
      2.0408163265306123,  2.1224489795918364,  1.530612244897959,
      1.5918367346938773,  3.183673469387755,   3.306122448979591,
      3.183673469387755,   3.306122448979591,   3.183673469387755,
      3.306122448979591,   3.183673469387755,   3.306122448979591,
      3.183673469387755,   3.306122448979591,   3.183673469387755,
      3.306122448979591,   1.6530612244897958,  1.714285714285714,
      1.1020408163265305,  1.1428571428571428,  2.2857142857142856,
      2.3673469387755097,  2.2857142857142856,  2.3673469387755097,
      2.2857142857142856,  2.3673469387755097,  2.2857142857142856,
      2.3673469387755097,  2.2857142857142856,  2.3673469387755097,
      2.2857142857142856,  2.3673469387755097,  1.183673469387755,
      1.2244897959183674,  0.5918367346938775,  0.6122448979591836,
      1.2244897959183674,  1.2653061224489794,  1.2244897959183674,
      1.2653061224489794,  1.2244897959183674,  1.2653061224489794,
      1.2244897959183674,  1.2653061224489794,  1.2244897959183674,
      1.2653061224489794,  1.2244897959183674,  1.2653061224489794,
      0.6326530612244897,  0.6530612244897959,  0.673469387755102,
      0.6938775510204082,  1.387755102040816,   1.4285714285714284,
      1.387755102040816,   1.4285714285714284,  1.387755102040816,
      1.4285714285714284,  1.387755102040816,   1.4285714285714284,
      1.387755102040816,   1.4285714285714284,  1.387755102040816,
      1.4285714285714284,  0.7142857142857142,  0.7346938775510203,
      1.4285714285714284,  1.4693877551020407,  2.938775510204081,
      3.020408163265306,   2.938775510204081,   3.020408163265306,
      2.938775510204081,   3.020408163265306,   2.938775510204081,
      3.020408163265306,   2.938775510204081,   3.020408163265306,
      2.938775510204081,   3.020408163265306,   1.510204081632653,
      1.5510204081632653,  2.265306122448979,   2.326530612244898,
      4.653061224489795,   4.775510204081632,   4.653061224489795,
      4.775510204081632,   4.653061224489795,   4.775510204081632,
      4.653061224489795,   4.775510204081632,   4.653061224489795,
      4.775510204081632,   4.653061224489795,   4.775510204081632,
      2.387755102040816,   2.4489795918367347,  3.1836734693877546,
      3.2653061224489797,  6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   3.346938775510204,   3.428571428571429,
      3.1836734693877546,  3.2653061224489797,  6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   3.346938775510204,
      3.428571428571429,   3.1836734693877546,  3.2653061224489797,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      3.346938775510204,   3.428571428571429,   3.1836734693877546,
      3.2653061224489797,  6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   6.5306122448979576,  6.693877551020408,
      6.5306122448979576,  6.693877551020408,   6.5306122448979576,
      6.693877551020408,   3.346938775510204,   3.428571428571429,
      2.510204081632653,   2.571428571428571,   5.142857142857142,
      5.26530612244898,    5.142857142857142,   5.26530612244898,
      5.142857142857142,   5.26530612244898,    5.142857142857142,
      5.26530612244898,    5.142857142857142,   5.26530612244898,
      5.142857142857142,   5.26530612244898,    2.63265306122449,
      2.6938775510204076,  1.7551020408163263,  1.7959183673469385,
      3.5918367346938775,  3.6734693877551017,  3.5918367346938775,
      3.6734693877551017,  3.5918367346938775,  3.6734693877551017,
      3.5918367346938775,  3.6734693877551017,  3.5918367346938775,
      3.6734693877551017,  3.5918367346938775,  3.6734693877551017,
      1.8367346938775508,  1.8775510204081631,  0.9183673469387754,
      0.9387755102040816,  1.8775510204081631,  1.9183673469387754,
      1.8775510204081631,  1.9183673469387754,  1.8775510204081631,
      1.9183673469387754,  1.8775510204081631,  1.9183673469387754,
      1.8775510204081631,  1.9183673469387754,  1.8775510204081631,
      1.9183673469387754,  0.9591836734693877,  0.9795918367346939};
  const std::array<int, 4> in_shape = {{3, 10, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907029477, 27.45497732426304,  28.031853741496597,
      28.60873015873016,  33.119937641723354, 33.80531746031746,
      34.49069727891156,  35.176077097505676, 40.90842970521542,
      41.720396825396826, 42.532363945578226, 43.34433106575963,
      50.862239229024944, 51.82611111111112,  52.78998299319728,
      53.75385487528344,  56.178905895691614, 57.14277777777777,
      58.10664965986395,  59.070521541950114, 49.263191609977326,
      50.07515873015873,  50.88712585034013,  51.699092970521534,
      42.993747165532874, 43.67912698412699,  44.36450680272108,
      45.04988662131519,  37.18592403628118,  37.76280045351474,
      38.33967687074829,  38.916553287981856, 41.42469954648526,
      42.110079365079365, 42.795459183673465, 43.48083900226758,
      50.62571995464852,  51.440011337868484, 52.25430272108843,
      53.0685941043084,   61.961831065759625, 62.92651927437642,
      63.89120748299319,  64.85589569160997,  76.28706916099772,
      77.43223356009071,  78.57739795918367,  79.72256235827663,
      82.6037358276644,   83.74890022675737,  84.89406462585035,
      86.0392290249433,   71.88802154195011,  72.85270975056689,
      73.81739795918367,  74.78208616780044,  62.356672335600905,
      63.17096371882086,  63.98525510204081,  64.79954648526076,
      53.67129818594104,  54.35667800453514,  55.04205782312925,
      55.727437641723355, 59.44340702947846,  60.2372902494331,
      61.031173469387745, 61.825056689342404, 72.2566723356009,
      73.19987528344672,  74.1430782312925,   75.08628117913833,
      87.9023072562358,   89.01971655328799,  90.13712585034013,
      91.25453514739229,  107.51325963718818, 108.839716553288,
      110.16617346938774, 111.4926303854875,  114.82992630385486,
      116.15638321995466, 117.48284013605442, 118.80929705215416,
      99.39992630385487,  100.51733560090703, 101.63474489795917,
      102.75215419501131, 85.84476757369615,  86.78797052154195,
      87.73117346938774,  88.67437641723355,  73.62878117913833,
      74.42266439909297,  75.21654761904762,  76.01043083900227,
      80.93422335600908,  81.83660997732426,  82.73899659863945,
      83.64138321995465,  98.01279478458049,  99.08490929705216,
      100.15702380952379, 101.22913832199546, 118.72985827664397,
      119.99998866213153, 121.27011904761903, 122.54024943310657,
      144.54081065759635, 146.04856009070298, 147.5563095238095,
      149.06405895691606, 152.85747732426302, 154.3652267573696,
      155.8729761904762,  157.38072562358272, 131.7989058956916,
      133.06903628117914, 134.33916666666664, 135.60929705215418,
      113.45803287981859, 114.53014739229026, 115.60226190476189,
      116.67437641723355, 97.05837301587302,  97.96075963718822,
      98.86314625850339,  99.7655328798186,   108.90585034013606,
      109.7449433106576,  110.58403628117911, 111.42312925170067,
      131.11537414965986, 132.11229024943313, 133.10920634920632,
      134.1061224489796,  157.7629931972789,  158.94403628117917,
      160.1250793650793,  161.30612244897955, 190.6239455782313,
      192.02594104308392, 193.4279365079365,  194.82993197278907,
      198.3572789115646,  199.75927437641724, 201.16126984126984,
      202.5632653061224,  169.91537414965984, 171.0964172335601,
      172.2774603174603,  173.4585034013605,  145.4772789115646,
      146.47419501133788, 147.4711111111111,  148.46802721088434,
      123.89904761904764, 124.73814058956916, 125.57723356009069,
      126.41632653061225, 142.93251700680273, 143.7716099773243,
      144.61070294784577, 145.44979591836733, 171.54204081632656,
      172.53895691609978, 173.535873015873,   174.53278911564624,
      205.65632653061223, 206.83736961451245, 208.0184126984127,
      209.1994557823129,  247.4772789115646,  248.87927437641721,
      250.28126984126982, 251.6832653061224,  255.21061224489796,
      256.61260770975053, 258.01460317460317, 259.4165986394557,
      217.8087074829932,  218.9897505668935,  220.17079365079363,
      221.35183673469388, 185.9039455782313,  186.90086167800453,
      187.89777777777778, 188.89469387755102, 157.9257142857143,
      158.7648072562358,  159.60390022675736, 160.44299319727892,
      189.9005725623583,  190.80295918367347, 191.70534580498867,
      192.60773242630387, 227.47438208616782, 228.54649659863944,
      229.61861111111114, 230.69072562358278, 272.1025566893424,
      273.37268707482997, 274.6428174603175,  275.912947845805,
      326.60684240362815, 328.11459183673475, 329.6223412698412,
      331.1300907029478,  334.9235090702948,  336.4312585034014,
      337.93900793650795, 339.4467573696145,  285.17160430839,
      286.44173469387755, 287.7118650793651,  288.9819954648526,
      242.91962018140592, 243.99173469387748, 245.06384920634923,
      246.13596371882085, 206.02472222222224, 206.92710884353738,
      207.8294954648526,  208.73188208616781, 178.8260827664399,
      179.61996598639453, 180.41384920634923, 181.20773242630386,
      214.09376984126985, 215.03697278911562, 215.98017573696146,
      216.92337868480726, 255.93623015873018, 257.05363945578233,
      258.1710487528345,  259.28845804988663, 306.98337301587304,
      308.30982993197284, 309.63628684807253, 310.96274376417233,
      314.3000396825397,  315.6264965986395,  316.95295351473925,
      318.27941043083905, 267.43384920634924, 268.5512585034013,
      269.66866780045353, 270.7860770975057,  227.68186507936508,
      228.62506802721083, 229.56827097505672, 230.5114739229025,
      193.01145691609977, 193.80534013605435, 194.5992233560091,
      195.3931065759637,  164.2794841269841,  164.96486394557823,
      165.6502437641724,  166.33562358276646, 196.58798752834466,
      197.4022789115646,  198.21657029478462, 199.03086167800453,
      234.88282879818595, 235.8475170068027,  236.81220521541954,
      237.77689342403627, 281.5585430839002,  282.70370748299314,
      283.8488718820862,  284.99403628117915, 287.8752097505669,
      289.0203741496598,  290.1655385487529,  291.3107029478458,
      244.80901927437642, 245.77370748299313, 246.73839569161004,
      247.70308390022677, 208.31893990929706, 209.13323129251694,
      209.947522675737,   210.76181405895693, 176.5260827664399,
      177.21146258503398, 177.89684240362814, 178.58222222222224,
      146.26077664399094, 146.83765306122447, 147.41452947845806,
      147.9914058956916,  174.95703514739228, 175.64241496598635,
      176.32779478458053, 177.0131746031746,  208.94235260770972,
      209.7543197278911,  210.56628684807262, 211.378253968254,
      250.33235260770974, 251.29622448979586, 252.26009637188213,
      253.22396825396825, 255.64901927437643, 256.6128911564625,
      257.57676303854885, 258.54063492063494, 217.29711451247164,
      218.109081632653,   218.9210487528345,  219.7330158730159,
      184.83084467120182, 185.51622448979586, 186.20160430839002,
      186.88698412698415, 156.5685997732426,  157.1454761904762,
      157.72235260770972, 158.29922902494332, 211.4785544217687,
      212.05543083900227, 212.6323072562358,  213.2091836734694,
      252.44147959183672, 253.12685941043085, 253.81223922902493,
      254.497619047619,   300.7379081632653,  301.54987528344674,
      302.3618424036281,  303.17380952380955, 359.3012414965986,
      360.26511337868493, 361.22898526077097, 362.1928571428571,
      364.6179081632653,  365.58178004535154, 366.54565192743775,
      367.50952380952384, 309.09267006802725, 309.90463718820865,
      310.71660430839,    311.5285714285715,  262.3152891156463,
      263.00066893424037, 263.6860487528344,  264.37142857142857,
      221.7863775510204,  222.36325396825396, 222.9401303854875,
      223.51700680272108, 260.74624149659866, 261.43162131519273,
      262.1170011337868,  262.802380952381,   311.198962585034,
      312.01325396825405, 312.82754535147393, 313.6418367346938,
      370.66205782312926, 371.6267460317461,  372.5914342403628,
      373.55612244897964, 442.73967687074827, 443.88484126984144,
      445.0300056689342,  446.1751700680272,  449.05634353741505,
      450.20150793650805, 451.346672335601,   452.49183673469395,
      380.58824829931984, 381.5529365079366,  382.51762471655326,
      383.4823129251702,  322.9299149659865,  323.74420634920637,
      324.5584977324262,  325.3727891156463,  272.9928401360544,
      273.6782199546485,  274.3635997732426,  275.04897959183677,
      313.486037414966,   314.27992063492064, 315.0738038548752,
      315.8676870748299,  374.0816156462585,  375.02481859410443,
      375.9680215419501,  376.9112244897958,  445.4732823129252,
      446.59069160997745, 447.70810090702946, 448.82551020408164,
      531.9794727891157,  533.3059297052157,  534.6323866213152,
      535.958843537415,   539.2961394557824,  540.6225963718822,
      541.949053287982,   543.2755102040817,  456.9709013605444,
      458.0883106575965,  459.2057199546485,  460.32312925170083,
      387.6697108843539,  388.6129138321996,  389.5561167800452,
      390.4993197278912,  327.6714115646259,  328.4652947845805,
      329.2591780045351,  330.05306122448985, 369.69794217687075,
      370.60032879818596, 371.5027154195011,  372.4051020408163,
      441.0894387755102,  442.161553287982,   443.23366780045353,
      444.30578231292503, 525.1715816326531,  526.4417120181407,
      527.7118424036281,  528.9819727891157,  627.0206292517007,
      628.5283786848075,  630.0361281179138,  631.5438775510206,
      635.3372959183674,  636.845045351474,   638.3527947845806,
      639.8605442176873,  538.2406292517009,  539.5107596371884,
      540.7808900226756,  542.0510204081634,  456.53467687074846,
      457.60679138321996, 458.67890589569146, 459.7510204081633,
      385.8220918367347,  386.7244784580499,  387.626865079365,
      388.52925170068033, 377.41560090702944, 378.25469387755095,
      379.09378684807257, 379.9328798185941,  450.1285260770975,
      451.1254421768707,  452.12235827664404, 453.11927437641714,
      535.6967800453515,  536.8778231292516,  538.058866213152,
      539.239909297052,   639.2624943310659,  640.6644897959186,
      642.066485260771,   643.4684807256237,  646.9958276643994,
      648.3978231292518,  649.7998185941043,  651.201814058957,
      547.8491609977325,  549.0302040816326,  550.2112471655329,
      551.3922902494331,  464.4904308390023,  465.48734693877543,
      466.4842630385487,  467.481179138322,   392.40879818594095,
      393.2478911564625,  394.0869841269842,  394.92607709750564,
      411.4422675736961,  412.28136054421765, 413.12045351473927,
      413.9595464852608,  490.55519274376405, 491.5521088435373,
      492.5490249433107,  493.5459410430839,  583.5901133786848,
      584.7711564625849,  585.9521995464854,  587.1332426303854,
      696.1158276643991,  697.5178231292515,  698.9198185941044,
      700.321814058957,   703.8491609977324,  705.2511564625848,
      706.6531519274379,  708.0551473922903,  595.7424943310656,
      596.923537414966,   598.1045804988662,  599.2856235827664,
      504.9170975056688,  505.9140136054422,  506.91092970521544,
      507.9078458049886,  426.4354648526076,  427.27455782312927,
      428.1136507936508,  428.9527437641723,  478.66429138321996,
      479.56667800453505, 480.4690646258503,  481.3714512471655,
      570.5510260770974,  571.6231405895691,  572.6952551020408,
      573.7673696145126,  678.5442800453515,  679.814410430839,
      681.0845408163264,  682.3546712018141,  809.0866609977323,
      810.594410430839,   812.1021598639455,  813.6099092970521,
      817.4033276643991,  818.9110770975057,  820.4188265306123,
      821.9265759637188,  691.613327664399,   692.8834580498866,
      694.1535884353741,  695.4237188208618,  585.9962641723355,
      587.0683786848074,  588.1404931972789,  589.2126077097505,
      494.78844104308376, 495.69082766439914, 496.59321428571434,
      497.4956009070294,  432.8687131519274,  433.662596371882,
      434.45647959183674, 435.2503628117914,  515.9187131519274,
      516.8619160997732,  517.8051190476191,  518.7483219954648,
      613.5072052154195,  614.6246145124716,  615.7420238095237,
      616.8594331065761,  731.4495861678004,  732.7760430839003,
      734.1025,           735.4289569160998,  738.766252834467,
      740.0927097505669,  741.4191666666666,  742.7456235827664,
      625.0048242630385,  626.1222335600908,  627.2396428571429,
      628.3570521541949,  529.5068083900226,  530.4500113378684,
      531.3932142857143,  532.33641723356,    447.05408730158723,
      447.84797052154187, 448.6418537414967,  449.43573696145125,
      383.6010260770975,  384.2864058956916,  384.9717857142857,
      385.65716553287984, 457.16123015873006, 457.97552154195006,
      458.78981292517005, 459.60410430839005, 543.5830555555556,
      544.5477437641723,  545.512431972789,   546.4771201814059,
      648.0111507936508,  649.1563151927438,  650.3014795918366,
      651.4466439909298,  654.3278174603174,  655.4729818594104,
      656.6181462585033,  657.7633106575964,  553.509246031746,
      554.4739342403627,  555.4386224489797,  556.4033106575963,
      468.8921825396825,  469.70647392290243, 470.5207653061225,
      471.3350566893424,  395.84762471655324, 396.5330045351473,
      397.21838435374156, 397.9037641723356,  330.86123015873017,
      331.43810657596373, 332.0149829931973,  332.5918594104308,
      394.27857709750566, 394.96395691609973, 395.6493367346939,
      396.33471655328793, 468.77183106575956, 469.583798185941,
      470.3957653061225,  471.20773242630383, 558.7713548752834,
      559.7352267573697,  560.6990986394558,  561.662970521542,
      564.08802154195,    565.0518934240363,  566.0157653061225,
      566.9796371882086,  477.1265929705215,  477.93856009070294,
      478.7505272108844,  479.5624943310657,  404.15238662131515,
      404.8377664399093,  405.52314625850346, 406.2085260770975,
      341.1690532879818,  341.7459297052154,  342.322806122449,
      342.89968253968254, 396.0790079365079,  396.65588435374144,
      397.232760770975,   397.8096371882087,  471.7630215419501,
      472.4484013605442,  473.1337811791383,  473.8191609977325,
      560.5673866213152,  561.3793537414967,  562.191320861678,
      563.0032879818596,  667.7402437641723,  668.7041156462589,
      669.6679875283445,  670.6318594104309,  673.056910430839,
      674.0207823129255,  674.9846541950113,  675.9485260770977,
      568.9221485260771,  569.7341156462586,  570.5460827664398,
      571.3580498866213,  481.6368310657596,  482.32221088435375,
      483.0075907029479,  483.69297052154195, 406.3868310657596,
      406.96370748299313, 407.5405839002268,  408.1174603174603,
      480.067783446712,   480.75316326530606, 481.4385430839002,
      482.12392290249437, 571.7722052154195,  572.5864965986394,
      573.4007879818594,  574.2150793650794,  679.3622845804989,
      680.3269727891159,  681.2916609977325,  682.2563492063493,
      809.1922845804988,  810.3374489795923,  811.4826133786846,
      812.6277777777779,  815.5089512471656,  816.6541156462589,
      817.7992800453515,  818.9444444444446,  689.2884750566893,
      690.2531632653063,  691.2178514739228,  692.1825396825396,
      583.5031575963719,  584.317448979592,   585.1317403628119,
      585.9460317460317,  492.31438208616777, 492.99976190476184,
      493.685141723356,   494.37052154195004, 567.5286678004535,
      568.3225510204081,  569.1164342403628,  569.9103174603175,
      675.9065589569161,  676.8497619047619,  677.7929648526076,
      678.7361678004535,  803.0442573696146,  804.1616666666669,
      805.2790759637188,  806.396485260771,   956.445685941043,
      957.7721428571433,  959.0985997732423,  960.4250566893423,
      963.7623526077097,  965.0888095238099,  966.4152664399091,
      967.7417233560091,  814.5418764172335,  815.6592857142858,
      816.7766950113377,  817.8941043083898,  689.4946541950113,
      690.4378571428572,  691.3810600907029,  692.3242630385486,
      581.7140419501134,  582.507925170068,   583.3018083900226,
      584.0956916099772,  658.4616609977323,  659.3640476190477,
      660.2664342403627,  661.1688208616781,  784.1660827664399,
      785.2381972789117,  786.3103117913831,  787.3824263038549,
      931.6133049886622,  932.88343537415,    934.1535657596372,
      935.4236961451248,  1109.500447845805,  1111.008197278912,
      1112.5159467120177, 1114.0236961451246, 1117.8171145124716,
      1119.3248639455785, 1120.8326133786848, 1122.3403628117912,
      944.6823526077097,  945.9524829931976,  947.2226133786846,
      948.4927437641722,  799.611320861678,   800.6834353741499,
      801.7555498866213,  802.8276643990929,  674.5858106575964,
      675.4881972789117,  676.3905839002267,  677.2929705215419,
      645.9253514739228,  646.7644444444445,  647.603537414966,
      648.4426303854876,  769.141678004535,   770.1385941043086,
      771.1355102040816,  772.1324263038549,  913.6305668934241,
      914.8116099773245,  915.9926530612244,  917.1736961451246,
      1087.9010430839,    1089.3030385487532, 1090.7050340136054,
      1092.1070294784581, 1095.6343764172334, 1097.0363718820865,
      1098.4383673469388, 1099.8403628117912, 925.782947845805,
      926.9639909297053,  928.1450340136055,  929.3260770975056,
      783.50358276644,    784.5004988662133,  785.4974149659865,
      786.4943310657596,  660.9185487528345,  661.757641723356,
      662.5967346938775,  663.4358276643991,  679.9520181405894,
      680.7911111111111,  681.6302040816327,  682.4692970521542,
      809.5683446712018,  810.5652607709752,  811.5621768707483,
      812.5590929705214,  961.5239002267573,  962.7049433106579,
      963.8859863945579,  965.0670294784579,  1144.7543764172333,
      1146.1563718820864, 1147.558367346939,  1148.9603628117916,
      1152.4877097505666, 1153.8897052154196, 1155.2917006802722,
      1156.693696145125,  973.6762811791384,  974.8573242630387,
      976.0383673469388,  977.2194104308389,  823.9302494331066,
      824.9271655328797,  825.924081632653,   826.9209977324263,
      694.9452154195011,  695.7843083900227,  696.6234013605441,
      697.4624943310657,  767.4280102040815,  768.330396825397,
      769.232783446712,   770.1351700680269,  913.627670068027,
      914.699784580499,   915.7718990929704,  916.8440136054419,
      1084.9860034013607, 1086.256133786848,  1087.5262641723357,
      1088.7963945578229, 1291.5664795918372, 1293.0742290249434,
      1294.58197845805,   1296.0897278911564, 1299.8831462585038,
      1301.3908956916098, 1302.8986451247165, 1304.4063945578232,
      1098.0550510204082, 1099.3251814058958, 1100.5953117913832,
      1101.8654421768706, 929.0729081632652,  930.1450226757371,
      931.2171371882085,  932.2892517006801,  783.5521598639455,
      784.4545464852607,  785.356933106576,   786.2593197278911,
      686.911343537415,   687.7052267573696,  688.4991099773243,
      689.2929931972787,  817.7436564625849,  818.686859410431,
      819.6300623582766,  820.5732653061223,  971.0781802721087,
      972.1955895691611,  973.3129988662132,  974.430408163265,
      1155.915799319728,  1157.2422562358277, 1158.5687131519276,
      1159.895170068027,  1163.2324659863946, 1164.5589229024945,
      1165.8853798185942, 1167.2118367346936, 982.5757993197277,
      983.6932086167801,  984.8106179138322,  985.9280272108841,
      831.3317517006802,  832.2749546485261,  833.218157596372,
      834.1613605442176,  701.0967176870747,  701.8906009070296,
      702.6844841269841,  703.4783673469387,  602.922568027211,
      603.607947845805,   604.293327664399,   604.9787074829931,
      717.7344727891157,  718.5487641723357,  719.3630555555555,
      720.1773469387754,  852.283282312925,   853.2479705215421,
      854.2126587301586,  855.1773469387754,  1014.4637585034012,
      1015.6089229024947, 1016.7540873015872, 1017.89925170068,
      1020.7804251700678, 1021.9255895691613, 1023.0707539682539,
      1024.2159183673466, 862.2094727891157,  863.1741609977324,
      864.1388492063493,  865.1035374149658,  729.465425170068,
      730.279716553288,   731.094007936508,   731.9082993197279,
      615.1691666666667,  615.8545464852608,  616.5399263038549,
      617.2253061224488,  515.4616836734695,  516.0385600907028,
      516.6154365079365,  517.1923129251701,  613.6001190476192,
      614.2854988662131,  614.9708786848073,  615.6562585034014,
      728.6013095238095,  729.413276643991,   730.2252437641723,
      731.0372108843536,  867.2103571428572,  868.1742290249434,
      869.1381009070295,  870.1019727891155,  872.5270238095237,
      873.4908956916101,  874.4547675736961,  875.4186394557821,
      736.9560714285714,  737.7680385487529,  738.5800056689343,
      739.3919727891155,  623.4739285714286,  624.1593083900227,
      624.8446882086168,  625.5300680272107,  525.7695068027211,
      526.3463832199546,  526.9232596371883,  527.5001360544218};
  const std::array<int, 4> in_shape = {{3, 10, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.04081632653061224,
                                         0.061224489795918366,
                                         0.08163265306122448,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.1020408163265306,
                                         0.12244897959183673,
                                         0.14285714285714285,
                                         0.16326530612244897,
                                         0.2040816326530612,
                                         0.24489795918367344,
                                         0.2857142857142857,
                                         0.32653061224489793,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.36734693877551017,
                                         0.40816326530612246,
                                         0.44897959183673464,
                                         0.4897959183673469,
                                         0.5510204081632653,
                                         0.6122448979591836,
                                         0.673469387755102,
                                         0.7346938775510203,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         1.346938775510204,
                                         1.4693877551020407,
                                         1.5918367346938775,
                                         1.7142857142857144,
                                         0.7959183673469388,
                                         0.8571428571428571,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.2244897959183674,
                                         1.3061224489795917,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         1.3877551020408163,
                                         1.4693877551020407,
                                         1.5510204081632653,
                                         1.6326530612244898,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.2244897959183674,
                                         1.3061224489795917,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         1.3877551020408163,
                                         1.4693877551020407,
                                         1.5510204081632653,
                                         1.6326530612244898,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.2244897959183674,
                                         1.3061224489795917,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         1.3877551020408163,
                                         1.4693877551020407,
                                         1.5510204081632653,
                                         1.6326530612244898,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.2244897959183674,
                                         1.3061224489795917,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         1.3877551020408163,
                                         1.4693877551020407,
                                         1.5510204081632653,
                                         1.6326530612244898,
                                         1.0408163265306123,
                                         1.1020408163265305,
                                         1.163265306122449,
                                         1.2244897959183674,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.6938775510204076,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.6938775510204076,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.6938775510204076,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.6938775510204076,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.6938775510204076,
                                         2.326530612244898,
                                         2.4489795918367343,
                                         2.571428571428571,
                                         2.6938775510204076,
                                         1.2857142857142856,
                                         1.3469387755102038,
                                         1.4081632653061225,
                                         1.4693877551020407,
                                         0.8571428571428572,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         1.9591836734693873,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         1.0204081632653061,
                                         1.0612244897959182,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         0.5102040816326531,
                                         0.5306122448979591,
                                         0.5510204081632653,
                                         0.5714285714285714,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         1.183673469387755,
                                         1.2244897959183674,
                                         0.5918367346938775,
                                         0.6122448979591836,
                                         0.6326530612244897,
                                         0.6530612244897959,
                                         0.673469387755102,
                                         0.6938775510204082,
                                         0.7142857142857142,
                                         0.7346938775510203,
                                         1.4285714285714284,
                                         1.4693877551020407,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         1.4285714285714284,
                                         1.4693877551020407,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         1.4285714285714284,
                                         1.4693877551020407,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         1.4285714285714284,
                                         1.4693877551020407,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         1.4285714285714284,
                                         1.4693877551020407,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         1.4285714285714284,
                                         1.4693877551020407,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         0.7551020408163265,
                                         0.7755102040816326,
                                         0.7959183673469387,
                                         0.8163265306122448,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         1.5918367346938775,
                                         1.6326530612244896,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         3.2653061224489797,
                                         3.346938775510204,
                                         3.428571428571429,
                                         1.673469387755102,
                                         1.7142857142857142,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         2.510204081632653,
                                         2.571428571428571,
                                         2.63265306122449,
                                         2.6938775510204076,
                                         5.265306122448979,
                                         5.387755102040816,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.265306122448979,
                                         5.387755102040816,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.265306122448979,
                                         5.387755102040816,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.265306122448979,
                                         5.387755102040816,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.265306122448979,
                                         5.387755102040816,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.265306122448979,
                                         5.387755102040816,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         2.7551020408163263,
                                         2.816326530612245,
                                         2.8775510204081627,
                                         2.9387755102040813,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         3.836734693877551,
                                         3.9183673469387745,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         3.9999999999999996,
                                         4.081632653061225,
                                         4.163265306122448,
                                         4.244897959183673,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         3.836734693877551,
                                         3.9183673469387745,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         3.9999999999999996,
                                         4.081632653061225,
                                         4.163265306122448,
                                         4.244897959183673,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         3.836734693877551,
                                         3.9183673469387745,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         3.9999999999999996,
                                         4.081632653061225,
                                         4.163265306122448,
                                         4.244897959183673,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         3.836734693877551,
                                         3.9183673469387745,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         3.9999999999999996,
                                         4.081632653061225,
                                         4.163265306122448,
                                         4.244897959183673,
                                         3.,
                                         3.061224489795918,
                                         3.1224489795918364,
                                         3.1836734693877546,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367346,
                                         6.612244897959182,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367346,
                                         6.612244897959182,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367346,
                                         6.612244897959182,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367346,
                                         6.612244897959182,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367346,
                                         6.612244897959182,
                                         6.244897959183673,
                                         6.36734693877551,
                                         6.489795918367346,
                                         6.612244897959182,
                                         3.244897959183673,
                                         3.3061224489795915,
                                         3.36734693877551,
                                         3.428571428571428,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         2.3265306122448974,
                                         2.36734693877551,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         1.163265306122449,
                                         1.183673469387755,
                                         1.2040816326530612,
                                         1.2244897959183672,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         1.2448979591836733,
                                         1.2653061224489794,
                                         1.2857142857142856,
                                         1.3061224489795917,
                                         1.3265306122448979,
                                         1.346938775510204,
                                         1.3673469387755102,
                                         1.3877551020408163,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         1.4081632653061222,
                                         1.4285714285714284,
                                         1.4489795918367345,
                                         1.4693877551020407,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         2.8979591836734695,
                                         2.9387755102040813,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         2.9795918367346936,
                                         3.020408163265306,
                                         3.0612244897959178,
                                         3.1020408163265305,
                                         4.469387755102041,
                                         4.530612244897958,
                                         4.591836734693878,
                                         4.653061224489796,
                                         9.183673469387754,
                                         9.30612244897959,
                                         9.428571428571429,
                                         9.551020408163264,
                                         9.183673469387754,
                                         9.30612244897959,
                                         9.428571428571429,
                                         9.551020408163264,
                                         9.183673469387754,
                                         9.30612244897959,
                                         9.428571428571429,
                                         9.551020408163264,
                                         9.183673469387754,
                                         9.30612244897959,
                                         9.428571428571429,
                                         9.551020408163264,
                                         9.183673469387754,
                                         9.30612244897959,
                                         9.428571428571429,
                                         9.551020408163264,
                                         9.183673469387754,
                                         9.30612244897959,
                                         9.428571428571429,
                                         9.551020408163264,
                                         4.7142857142857135,
                                         4.775510204081632,
                                         4.83673469387755,
                                         4.8979591836734695,
                                         6.285714285714286,
                                         6.367346938775509,
                                         6.448979591836735,
                                         6.530612244897959,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         6.612244897959183,
                                         6.693877551020408,
                                         6.775510204081631,
                                         6.857142857142858,
                                         6.285714285714286,
                                         6.367346938775509,
                                         6.448979591836735,
                                         6.530612244897959,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         6.612244897959183,
                                         6.693877551020408,
                                         6.775510204081631,
                                         6.857142857142858,
                                         6.285714285714286,
                                         6.367346938775509,
                                         6.448979591836735,
                                         6.530612244897959,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         6.612244897959183,
                                         6.693877551020408,
                                         6.775510204081631,
                                         6.857142857142858,
                                         6.285714285714286,
                                         6.367346938775509,
                                         6.448979591836735,
                                         6.530612244897959,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         6.612244897959183,
                                         6.693877551020408,
                                         6.775510204081631,
                                         6.857142857142858,
                                         4.959183673469387,
                                         5.020408163265306,
                                         5.081632653061224,
                                         5.142857142857142,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         10.163265306122447,
                                         10.285714285714285,
                                         10.408163265306122,
                                         10.53061224489796,
                                         5.204081632653061,
                                         5.26530612244898,
                                         5.326530612244897,
                                         5.387755102040815,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.1020408163265305,
                                         7.183673469387755,
                                         7.265306122448979,
                                         7.346938775510203,
                                         3.63265306122449,
                                         3.6734693877551017,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         1.8163265306122447,
                                         1.8367346938775508,
                                         1.857142857142857,
                                         1.8775510204081631,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         3.7959183673469385,
                                         3.836734693877551,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         3.7959183673469385,
                                         3.836734693877551,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         3.7959183673469385,
                                         3.836734693877551,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         3.7959183673469385,
                                         3.836734693877551,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         3.7959183673469385,
                                         3.836734693877551,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         3.7959183673469385,
                                         3.836734693877551,
                                         1.8979591836734693,
                                         1.9183673469387754,
                                         1.9387755102040816,
                                         1.9591836734693877};
  const std::array<int, 4> in_shape = {{3, 10, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.882772108843537,  9.66202380952381,   11.549778911564626,
      13.87874716553288,  14.47124716553288,  16.30922335600907,
      14.486604308390024, 12.815856009070295, 11.036604308390022,
      12.034812925170067, 14.65079931972789,  17.395697278911566,
      20.748475056689344, 21.276689342403625, 23.63609410430839,
      20.884903628117918, 18.39782879818594,  15.781842403628119,
      17.163384353741495, 20.799778911564623, 24.58549319727891,
      29.176366213151926, 29.57600907029478,  32.52112811791383,
      28.627080498866217, 25.14000566893424,  21.50361111111111,
      23.268486394557826, 28.108962585034014, 33.11916666666667,
      39.16242063492063,  39.369206349206344, 42.964325396825394,
      37.71313492063492,  33.04238662131519,  28.201910430839,
      31.100034013605445, 37.38098639455782,  43.819761904761904,
      51.515793650793654, 51.085079365079366, 55.051031746031754,
      48.09150793650793,  41.968378684807256, 35.68742630385487,
      40.670034013605445, 48.75098639455783,  56.989761904761906,
      66.78579365079366,  65.72507936507937,  70.32103174603175,
      61.26150793650793,  53.33837868480725,  45.25742630385487,
      53.91527210884354,  64.52003401360544,  75.29452380952382,
      88.0627777777778,   86.25206349206353,  91.86468253968256,
      79.88849206349207,  69.45345804988662,  58.84869614512471,
      50.739761904761906, 60.69146258503402,  70.79248299319728,
      82.75121315192746,  80.94049886621316,  86.09597505668935,
      74.83407029478458,  65.03168934240362,  55.07998866213151,
      46.58772108843537,  55.70268707482993,  64.94656462585034,
      75.88148526077099,  74.1350566893424,   78.76910430839003,
      68.43577097505668,  59.44971655328798,  50.33475056689341,
      41.45914965986395,  49.55370748299319,  57.75676870748299,
      67.45359410430838,  65.83573696145123,  69.88407029478456,
      60.69359410430838,  52.707539682539675, 44.61298185941043,
      59.80164965986393,  71.34620748299321,  82.999268707483,
      96.72109410430836,  93.89573696145123,  99.15157029478456,
      85.93609410430838,  74.50003968253968,  62.95548185941042,
      73.71899659863944,  87.93702380952382,  102.28396258503402,
      119.17245464852606, 115.63995464852606, 122.0600736961451,
      105.77316893424035, 91.68405328798185,  77.4660260770975,
      88.61287414965985,  105.6880442176871,  122.91253401360545,
      143.18197845804988, 138.87804988662128, 146.52674036281178,
      126.95412131519272, 110.02827097505669, 92.95310090702947,
      104.48328231292516, 124.59926870748302, 144.88498299319727,
      168.7496655328798,  163.61002267573693, 172.55157029478457,
      149.47895124716553, 129.53269274376416, 109.41670634920632,
      106.61840136054423, 127.10343537414967, 147.7462925170068,
      172.0137528344671,  166.6116099773243,  175.54899092970524,
      152.01803854875283, 131.69082766439908, 111.20579365079364,
      116.18840136054422, 138.47343537414966, 160.91629251700684,
      187.28375283446715, 181.25160997732428, 190.81899092970522,
      165.18803854875281, 143.06082766439908, 120.77579365079362,
      135.1300680272109,  161.01034013605445, 187.06034013605446,
      217.65002267573695, 210.49287981859408, 221.4519274376417,
      191.65430839002266, 165.94376417233556, 140.06349206349205,
      122.18925170068029, 145.57972789115647, 169.11952380952383,
      196.75682539682543, 190.24253968253967, 200.1015873015873,
      173.1611111111111,  149.91995464852604, 126.5294784580499,
      108.27190476190476, 128.98891156462585, 149.83482993197282,
      174.3054648526077,  168.49832199546483, 177.19308390022672,
      153.3240362811791,  132.7359410430839,  112.01893424036281,
      93.37802721088437,  111.2378911564626,  129.2062585034014,
      150.2959410430839,  145.26022675736962, 152.72641723356006,
      132.14308390022677, 114.39172335600908, 96.53185941043084,
      111.72052721088436, 133.0303911564626,  154.44875850340136,
      179.5634410430839,  173.32022675736962, 181.9939172335601,
      157.38558390022678, 136.18422335600906, 114.87435941043084,
      135.40318027210884, 161.22324829931975, 187.17222789115647,
      217.5964342403628,  210.00321995464853, 220.48405328798185,
      190.6614342403628,  164.97027777777774, 139.1502097505669,
      160.06236394557823, 190.57630952380956, 221.239574829932,
      257.1875907029479,  248.18009070294784, 260.5323526077097,
      225.28116213151927, 194.9165362811791,  164.40259070294783,
      185.6980782312925,  221.089574829932,   256.6507993197279,
      298.33691043083905, 287.8508390022676,  302.1388151927437,
      261.24476757369615, 226.0229988662131,  190.63150226757367,
      182.13676870748296, 216.82588435374146, 251.67282312925164,
      292.5117120181406,  282.13814058956916, 296.04695011337867,
      255.9445691609977,  221.41327664399086, 186.72416099773238,
      191.70676870748298, 228.19588435374146, 264.84282312925166,
      307.7817120181405,  296.7781405895691,  311.31695011337865,
      269.1145691609977,  232.78327664399092, 196.29416099773243,
      216.34486394557825, 257.5006462585035,  298.826156462585,
      347.2372675736961,  334.73369614512467, 351.03917233560094,
      303.4201247165533,  262.43407029478453, 221.2782879818594,
      193.63874149659867, 230.46799319727893, 267.4465646258503,
      310.76243764172335, 299.54458049886625, 314.10719954648533,
      271.4881519274377,  234.8082199546485,  197.97896825396825,
      169.95608843537414, 202.27513605442178, 234.72309523809525,
      272.7294444444445,  262.8615873015873,  275.6170634920635,
      238.21230158730157, 206.0221655328798,  173.70311791383216,
      145.29690476190478, 172.92207482993197, 200.65574829931973,
      233.1382879818594,  224.68471655328796, 235.5687641723356,
      203.5925736961451,  176.07590702947843, 148.45073696145127};
  const std::array<int, 4> in_shape = {{3, 10, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.061224489795918366, 0.12244897959183673,
      0.12244897959183673, 0.12244897959183673,  0.12244897959183673,
      0.12244897959183673, 0.10204081632653061,  0.061224489795918366,
      0.1020408163265306,  0.24489795918367346,  0.4285714285714286,
      0.4285714285714286,  0.4285714285714286,   0.4285714285714286,
      0.4285714285714286,  0.326530612244898,    0.18367346938775508,
      0.24489795918367346, 0.5510204081632653,   0.9183673469387754,
      0.9183673469387754,  0.9183673469387754,   0.9183673469387754,
      0.9183673469387754,  0.673469387755102,    0.36734693877551017,
      0.44897959183673464, 0.9795918367346939,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.1428571428571428,   0.6122448979591837,
      0.44897959183673464, 0.9795918367346939,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.1428571428571428,   0.6122448979591837,
      0.44897959183673464, 0.9795918367346939,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.1428571428571428,   0.6122448979591837,
      0.44897959183673464, 0.9795918367346939,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.1428571428571428,   0.6122448979591837,
      0.4285714285714285,  0.9183673469387754,   1.469387755102041,
      1.469387755102041,   1.469387755102041,    1.469387755102041,
      1.469387755102041,   1.0408163265306123,   0.5510204081632653,
      0.346938775510204,   0.7346938775510203,   1.163265306122449,
      1.163265306122449,   1.163265306122449,    1.163265306122449,
      1.163265306122449,   0.8163265306122449,   0.42857142857142855,
      0.2040816326530612,  0.4285714285714285,   0.6734693877551019,
      0.6734693877551019,  0.6734693877551019,   0.6734693877551019,
      0.6734693877551019,  0.4693877551020408,   0.24489795918367346,
      0.26530612244897955, 0.5510204081632653,   0.857142857142857,
      0.857142857142857,   0.857142857142857,    0.857142857142857,
      0.857142857142857,   0.5918367346938775,   0.3061224489795918,
      0.5918367346938775,  1.2244897959183672,   1.897959183673469,
      1.897959183673469,   1.897959183673469,    1.897959183673469,
      1.897959183673469,   1.3061224489795917,   0.6734693877551019,
      0.9795918367346939,  2.020408163265306,    3.1224489795918364,
      3.1224489795918364,  3.1224489795918364,   3.1224489795918364,
      3.1224489795918364,  2.142857142857143,    1.1020408163265305,
      1.4285714285714284,  2.9387755102040813,   4.530612244897958,
      4.530612244897958,   4.530612244897958,    4.530612244897958,
      4.530612244897958,   3.1020408163265305,   1.5918367346938775,
      1.4285714285714284,  2.9387755102040813,   4.530612244897958,
      4.530612244897958,   4.530612244897958,    4.530612244897958,
      4.530612244897958,   3.1020408163265305,   1.5918367346938775,
      1.4285714285714284,  2.9387755102040813,   4.530612244897958,
      4.530612244897958,   4.530612244897958,    4.530612244897958,
      4.530612244897958,   3.1020408163265305,   1.5918367346938775,
      1.4285714285714284,  2.9387755102040813,   4.530612244897958,
      4.530612244897958,   4.530612244897958,    4.530612244897958,
      4.530612244897958,   3.1020408163265305,   1.5918367346938775,
      1.1632653061224487,  2.387755102040816,    3.673469387755102,
      3.673469387755102,   3.673469387755102,    3.673469387755102,
      3.673469387755102,   2.510204081632653,    1.2857142857142856,
      0.836734693877551,   1.714285714285714,    2.63265306122449,
      2.63265306122449,    2.63265306122449,     2.63265306122449,
      2.63265306122449,    1.7959183673469385,   0.9183673469387754,
      0.44897959183673464, 0.9183673469387754,   1.4081632653061225,
      1.4081632653061225,  1.4081632653061225,   1.4081632653061225,
      1.4081632653061225,  0.9591836734693877,   0.4897959183673469,
      0.5102040816326531,  1.0408163265306123,   1.5918367346938775,
      1.5918367346938775,  1.5918367346938775,   1.5918367346938775,
      1.5918367346938775,  1.0816326530612244,   0.5510204081632653,
      1.0816326530612246,  2.204081632653061,    3.36734693877551,
      3.36734693877551,    3.36734693877551,     3.36734693877551,
      3.36734693877551,    2.2857142857142856,   1.1632653061224487,
      1.7142857142857144,  3.4897959183673466,   5.326530612244897,
      5.326530612244897,   5.326530612244897,    5.326530612244897,
      5.326530612244897,   3.6122448979591835,   1.8367346938775508,
      2.4081632653061225,  4.8979591836734695,   7.469387755102041,
      7.469387755102041,   7.469387755102041,    7.469387755102041,
      7.469387755102041,   5.061224489795918,    2.571428571428571,
      2.4081632653061225,  4.8979591836734695,   7.469387755102041,
      7.469387755102041,   7.469387755102041,    7.469387755102041,
      7.469387755102041,   5.061224489795918,    2.571428571428571,
      2.4081632653061225,  4.8979591836734695,   7.469387755102041,
      7.469387755102041,   7.469387755102041,    7.469387755102041,
      7.469387755102041,   5.061224489795918,    2.571428571428571,
      2.4081632653061225,  4.8979591836734695,   7.469387755102041,
      7.469387755102041,   7.469387755102041,    7.469387755102041,
      7.469387755102041,   5.061224489795918,    2.571428571428571,
      1.897959183673469,   3.8571428571428568,   5.877551020408164,
      5.877551020408164,   5.877551020408164,    5.877551020408164,
      5.877551020408164,   3.979591836734693,    2.020408163265306,
      1.3265306122448979,  2.6938775510204076,   4.1020408163265305,
      4.1020408163265305,  4.1020408163265305,   4.1020408163265305,
      4.1020408163265305,  2.775510204081632,    1.4081632653061225,
      0.6938775510204082,  1.4081632653061225,   2.142857142857143,
      2.142857142857143,   2.142857142857143,    2.142857142857143,
      2.142857142857143,   1.4489795918367345,   0.7346938775510203};
  const std::array<int, 4> in_shape = {{3, 10, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.188667800453512, 15.765544217687074, 18.63866780045351,
      19.32404761904762,  22.3056746031746,   23.099557823129253,
      26.837023809523814, 27.75749433106576,  28.060000000000002,
      28.94249433106576,  31.697976190476187, 32.61844671201814,
      28.179325396825394, 28.97320861678005,  24.946332199546482,
      25.63171201814059,  21.496332199546483, 22.073208616780043,
      23.384246031746027, 24.069625850340135, 28.487307256235823,
      29.30159863945578,  33.84819160997732,  34.79139455782313,
      40.403350340136065, 41.49695011337869,  41.50489795918368,
      42.55337868480725,  46.17858843537415,  47.27218820861678,
      40.826604308390024, 41.769807256235836, 35.98136621315193,
      36.79565759637188,  30.878304988662126, 31.563684807256237,
      33.53288548752834,  34.32676870748299,  40.65635487528344,
      41.599557823129246, 48.078463718820856, 49.17098639455782,
      57.08600340136055,  58.35273242630385,  57.937551020408165,
      59.15201814058956,  63.77552721088435,  65.04225623582767,
      56.16163832199546,  57.254160997732434, 49.336808390022675,
      50.28001133786848,  42.21333900226756,  43.00722222222222,
      45.63458616780045,  46.53697278911565,  55.145810657596364,
      56.21792517006803,  64.9964909297052,   66.23833333333334,
      76.8849829931973,   78.32484126984126,  77.35795918367347,
      78.73841269841269,  84.4887925170068,   85.92865079365079,
      74.18442743764172,  75.42626984126984,  65.01265873015872,
      66.08477324263038,  55.5014342403628,   56.403820861678,
      61.36097505668933,  62.20006802721089,  73.76505668934239,
      74.76197278911565,  86.48478458049885,  87.63952380952381,
      101.69272108843538, 103.03158730158731, 100.8865306122449,
      102.17015873015873, 108.76319727891155, 110.10206349206351,
      95.02827664399092,  96.18301587301586,  82.93984126984125,
      83.93675736961451,  70.53575963718819,  71.37485260770974,
      80.50097505668933,  81.34006802721089,  96.50505668934238,
      97.50197278911565,  112.82478458049884, 113.97952380952381,
      132.23272108843534, 133.57158730158733, 130.16653061224488,
      131.45015873015873, 139.30319727891157, 140.6420634920635,
      121.36827664399091, 122.52301587301586, 105.67984126984125,
      106.6767573696145,  89.6757596371882,   90.51485260770974,
      106.92815759637188, 107.83054421768708, 127.96795351473921,
      129.04006802721088, 149.34720521541948, 150.58904761904765,
      174.68569727891153, 176.1255555555556,  171.12367346938774,
      172.50412698412705, 182.28950680272106, 183.72936507936512,
      158.535141723356,   159.77698412698413, 137.83480158730157,
      138.90691609977324, 116.79500566893424, 117.69739229024943,
      100.68564058956916, 101.47952380952381, 120.43972222222222,
      121.38292517006803, 140.49244331065756, 141.58496598639456,
      164.23569727891152, 165.50242630385492, 160.66653061224486,
      161.88099773242632, 170.92522108843534, 172.1919501133787,
      148.5756179138322,  149.66814058956916, 129.12017573696147,
      130.06337868480725, 109.3660941043084,  110.15997732426302,
      92.49006235827665,  93.17544217687075,  110.5910827664399,
      111.40537414965986, 128.94992630385485, 129.89312925170069,
      150.6693707482993,  151.76297052154197, 147.2216326530612,
      148.2701133786848,  156.4446088435374,  157.53820861678005,
      135.9283390022676,  136.87154195011337, 118.08514172335602,
      118.89943310657596, 99.98412131519275,  100.66950113378682,
      82.34142290249434,  82.9182993197279,   98.42203514739231,
      99.10741496598638,  114.71965419501134, 115.51353741496598,
      133.98671768707482, 134.90718820861676, 130.78897959183675,
      131.67147392290246, 138.84767006802724, 139.76814058956913,
      120.59330498866215, 121.38718820861676, 104.72969954648528,
      105.41507936507935, 88.6490873015873,   89.22596371882086,
      119.02642290249433, 119.60329931972787, 142.0070351473923,
      142.69241496598642, 165.20465419501133, 165.998537414966,
      192.52171768707484, 193.44218820861673, 186.90897959183673,
      187.79147392290247, 197.3826700680272,  198.30314058956913,
      171.07830498866213, 171.87218820861676, 148.31469954648526,
      149.00007936507936, 125.33408730158729, 125.91096371882084,
      146.7526133786848,  147.43799319727887, 175.05975623582765,
      175.87404761904764, 203.6247222222222,  204.56792517006804,
      237.2513095238095,  238.3449092970521,  230.23142857142855,
      231.27990929705211, 243.02654761904762, 244.1201473922902,
      210.60313492063491, 211.5463378684807,  182.55381519274377,
      183.3681065759637,  154.2466723356009,  154.932052154195,
      176.43186507936505, 177.2257482993197,  210.43288548752832,
      211.3760884353742,  244.7325453514739,  245.8250680272109,
      285.0972278911565,  286.36395691609977, 276.54163265306124,
      277.75609977324257, 291.78675170068027, 293.05348072562356,
      252.81571995464853, 253.90824263038544, 219.1133390022676,
      220.05654195011337, 185.1123185941043,  185.90620181405893,
      208.06417800453514, 208.9665646258503,  248.1264229024943,
      249.19853741496604, 288.5281235827664,  289.76996598639454,
      336.0594727891156,  337.4993310657596,  325.83959183673466,
      327.22004535147386, 343.66328231292516, 345.10314058956914,
      297.71606009070297, 298.95790249433105, 257.9932709750567,
      259.0653854875283,  217.93102607709747, 218.83341269841264,
      212.39770975056692, 213.23680272108845, 253.2099546485261,
      254.20687074829934, 294.33784580498866, 295.4925850340136,
      342.6886394557823,  344.0275056689342,  331.9395918367347,
      333.2232199546486,  349.75911564625846, 351.0979818594105,
      302.8813378684806,  304.03607709750565, 262.3847392290249,
      263.38165532879816, 221.5724943310657,  222.41158730158728,
      231.5377097505669,  232.37680272108844, 275.9499546485261,
      276.9468707482993,  320.67784580498864, 321.8325850340137,
      373.2286394557823,  374.5675056689343,  361.21959183673465,
      362.50321995464856, 380.29911564625843, 381.63798185941044,
      329.2213378684807,  330.37607709750563, 285.1247392290249,
      286.12165532879817, 240.71249433106576, 241.55158730158723,
      269.3577494331066,  270.2601360544218,  320.9485657596372,
      322.0206802721089,  372.8788378684807,  374.1206802721089,
      433.86018707482987, 435.3000453514739,  419.60530612244895,
      420.98575963718815, 441.4639965986394,  442.9038548752834,
      382.06677437641724, 383.3086167800453,  330.81541383219957,
      331.8875283446711,  279.22459750566895, 280.1269841269841,
      243.58462018140594, 244.37850340136058, 290.2162528344671,
      291.15945578231293, 337.1465249433106,  338.23904761904765,
      392.24692176870747, 393.51365079365087, 379.27061224489796,
      380.48507936507934, 398.9364455782313,  400.2031746031746,
      345.2296995464853,  346.3222222222222,  298.8967063492064,
      299.8399092970521,  252.26507369614515, 253.0589569160998,
      215.85842970521543, 216.54380952380953, 257.16353174603177,
      257.9778231292517,  298.7264569160997,  299.66965986394564,
      347.5173299319728,  348.6109297052154,  335.9481632653061,
      336.99664399092967, 353.2925680272109,  354.38616780045345,
      305.7048696145125,  306.6480725623582,  264.6575907029478,
      265.4718820861678,  223.35248866213152, 224.03786848072562,
      186.17917800453515, 186.75605442176874, 221.79040249433106,
      222.4757823129252,  257.6186337868481,  258.4125170068028,
      299.6714115646258,  300.5918820861678,  289.6379591836735,
      290.52045351473924, 304.53236394557825, 305.4528344671201,
      263.4922845804989,  264.28616780045354, 228.09806689342403,
      228.78344671201816, 192.4868424036281,  193.06371882086168,
      222.86417800453518, 223.4410544217687,  265.37540249433107,
      266.0607823129252,  308.1036337868481,  308.89751700680273,
      358.2064115646259,  359.1268820861678,  345.75795918367345,
      346.64045351473925, 363.0673639455782,  363.9878344671202,
      313.977284580499,   314.77116780045355, 271.68306689342404,
      272.3684467120181,  229.17184240362812, 229.74871882086168,
      270.1209807256236,  270.8063605442177,  321.63220521541956,
      322.4464965986395,  373.4012528344672,  374.34445578231293,
      434.0992687074831,  435.1928684807256,  418.95795918367344,
      420.00643990929706, 439.87450680272104, 440.9681065759637,
      380.37966553287987, 381.3228684807256,  329.12626417233554,
      329.9405555555555,  277.61503968253965, 278.3004195011338,
      319.33084467120176, 320.12472789115645, 380.2094160997732,
      381.1526190476191,  441.38662698412696, 442.479149659864,
      513.1084523809524,  514.3751814058958,  495.1457142857142,
      496.3601814058957,  519.7979761904761,  521.0647052154194,
      449.4698015873016,  450.56232426303853, 388.8898696145124,
      389.8330725623582,  328.01129818594103, 328.80518140589567,
      370.4937698412698,  371.396156462585,   441.10703514739225,
      442.179149659864,   512.0597562358276,  513.3015986394558,
      595.2339625850341,  596.6738208616781,  574.3212244897958,
      575.7016780045352,  602.8377721088434,  604.2776303854874,
      521.2476927437642,  522.4895351473923,  450.9738832199546,
      452.0459977324262,  380.3606179138322,  381.26300453514733,
      363.4344444444446,  364.2735374149659,  432.65485260770976,
      433.6517687074829,  502.1909070294784,  503.3456462585033,
      583.6845578231292,  585.0234240362812,  562.9926530612245,
      564.2762811791383,  590.7550340136055,  592.0939002267573,
      510.7343990929704,  511.8891383219954,  441.82963718820855,
      442.8265532879817,  372.6092290249432,  373.44832199546477,
      382.5744444444445,  383.41353741496596, 455.39485260770977,
      456.3917687074829,  528.5309070294785,  529.6856462585033,
      614.2245578231291,  615.563424036281,   592.2726530612244,
      593.5562811791382,  621.2950340136053,  622.6339002267573,
      537.0743990929705,  538.2291383219954,  464.5696371882085,
      465.56655328798183, 391.74922902494325, 392.58832199546487,
      431.7873412698413,  432.6897278911565,  513.9291780045352,
      515.001292517007,   596.4104705215419,  597.65231292517,
      693.0346768707483,  694.4745351473922,  668.0869387755101,
      669.4673922902493,  700.6384863945577,  702.0783446712019,
      605.5984070294784,  606.8402494331066,  523.7960260770974,
      524.8681405895691,  441.65418934240364, 442.5565759637188,
      386.48359977324264, 387.27748299319734, 459.992783446712,
      460.93598639455786, 533.8006065759637,  534.8931292517007,
      620.2581462585034,  621.5248752834467,  597.874693877551,
      599.0891609977325,  626.947670068027,   628.2143990929707,
      541.8837811791384,  542.9763038548754,  468.6732369614513,
      469.616439909297,   395.1640532879819,  395.9579365079365,
      339.2267970521542,  339.9121768707483,  403.7359807256236,
      404.55027210884356, 468.50298752834465, 469.4461904761905,
      544.3652891156462,  545.458888888889,   524.674693877551,
      525.7231746031746,  550.1405272108844,  551.234126984127,
      475.48140022675744, 476.42460317460313, 411.2300396825397,
      412.0443310657596,  346.7208560090703,  347.4062358276643,
      290.016933106576,   290.59380952380957, 345.1587698412698,
      345.84414965986394, 400.51761337868476, 401.31149659863945,
      465.3561054421769,  466.2765759637188,  448.4869387755102,
      449.3694331065759,  470.21705782312927, 471.1375283446712,
      406.39126417233564, 407.1851473922902,  351.46643424036284,
      352.15181405895686, 296.3245975056689,  296.90147392290254};
  const std::array<int, 4> in_shape = {{3, 10, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.08163265306122448,
      0.12244897959183673, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.18367346938775508,
      0.24489795918367346, 0.18367346938775508, 0.24489795918367346,
      0.18367346938775508, 0.24489795918367346, 0.16326530612244897,
      0.20408163265306123, 0.1020408163265306,  0.12244897959183673,
      0.16326530612244897, 0.2040816326530612,  0.4081632653061224,
      0.4897959183673469,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.7346938775510203,
      0.8571428571428572,  0.7346938775510203,  0.8571428571428572,
      0.7346938775510203,  0.8571428571428572,  0.5714285714285714,
      0.653061224489796,   0.32653061224489793, 0.36734693877551017,
      0.4285714285714285,  0.4897959183673469,  0.9795918367346936,
      1.1020408163265305,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.6530612244897958,
      1.8367346938775508,  1.6530612244897958,  1.8367346938775508,
      1.6530612244897958,  1.8367346938775508,  1.2244897959183672,
      1.346938775510204,   0.673469387755102,   0.7346938775510203,
      0.8163265306122448,  0.8979591836734693,  1.7959183673469385,
      1.9591836734693877,  2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.1224489795918364,
      2.2857142857142856,  1.1428571428571428,  1.2244897959183674,
      0.8163265306122448,  0.8979591836734693,  1.7959183673469385,
      1.9591836734693877,  2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.1224489795918364,
      2.2857142857142856,  1.1428571428571428,  1.2244897959183674,
      0.8163265306122448,  0.8979591836734693,  1.7959183673469385,
      1.9591836734693877,  2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.1224489795918364,
      2.2857142857142856,  1.1428571428571428,  1.2244897959183674,
      0.8163265306122448,  0.8979591836734693,  1.7959183673469385,
      1.9591836734693877,  2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.938775510204081,
      3.183673469387755,   2.938775510204081,   3.183673469387755,
      2.938775510204081,   3.183673469387755,   2.1224489795918364,
      2.2857142857142856,  1.1428571428571428,  1.2244897959183674,
      0.7959183673469388,  0.857142857142857,   1.7142857142857142,
      1.8367346938775508,  2.7551020408163263,  2.938775510204082,
      2.7551020408163263,  2.938775510204082,   2.7551020408163263,
      2.938775510204082,   2.7551020408163263,  2.938775510204082,
      2.7551020408163263,  2.938775510204082,   1.9591836734693877,
      2.0816326530612246,  1.0408163265306123,  1.1020408163265305,
      0.6530612244897959,  0.693877551020408,   1.3877551020408163,
      1.4693877551020407,  2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   2.204081632653061,
      2.326530612244898,   2.204081632653061,   2.326530612244898,
      2.204081632653061,   2.326530612244898,   1.5510204081632653,
      1.6326530612244898,  0.8163265306122449,  0.8571428571428571,
      0.3877551020408163,  0.4081632653061224,  0.8163265306122449,
      0.857142857142857,   1.2857142857142856,  1.3469387755102038,
      1.2857142857142856,  1.3469387755102038,  1.2857142857142856,
      1.3469387755102038,  1.2857142857142856,  1.3469387755102038,
      1.2857142857142856,  1.3469387755102038,  0.8979591836734693,
      0.9387755102040816,  0.4693877551020408,  0.4897959183673469,
      0.5102040816326531,  0.5306122448979591,  1.0612244897959182,
      1.1020408163265305,  1.6530612244897958,  1.714285714285714,
      1.6530612244897958,  1.714285714285714,   1.6530612244897958,
      1.714285714285714,   1.6530612244897958,  1.714285714285714,
      1.6530612244897958,  1.714285714285714,   1.1428571428571428,
      1.183673469387755,   0.5918367346938775,  0.6122448979591836,
      1.1428571428571428,  1.183673469387755,   2.36734693877551,
      2.4489795918367343,  3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   3.6734693877551017,
      3.795918367346938,   3.6734693877551017,  3.795918367346938,
      3.6734693877551017,  3.795918367346938,   2.5306122448979593,
      2.6122448979591835,  1.3061224489795917,  1.3469387755102038,
      1.8979591836734693,  1.9591836734693877,  3.918367346938775,
      4.040816326530612,   6.061224489795918,   6.244897959183673,
      6.061224489795918,   6.244897959183673,   6.061224489795918,
      6.244897959183673,   6.061224489795918,   6.244897959183673,
      6.061224489795918,   6.244897959183673,   4.163265306122449,
      4.285714285714286,   2.142857142857143,   2.204081632653061,
      2.7755102040816326,  2.8571428571428568,  5.7142857142857135,
      5.877551020408163,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   6.040816326530612,
      6.204081632653061,   3.1020408163265305,  3.183673469387755,
      2.7755102040816326,  2.8571428571428568,  5.7142857142857135,
      5.877551020408163,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   6.040816326530612,
      6.204081632653061,   3.1020408163265305,  3.183673469387755,
      2.7755102040816326,  2.8571428571428568,  5.7142857142857135,
      5.877551020408163,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   6.040816326530612,
      6.204081632653061,   3.1020408163265305,  3.183673469387755,
      2.7755102040816326,  2.8571428571428568,  5.7142857142857135,
      5.877551020408163,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   8.816326530612244,
      9.061224489795917,   8.816326530612244,   9.061224489795917,
      8.816326530612244,   9.061224489795917,   6.040816326530612,
      6.204081632653061,   3.1020408163265305,  3.183673469387755,
      2.265306122448979,   2.3265306122448974,  4.653061224489795,
      4.775510204081632,   7.163265306122449,   7.346938775510204,
      7.163265306122449,   7.346938775510204,   7.163265306122449,
      7.346938775510204,   7.163265306122449,   7.346938775510204,
      7.163265306122449,   7.346938775510204,   4.897959183673469,
      5.020408163265306,   2.510204081632653,   2.571428571428571,
      1.6326530612244898,  1.673469387755102,   3.346938775510204,
      3.428571428571428,   5.142857142857142,   5.26530612244898,
      5.142857142857142,   5.26530612244898,    5.142857142857142,
      5.26530612244898,    5.142857142857142,   5.26530612244898,
      5.142857142857142,   5.26530612244898,    3.510204081632653,
      3.591836734693877,   1.7959183673469385,  1.8367346938775508,
      0.8775510204081632,  0.8979591836734693,  1.7959183673469385,
      1.8367346938775508,  2.7551020408163263,  2.816326530612245,
      2.7551020408163263,  2.816326530612245,   2.7551020408163263,
      2.816326530612245,   2.7551020408163263,  2.816326530612245,
      2.7551020408163263,  2.816326530612245,   1.8775510204081631,
      1.9183673469387754,  0.9591836734693877,  0.9795918367346939,
      0.9999999999999999,  1.0204081632653061,  2.040816326530612,
      2.0816326530612246,  3.1224489795918364,  3.183673469387755,
      3.1224489795918364,  3.183673469387755,   3.1224489795918364,
      3.183673469387755,   3.1224489795918364,  3.183673469387755,
      3.1224489795918364,  3.183673469387755,   2.1224489795918364,
      2.1632653061224487,  1.0816326530612244,  1.1020408163265305,
      2.1224489795918364,  2.163265306122449,   4.326530612244897,
      4.408163265306122,   6.612244897959183,   6.73469387755102,
      6.612244897959183,   6.73469387755102,    6.612244897959183,
      6.73469387755102,    6.612244897959183,   6.73469387755102,
      6.612244897959183,   6.73469387755102,    4.489795918367347,
      4.571428571428571,   2.2857142857142856,  2.3265306122448974,
      3.3673469387755097,  3.428571428571429,   6.857142857142857,
      6.979591836734693,   10.46938775510204,   10.653061224489795,
      10.46938775510204,   10.653061224489795,  10.46938775510204,
      10.653061224489795,  10.46938775510204,   10.653061224489795,
      10.46938775510204,   10.653061224489795,  7.1020408163265305,
      7.224489795918367,   3.6122448979591835,  3.6734693877551017,
      4.73469387755102,    4.816326530612245,   9.632653061224488,
      9.795918367346939,   14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  9.959183673469386,
      10.122448979591836,  5.061224489795918,   5.142857142857142,
      4.73469387755102,    4.816326530612245,   9.632653061224488,
      9.795918367346939,   14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  9.959183673469386,
      10.122448979591836,  5.061224489795918,   5.142857142857142,
      4.73469387755102,    4.816326530612245,   9.632653061224488,
      9.795918367346939,   14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  9.959183673469386,
      10.122448979591836,  5.061224489795918,   5.142857142857142,
      4.73469387755102,    4.816326530612245,   9.632653061224488,
      9.795918367346939,   14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  14.693877551020407,
      14.938775510204081,  14.693877551020407,  14.938775510204081,
      14.693877551020407,  14.938775510204081,  9.959183673469386,
      10.122448979591836,  5.061224489795918,   5.142857142857142,
      3.7346938775510203,  3.795918367346938,   7.591836734693876,
      7.7142857142857135,  11.57142857142857,   11.755102040816327,
      11.57142857142857,   11.755102040816327,  11.57142857142857,
      11.755102040816327,  11.57142857142857,   11.755102040816327,
      11.57142857142857,   11.755102040816327,  7.83673469387755,
      7.959183673469386,   3.979591836734694,   4.040816326530612,
      2.6122448979591835,  2.6530612244897958,  5.3061224489795915,
      5.387755102040815,   8.081632653061224,   8.204081632653061,
      8.081632653061224,   8.204081632653061,   8.081632653061224,
      8.204081632653061,   8.081632653061224,   8.204081632653061,
      8.081632653061224,   8.204081632653061,   5.469387755102041,
      5.551020408163264,   2.775510204081632,   2.816326530612245,
      1.3673469387755102,  1.3877551020408163,  2.775510204081632,
      2.816326530612245,   4.224489795918367,   4.285714285714286,
      4.224489795918367,   4.285714285714286,   4.224489795918367,
      4.285714285714286,   4.224489795918367,   4.285714285714286,
      4.224489795918367,   4.285714285714286,   2.8571428571428568,
      2.897959183673469,   1.4489795918367345,  1.4693877551020407};
  const std::array<int, 4> in_shape = {{3, 10, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.800459183673464, 30.377335600907024, 30.954212018140588,
      31.531088435374148, 36.59195578231292,  37.27733560090702,
      37.96271541950113,  38.64809523809524,  43.81746598639456,
      44.6113492063492,   45.405232426303854, 46.199115646258505,
      52.75357709750567,  53.67404761904763,  54.594518140589564,
      55.51498866213152,  55.23750566893423,  56.120000000000005,
      57.00249433106575,  57.88498866213152,  62.47548185941042,
      63.39595238095237,  64.31642290249434,  65.23689342403628,
      55.56476757369614,  56.35865079365079,  57.15253401360544,
      57.9464172335601,   49.20728458049886,  49.892664399092965,
      50.57804421768707,  51.26342403628118,  42.4157879818594,
      42.992664399092966, 43.56954081632652,  44.146417233560086,
      46.08311224489796,  46.768492063492054, 47.45387188208617,
      48.13925170068027,  56.1603231292517,   56.974614512471646,
      57.788905895691606, 58.60319727891156,  66.75318027210885,
      67.69638321995464,  68.63958616780045,  69.58278911564626,
      79.71310090702949,  80.80670068027213,  81.90030045351473,
      82.99390022675738,  81.96131519274377,  83.00979591836736,
      84.05827664399091,  85.1067573696145,   91.26357709750566,
      92.3571768707483,   93.45077664399092,  94.54437641723356,
      80.71000566893422,  81.65320861678005,  82.59641156462584,
      83.53961451247167,  71.14844104308389,  71.96273242630386,
      72.7770238095238,   73.59131519274376,  61.07123015873015,
      61.75660997732425,  62.44198979591836,  63.127369614512475,
      66.27188775510204,  67.06577097505668,  67.85965419501134,
      68.65353741496598,  80.36950680272109,  81.31270975056688,
      82.2559126984127,   83.19911564625849,  95.06440476190477,
      96.15692743764171,  97.24945011337869,  98.34197278911564,
      112.90527777777778, 114.1720068027211,  115.4387358276644,
      116.7054648526077,  114.66063492063493, 115.87510204081633,
      117.08956916099771, 118.30403628117912, 126.2843253968254,
      127.5510544217687,  128.817783446712,   130.08451247165533,
      111.23075396825395, 112.32327664399092, 113.41579931972788,
      114.50832199546487, 97.73041383219955,  98.67361678004535,
      99.61681972789114,  100.56002267573696, 83.6327947845805,
      84.42667800453512,  85.22056122448978,  86.01444444444444,
      90.36678571428573,  91.2691723356009,   92.17155895691609,
      93.0739455782313,   109.2195068027211,  110.29162131519273,
      111.36373582766439, 112.43585034013606, 128.75113945578232,
      129.9929818594104,  131.23482426303855, 132.4766666666667,
      152.33010770975056, 153.7699659863946,  155.20982426303854,
      156.64968253968252, 153.33546485260774, 154.71591836734694,
      156.09637188208612, 157.47682539682538, 167.5377267573696,
      168.9775850340136,  170.41744331065757, 171.85730158730158,
      147.1270124716553,  148.36885487528343, 149.61069727891154,
      150.85253968253969, 128.9532029478458,  130.02531746031744,
      131.0974319727891,  132.16954648526075, 110.10048185941042,
      111.0028684807256,  111.90525510204081, 112.807641723356,
      121.88285714285716, 122.72195011337865, 123.5610430839002,
      124.40013605442178, 146.53319727891156, 147.53011337868477,
      148.52702947845805, 149.5239455782313,  171.81482993197278,
      172.9695691609977,  174.12430839002266, 175.27904761904762,
      202.0465759637188,  203.38544217687075, 204.72430839002266,
      206.06317460317462, 200.489433106576,   201.7730612244898,
      203.0566893424036,  204.34031746031746, 216.18752834467122,
      217.5263945578231,  218.86526077097506, 220.20412698412702,
      188.90181405895692, 190.05655328798184, 191.21129251700683,
      192.36603174603172, 164.88276643990932, 165.8796825396825,
      166.87659863945578, 167.87351473922902, 140.23242630385488,
      141.07151927437639, 141.91061224489798, 142.74970521541948,
      160.16285714285715, 161.00195011337865, 161.84104308390022,
      162.68013605442178, 192.01319727891155, 193.01011337868476,
      194.00702947845804, 195.0039455782313,  224.4948299319728,
      225.6495691609977,  226.80430839002264, 227.95904761904762,
      263.1265759637188,  264.4654421768707,  265.80430839002264,
      267.14317460317466, 259.049433106576,   260.33306122448977,
      261.61668934240356, 262.90031746031747, 277.2675283446712,
      278.60639455782314, 279.945260770975,   281.284126984127,
      241.58181405895695, 242.73655328798182, 243.8912925170068,
      245.04603174603173, 210.36276643990934, 211.3596825396825,
      212.35659863945583, 213.353514739229,   178.51242630385488,
      179.3515192743764,  180.19061224489795, 181.02970521541948,
      212.95392857142858, 213.85631519274375, 214.75870181405898,
      215.66108843537415, 254.86379251700677, 255.93590702947841,
      257.00802154195014, 258.08013605442176, 297.4525680272108,
      298.69441043083896, 299.9362528344671,  301.1780952380953,
      347.93153628117915, 349.37139455782307, 350.8112528344671,
      352.2511111111112,  340.8668934240363,  342.2473469387755,
      343.6278004535147,  345.0082539682541,  363.1391553287982,
      364.5790136054421,  366.0188718820861,  367.45873015873025,
      315.8284410430839,  317.070283446712,   318.3121258503401,
      319.55396825396826, 274.5974886621315,  275.66960317460314,
      276.7417176870748,  277.8138321995465,  232.6876247165533,
      233.59001133786848, 234.49239795918365, 235.39478458049885,
      200.57739795918366, 201.37128117913832, 202.16516439909296,
      202.95904761904762, 239.93624149659863, 240.87944444444443,
      241.82264739229026, 242.76585034013607, 279.89236394557815,
      280.9848866213151,  282.0774092970522,  283.16993197278913,
      327.2046655328798,  328.47139455782303, 329.73812358276643,
      331.00485260770984, 320.1185941043084,  321.3330612244897,
      322.5475283446712,  323.76199546485265, 340.58371315192744,
      341.8504421768707,  343.1171712018141,  344.3839002267574,
      296.0587131519274,  297.1512358276644,  298.2437585034013,
      299.3362811791383,  257.2971485260771,  258.24035147392294,
      259.1835544217687,  260.1267573696145,  217.93830498866214,
      218.7321882086168,  219.5260714285714,  220.31995464852605,
      184.29474489795916, 184.9801247165533,  185.66550453514742,
      186.3508843537415,  220.36787414965983, 221.1821655328798,
      221.9964569160998,  222.81074829931973, 256.9566496598639,
      257.8998526077097,  258.8430555555556,  259.78625850340137,
      300.245141723356,   301.3387414965986,  302.43234126984134,
      303.52594104308395, 293.3947845804988,  294.4432653061224,
      295.49174603174606, 296.5402267573696,  311.7956179138322,
      312.8892176870748,  313.98281746031745, 315.0764172335601,
      270.9134750566893,  271.8566780045352,  272.79988095238093,
      273.74308390022674, 235.35599206349207, 236.17028344671203,
      236.98457482993197, 237.7988662131519,  199.2828628117914,
      199.9682426303855,  200.65362244897958, 201.33900226757365,
      164.1059693877551,  164.6828458049887,  165.25972222222225,
      165.8365986394558,  196.15869047619043, 196.84407029478461,
      197.5294501133787,  198.21482993197276, 228.645425170068,
      229.4393083900227,  230.23319160997735, 231.02707482993196,
      267.05296485260766, 267.97343537414963, 268.89390589569166,
      269.8143764172335,  260.69546485260764, 261.5779591836735,
      262.46045351473924, 263.34294784580493, 276.77486961451245,
      277.6953401360545,  278.6158106575964,  279.53628117913826,
      240.39272675736962, 241.1866099773243,  241.98049319727892,
      242.77437641723353, 208.77401927437643, 209.45939909297056,
      210.14477891156463, 210.8301587301587,  176.72129818594104,
      177.2981746031746,  177.87505102040816, 178.45192743764173,
      237.47596938775507, 238.05284580498866, 238.62972222222223,
      239.20659863945573, 283.32869047619045, 284.0140702947846,
      284.69945011337865, 285.38482993197283, 329.615425170068,
      330.40930839002266, 331.20319160997724, 331.997074829932,
      384.1229648526077,  385.0434353741497,  385.96390589569154,
      386.88437641723345, 372.9354648526077,  373.81795918367345,
      374.7004535147392,  375.58294784580494, 393.84486961451245,
      394.7653401360544,  395.68581065759633, 396.60628117913825,
      341.36272675736967, 342.15660997732425, 342.95049319727894,
      343.7443764172335,  295.9440192743764,  296.6293990929705,
      297.31477891156464, 298.0001587301587,  250.09129818594104,
      250.66817460317458, 251.2450510204082,  251.82192743764168,
      292.81984693877547, 293.5052267573696,  294.1906065759637,
      294.87598639455774, 349.30522108843536, 350.1195124716553,
      350.93380385487524, 351.7480952380953,  406.30624149659866,
      407.2494444444444,  408.19264739229016, 409.1358503401361,
      473.4090192743764,  474.502619047619,   475.5962188208616,
      476.6898185941042,  459.4143764172336,  460.4628571428571,
      461.5113378684807,  462.55981859410423, 484.9594954648526,
      486.05309523809524, 487.14669501133784, 488.2402947845804,
      420.26306689342414, 421.20626984126983, 422.1494727891157,
      423.0926757369614,  364.29333900226754, 365.10763038548754,
      365.92192176870753, 366.7362131519274,  307.8079648526077,
      308.4933446712018,  309.17872448979597, 309.86410430839,
      352.0698469387754,  352.8637301587301,  353.6576133786848,
      354.4514965986394,  419.9225680272108,  420.86577097505665,
      421.80897392290245, 422.7521768707484,  488.37256802721083,
      489.4650907029478,  490.5576133786847,  491.6501360544218,
      568.9277267573697,  570.194455782313,   571.4611848072562,
      572.7279138321995,  551.868798185941,   553.0832653061225,
      554.2977324263038,  555.5121995464851,  582.3067743764171,
      583.5735034013605,  584.8402324263038,  586.1069614512471,
      504.5389172335602,  505.63143990929706, 506.72396258503403,
      507.8164852607709,  437.2834750566893,  438.2266780045352,
      439.169880952381,   440.11308390022674, 369.430753968254,
      370.2246371882086,  371.0185204081633,  371.81240362811786,
      415.225969387755,   416.1283560090703,  417.0307426303855,
      417.9331292517006,  495.1807312925169,  496.2528458049886,
      497.3249603174603,  498.3970748299321,  575.8144047619046,
      577.0562471655328,  578.2980895691609,  579.5399319727891,
      670.6790873015874,  672.1189455782312,  673.5588038548752,
      674.9986621315192,  650.2987301587302,  651.6791836734693,
      653.0596371882085,  654.4400907029477,  685.8867063492063,
      687.3265646258503,  688.7664229024942,  690.2062811791383,
      594.190277777778,   595.4321201814059,  596.673962585034,
      597.9158049886621,  514.9144274376417,  515.9865419501134,
      517.0586564625851,  518.1307709750566,  434.95966553287985,
      435.86205215419494, 436.7644387755102,  437.6668253968253,
      423.95632653061216, 424.79541950113384, 425.6345124716553,
      426.4736054421769,  505.42299319727874, 506.4199092970522,
      507.4168253968254,  508.4137414965987,  587.5209523809523,
      588.6756916099773,  589.8304308390022,  590.9851700680272,
      684.0384126984127,  685.3772789115646,  686.7161451247165,
      688.0550113378685,  662.5955555555557,  663.8791836734694,
      665.1628117913832,  666.4464399092972,  698.1793650793653,
      699.5182312925169,  700.8570975056689,  702.195963718821,
      604.6079365079365,  605.7626757369612,  606.9174149659864,
      608.0721541950113,  523.7725623582767,  524.7694784580498,
      525.7663945578231,  526.7633106575963,  442.30589569161,
      443.1449886621314,  443.98408163265293, 444.82317460317455,
      462.23632653061225, 463.0754195011338,  463.91451247165526,
      464.7536054421769,  550.9029931972789,  551.8999092970522,
      552.8968253968254,  553.8937414965986,  640.2009523809523,
      641.3556916099773,  642.5104308390022,  643.6651700680274,
      745.1184126984126,  746.4572789115646,  747.7961451247166,
      749.1350113378686,  721.1555555555556,  722.4391836734693,
      723.7228117913832,  725.0064399092971,  759.259365079365,
      760.5982312925169,  761.9370975056688,  763.2759637188209,
      657.2879365079365,  658.4426757369614,  659.5974149659863,
      660.7521541950113,  569.2525623582766,  570.2494784580498,
      571.246394557823,   572.2433106575963,  480.58589569160995,
      481.4249886621315,  482.26408163265296, 483.10317460317447,
      537.8131122448979,  538.7154988662132,  539.6178854875283,
      540.5202721088436,  640.8250170068028,  641.8971315192744,
      642.969246031746,   644.0413605442178,  744.5158333333335,
      745.7576757369613,  746.9995181405894,  748.2413605442179,
      866.2805158730159,  867.7203741496597,  869.1602324263039,
      870.6000907029478,  837.8301587301588,  839.2106122448979,
      840.591065759637,   841.9715192743763,  881.4881349206348,
      882.9279931972789,  884.3678514739228,  885.8077097505668,
      762.8917063492063,  764.1335487528345,  765.3753911564625,
      766.6172335600907,  660.5587131519275,  661.6308276643991,
      662.7029421768707,  663.7750566893423,  557.5468083900226,
      558.4491950113379,  559.351581632653,   560.2539682539682,
      486.3753571428571,  487.1692403628119,  487.9631235827664,
      488.75700680272115, 579.4893027210884,  580.4325056689343,
      581.37570861678,    582.3189115646259,  673.2005272108843,
      674.2930498866212,  675.3855725623582,  676.4780952380953,
      783.2271145124716,  784.4938435374149,  785.7605725623581,
      787.0273015873017,  757.3267573696145,  758.5412244897959,
      759.7556916099772,  760.9701587301587,  796.6061621315192,
      797.8728911564626,  799.1396201814057,  800.4063492063492,
      689.3668764172336,  690.4593990929706,  691.5519217687074,
      692.6444444444444,  596.8502097505668,  597.7934126984128,
      598.7366156462585,  599.6798185941042,  503.73626417233555,
      504.5301473922903,  505.32403061224494, 506.1179138321996,
      431.0314795918367,  431.71685941043086, 432.4022392290249,
      433.08761904761906, 513.5127721088436,  514.3270634920635,
      515.1413548752834,  515.9556462585034,  596.5097108843536,
      597.4529138321994,  598.3961167800453,  599.3393197278913,
      693.9410600907029,  695.0346598639456,  696.1282596371882,
      697.2218594104309,  670.8478458049885,  671.8963265306122,
      672.9448072562358,  673.9932879818593,  705.491536281179,
      706.5851360544218,  707.6787358276644,  708.7723356009069,
      610.4665362811792,  611.409739229025,   612.3529421768707,
      613.2961451247164,  528.5008900226758,  529.3151814058956,
      530.1294727891157,  530.9437641723356,  446.01959750566897,
      446.70497732426304, 447.39035714285717, 448.07573696145124,
      371.7814795918367,  372.3583560090703,  372.93523242630386,
      373.5121088435375,  442.89542517006805, 443.5808049886621,
      444.2661848072562,  444.9515646258504,  514.4433843537415,
      515.2372675736962,  516.0311507936508,  516.8250340136055,
      598.4223526077097,  599.3428231292517,  600.2632936507936,
      601.1837641723356,  578.3934240362811,  579.275918367347,
      580.1584126984127,  581.0409070294785,  608.1442573696145,
      609.0647278911565,  609.9851984126984,  610.9056689342402,
      526.1906859410431,  526.9845691609978,  527.7784523809523,
      528.5723356009071,  455.510753968254,   456.19613378684807,
      456.88151360544214, 457.5668934240363,  384.39680839002267,
      384.9736848072562,  385.5505612244898,  386.12743764172336,
      445.15147959183673, 445.72835600907035, 446.30523242630386,
      446.8821088435374,  530.065425170068,   530.7508049886621,
      531.4361848072563,  532.1215646258504,  615.4133843537414,
      616.2072675736962,  617.0011507936508,  617.7950340136055,
      715.4923526077098,  716.4128231292518,  717.3332936507938,
      718.2537641723357,  690.6334240362811,  691.5159183673469,
      692.3984126984127,  693.2809070294785,  725.2142573696145,
      726.1347278911564,  727.0551984126985,  727.9756689342404,
      627.1606859410431,  627.954569160998,   628.7484523809525,
      629.5423356009071,  542.6807539682538,  543.3661337868481,
      544.0515136054421,  544.7368934240362,  457.7668083900226,
      458.34368480725624, 458.92056122448975, 459.49743764172337,
      539.5565816326531,  540.2419614512472,  540.9273412698413,
      541.6127210884354,  642.4501190476191,  643.2644104308391,
      644.078701814059,   644.892993197279,   745.8593027210884,
      746.8025056689344,  747.74570861678,    748.6889115646259,
      867.1049376417234,  868.1985374149662,  869.2921371882087,
      870.3857369614512,  836.8674376417233,  837.9159183673469,
      838.9643990929704,  840.0128798185941,  878.6554138321997,
      879.7490136054421,  880.8426133786849,  881.9362131519274,
      759.8161281179139,  760.7593310657597,  761.7025340136055,
      762.6457369614512,  657.4382369614511,  658.2525283446711,
      659.066819727891,   659.881111111111,   554.5446995464853,
      555.2300793650793,  555.9154591836734,  556.6008390022675,
      637.867806122449,   638.6616893424035,  639.4555725623583,
      640.2494557823129,  759.4756292517006,  760.4188321995464,
      761.3620351473921,  762.3052380952382,  881.680731292517,
      882.7732539682539,  883.8657766439908,  884.958299319728,
      1024.9501757369615, 1026.2169047619047, 1027.4836337868483,
      1028.7503628117915, 989.076961451247,   990.2914285714284,
      991.5058956916098,  992.7203628117913,  1038.3292233560092,
      1039.5959523809522, 1040.8626814058957, 1042.1294104308388,
      897.8470804988661,  898.9396031746032,  900.0321258503402,
      901.1246485260771,  776.836536281179,   777.7797392290248,
      778.7229421768707,  779.6661451247164,  655.2287131519274,
      656.0225963718821,  656.8164795918367,  657.6103628117913,
      740.0851530612244,  740.9875396825396,  741.889926303855,
      742.79231292517,    881.1419557823128,  882.2140702947845,
      883.2861848072562,  884.358299319728,   1022.8776700680271,
      1024.1195124716553, 1025.3613548752835, 1026.6031972789117,
      1189.028066893424,  1190.4679251700682, 1191.9077834467118,
      1193.3476417233562, 1147.2619954648524, 1148.6424489795916,
      1150.0229024943308, 1151.4033560090704, 1204.2356859410431,
      1205.6755442176868, 1207.1154024943307, 1208.5552607709749,
      1041.2535430839002, 1042.4953854875284, 1043.7372278911564,
      1044.9790702947846, 900.8756519274375,  901.9477664399092,
      903.0198809523808,  904.0919954648524,  759.8188492063492,
      760.7212358276644,  761.6236224489795,  762.5260090702947,
      726.0297959183674,  726.8688888888892,  727.7079818594106,
      728.5470748299318,  864.3127891156462,  865.3097052154195,
      866.3066213151928,  867.3035374149658,  1003.2270748299318,
      1004.3818140589568, 1005.5365532879817, 1006.6912925170066,
      1166.0302494331063, 1167.3691156462585, 1168.7079818594104,
      1170.0468480725624, 1124.7016780045349, 1125.985306122449,
      1127.2689342403628, 1128.5525623582766, 1180.1712018140586,
      1181.510068027211,  1182.8489342403625, 1184.1878004535147,
      1020.3140589569161, 1021.4687981859408, 1022.6235374149659,
      1023.7782766439908, 882.6623582766439,  883.6592743764171,
      884.6561904761902,  885.6531065759634,  744.3793650793651,
      745.2184580498864,  746.057551020408,   746.8966439909295,
      764.3097959183675,  765.148888888889,   765.9879818594104,
      766.8270748299319,  909.7927891156464,  910.7897052154195,
      911.7866213151927,  912.7835374149658,  1055.907074829932,
      1057.061814058957,  1058.2165532879817, 1059.3712925170066,
      1227.1102494331064, 1228.4491156462582, 1229.7879818594104,
      1231.126848072562,  1183.261678004535,  1184.545306122449,
      1185.8289342403627, 1187.1125623582764, 1241.251201814059,
      1242.5900680272107, 1243.9289342403627, 1245.2678004535146,
      1072.9940589569162, 1074.148798185941,  1075.3035374149658,
      1076.4582766439908, 928.1423582766439,  929.139274376417,
      930.1361904761901,  931.1331065759637,  782.6593650793649,
      783.4984580498865,  784.3375510204081,  785.1766439909297,
      862.6722959183674,  863.5746825396826,  864.4770691609976,
      865.379455782313,   1026.7862414965987, 1027.8583560090703,
      1028.930470521542,  1030.002585034014,  1191.5790986394554,
      1192.8209410430838, 1194.0627834467118, 1195.30462585034,
      1384.6294954648527, 1386.0693537414966, 1387.5092120181405,
      1388.9490702947844, 1334.7934240362813, 1336.1738775510203,
      1337.5543310657595, 1338.9347845804987, 1399.8371145124715,
      1401.2769727891155, 1402.7168310657596, 1404.1566893424038,
      1209.9549716553288, 1211.1968140589568, 1212.4386564625847,
      1213.6804988662132, 1046.5199376417231, 1047.5920521541948,
      1048.6641666666667, 1049.7362811791381, 882.4059920634919,
      883.3083786848073,  884.2107653061224,  885.1131519274376,
      772.1733163265307,  772.9671995464853,  773.7610827664398,
      774.5549659863947,  919.0423639455782,  919.985566893424,
      920.9287698412697,  921.8719727891157,  1066.5086904761904,
      1067.6012131519274, 1068.6937358276643, 1069.7862585034013,
      1239.2495634920633, 1240.5162925170068, 1241.78302154195,
      1243.0497505668934, 1194.5349206349206, 1195.749387755102,
      1196.9638548752835, 1198.178321995465,  1252.628611111111,
      1253.895340136054,  1255.1620691609976, 1256.4287981859413,
      1082.6750396825396, 1083.7675623582768, 1084.8600850340135,
      1085.9526077097507, 936.4032709750566,  937.3464739229026,
      938.2896768707483,  939.232879818594,   789.534223356009,
      790.3281065759638,  791.1219897959184,  791.915873015873,
      677.7682142857143,  678.4535941043084,  679.1389739229024,
      679.8243537414966,  806.6576700680272,  807.4719614512472,
      808.286252834467,   809.1005442176871,  936.0627721088437,
      937.0059750566893,  937.9491780045352,  938.892380952381,
      1087.63697845805,   1088.7305782312924, 1089.8241780045348,
      1090.917777777778,  1048.3009070294784, 1049.349387755102,
      1050.3978684807257, 1051.4463492063492, 1099.187454648526,
      1100.2810544217689, 1101.3746541950113, 1102.468253968254,
      950.0195975056688,  950.9628004535149,  951.9060034013604,
      952.8492063492063,  821.6457879818594,  822.4600793650794,
      823.2743707482992,  824.0886621315192,  692.7563321995465,
      693.4417120181406,  694.1270918367347,  694.8124716553286,
      579.4569897959184,  580.033866213152,   580.6107426303854,
      581.1876190476191,  689.6321598639456,  690.3175396825396,
      691.0029195011338,  691.6882993197279,  800.241343537415,
      801.0352267573695,  801.8291099773243,  802.6229931972789,
      929.7917403628118,  930.7122108843538,  931.6326814058956,
      932.5531519274376,  896.0913832199547,  896.9738775510205,
      897.8563718820861,  898.7388662131518,  939.5136451247164,
      940.4341156462585,  941.3545861678003,  942.2750566893424,
      811.9886451247165,  812.7825283446713,  813.5764115646258,
      814.3702947845804,  702.2474886621314,  702.9328684807257,
      703.6182482993197,  704.3036281179137,  592.0723185941043,
      592.6491950113378,  593.2260714285715,  593.8029478458051};
  const std::array<int, 4> in_shape = {{3, 10, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.02040816326530612, 0.04081632653061224, 0.061224489795918366,
      0.08163265306122448, 0.12244897959183672, 0.16326530612244897,
      0.20408163265306123, 0.24489795918367346, 0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.3061224489795918,  0.36734693877551017,
      0.42857142857142855, 0.4897959183673469,  0.3061224489795918,
      0.36734693877551017, 0.42857142857142855, 0.4897959183673469,
      0.3061224489795918,  0.36734693877551017, 0.42857142857142855,
      0.4897959183673469,  0.2857142857142857,  0.32653061224489793,
      0.36734693877551017, 0.40816326530612246, 0.18367346938775508,
      0.2040816326530612,  0.22448979591836732, 0.24489795918367346,
      0.2857142857142857,  0.32653061224489793, 0.36734693877551017,
      0.4081632653061224,  0.7346938775510203,  0.8163265306122448,
      0.8979591836734693,  0.9795918367346939,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.346938775510204,   1.4693877551020407,
      1.5918367346938775,  1.7142857142857144,  1.346938775510204,
      1.4693877551020407,  1.5918367346938775,  1.7142857142857144,
      1.346938775510204,   1.4693877551020407,  1.5918367346938775,
      1.7142857142857144,  1.0612244897959184,  1.1428571428571428,
      1.2244897959183674,  1.306122448979592,   0.6122448979591837,
      0.6530612244897959,  0.693877551020408,   0.7346938775510203,
      0.7959183673469388,  0.857142857142857,   0.9183673469387754,
      0.9795918367346939,  1.8367346938775508,  1.9591836734693873,
      2.081632653061224,   2.204081632653061,   3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  3.122448979591837,   3.3061224489795915,
      3.4897959183673466,  3.6734693877551017,  3.122448979591837,
      3.3061224489795915,  3.4897959183673466,  3.6734693877551017,
      3.122448979591837,   3.3061224489795915,  3.4897959183673466,
      3.6734693877551017,  2.326530612244898,   2.4489795918367343,
      2.571428571428571,   2.693877551020408,   1.2857142857142856,
      1.346938775510204,   1.4081632653061222,  1.4693877551020407,
      1.5510204081632653,  1.6326530612244896,  1.714285714285714,
      1.7959183673469385,  3.428571428571428,   3.591836734693877,
      3.755102040816326,   3.9183673469387754,  5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.081632653061224,   4.244897959183673,
      4.408163265306122,   4.571428571428571,   2.204081632653061,
      2.2857142857142856,  2.36734693877551,    2.4489795918367347,
      1.5510204081632653,  1.6326530612244896,  1.714285714285714,
      1.7959183673469385,  3.428571428571428,   3.591836734693877,
      3.755102040816326,   3.9183673469387754,  5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.081632653061224,   4.244897959183673,
      4.408163265306122,   4.571428571428571,   2.204081632653061,
      2.2857142857142856,  2.36734693877551,    2.4489795918367347,
      1.5510204081632653,  1.6326530612244896,  1.714285714285714,
      1.7959183673469385,  3.428571428571428,   3.591836734693877,
      3.755102040816326,   3.9183673469387754,  5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.081632653061224,   4.244897959183673,
      4.408163265306122,   4.571428571428571,   2.204081632653061,
      2.2857142857142856,  2.36734693877551,    2.4489795918367347,
      1.5510204081632653,  1.6326530612244896,  1.714285714285714,
      1.7959183673469385,  3.428571428571428,   3.591836734693877,
      3.755102040816326,   3.9183673469387754,  5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    5.63265306122449,    5.877551020408162,
      6.122448979591837,   6.36734693877551,    5.63265306122449,
      5.877551020408162,   6.122448979591837,   6.36734693877551,
      5.63265306122449,    5.877551020408162,   6.122448979591837,
      6.36734693877551,    4.081632653061224,   4.244897959183673,
      4.408163265306122,   4.571428571428571,   2.204081632653061,
      2.2857142857142856,  2.36734693877551,    2.4489795918367347,
      1.530612244897959,   1.5918367346938775,  1.6530612244897958,
      1.714285714285714,   3.3061224489795915,  3.4285714285714284,
      3.551020408163265,   3.6734693877551017,  5.326530612244897,
      5.5102040816326525,  5.693877551020407,   5.877551020408164,
      5.326530612244897,   5.5102040816326525,  5.693877551020407,
      5.877551020408164,   5.326530612244897,   5.5102040816326525,
      5.693877551020407,   5.877551020408164,   5.326530612244897,
      5.5102040816326525,  5.693877551020407,   5.877551020408164,
      5.326530612244897,   5.5102040816326525,  5.693877551020407,
      5.877551020408164,   3.7959183673469385,  3.9183673469387754,
      4.040816326530612,   4.163265306122449,   2.020408163265306,
      2.0816326530612246,  2.142857142857143,   2.204081632653061,
      1.2653061224489797,  1.3061224489795917,  1.3469387755102038,
      1.387755102040816,   2.693877551020408,   2.7755102040816326,
      2.8571428571428568,  2.9387755102040813,  4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   4.285714285714286,   4.408163265306122,
      4.530612244897959,   4.653061224489796,   4.285714285714286,
      4.408163265306122,   4.530612244897959,   4.653061224489796,
      4.285714285714286,   4.408163265306122,   4.530612244897959,
      4.653061224489796,   3.020408163265306,   3.1020408163265305,
      3.1836734693877546,  3.2653061224489797,  1.5918367346938775,
      1.6326530612244898,  1.673469387755102,   1.7142857142857142,
      0.7551020408163265,  0.7755102040816326,  0.7959183673469387,
      0.8163265306122448,  1.5918367346938775,  1.6326530612244898,
      1.673469387755102,   1.714285714285714,   2.510204081632653,
      2.571428571428571,   2.63265306122449,    2.6938775510204076,
      2.510204081632653,   2.571428571428571,   2.63265306122449,
      2.6938775510204076,  2.510204081632653,   2.571428571428571,
      2.63265306122449,    2.6938775510204076,  2.510204081632653,
      2.571428571428571,   2.63265306122449,    2.6938775510204076,
      2.510204081632653,   2.571428571428571,   2.63265306122449,
      2.6938775510204076,  1.7551020408163263,  1.7959183673469385,
      1.8367346938775508,  1.8775510204081631,  0.9183673469387754,
      0.9387755102040816,  0.9591836734693877,  0.9795918367346939,
      0.9999999999999999,  1.0204081632653061,  1.040816326530612,
      1.0612244897959182,  2.081632653061224,   2.1224489795918364,
      2.1632653061224487,  2.204081632653061,   3.244897959183673,
      3.3061224489795915,  3.36734693877551,    3.428571428571428,
      3.244897959183673,   3.3061224489795915,  3.36734693877551,
      3.428571428571428,   3.244897959183673,   3.3061224489795915,
      3.36734693877551,    3.428571428571428,   3.244897959183673,
      3.3061224489795915,  3.36734693877551,    3.428571428571428,
      3.244897959183673,   3.3061224489795915,  3.36734693877551,
      3.428571428571428,   2.2448979591836733,  2.2857142857142856,
      2.326530612244898,   2.36734693877551,    1.163265306122449,
      1.183673469387755,   1.2040816326530612,  1.2244897959183672,
      2.2448979591836733,  2.2857142857142856,  2.3265306122448974,
      2.36734693877551,    4.653061224489795,   4.73469387755102,
      4.816326530612244,   4.897959183673469,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   7.224489795918366,   7.346938775510203,
      7.469387755102041,   7.591836734693876,   7.224489795918366,
      7.346938775510203,   7.469387755102041,   7.591836734693876,
      7.224489795918366,   7.346938775510203,   7.469387755102041,
      7.591836734693876,   4.979591836734693,   5.061224489795919,
      5.142857142857142,   5.224489795918367,   2.571428571428571,
      2.6122448979591835,  2.6530612244897958,  2.6938775510204076,
      3.7346938775510203,  3.7959183673469385,  3.8571428571428568,
      3.9183673469387754,  7.714285714285713,   7.83673469387755,
      7.959183673469386,   8.081632653061224,   11.938775510204081,
      12.122448979591836,  12.306122448979592,  12.489795918367346,
      11.938775510204081,  12.122448979591836,  12.306122448979592,
      12.489795918367346,  11.938775510204081,  12.122448979591836,
      12.306122448979592,  12.489795918367346,  11.938775510204081,
      12.122448979591836,  12.306122448979592,  12.489795918367346,
      11.938775510204081,  12.122448979591836,  12.306122448979592,
      12.489795918367346,  8.204081632653061,   8.326530612244898,
      8.448979591836734,   8.571428571428571,   4.224489795918367,
      4.285714285714286,   4.346938775510203,   4.408163265306122,
      5.469387755102041,   5.551020408163265,   5.632653061224489,
      5.7142857142857135,  11.265306122448976,  11.428571428571427,
      11.591836734693876,  11.755102040816325,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  11.918367346938775,  12.081632653061224,
      12.244897959183673,  12.408163265306122,  6.122448979591836,
      6.204081632653061,   6.285714285714285,   6.36734693877551,
      5.469387755102041,   5.551020408163265,   5.632653061224489,
      5.7142857142857135,  11.265306122448976,  11.428571428571427,
      11.591836734693876,  11.755102040816325,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  11.918367346938775,  12.081632653061224,
      12.244897959183673,  12.408163265306122,  6.122448979591836,
      6.204081632653061,   6.285714285714285,   6.36734693877551,
      5.469387755102041,   5.551020408163265,   5.632653061224489,
      5.7142857142857135,  11.265306122448976,  11.428571428571427,
      11.591836734693876,  11.755102040816325,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  11.918367346938775,  12.081632653061224,
      12.244897959183673,  12.408163265306122,  6.122448979591836,
      6.204081632653061,   6.285714285714285,   6.36734693877551,
      5.469387755102041,   5.551020408163265,   5.632653061224489,
      5.7142857142857135,  11.265306122448976,  11.428571428571427,
      11.591836734693876,  11.755102040816325,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  17.387755102040813,  17.632653061224488,
      17.877551020408163,  18.122448979591834,  17.387755102040813,
      17.632653061224488,  17.877551020408163,  18.122448979591834,
      17.387755102040813,  17.632653061224488,  17.877551020408163,
      18.122448979591834,  11.918367346938775,  12.081632653061224,
      12.244897959183673,  12.408163265306122,  6.122448979591836,
      6.204081632653061,   6.285714285714285,   6.36734693877551,
      4.469387755102041,   4.530612244897958,   4.591836734693877,
      4.653061224489795,   9.183673469387754,   9.30612244897959,
      9.428571428571429,   9.551020408163264,   14.14285714285714,
      14.326530612244898,  14.510204081632653,  14.693877551020408,
      14.14285714285714,   14.326530612244898,  14.510204081632653,
      14.693877551020408,  14.14285714285714,   14.326530612244898,
      14.510204081632653,  14.693877551020408,  14.14285714285714,
      14.326530612244898,  14.510204081632653,  14.693877551020408,
      14.14285714285714,   14.326530612244898,  14.510204081632653,
      14.693877551020408,  9.673469387755102,   9.795918367346937,
      9.918367346938776,   10.040816326530612,  4.959183673469387,
      5.020408163265306,   5.081632653061224,   5.142857142857142,
      3.224489795918367,   3.2653061224489797,  3.3061224489795915,
      3.346938775510204,   6.612244897959184,   6.693877551020408,
      6.775510204081631,   6.857142857142856,   10.163265306122447,
      10.285714285714285,  10.408163265306122,  10.53061224489796,
      10.163265306122447,  10.285714285714285,  10.408163265306122,
      10.53061224489796,   10.163265306122447,  10.285714285714285,
      10.408163265306122,  10.53061224489796,   10.163265306122447,
      10.285714285714285,  10.408163265306122,  10.53061224489796,
      10.163265306122447,  10.285714285714285,  10.408163265306122,
      10.53061224489796,   6.938775510204081,   7.020408163265306,
      7.10204081632653,    7.183673469387754,   3.5510204081632653,
      3.591836734693877,   3.63265306122449,    3.6734693877551017,
      1.7346938775510203,  1.7551020408163265,  1.7755102040816324,
      1.7959183673469385,  3.5510204081632653,  3.591836734693877,
      3.6326530612244894,  3.6734693877551017,  5.448979591836735,
      5.5102040816326525,  5.571428571428571,   5.63265306122449,
      5.448979591836735,   5.5102040816326525,  5.571428571428571,
      5.63265306122449,    5.448979591836735,   5.5102040816326525,
      5.571428571428571,   5.63265306122449,    5.448979591836735,
      5.5102040816326525,  5.571428571428571,   5.63265306122449,
      5.448979591836735,   5.5102040816326525,  5.571428571428571,
      5.63265306122449,    3.714285714285714,   3.7551020408163263,
      3.7959183673469385,  3.836734693877551,   1.8979591836734693,
      1.9183673469387754,  1.9387755102040816,  1.9591836734693877,
      1.9795918367346936,  1.9999999999999998,  2.020408163265306,
      2.0408163265306123,  4.040816326530612,   4.081632653061224,
      4.122448979591836,   4.163265306122449,   6.183673469387754,
      6.244897959183673,   6.3061224489795915,  6.36734693877551,
      6.183673469387754,   6.244897959183673,   6.3061224489795915,
      6.36734693877551,    6.183673469387754,   6.244897959183673,
      6.3061224489795915,  6.36734693877551,    6.183673469387754,
      6.244897959183673,   6.3061224489795915,  6.36734693877551,
      6.183673469387754,   6.244897959183673,   6.3061224489795915,
      6.36734693877551,    4.204081632653061,   4.244897959183673,
      4.285714285714286,   4.326530612244897,   2.142857142857143,
      2.1632653061224487,  2.183673469387755,   2.204081632653061,
      4.204081632653061,   4.244897959183673,   4.285714285714285,
      4.326530612244898,   8.571428571428571,   8.653061224489795,
      8.734693877551019,   8.816326530612244,   13.102040816326529,
      13.224489795918366,  13.346938775510203,  13.46938775510204,
      13.102040816326529,  13.224489795918366,  13.346938775510203,
      13.46938775510204,   13.102040816326529,  13.224489795918366,
      13.346938775510203,  13.46938775510204,   13.102040816326529,
      13.224489795918366,  13.346938775510203,  13.46938775510204,
      13.102040816326529,  13.224489795918366,  13.346938775510203,
      13.46938775510204,   8.897959183673468,   8.979591836734693,
      9.061224489795919,   9.142857142857142,   4.530612244897959,
      4.571428571428571,   4.612244897959183,   4.653061224489795,
      6.673469387755102,   6.7346938775510194,  6.795918367346937,
      6.857142857142858,   13.591836734693878,  13.714285714285714,
      13.836734693877549,  13.959183673469386,  20.755102040816322,
      20.93877551020408,   21.122448979591834,  21.30612244897959,
      20.755102040816322,  20.93877551020408,   21.122448979591834,
      21.30612244897959,   20.755102040816322,  20.93877551020408,
      21.122448979591834,  21.30612244897959,   20.755102040816322,
      20.93877551020408,   21.122448979591834,  21.30612244897959,
      20.755102040816322,  20.93877551020408,   21.122448979591834,
      21.30612244897959,   14.081632653061222,  14.204081632653061,
      14.326530612244898,  14.448979591836734,  7.163265306122449,
      7.224489795918367,   7.285714285714285,   7.346938775510203,
      9.387755102040815,   9.46938775510204,    9.551020408163264,
      9.63265306122449,    19.102040816326532,  19.265306122448976,
      19.428571428571423,  19.591836734693878,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  19.755102040816322,  19.918367346938773,
      20.081632653061224,  20.24489795918367,   10.040816326530612,
      10.122448979591836,  10.204081632653061,  10.285714285714285,
      9.387755102040815,   9.46938775510204,    9.551020408163264,
      9.63265306122449,    19.102040816326532,  19.265306122448976,
      19.428571428571423,  19.591836734693878,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  19.755102040816322,  19.918367346938773,
      20.081632653061224,  20.24489795918367,   10.040816326530612,
      10.122448979591836,  10.204081632653061,  10.285714285714285,
      9.387755102040815,   9.46938775510204,    9.551020408163264,
      9.63265306122449,    19.102040816326532,  19.265306122448976,
      19.428571428571423,  19.591836734693878,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  19.755102040816322,  19.918367346938773,
      20.081632653061224,  20.24489795918367,   10.040816326530612,
      10.122448979591836,  10.204081632653061,  10.285714285714285,
      9.387755102040815,   9.46938775510204,    9.551020408163264,
      9.63265306122449,    19.102040816326532,  19.265306122448976,
      19.428571428571423,  19.591836734693878,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  29.14285714285714,   29.387755102040813,
      29.632653061224485,  29.877551020408163,  29.14285714285714,
      29.387755102040813,  29.632653061224485,  29.877551020408163,
      29.14285714285714,   29.387755102040813,  29.632653061224485,
      29.877551020408163,  19.755102040816322,  19.918367346938773,
      20.081632653061224,  20.24489795918367,   10.040816326530612,
      10.122448979591836,  10.204081632653061,  10.285714285714285,
      7.408163265306122,   7.469387755102041,   7.530612244897958,
      7.591836734693876,   15.061224489795917,  15.183673469387752,
      15.306122448979592,  15.428571428571427,  22.959183673469386,
      23.14285714285714,   23.3265306122449,    23.510204081632654,
      22.959183673469386,  23.14285714285714,   23.3265306122449,
      23.510204081632654,  22.959183673469386,  23.14285714285714,
      23.3265306122449,    23.510204081632654,  22.959183673469386,
      23.14285714285714,   23.3265306122449,    23.510204081632654,
      22.959183673469386,  23.14285714285714,   23.3265306122449,
      23.510204081632654,  15.551020408163264,  15.6734693877551,
      15.795918367346939,  15.918367346938773,  7.897959183673468,
      7.959183673469388,   8.020408163265305,   8.081632653061224,
      5.183673469387754,   5.224489795918367,   5.26530612244898,
      5.3061224489795915,  10.53061224489796,   10.612244897959183,
      10.693877551020407,  10.77551020408163,   16.04081632653061,
      16.163265306122447,  16.285714285714285,  16.408163265306122,
      16.04081632653061,   16.163265306122447,  16.285714285714285,
      16.408163265306122,  16.04081632653061,   16.163265306122447,
      16.285714285714285,  16.408163265306122,  16.04081632653061,
      16.163265306122447,  16.285714285714285,  16.408163265306122,
      16.04081632653061,   16.163265306122447,  16.285714285714285,
      16.408163265306122,  10.857142857142856,  10.938775510204081,
      11.020408163265305,  11.102040816326529,  5.5102040816326525,
      5.551020408163264,   5.591836734693877,   5.63265306122449,
      2.714285714285714,   2.7346938775510203,  2.7551020408163263,
      2.7755102040816326,  5.5102040816326525,  5.551020408163264,
      5.591836734693877,   5.63265306122449,    8.387755102040815,
      8.448979591836734,   8.510204081632653,   8.571428571428571,
      8.387755102040815,   8.448979591836734,   8.510204081632653,
      8.571428571428571,   8.387755102040815,   8.448979591836734,
      8.510204081632653,   8.571428571428571,   8.387755102040815,
      8.448979591836734,   8.510204081632653,   8.571428571428571,
      8.387755102040815,   8.448979591836734,   8.510204081632653,
      8.571428571428571,   5.673469387755102,   5.7142857142857135,
      5.755102040816326,   5.795918367346938,   2.877551020408163,
      2.897959183673469,   2.9183673469387754,  2.9387755102040813};
  const std::array<int, 4> in_shape = {{3, 10, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678004535,  10.5300283446712,   12.555198412698413,
      14.688871882086168, 14.710102040816327, 15.773435374149658,
      18.094070294784576, 16.285907029478455, 14.36924036281179,
      12.344070294784583, 13.199416099773241, 16.034450113378682,
      18.998395691609975, 22.091252834467117, 21.791054421768706,
      23.054387755102034, 26.136927437641713, 23.430804988662125,
      20.595770975056684, 17.6318253968254,   18.87050453514739,
      22.82798752834467,  26.93479024943311,  31.1909126984127,
      30.450238095238095, 31.913571428571423, 35.877063492063485,
      32.068900226757364, 28.111417233560083, 24.004614512471655,
      25.626626984126982, 30.910640589569162, 36.3643820861678,
      41.9878514739229,   40.68765306122449,  42.350986394557815,
      47.31447845804988,  42.20019274376416,  36.916179138321986,
      31.46243764172336,  34.34428571428571,  41.23544217687075,
      48.28442176870748,  55.49122448979592,  53.128526077097504,
      54.67519274376416,  60.44424036281178,  53.71090702947845,
      46.81975056689342,  39.770770975056685, 44.97761904761904,
      53.86877551020408,  62.917755102040815, 72.12455782312925,
      68.59519274376417,  70.14185941043084,  77.07757369614512,
      68.34424036281179,  59.45308390022675,  50.40410430839003,
      59.67861111111111,  71.36738662131519,  83.22589002267573,
      95.25412131519273,  90.2178117913832,   91.88114512471654,
      100.58074829931971, 89.06170068027211,  77.37292517006803,
      65.51442176870749,  56.17759070294784,  67.15208049886621,
      78.27589002267572,  89.5490192743764,   84.71509070294783,
      86.17842403628117,  94.2351700680272,   83.41,
      72.43551020408164,  61.31170068027211,  51.59153628117914,
      61.64765873015873,  71.83269274376417,  82.14663832199545,
      77.63413832199545,  78.89747165532879,  86.19231292517006,
      76.26510204081633,  66.20897959183674,  56.0239455782313,
      45.920447845804986, 54.85412131519274,  63.89629818594105,
      73.04697845804988,  68.97495464852608,  70.03828798185941,
      76.4521768707483,   67.6270068027211,   58.693333333333335,
      49.651156462585035, 66.30100340136055,  79.06801020408163,
      91.94352040816328,  104.92753401360545, 98.61939909297054,
      99.68273242630386,  108.33273242630385, 95.67422902494332,
      82.90722222222223,  70.03171201814058,  81.73739795918367,
      97.46358843537413,  113.31869047619048, 129.30270408163267,
      121.48266439909298, 122.74599773242629, 133.34837868480724,
      117.75109977324263, 102.02490929705216, 86.16980725623581,
      98.25882653061223,  117.14828231292515, 136.18705782312924,
      155.3751530612245,  145.92416099773243, 147.38749433106574,
      160.06130385487526, 141.32116780045354, 122.43171201814059,
      103.39293650793648, 115.86528911564625, 138.12209183673468,
      160.5486224489796,  183.14488095238096, 171.9438888888889,
      173.6072222222222,  188.47150793650792, 166.38443310657598,
      144.12763038548752, 121.7010997732426,  118.2535827664399,
      140.92705215419497, 163.7583446712017,  186.74746031746025,
      175.17841269841267, 176.72507936507932, 191.70047619047622,
      169.18482993197276, 146.51136054421767, 123.68006802721085,
      128.88691609977326, 153.56038548752835, 178.39167800453512,
      203.3807936507936,  190.64507936507937, 192.19174603174605,
      208.33380952380955, 183.81816326530614, 159.14469387755102,
      134.31340136054422, 149.91727324263036, 178.57883786848072,
      207.4101303854875,  236.41115079365082, 221.4740476190476,
      223.13738095238097, 241.73777777777775, 213.24594104308392,
      184.58437641723353, 155.75308390022676, 135.56591269841266,
      161.47237528344667, 187.52815759637184, 213.7332596371882,
      200.18901360544217, 201.65234693877548, 218.41941043083898,
      192.66226757369614, 166.7558049886621,  140.70002267573696,
      120.12951814058957, 143.07679705215418, 166.15298752834465,
      189.35808956916097, 177.3257482993197,  178.589081632653,
      193.40376417233557, 170.5853968253968,  147.6381179138322,
      124.56192743764173, 103.608089569161,   123.39210317460318,
      143.2846201814059,  163.28564058956914, 152.88425170068027,
      153.94758503401357, 166.69083900226755, 147.01532879818592,
      127.23131519274378, 107.33879818594104, 123.98864512471656,
      147.60599206349204, 171.3318424036281,  195.16619614512473,
      182.52869614512468, 183.59202947845804, 198.57139455782314,
      175.06255102040816, 151.44520408163265, 127.71935374149658,
      150.2753798185941,  178.8927267573696,  207.63898526077094,
      236.51415532879818, 221.17427437641717, 222.43760770975052,
      240.55982993197276, 212.07139455782308, 183.4540476190476,
      154.7077891156462,  177.64714852607707, 211.46857709750563,
      245.43932539682535, 279.55939342403633, 261.3980839002267,
      262.86141723356,    284.24554421768704, 250.57343537414962,
      216.75200680272107, 182.7812585034013,  206.10395124716553,
      245.3335430839002,  284.7328628117914,  324.3019104308391,
      303.2001247165533,  304.8634580498867,  329.6285374149661,
      290.5686734693878,  251.33908163265303, 211.93976190476184,
      202.1628798185941,  240.61866213151927, 279.2322675736961,
      318.0036961451247,  297.2282993197278,  298.77496598639453,
      322.9567120181406,  284.6587528344671,  246.20297052154194,
      207.58936507936508, 212.79621315192742, 253.25199546485257,
      293.8656009070295,  334.637029478458,   312.6949659863946,
      314.24163265306123, 339.5900453514739,  299.29208616780045,
      258.83630385487527, 218.2226984126984,  240.15593537414964,
      285.7902891156462,  331.5943707482993,  377.5681802721088,
      352.730283446712,   354.3936167800453,  382.8948072562358,
      337.4301814058956,  291.7958276643991,  245.991746031746,
      214.95423469387754, 255.7926700680272,  296.780425170068,
      337.91749999999996, 315.6629365079365,  317.12626984126985,
      342.60365079365073, 301.91453514739226, 261.0760997732426,
      220.0883446712018,  188.6675,           224.50593537414963,
      260.47328231292516, 296.5695408163265,  277.017358276644,
      278.2806916099773,  300.6152154195011,  264.90569160997734,
      229.06725623582767, 193.09990929705214, 161.29573129251702,
      191.9300850340136,  222.67294217687075, 253.5243027210884,
      236.79354875283448, 237.8568820861678,  256.9295011337868,
      226.40365079365077, 195.7692970521542,  165.02643990929704};
  const std::array<int, 4> in_shape = {{3, 10, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.061224489795918366,
                                         0.12244897959183673,
                                         0.20408163265306123,
                                         0.20408163265306123,
                                         0.20408163265306123,
                                         0.20408163265306123,
                                         0.18367346938775508,
                                         0.14285714285714285,
                                         0.08163265306122448,
                                         0.12244897959183672,
                                         0.2857142857142857,
                                         0.48979591836734687,
                                         0.7346938775510203,
                                         0.7346938775510203,
                                         0.7346938775510203,
                                         0.7346938775510203,
                                         0.6122448979591837,
                                         0.44897959183673464,
                                         0.24489795918367346,
                                         0.3061224489795918,
                                         0.673469387755102,
                                         1.1020408163265305,
                                         1.5918367346938775,
                                         1.5918367346938775,
                                         1.5918367346938775,
                                         1.5918367346938775,
                                         1.2857142857142858,
                                         0.9183673469387754,
                                         0.4897959183673469,
                                         0.5714285714285714,
                                         1.2244897959183674,
                                         1.9591836734693875,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.2040816326530615,
                                         1.551020408163265,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         1.2244897959183674,
                                         1.9591836734693875,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.2040816326530615,
                                         1.551020408163265,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         1.2244897959183674,
                                         1.9591836734693875,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.2040816326530615,
                                         1.551020408163265,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         1.2244897959183674,
                                         1.9591836734693875,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.7755102040816326,
                                         2.2040816326530615,
                                         1.551020408163265,
                                         0.8163265306122449,
                                         0.5510204081632653,
                                         1.1632653061224487,
                                         1.8367346938775506,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.571428571428571,
                                         2.020408163265306,
                                         1.4081632653061222,
                                         0.7346938775510203,
                                         0.44897959183673464,
                                         0.9387755102040816,
                                         1.4693877551020407,
                                         2.0408163265306123,
                                         2.0408163265306123,
                                         2.0408163265306123,
                                         2.0408163265306123,
                                         1.5918367346938773,
                                         1.1020408163265305,
                                         0.5714285714285714,
                                         0.26530612244897955,
                                         0.5510204081632653,
                                         0.857142857142857,
                                         1.1836734693877549,
                                         1.1836734693877549,
                                         1.1836734693877549,
                                         1.1836734693877549,
                                         0.9183673469387754,
                                         0.6326530612244897,
                                         0.32653061224489793,
                                         0.3469387755102041,
                                         0.7142857142857142,
                                         1.1020408163265305,
                                         1.510204081632653,
                                         1.510204081632653,
                                         1.510204081632653,
                                         1.510204081632653,
                                         1.163265306122449,
                                         0.7959183673469388,
                                         0.4081632653061224,
                                         0.7755102040816326,
                                         1.5918367346938775,
                                         2.4489795918367343,
                                         3.346938775510204,
                                         3.346938775510204,
                                         3.346938775510204,
                                         3.346938775510204,
                                         2.571428571428571,
                                         1.7551020408163267,
                                         0.8979591836734693,
                                         1.2857142857142856,
                                         2.63265306122449,
                                         4.040816326530612,
                                         5.5102040816326525,
                                         5.5102040816326525,
                                         5.5102040816326525,
                                         5.5102040816326525,
                                         4.224489795918367,
                                         2.8775510204081636,
                                         1.4693877551020407,
                                         1.8775510204081631,
                                         3.836734693877551,
                                         5.877551020408164,
                                         8.,
                                         8.,
                                         8.,
                                         8.,
                                         6.122448979591836,
                                         4.163265306122449,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         3.836734693877551,
                                         5.877551020408164,
                                         8.,
                                         8.,
                                         8.,
                                         8.,
                                         6.122448979591836,
                                         4.163265306122449,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         3.836734693877551,
                                         5.877551020408164,
                                         8.,
                                         8.,
                                         8.,
                                         8.,
                                         6.122448979591836,
                                         4.163265306122449,
                                         2.1224489795918364,
                                         1.8775510204081631,
                                         3.836734693877551,
                                         5.877551020408164,
                                         8.,
                                         8.,
                                         8.,
                                         8.,
                                         6.122448979591836,
                                         4.163265306122449,
                                         2.1224489795918364,
                                         1.530612244897959,
                                         3.122448979591836,
                                         4.775510204081632,
                                         6.489795918367346,
                                         6.489795918367346,
                                         6.489795918367346,
                                         6.489795918367346,
                                         4.959183673469386,
                                         3.36734693877551,
                                         1.714285714285714,
                                         1.1020408163265305,
                                         2.2448979591836733,
                                         3.4285714285714284,
                                         4.653061224489796,
                                         4.653061224489796,
                                         4.653061224489796,
                                         4.653061224489796,
                                         3.551020408163265,
                                         2.408163265306122,
                                         1.2244897959183674,
                                         0.5918367346938775,
                                         1.204081632653061,
                                         1.8367346938775508,
                                         2.4897959183673466,
                                         2.4897959183673466,
                                         2.4897959183673466,
                                         2.4897959183673466,
                                         1.897959183673469,
                                         1.2857142857142856,
                                         0.6530612244897959,
                                         0.673469387755102,
                                         1.3673469387755102,
                                         2.0816326530612246,
                                         2.816326530612245,
                                         2.816326530612245,
                                         2.816326530612245,
                                         2.816326530612245,
                                         2.142857142857143,
                                         1.4489795918367345,
                                         0.7346938775510203,
                                         1.4285714285714284,
                                         2.897959183673469,
                                         4.408163265306122,
                                         5.959183673469387,
                                         5.959183673469387,
                                         5.959183673469387,
                                         5.959183673469387,
                                         4.530612244897958,
                                         3.061224489795918,
                                         1.5510204081632653,
                                         2.265306122448979,
                                         4.591836734693877,
                                         6.979591836734693,
                                         9.428571428571427,
                                         9.428571428571427,
                                         9.428571428571427,
                                         9.428571428571427,
                                         7.163265306122448,
                                         4.836734693877551,
                                         2.4489795918367347,
                                         3.1836734693877546,
                                         6.448979591836734,
                                         9.795918367346939,
                                         13.224489795918366,
                                         13.224489795918366,
                                         13.224489795918366,
                                         13.224489795918366,
                                         10.040816326530612,
                                         6.775510204081633,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         6.448979591836734,
                                         9.795918367346939,
                                         13.224489795918366,
                                         13.224489795918366,
                                         13.224489795918366,
                                         13.224489795918366,
                                         10.040816326530612,
                                         6.775510204081633,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         6.448979591836734,
                                         9.795918367346939,
                                         13.224489795918366,
                                         13.224489795918366,
                                         13.224489795918366,
                                         13.224489795918366,
                                         10.040816326530612,
                                         6.775510204081633,
                                         3.428571428571429,
                                         3.1836734693877546,
                                         6.448979591836734,
                                         9.795918367346939,
                                         13.224489795918366,
                                         13.224489795918366,
                                         13.224489795918366,
                                         13.224489795918366,
                                         10.040816326530612,
                                         6.775510204081633,
                                         3.428571428571429,
                                         2.510204081632653,
                                         5.081632653061224,
                                         7.7142857142857135,
                                         10.408163265306122,
                                         10.408163265306122,
                                         10.408163265306122,
                                         10.408163265306122,
                                         7.897959183673469,
                                         5.326530612244897,
                                         2.6938775510204076,
                                         1.7551020408163263,
                                         3.5510204081632653,
                                         5.387755102040815,
                                         7.265306122448979,
                                         7.265306122448979,
                                         7.265306122448979,
                                         7.265306122448979,
                                         5.510204081632653,
                                         3.7142857142857144,
                                         1.8775510204081631,
                                         0.9183673469387754,
                                         1.857142857142857,
                                         2.816326530612245,
                                         3.795918367346939,
                                         3.795918367346939,
                                         3.795918367346939,
                                         3.795918367346939,
                                         2.877551020408163,
                                         1.9387755102040816,
                                         0.9795918367346939};
  const std::array<int, 4> in_shape = {{3, 10, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.64984693877551,  17.22672335600907,
                                         20.374676870748296, 21.0600566893424,
                                         24.31651360544218,  25.110396825396826,
                                         28.475357142857142, 29.377743764172337,
                                         28.581111111111106, 29.420204081632654,
                                         30.707777777777775, 31.546870748299316,
                                         35.285753968253964, 36.18814058956915,
                                         31.77793083900226,  32.57181405895691,
                                         28.053100907029474, 28.73848072562358,
                                         24.111264172335602, 24.688140589569166,
                                         25.713452380952383, 26.398832199546483,
                                         31.25460884353741,  32.068900226757364,
                                         37.053588435374145, 37.99679138321995,
                                         43.11039115646258,  44.18250566893423,
                                         42.58519274376416,  43.58210884353741,
                                         45.11185941043083,  46.10877551020407,
                                         51.20174036281178,  52.273854875283426,
                                         45.918407029478445, 46.86160997732425,
                                         40.377250566893416, 41.19154195011337,
                                         34.57827097505669,  35.2636507936508,
                                         36.947125850340136, 37.74100907029478,
                                         44.71277210884353,  45.65597505668934,
                                         52.77705782312924,  53.86958049886622,
                                         61.13998299319727,  62.3818253968254,
                                         59.745736961451236, 60.90047619047619,
                                         62.672403628117905, 63.827142857142846,
                                         70.51228458049886,  71.75412698412697,
                                         63.04527777777776,  64.13780045351473,
                                         55.27963151927437,  56.222834467120165,
                                         47.215345804988665, 48.00922902494331,
                                         50.35086734693877,  51.253253968253965,
                                         60.74916666666665,  61.821281179138325,
                                         71.48692176870746,  72.7287641723356,
                                         82.56413265306122,  83.9757029478458,
                                         80.06274376417231,  81.37530612244898,
                                         83.38941043083898,  84.70197278911563,
                                         93.21738662131516,  94.62895691609975,
                                         83.1585430839002,   84.40038548752833,
                                         72.76024376417232,  73.83235827664397,
                                         62.02248866213152,  62.92487528344672,
                                         67.84947845804989,  68.68857142857142,
                                         81.47396825396824,  82.4708843537415,
                                         95.41410430839,     96.56884353741496,
                                         109.66988662131516, 110.98244897959184,
                                         105.03655328798182, 106.25705215419501,
                                         108.12988662131517, 109.35038548752831,
                                         119.5759183673469,  120.88848072562357,
                                         106.26707482993194, 107.4218140589569,
                                         92.64258503401359,  93.63950113378684,
                                         78.70244897959184,  79.54154195011337,
                                         89.11614512471654,  89.95523809523807,
                                         106.7406349206349,  107.73755102040816,
                                         124.68077097505666, 125.83551020408163,
                                         142.9365532879818,  144.2491156462585,
                                         135.96988662131517, 137.19038548752835,
                                         139.0632199546485,  140.28371882086168,
                                         152.84258503401358, 154.15514739229025,
                                         135.5337414965986,  136.68848072562358,
                                         117.90925170068026, 118.9061678004535,
                                         99.96911564625852,  100.80820861678006,
                                         118.45483560090703, 119.35722222222222,
                                         141.6626587301587,  142.73477324263038,
                                         165.20993764172334, 166.45178004535146,
                                         189.09667233560086, 190.50824263038547,
                                         179.12306122448976, 180.4356235827664,
                                         182.44972789115644, 183.76229024943308,
                                         199.74992630385483, 201.16149659863942,
                                         176.88155895691605, 178.12340136054422,
                                         153.6737358276644,  154.74585034013606,
                                         130.12645691609978, 131.02884353741499,
                                         111.56129818594104, 112.35518140589568,
                                         133.36095804988662, 134.30416099773242,
                                         155.45925736961448, 156.55178004535145,
                                         177.8561961451247,  179.0980385487528,
                                         168.2754421768707,  169.43018140589567,
                                         171.2021088435374,  172.35684807256234,
                                         187.22849773242626, 188.4703401360544,
                                         165.72747732426302, 166.82,
                                         143.92781746031744, 144.87102040816328,
                                         121.82951814058958, 122.62340136054422,
                                         102.49769274376418, 103.18307256235828,
                                         122.4810260770975,  123.29531746031746,
                                         142.72218253968254, 143.66538548752834,
                                         163.22116213151926, 164.2932766439909,
                                         154.27136054421766, 155.2682766439909,
                                         156.79802721088433, 157.79494331065757,
                                         171.31251133786847, 172.38462585034011,
                                         151.58700113378683, 152.53020408163266,
                                         131.6036678004535,  132.41795918367347,
                                         111.36251133786848, 112.0478911564626,
                                         91.26401927437644,  91.84089569160997,
                                         109.02286281179138, 109.70824263038548,
                                         126.99871315192743, 127.7925963718821,
                                         145.19157029478458, 146.09395691609976,
                                         137.1108163265306,  137.94990929705216,
                                         139.2374829931973,  140.07657596371882,
                                         152.00196712018138, 152.9043537414966,
                                         134.46013038548753, 135.2540136054422,
                                         116.70128684807256, 117.38666666666667,
                                         98.72543650793651,  99.30231292517007,
                                         132.02513038548753, 132.6020068027211,
                                         157.45064058956916, 158.13602040816326,
                                         183.09315759637187, 183.88704081632656,
                                         208.95268140589567, 209.8550680272109,
                                         196.39970521541946, 197.23879818594108,
                                         198.52637188208615, 199.36546485260772,
                                         215.76307823129252, 216.6654648526077,
                                         190.55457482993197, 191.34845804988663,
                                         165.12906462585033, 165.81444444444446,
                                         139.48654761904763, 140.06342403628116,
                                         162.78941609977323, 163.47479591836733,
                                         194.11288548752833, 194.92717687074827,
                                         225.6941780045351,  226.63738095238097,
                                         257.5332936507936,  258.60540816326534,
                                         241.96841269841264, 242.96532879818596,
                                         244.49507936507936, 245.49199546485258,
                                         265.6246428571429,  266.6967573696145,
                                         234.55899659863945, 235.50219954648526,
                                         203.23552721088436, 204.04981859410432,
                                         171.65423469387756, 172.33961451247163,
                                         195.7237698412698,  196.51765306122445,
                                         233.3533616780045,  234.2965646258503,
                                         271.28159297052144, 272.3741156462585,
                                         309.5084637188208,  310.750306122449,
                                         290.6935827664398,  291.84832199546486,
                                         293.6202494331066,  294.7749886621315,
                                         318.8807653061225,  320.1226077097505,
                                         281.5498129251701,  282.6423356009071,
                                         243.92022108843537, 244.86342403628117,
                                         205.99198979591836, 206.78587301587297,
                                         230.8281916099773,  231.7305782312925,
                                         275.1720691609977,  276.24418367346937,
                                         319.855402494331,   321.0972448979592,
                                         364.87819160997725, 366.2897619047619,
                                         342.57521541950103, 343.8877777777778,
                                         345.90188208616786, 347.2144444444444,
                                         375.53144557823134, 376.94301587301584,
                                         331.5270238095238,  332.76886621315197,
                                         287.18314625850337, 288.25526077097504,
                                         242.49981292517006, 243.4021995464852,
                                         235.6680725623583,  236.5071655328798,
                                         280.8571882086167,  281.85410430838994,
                                         326.36195011337855, 327.5166893424034,
                                         372.1823582766439,  373.4949206349205,
                                         349.13632653061217, 350.35682539682534,
                                         352.2296598639454,  353.45015873015865,
                                         382.08839002267564, 383.40095238095245,
                                         337.2149206349205,  338.3696598639455,
                                         292.02580498866206, 293.02272108843533,
                                         246.52104308390022, 247.3601360544217,
                                         256.93473922902496, 257.7738321995465,
                                         306.1238548752834,  307.1207709750567,
                                         355.6286167800453,  356.78335600907025,
                                         405.4490249433106,  406.7615873015872,
                                         380.0696598639455,  381.29015873015874,
                                         383.16299319727887, 384.3834920634921,
                                         415.35505668934223, 416.6676190476191,
                                         366.4815873015872,  367.6363265306123,
                                         317.29247165532877, 318.28938775510204,
                                         267.7877097505669,  268.62680272108844,
                                         298.93215986394557, 299.8345464852607,
                                         356.0855612244898,  357.15767573696144,
                                         413.578418367347,   414.820260770975,
                                         471.410731292517,   472.82230158730164,
                                         441.6355328798186,  442.9480952380952,
                                         444.96219954648524, 446.27476190476193,
                                         482.0639852607709,  483.4755555555555,
                                         425.2500396825397,  426.49188208616783,
                                         368.09663832199544, 369.16875283446706,
                                         310.6037811791383,  311.5061678004535,
                                         270.33794217687074, 271.1318253968253,
                                         322.00154761904764, 322.94475056689333,
                                         373.9637925170069,  375.0563151927437,
                                         426.2246768707483,  427.4665192743764,
                                         399.22328798185936, 400.37802721088434,
                                         402.1499546485261,  403.30469387755096,
                                         435.5969784580499,  436.83882086167796,
                                         384.2320124716553,  385.3245351473923,
                                         332.56840702947846, 333.5116099773242,
                                         280.6061621315193,  281.4000453514739,
                                         239.57365646258506, 240.25903628117914,
                                         285.3393027210885,  286.15359410430835,
                                         331.36277210884356, 332.3059750566893,
                                         377.6440646258504,  378.71617913832193,
                                         353.6545804988662,  354.6514965986394,
                                         356.1812471655329,  357.178163265306,
                                         385.7354138321996,  386.80752834467114,
                                         340.22759070294785, 341.1707936507936,
                                         294.46194444444444, 295.2762358276644,
                                         248.43847505668933, 249.12385487528346,
                                         206.63930272108843, 207.216179138322,
                                         246.09882653061226, 246.78420634920636,
                                         285.77535714285716, 286.5692403628118,
                                         325.66889455782314, 326.5712811791383,
                                         304.92941043083897, 305.76850340136053,
                                         307.05607709750564, 307.89517006802714,
                                         332.47929138321996, 333.3816780045351,
                                         293.23677437641726, 294.03065759637184,
                                         253.7772505668934,  254.46263038548756,
                                         214.10071995464853, 214.6775963718821,
                                         247.40041383219955, 247.9772902494331,
                                         294.52660430839,    295.2119841269841,
                                         341.8698015873015,  342.6636848072562,
                                         389.43000566893414, 390.33239229024946,
                                         364.21829931972786, 365.05739229024937,
                                         366.3449659863945,  367.1840589569161,
                                         396.240402494331,   397.1427891156463,
                                         349.3312188208616,  350.12510204081633,
                                         302.2050283446711,  302.8904081632653,
                                         254.8618310657596,  255.43870748299315,
                                         299.86537981859414, 300.5507596371882,
                                         356.9711621315193,  357.7854535147392,
                                         414.33476757369607, 415.2779705215419,
                                         471.95619614512464, 473.02831065759636,
                                         441.3516326530612,  442.34854875283435,
                                         443.87829931972783, 444.87521541950105,
                                         480.04754535147384, 481.1196598639455,
                                         423.1995861678003,  424.14278911564617,
                                         366.09380385487515, 366.9080952380952,
                                         308.7301984126983,  309.4155782312924,
                                         354.50041383219957, 355.29429705215415,
                                         421.99395124716557, 422.93715419501126,
                                         489.7861281179138,  490.8786507936507,
                                         557.8769444444445,  559.1187868480727,
                                         521.6414285714286,  522.7961678004534,
                                         524.5680952380952,  525.72283446712,
                                         567.2492460317461,  568.4910884353741,
                                         500.0543480725622,  501.14687074829925,
                                         432.5608106575962,  433.50401360544214,
                                         364.76863378684794, 365.5625170068026,
                                         411.30551587301585, 412.20790249433105,
                                         489.5949716553288,  490.6670861678004,
                                         568.2238832199546,  569.4657256235828,
                                         647.1922505668936,  648.6038208616782,
                                         605.08768707483,    606.4002494331066,
                                         608.4143537414966,  609.7269160997733,
                                         657.8455045351475,  659.2570748299322,
                                         579.8955045351472,  581.1373469387756,
                                         501.6060487528343,  502.67816326530607,
                                         422.9771371882085,  423.8795238095237,
                                         403.4866666666667,  404.3257596371882,
                                         480.24040816326533, 481.23732426303854,
                                         557.3097959183673,  558.4645351473922,
                                         634.6948299319728,  636.0073922902494,
                                         593.2360997732425,  594.4565986394556,
                                         596.329433106576,   597.5499319727891,
                                         644.6008616780042,  645.9134240362812,
                                         568.1627664399092,  569.3175056689342,
                                         491.4090249433106,  492.4059410430839,
                                         414.33963718820866, 415.17873015873016,
                                         424.75333333333333, 425.59242630385484,
                                         505.5070748299319,  506.50399092970514,
                                         586.576462585034,   587.731201814059,
                                         667.9614965986394,  669.274058956916,
                                         624.169433106576,   625.3899319727892,
                                         627.2627664399093,  628.4832653061225,
                                         677.8675283446712,  679.1800907029478,
                                         597.4294331065759,  598.5841723356009,
                                         516.6756916099773,  517.6726077097505,
                                         435.6063038548753,  436.4453968253968,
                                         479.40948412698407, 480.31187074829927,
                                         570.5084637188208,  571.5805782312924,
                                         661.9468990929705,  663.1887414965986,
                                         753.7247902494331,  755.1363605442176,
                                         704.1480045351473,  705.460566893424,
                                         707.4746712018141,  708.7872335600906,
                                         764.3780442176871,  765.7896145124716,
                                         673.6185204081634,  674.8603628117912,
                                         582.5195408163265,  583.5916553287982,
                                         491.0811054421769,  491.983492063492,
                                         429.1145861678004,  429.9084693877551,
                                         510.64213718820855, 511.5853401360544,
                                         592.468327664399,   593.560850340136,
                                         674.5931575963718,  675.8349999999999,
                                         630.171133786848,   631.325873015873,
                                         633.0978004535148,  634.2525396825397,
                                         683.9654591836735,  685.2073015873015,
                                         602.7365476190477,  603.8290702947845,
                                         521.2089965986395,  522.1521995464852,
                                         439.3828061224489,  440.1766893424036,
                                         376.6496201814059,  377.335,
                                         448.1975793650793,  449.01187074829926,
                                         520.0033616780045,  520.9465646258503,
                                         592.0669671201814,  593.139081632653,
                                         553.0378004535146,  554.034716553288,
                                         555.5644671201813,  556.5613832199546,
                                         600.1583163265306,  601.2304308390022,
                                         528.8681802721088,  529.8113832199547,
                                         457.32022108843535, 458.13451247165534,
                                         385.51443877551026, 386.1998185941043,
                                         322.0145861678005,  322.59146258503404,
                                         383.1747902494331,  383.8601700680272,
                                         444.5520011337868,  445.3458843537415,
                                         506.14621882086163, 507.0486054421768,
                                         472.74800453514734, 473.58709750566896,
                                         474.87467120181407, 475.7137641723356,
                                         512.9566156462586,  513.8590022675736,
                                         452.01341836734696, 452.80730158730154,
                                         390.85321428571433, 391.5385941043084,
                                         329.4760034013606,  330.0528798185941};
  const std::array<int, 4> in_shape = {{3, 10, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.04081632653061224,
                                         0.08163265306122448,
                                         0.12244897959183673,
                                         0.18367346938775508,
                                         0.24489795918367346,
                                         0.32653061224489793,
                                         0.40816326530612246,
                                         0.32653061224489793,
                                         0.40816326530612246,
                                         0.32653061224489793,
                                         0.40816326530612246,
                                         0.32653061224489793,
                                         0.40816326530612246,
                                         0.30612244897959184,
                                         0.36734693877551017,
                                         0.24489795918367346,
                                         0.2857142857142857,
                                         0.14285714285714285,
                                         0.16326530612244897,
                                         0.2040816326530612,
                                         0.24489795918367344,
                                         0.48979591836734687,
                                         0.5714285714285714,
                                         0.8571428571428571,
                                         0.9795918367346937,
                                         1.3061224489795917,
                                         1.4693877551020407,
                                         1.3061224489795917,
                                         1.4693877551020407,
                                         1.3061224489795917,
                                         1.4693877551020407,
                                         1.3061224489795917,
                                         1.4693877551020407,
                                         1.1020408163265305,
                                         1.2244897959183674,
                                         0.8163265306122447,
                                         0.8979591836734693,
                                         0.44897959183673464,
                                         0.4897959183673469,
                                         0.5510204081632653,
                                         0.6122448979591836,
                                         1.2244897959183674,
                                         1.346938775510204,
                                         2.020408163265306,
                                         2.204081632653061,
                                         2.938775510204081,
                                         3.183673469387755,
                                         2.938775510204081,
                                         3.183673469387755,
                                         2.938775510204081,
                                         3.183673469387755,
                                         2.938775510204081,
                                         3.183673469387755,
                                         2.387755102040816,
                                         2.5714285714285716,
                                         1.714285714285714,
                                         1.8367346938775508,
                                         0.9183673469387754,
                                         0.9795918367346939,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         2.2857142857142856,
                                         2.4489795918367347,
                                         3.6734693877551017,
                                         3.918367346938775,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         4.163265306122448,
                                         4.408163265306123,
                                         2.9387755102040813,
                                         3.10204081632653,
                                         1.5510204081632653,
                                         1.6326530612244898,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         2.2857142857142856,
                                         2.4489795918367347,
                                         3.6734693877551017,
                                         3.918367346938775,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         4.163265306122448,
                                         4.408163265306123,
                                         2.9387755102040813,
                                         3.10204081632653,
                                         1.5510204081632653,
                                         1.6326530612244898,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         2.2857142857142856,
                                         2.4489795918367347,
                                         3.6734693877551017,
                                         3.918367346938775,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         4.163265306122448,
                                         4.408163265306123,
                                         2.9387755102040813,
                                         3.10204081632653,
                                         1.5510204081632653,
                                         1.6326530612244898,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         2.2857142857142856,
                                         2.4489795918367347,
                                         3.6734693877551017,
                                         3.918367346938775,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         5.224489795918366,
                                         5.551020408163265,
                                         4.163265306122448,
                                         4.408163265306123,
                                         2.9387755102040813,
                                         3.10204081632653,
                                         1.5510204081632653,
                                         1.6326530612244898,
                                         1.0408163265306123,
                                         1.1020408163265305,
                                         2.204081632653061,
                                         2.3265306122448974,
                                         3.4897959183673466,
                                         3.6734693877551012,
                                         4.897959183673469,
                                         5.142857142857142,
                                         4.897959183673469,
                                         5.142857142857142,
                                         4.897959183673469,
                                         5.142857142857142,
                                         4.897959183673469,
                                         5.142857142857142,
                                         3.857142857142857,
                                         4.040816326530612,
                                         2.693877551020408,
                                         2.8163265306122445,
                                         1.4081632653061225,
                                         1.4693877551020407,
                                         0.8571428571428572,
                                         0.8979591836734693,
                                         1.7959183673469385,
                                         1.8775510204081631,
                                         2.816326530612245,
                                         2.9387755102040813,
                                         3.9183673469387754,
                                         4.081632653061225,
                                         3.9183673469387754,
                                         4.081632653061225,
                                         3.9183673469387754,
                                         4.081632653061225,
                                         3.9183673469387754,
                                         4.081632653061225,
                                         3.061224489795918,
                                         3.1836734693877546,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         1.1020408163265305,
                                         1.1428571428571428,
                                         0.5102040816326531,
                                         0.5306122448979591,
                                         1.0612244897959182,
                                         1.1020408163265305,
                                         1.6530612244897958,
                                         1.714285714285714,
                                         2.2857142857142856,
                                         2.3673469387755097,
                                         2.2857142857142856,
                                         2.3673469387755097,
                                         2.2857142857142856,
                                         2.3673469387755097,
                                         2.2857142857142856,
                                         2.3673469387755097,
                                         1.7755102040816326,
                                         1.8367346938775508,
                                         1.2244897959183674,
                                         1.2653061224489794,
                                         0.6326530612244897,
                                         0.6530612244897959,
                                         0.673469387755102,
                                         0.6938775510204082,
                                         1.387755102040816,
                                         1.4285714285714284,
                                         2.1428571428571423,
                                         2.204081632653061,
                                         2.938775510204081,
                                         3.020408163265306,
                                         2.938775510204081,
                                         3.020408163265306,
                                         2.938775510204081,
                                         3.020408163265306,
                                         2.938775510204081,
                                         3.020408163265306,
                                         2.265306122448979,
                                         2.326530612244898,
                                         1.5510204081632653,
                                         1.5918367346938775,
                                         0.7959183673469387,
                                         0.8163265306122448,
                                         1.510204081632653,
                                         1.5510204081632653,
                                         3.10204081632653,
                                         3.183673469387755,
                                         4.775510204081632,
                                         4.897959183673469,
                                         6.5306122448979576,
                                         6.693877551020408,
                                         6.5306122448979576,
                                         6.693877551020408,
                                         6.5306122448979576,
                                         6.693877551020408,
                                         6.5306122448979576,
                                         6.693877551020408,
                                         5.020408163265305,
                                         5.142857142857142,
                                         3.4285714285714284,
                                         3.5102040816326534,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         2.510204081632653,
                                         2.571428571428571,
                                         5.1428571428571415,
                                         5.26530612244898,
                                         7.897959183673469,
                                         8.081632653061224,
                                         10.77551020408163,
                                         11.020408163265305,
                                         10.77551020408163,
                                         11.020408163265305,
                                         10.77551020408163,
                                         11.020408163265305,
                                         10.77551020408163,
                                         11.020408163265305,
                                         8.265306122448978,
                                         8.448979591836734,
                                         5.632653061224489,
                                         5.755102040816327,
                                         2.8775510204081627,
                                         2.9387755102040813,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         7.510204081632652,
                                         7.673469387755102,
                                         11.51020408163265,
                                         11.755102040816327,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         11.999999999999996,
                                         12.244897959183673,
                                         8.163265306122447,
                                         8.326530612244898,
                                         4.163265306122448,
                                         4.244897959183673,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         7.510204081632652,
                                         7.673469387755102,
                                         11.51020408163265,
                                         11.755102040816327,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         11.999999999999996,
                                         12.244897959183673,
                                         8.163265306122447,
                                         8.326530612244898,
                                         4.163265306122448,
                                         4.244897959183673,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         7.510204081632652,
                                         7.673469387755102,
                                         11.51020408163265,
                                         11.755102040816327,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         11.999999999999996,
                                         12.244897959183673,
                                         8.163265306122447,
                                         8.326530612244898,
                                         4.163265306122448,
                                         4.244897959183673,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         7.510204081632652,
                                         7.673469387755102,
                                         11.51020408163265,
                                         11.755102040816327,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         15.673469387755098,
                                         16.,
                                         11.999999999999996,
                                         12.244897959183673,
                                         8.163265306122447,
                                         8.326530612244898,
                                         4.163265306122448,
                                         4.244897959183673,
                                         3.,
                                         3.061224489795918,
                                         6.122448979591836,
                                         6.244897959183672,
                                         9.36734693877551,
                                         9.551020408163264,
                                         12.734693877551017,
                                         12.979591836734691,
                                         12.734693877551017,
                                         12.979591836734691,
                                         12.734693877551017,
                                         12.979591836734691,
                                         12.734693877551017,
                                         12.979591836734691,
                                         9.73469387755102,
                                         9.918367346938773,
                                         6.612244897959182,
                                         6.73469387755102,
                                         3.36734693877551,
                                         3.428571428571428,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         4.408163265306122,
                                         4.489795918367347,
                                         6.73469387755102,
                                         6.857142857142857,
                                         9.142857142857142,
                                         9.306122448979592,
                                         9.142857142857142,
                                         9.306122448979592,
                                         9.142857142857142,
                                         9.306122448979592,
                                         9.142857142857142,
                                         9.306122448979592,
                                         6.979591836734692,
                                         7.10204081632653,
                                         4.73469387755102,
                                         4.816326530612244,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         1.163265306122449,
                                         1.183673469387755,
                                         2.36734693877551,
                                         2.408163265306122,
                                         3.6122448979591835,
                                         3.6734693877551017,
                                         4.8979591836734695,
                                         4.979591836734693,
                                         4.8979591836734695,
                                         4.979591836734693,
                                         4.8979591836734695,
                                         4.979591836734693,
                                         4.8979591836734695,
                                         4.979591836734693,
                                         3.7346938775510203,
                                         3.795918367346938,
                                         2.530612244897959,
                                         2.571428571428571,
                                         1.2857142857142856,
                                         1.3061224489795917,
                                         1.3265306122448979,
                                         1.346938775510204,
                                         2.693877551020408,
                                         2.7346938775510203,
                                         4.1020408163265305,
                                         4.163265306122449,
                                         5.551020408163265,
                                         5.63265306122449,
                                         5.551020408163265,
                                         5.63265306122449,
                                         5.551020408163265,
                                         5.63265306122449,
                                         5.551020408163265,
                                         5.63265306122449,
                                         4.224489795918367,
                                         4.285714285714286,
                                         2.8571428571428568,
                                         2.897959183673469,
                                         1.4489795918367345,
                                         1.4693877551020407,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         5.714285714285714,
                                         5.795918367346938,
                                         8.693877551020408,
                                         8.816326530612244,
                                         11.755102040816325,
                                         11.918367346938775,
                                         11.755102040816325,
                                         11.918367346938775,
                                         11.755102040816325,
                                         11.918367346938775,
                                         11.755102040816325,
                                         11.918367346938775,
                                         8.938775510204081,
                                         9.061224489795917,
                                         6.040816326530612,
                                         6.122448979591836,
                                         3.0612244897959178,
                                         3.1020408163265305,
                                         4.469387755102041,
                                         4.530612244897958,
                                         9.061224489795919,
                                         9.183673469387754,
                                         13.775510204081632,
                                         13.959183673469386,
                                         18.612244897959187,
                                         18.857142857142854,
                                         18.612244897959187,
                                         18.857142857142854,
                                         18.612244897959187,
                                         18.857142857142854,
                                         18.612244897959187,
                                         18.857142857142854,
                                         14.142857142857142,
                                         14.326530612244897,
                                         9.551020408163264,
                                         9.673469387755102,
                                         4.83673469387755,
                                         4.8979591836734695,
                                         6.285714285714286,
                                         6.367346938775509,
                                         12.73469387755102,
                                         12.897959183673468,
                                         19.3469387755102,
                                         19.591836734693878,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         19.83673469387755,
                                         20.081632653061224,
                                         13.387755102040815,
                                         13.551020408163266,
                                         6.775510204081631,
                                         6.857142857142858,
                                         6.285714285714286,
                                         6.367346938775509,
                                         12.73469387755102,
                                         12.897959183673468,
                                         19.3469387755102,
                                         19.591836734693878,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         19.83673469387755,
                                         20.081632653061224,
                                         13.387755102040815,
                                         13.551020408163266,
                                         6.775510204081631,
                                         6.857142857142858,
                                         6.285714285714286,
                                         6.367346938775509,
                                         12.73469387755102,
                                         12.897959183673468,
                                         19.3469387755102,
                                         19.591836734693878,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         19.83673469387755,
                                         20.081632653061224,
                                         13.387755102040815,
                                         13.551020408163266,
                                         6.775510204081631,
                                         6.857142857142858,
                                         6.285714285714286,
                                         6.367346938775509,
                                         12.73469387755102,
                                         12.897959183673468,
                                         19.3469387755102,
                                         19.591836734693878,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         26.122448979591837,
                                         26.448979591836732,
                                         19.83673469387755,
                                         20.081632653061224,
                                         13.387755102040815,
                                         13.551020408163266,
                                         6.775510204081631,
                                         6.857142857142858,
                                         4.959183673469387,
                                         5.020408163265306,
                                         10.040816326530612,
                                         10.163265306122447,
                                         15.244897959183673,
                                         15.428571428571427,
                                         20.571428571428566,
                                         20.816326530612244,
                                         20.571428571428566,
                                         20.816326530612244,
                                         20.571428571428566,
                                         20.816326530612244,
                                         20.571428571428566,
                                         20.816326530612244,
                                         15.612244897959183,
                                         15.795918367346937,
                                         10.530612244897958,
                                         10.653061224489795,
                                         5.326530612244897,
                                         5.387755102040815,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         7.020408163265305,
                                         7.1020408163265305,
                                         10.653061224489795,
                                         10.77551020408163,
                                         14.367346938775508,
                                         14.530612244897958,
                                         14.367346938775508,
                                         14.530612244897958,
                                         14.367346938775508,
                                         14.530612244897958,
                                         14.367346938775508,
                                         14.530612244897958,
                                         10.897959183673468,
                                         11.020408163265307,
                                         7.346938775510203,
                                         7.428571428571429,
                                         3.714285714285714,
                                         3.7551020408163263,
                                         1.8163265306122447,
                                         1.8367346938775508,
                                         3.6734693877551017,
                                         3.714285714285714,
                                         5.571428571428571,
                                         5.63265306122449,
                                         7.5102040816326525,
                                         7.591836734693878,
                                         7.5102040816326525,
                                         7.591836734693878,
                                         7.5102040816326525,
                                         7.591836734693878,
                                         7.5102040816326525,
                                         7.591836734693878,
                                         5.693877551020408,
                                         5.755102040816326,
                                         3.836734693877551,
                                         3.877551020408163,
                                         1.9387755102040816,
                                         1.9591836734693877};
  const std::array<int, 4> in_shape = {{3, 10, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {32.72281746031746,  33.29969387755102,
                                         33.876570294784585, 34.45344671201814,
                                         40.06397392290249,  40.74935374149659,
                                         41.434733560090706, 42.1201133786848,
                                         47.8391439909297,   48.63302721088436,
                                         49.426910430838994, 50.22079365079365,
                                         56.04832766439909,  56.950714285714284,
                                         57.853100907029464, 58.75548752834467,
                                         56.32312925170068,  57.16222222222221,
                                         58.00131519274377,  58.84040816326531,
                                         60.576462585034015, 61.41555555555555,
                                         62.254648526077105, 63.09374149659863,
                                         69.66912131519274,  70.57150793650793,
                                         71.47389455782313,  72.3762811791383,
                                         62.76197845804988,  63.55586167800452,
                                         64.34974489795918,  65.14362811791382,
                                         55.42082199546485,  56.10620181405895,
                                         56.79158163265306,  57.47696145124716,
                                         47.64565192743764,  48.222528344671204,
                                         48.79940476190476,  49.37628117913833,
                                         50.74152494331066,  51.426904761904765,
                                         52.112284580498866, 52.797664399092966,
                                         61.69492630385488,  62.50921768707482,
                                         63.32350907029478,  64.13780045351473,
                                         73.16397392290249,  74.10717687074829,
                                         75.0503798185941,   75.9935827664399,
                                         85.1486678004535,   86.22078231292517,
                                         87.2928968253968,   88.36501133786847,
                                         84.17346938775509,  85.17038548752832,
                                         86.1673015873016,   87.16421768707482,
                                         89.22680272108843,  90.22371882086166,
                                         91.22063492063492,  92.21755102040814,
                                         101.33136621315192, 102.40348072562357,
                                         103.47559523809524, 104.54770975056685,
                                         90.89361111111111,  91.83681405895689,
                                         92.78001700680272,  93.7232199546485,
                                         79.94020975056691,  80.75450113378683,
                                         81.56879251700681,  82.38308390022674,
                                         68.47116213151928,  69.15654195011338,
                                         69.84192176870748,  70.5273015873016,
                                         73.10036848072562,  73.89425170068027,
                                         74.68813492063491,  75.48201814058956,
                                         88.48234126984129,  89.42554421768706,
                                         90.36874716553288,  91.31195011337869,
                                         104.46159297052155, 105.55411564625848,
                                         106.64663832199544, 107.73916099773244,
                                         121.03812358276642, 122.27996598639454,
                                         123.52180839002263, 124.7636507936508,
                                         118.33673469387755, 119.49147392290247,
                                         120.64621315192743, 121.80095238095238,
                                         124.19006802721088, 125.34480725623581,
                                         126.49954648526077, 127.65428571428569,
                                         139.7827267573696,  141.02456916099771,
                                         142.26641156462583, 143.50825396825394,
                                         124.99803287981858, 126.09055555555553,
                                         127.18307823129251, 128.27560090702946,
                                         109.61606009070294, 110.55926303854874,
                                         111.50246598639455, 112.44566893424033,
                                         93.63680839002267,  94.43069160997733,
                                         95.22457482993195,  96.01845804988662,
                                         99.79934807256237,  100.70173469387754,
                                         101.60412131519273, 102.50650793650793,
                                         120.4262188208617,  121.4983333333333,
                                         122.570447845805,   123.64256235827665,
                                         141.73200113378687, 142.97384353741492,
                                         144.21568594104306, 145.4575283446712,
                                         163.71669501133783, 165.12826530612244,
                                         166.539835600907,   167.9514058956916,
                                         158.812925170068,   160.12548752834462,
                                         161.43804988662134, 162.75061224489795,
                                         165.46625850340135, 166.77882086167796,
                                         168.09138321995468, 169.40394557823126,
                                         185.0232029478458,  186.4347732426303,
                                         187.84634353741498, 189.2579138321995,
                                         165.0752437641723,  166.3170861678004,
                                         167.5589285714286,  168.80077097505665,
                                         144.44837301587302, 145.52048752834463,
                                         146.59260204081633, 147.66471655328795,
                                         123.14259070294783, 124.04497732426304,
                                         124.9473639455782,  125.84975056689343,
                                         134.8598639455782,  135.69895691609977,
                                         136.5380498866213,  137.37714285714284,
                                         161.9510204081633,  162.94793650793648,
                                         163.94485260770975, 164.941768707483,
                                         189.67346938775512, 190.82820861678,
                                         191.98294784580497, 193.13768707482993,
                                         218.02721088435374, 219.33977324263032,
                                         220.652335600907,   221.96489795918367,
                                         208.85260770975057, 210.07310657596364,
                                         211.2936054421769,  212.51410430839002,
                                         215.03927437641727, 216.25977324263033,
                                         217.48027210884356, 218.70077097505663,
                                         237.83927437641725, 239.1518367346938,
                                         240.46439909297052, 241.77696145124713,
                                         211.37941043083902, 212.53414965986389,
                                         213.6888888888889,  214.8436281179138,
                                         184.28825396825397, 185.28517006802718,
                                         186.28208616780043, 187.27900226757367,
                                         156.5658049886621,  157.40489795918367,
                                         158.24399092970518, 159.08308390022674,
                                         177.39319727891157, 178.23229024943308,
                                         179.07138321995467, 179.91047619047615,
                                         212.48435374149665, 213.4812698412698,
                                         214.47818594104314, 215.47510204081632,
                                         248.20680272108845, 249.36154195011332,
                                         250.51628117913836, 251.67102040816326,
                                         284.56054421768704, 285.8731065759636,
                                         287.1856689342404,  288.498231292517,
                                         270.7192743764172,  271.93977324263034,
                                         273.16027210884357, 274.3807709750567,
                                         276.90594104308394, 278.126439909297,
                                         279.34693877551024, 280.56743764172336,
                                         304.3726077097506,  305.68517006802716,
                                         306.99773242630386, 308.3102947845805,
                                         269.9127437641723,  271.0674829931972,
                                         272.2222222222222,  273.37696145124715,
                                         234.82158730158727, 235.81850340136052,
                                         236.8154195011337,  237.812335600907,
                                         199.09913832199544, 199.93823129251703,
                                         200.77732426303848, 201.61641723356013,
                                         236.00728458049886, 236.90967120181406,
                                         237.81205782312927, 238.71444444444444,
                                         282.2532029478458,  283.3253174603174,
                                         284.39743197278915, 285.46954648526076,
                                         329.17803287981855, 330.4198752834467,
                                         331.66171768707494, 332.9035600907029,
                                         376.7817743764172,  378.1933446712017,
                                         379.60491496598644, 381.01648526077093,
                                         356.9335600907029,  358.2461224489795,
                                         359.55868480725627, 360.8712471655328,
                                         363.5868934240362,  364.8994557823129,
                                         366.2120181405896,  367.52458049886616,
                                         398.0882823129251,  399.49985260770967,
                                         400.91142290249434, 402.32299319727883,
                                         352.52127551020396, 353.7631179138321,
                                         355.0049603174603,  356.24680272108844,
                                         306.2753571428571,  307.3474716553288,
                                         308.4195861678004,  309.4917006802721,
                                         259.35052721088437, 260.25291383219957,
                                         261.15530045351466, 262.05768707482997,
                                         222.32871315192742, 223.12259637188208,
                                         223.91647959183675, 224.71036281179136,
                                         265.77871315192743, 266.72191609977324,
                                         267.6651190476191,  268.60832199546485,
                                         309.825992063492,   310.91851473922895,
                                         312.01103741496604, 313.1035600907029,
                                         354.47054988662126, 355.7123922902494,
                                         356.9542346938776,  358.1960770975056,
                                         335.3961451247165,  336.5508843537414,
                                         337.70562358276646, 338.86036281179133,
                                         341.2494784580498,  342.4042176870748,
                                         343.55895691609976, 344.7136961451247,
                                         373.2151530612244,  374.4569954648525,
                                         375.6988378684807,  376.9406802721088,
                                         330.36243197278907, 331.45495464852604,
                                         332.547477324263,   333.64,
                                         286.9124319727891,  287.8556349206349,
                                         288.79883786848063, 289.74204081632655,
                                         242.8651530612245,  243.65903628117917,
                                         244.45291950113375, 245.24680272108844,
                                         204.31000566893425, 204.99538548752835,
                                         205.68076530612245, 206.36614512471655,
                                         244.14776077097505, 244.962052154195,
                                         245.77634353741496, 246.59063492063493,
                                         284.50116213151927, 285.44436507936507,
                                         286.38756802721093, 287.3307709750567,
                                         325.3702097505668,  326.44232426303853,
                                         327.5144387755102,  328.5865532879818,
                                         307.54580498866204, 308.5427210884353,
                                         309.53963718820864, 310.5365532879818,
                                         312.5991383219954,  313.59605442176866,
                                         314.59297052154193, 315.58988662131515,
                                         341.5529081632653,  342.62502267573694,
                                         343.69713718820856, 344.76925170068023,
                                         302.23079931972785, 303.17400226757366,
                                         304.11720521541946, 305.0604081632653,
                                         262.3930442176871,  263.207335600907,
                                         264.0216269841269,  264.83591836734695,
                                         222.03964285714287, 222.72502267573697,
                                         223.41040249433104, 224.0957823129252,
                                         181.95116213151928, 182.52803854875287,
                                         183.10491496598638, 183.68179138321995,
                                         217.36034580498867, 218.04572562358277,
                                         218.73110544217687, 219.41648526077097,
                                         253.20354308390023, 253.99742630385487,
                                         254.79130952380953, 255.5851927437642,
                                         289.48075396825396, 290.38314058956917,
                                         291.28552721088437, 292.1879138321995,
                                         273.3825396825397,  274.2216326530612,
                                         275.06072562358275, 275.8998185941043,
                                         277.635873015873,   278.4749659863946,
                                         279.3140589569161,  280.15315192743765,
                                         303.1015476190476,  304.00393424036275,
                                         304.90632086167795, 305.8087074829932,
                                         268.1263775510204,  268.92026077097506,
                                         269.71414399092964, 270.5080272108844,
                                         232.71719387755104, 233.4025736961451,
                                         234.0879535147392,  234.77333333333334,
                                         196.87399659863948, 197.45087301587301,
                                         198.02774943310658, 198.60462585034014,
                                         263.4733843537415,  264.05026077097506,
                                         264.6271371882086,  265.2040136054422,
                                         314.2159013605442,  314.9012811791383,
                                         315.5866609977325,  316.2720408163265,
                                         365.39243197278904, 366.18631519274373,
                                         366.9801984126984,  367.7740816326531,
                                         417.00297619047603, 417.90536281179135,
                                         418.8077494331066,  419.7101360544218,
                                         391.96031746031736, 392.7994104308389,
                                         393.63850340136054, 394.47759637188216,
                                         396.21365079365086, 397.0527437641723,
                                         397.89183673469387, 398.73092970521543,
                                         430.6237698412699,  431.52615646258505,
                                         432.4285430839002,  433.3309297052154,
                                         380.3152664399093,  381.10914965986393,
                                         381.90303287981857, 382.69691609977326,
                                         329.57274943310654, 330.25812925170067,
                                         330.94350907029474, 331.6288888888889,
                                         278.3962188208617,  278.97309523809525,
                                         279.54997165532876, 280.1268480725623,
                                         324.8934523809524,  325.57883219954647,
                                         326.26421201814054, 326.94959183673467,
                                         387.4114795918367,  388.22577097505666,
                                         389.04006235827666, 389.85435374149654,
                                         450.4451530612244,  451.3883560090702,
                                         452.33155895691607, 453.27476190476193,
                                         513.9944727891154,  515.0665873015872,
                                         516.1387018140589,  517.2108163265307,
                                         482.93990929705205, 483.93682539682527,
                                         484.9337414965986,  485.93065759637193,
                                         487.9932426303855,  488.9901587301587,
                                         489.98707482993194, 490.98399092970516,
                                         530.1771712018141,  531.2492857142857,
                                         532.3214002267573,  533.393514739229,
                                         468.17479024943304, 469.1179931972789,
                                         470.0611961451247,  471.0043990929705,
                                         405.65676303854866, 406.4710544217687,
                                         407.28534580498865, 408.09963718820865,
                                         342.623089569161,   343.3084693877551,
                                         343.9938492063492,  344.67922902494325,
                                         390.65365646258505, 391.4475396825396,
                                         392.24142290249426, 393.0353061224489,
                                         465.76352040816323, 466.706723356009,
                                         467.64992630385484, 468.5931292517006,
                                         541.470663265306,   542.5631859410429,
                                         543.65570861678,    544.748231292517,
                                         617.7750850340133,  619.0169274376416,
                                         620.2587698412698,  621.500612244898,
                                         580.2324263038546,  581.3871655328796,
                                         582.5419047619047,  583.6966439909297,
                                         586.0857596371882,  587.2404988662132,
                                         588.395238095238,   589.549977324263,
                                         636.5196882086168,  637.761530612245,
                                         639.0033730158729,  640.245215419501,
                                         562.0071031746031,  563.0996258503402,
                                         564.1921485260771,  565.2846712018141,
                                         486.8972392290249,  487.84044217687074,
                                         488.78364512471654, 489.72684807256235,
                                         411.1900963718821,  411.9839795918367,
                                         412.77786281179135, 413.57174603174593,
                                         460.7539965986395,  461.6563832199546,
                                         462.55876984126974, 463.461156462585,
                                         549.2720238095238,  550.3441383219954,
                                         551.4162528344671,  552.4883673469387,
                                         638.468962585034,   639.710804988662,
                                         640.9526473922901,  642.1944897959183,
                                         728.3448129251698,  729.7563832199545,
                                         731.1679535147391,  732.5795238095238,
                                         683.8378684807254,  685.1504308390021,
                                         686.4629931972788,  687.7755555555556,
                                         690.491201814059,   691.8037641723357,
                                         693.1163265306122,  694.4288888888888,
                                         749.6513208616781,  751.0628911564627,
                                         752.4744614512471,  753.8860317460317,
                                         661.8122052154195,  663.0540476190477,
                                         664.2958900226757,  665.5377324263039,
                                         573.2941780045351,  574.3662925170067,
                                         575.4384070294785,  576.5105215419501,
                                         484.0972392290249,  484.9996258503401,
                                         485.90201247165527, 486.8043990929704,
                                         470.49705215419505, 471.3361451247166,
                                         472.175238095238,   473.0143310657596,
                                         560.7174603174603,  561.7143764172334,
                                         562.7112925170065,  563.7082086167799,
                                         651.5691609977324,  652.7239002267571,
                                         653.878639455782,   655.0333786848068,
                                         743.0521541950114,  744.3647165532878,
                                         745.6772789115645,  746.989841269841,
                                         697.0521541950114,  698.2726530612243,
                                         699.4931519274376,  700.7136507936507,
                                         703.2388208616779,  704.4593197278908,
                                         705.6798185941043,  706.9003174603173,
                                         762.8642176870748,  764.1767800453513,
                                         765.4893424036281,  766.8019047619049,
                                         673.2751020408163,  674.429841269841,
                                         675.5845804988662,  676.739319727891,
                                         583.054693877551,   584.0516099773241,
                                         585.0485260770976,  586.0454421768707,
                                         492.2029931972789,  493.04208616780045,
                                         493.88117913832195, 494.7202721088434,
                                         513.0303854875284,  513.8694784580499,
                                         514.7085714285713,  515.547664399093,
                                         611.2507936507935,  612.2477097505669,
                                         613.2446258503402,  614.2415419501134,
                                         710.1024943310656,  711.2572335600906,
                                         712.4119727891156,  713.5667120181405,
                                         809.5854875283447,  810.8980498866212,
                                         812.2106122448979,  813.5231746031744,
                                         758.918820861678,   760.139319727891,
                                         761.3598185941042,  762.5803174603175,
                                         765.1054875283447,  766.3259863945577,
                                         767.5464852607711,  768.7669841269842,
                                         829.3975510204083,  830.7101133786845,
                                         832.0226757369616,  833.3352380952382,
                                         731.8084353741498,  732.9631746031744,
                                         734.1179138321997,  735.2726530612246,
                                         633.5880272108844,  634.5849433106575,
                                         635.5818594104309,  636.5787755102041,
                                         534.7363265306122,  535.5754195011338,
                                         536.4145124716553,  537.2536054421769,
                                         596.961933106576,   597.8643197278911,
                                         598.7667063492063,  599.6690929705214,
                                         711.099007936508,   712.1711224489796,
                                         713.2432369614512,  714.3153514739229,
                                         825.9149943310657,  827.156836734694,
                                         828.3986791383219,  829.64052154195,
                                         941.4098922902494,  942.821462585034,
                                         944.2330328798186,  945.6446031746033,
                                         881.9585034013606,  883.2710657596372,
                                         884.5836281179138,  885.8961904761904,
                                         888.611836734694,   889.9243990929705,
                                         891.2369614512472,  892.5495238095239,
                                         962.7164002267575,  964.1279705215418,
                                         965.5395408163266,  966.951111111111,
                                         849.2582369614513,  850.5000793650794,
                                         851.7419217687075,  852.9837641723357,
                                         735.1211621315193,  736.1932766439909,
                                         737.2653911564626,  738.3375056689341,
                                         620.3051757369614,  621.2075623582766,
                                         622.1099489795918,  623.012335600907,
                                         539.8820011337868,  540.6758843537415,
                                         541.4697675736962,  542.2636507936506,
                                         643.0598922902494,  644.0030952380953,
                                         644.946298185941,   645.8895011337867,
                                         746.8350623582766,  747.9275850340138,
                                         749.0201077097505,  750.1126303854874,
                                         851.2075113378685,  852.4493537414966,
                                         853.6911961451246,  854.9330385487528,
                                         797.2918367346939,  798.4465759637187,
                                         799.6013151927438,  800.7560544217687,
                                         803.1451700680273,  804.2999092970522,
                                         805.4546485260771,  806.6093877551019,
                                         869.9521145124718,  871.1939569160998,
                                         872.435799319728,   873.6776417233559,
                                         767.3715022675736,  768.4640249433106,
                                         769.5565476190477,  770.6490702947846,
                                         664.1936111111111,  665.1368140589569,
                                         666.0800170068026,  667.0232199546484,
                                         560.4184410430838,  561.2123242630386,
                                         562.0062074829931,  562.8000907029478,
                                         478.46193310657594, 479.1473129251701,
                                         479.83269274376414, 480.51807256235827,
                                         569.864314058957,   570.678605442177,
                                         571.4928968253969,  572.3071882086167,
                                         661.7823412698413,  662.7255442176871,
                                         663.6687471655329,  664.6119501133786,
                                         754.2160147392291,  755.2881292517008,
                                         756.3602437641723,  757.4323582766439,
                                         706.3122448979591,  707.3091609977324,
                                         708.3060770975056,  709.3029931972789,
                                         711.3655782312925,  712.3624943310658,
                                         713.3594104308388,  714.356326530612,
                                         770.3987131519274,  771.4708276643992,
                                         772.5429421768706,  773.6150566893423,
                                         679.51197845805,    680.4551814058957,
                                         681.3983843537414,  682.3415873015872,
                                         588.109597505669,   588.9238888888889,
                                         589.7381802721088,  590.5524716553288,
                                         496.1915702947846,  496.87695011337865,
                                         497.5623299319727,  498.2477097505669,
                                         412.7017290249433,  413.27860544217685,
                                         413.8554818594105,  414.432358276644,
                                         491.5122732426304,  492.1976530612245,
                                         492.8830328798186,  493.5684126984127,
                                         570.7568310657597,  571.5507142857143,
                                         572.3445975056688,  573.1384807256236,
                                         650.4354024943311,  651.3377891156463,
                                         652.2401757369614,  653.1425623582766,
                                         609.0197278911564,  609.8588208616779,
                                         610.6979138321996,  611.5370068027211,
                                         613.2730612244898,  614.1121541950113,
                                         614.9512471655329,  615.7903401360543,
                                         664.0561961451247,  664.9585827664399,
                                         665.8609693877551,  666.7633560090702,
                                         585.6796655328798,  586.4735487528345,
                                         587.2674319727889,  588.0613151927437,
                                         506.86912131519273, 507.5545011337868,
                                         508.23988095238093, 508.9252607709751,
                                         427.62456349206354, 428.20143990929705,
                                         428.77831632653056, 429.3551927437642,
                                         494.2239512471655,  494.8008276643991,
                                         495.37770408163266, 495.9545804988662,
                                         588.3678287981859,  589.05320861678,
                                         589.7385884353741,  590.4239682539682,
                                         682.9457199546484,  683.739603174603,
                                         684.5334863945576,  685.3273696145123,
                                         777.9576247165531,  778.8600113378683,
                                         779.7623979591835,  780.6647845804989,
                                         727.5975056689341,  728.4365986394557,
                                         729.2756916099771,  730.1147845804987,
                                         731.8508390022674,  732.689931972789,
                                         733.5290249433106,  734.3681179138322,
                                         791.5784183673468,  792.480804988662,
                                         793.3831916099772,  794.2855782312926,
                                         697.8685544217686,  698.6624376417232,
                                         699.4563208616779,  700.2502040816327,
                                         603.7246768707483,  604.4100566893422,
                                         605.0954365079365,  605.7808163265306,
                                         509.14678571428567, 509.7236621315192,
                                         510.3005385487528,  510.8774149659863,
                                         599.045379818594,   599.7307596371883,
                                         600.4161394557823,  601.1015192743764,
                                         713.1280328798185,  713.9423242630386,
                                         714.7566156462584,  715.5709070294783,
                                         827.7263321995464,  828.6695351473921,
                                         829.6127380952378,  830.5559410430837,
                                         942.8402777777776,  943.9123922902493,
                                         944.9845068027208,  946.0566213151927,
                                         881.706349206349,   882.7032653061224,
                                         883.7001814058954,  884.6970975056687,
                                         886.7596825396824,  887.7565986394557,
                                         888.7535147392289,  889.7504308390021,
                                         959.0229761904761,  960.0950907029477,
                                         961.1672052154194,  962.239319727891,
                                         845.4559693877551,  846.3991723356006,
                                         847.3423752834466,  848.2855782312923,
                                         731.3733163265307,  732.1876077097503,
                                         733.0018990929705,  733.8161904761904,
                                         616.7750170068027,  617.4603968253966,
                                         618.1457766439909,  618.8311564625848,
                                         708.2069444444443,  709.0008276643991,
                                         709.7947108843537,  710.5885941043083,
                                         843.0446995464852,  843.9879024943311,
                                         844.9311054421768,  845.8743083900225,
                                         978.4797335600906,  979.5722562358276,
                                         980.6647789115643,  981.7573015873014,
                                         1114.5120464852607, 1115.753888888889,
                                         1116.995731292517,  1118.2375736961453,
                                         1042.128117913832,  1043.2828571428572,
                                         1044.437596371882,  1045.5923356009068,
                                         1047.9814512471655, 1049.1361904761904,
                                         1050.2909297052154, 1051.44566893424,
                                         1133.2566496598638, 1134.4984920634922,
                                         1135.7403344671202, 1136.9821768707482,
                                         999.0161734693878,  1000.1086961451244,
                                         1001.2012188208616, 1002.2937414965985,
                                         864.1784183673471,  865.1216213151924,
                                         866.0648242630385,  867.0080272108843,
                                         728.7433843537416,  729.5372675736959,
                                         730.3311507936507,  731.1250340136052,
                                         821.7086451247164,  822.6110317460317,
                                         823.5134183673468,  824.4158049886621,
                                         978.1178287981859,  979.1899433106576,
                                         980.2620578231291,  981.3341723356008,
                                         1135.205924036281,  1136.4477664399092,
                                         1137.6896088435376, 1138.9314512471656,
                                         1292.9729308390022, 1294.3845011337871,
                                         1295.7960714285718, 1297.2076417233563,
                                         1208.8628117913831, 1210.17537414966,
                                         1211.4879365079369, 1212.8004988662133,
                                         1215.5161451247166, 1216.8287074829932,
                                         1218.1412698412703, 1219.4538321995467,
                                         1314.2794387755102, 1315.691009070295,
                                         1317.1025793650797, 1318.5141496598644,
                                         1158.549166666667,  1159.7910090702944,
                                         1161.0328514739228, 1162.2746938775513,
                                         1002.1399829931973, 1003.2120975056686,
                                         1004.2842120181406, 1005.3563265306121,
                                         845.051887755102,   845.954274376417,
                                         846.8566609977324,  847.7590476190474,
                                         806.1342403628116,  806.9733333333334,
                                         807.8124263038546,  808.6515192743764,
                                         959.483900226757,   960.4808163265307,
                                         961.4777324263038,  962.4746485260771,
                                         1113.4648526077099, 1114.6195918367346,
                                         1115.7743310657597, 1116.9290702947844,
                                         1268.0770975056694, 1269.3896598639456,
                                         1270.7022222222224, 1272.0147845804988,
                                         1185.2517006802723, 1186.472199546485,
                                         1187.6926984126985, 1188.9131972789112,
                                         1191.4383673469388, 1192.658866213152,
                                         1193.8793650793652, 1195.0998639455781,
                                         1287.889160997733,  1289.2017233560084,
                                         1290.514285714286,  1291.8268480725624,
                                         1135.1707936507935, 1136.3255328798184,
                                         1137.4802721088436, 1138.6350113378685,
                                         981.8211337868479,  982.8180498866212,
                                         983.8149659863947,  984.8118820861678,
                                         827.8401814058956,  828.6792743764173,
                                         829.5183673469388,  830.3574603174603,
                                         848.6675736961449,  849.5066666666667,
                                         850.3457596371883,  851.1848526077097,
                                         1010.0172335600905, 1011.0141496598638,
                                         1012.0110657596372, 1013.0079818594103,
                                         1171.998185941043,  1173.152925170068,
                                         1174.3076643990928, 1175.462403628118,
                                         1334.610430839002,  1335.9229931972789,
                                         1337.2355555555555, 1338.548117913832,
                                         1247.1183673469386, 1248.338866213152,
                                         1249.5593650793646, 1250.7798639455784,
                                         1253.305034013605,  1254.5255328798187,
                                         1255.7460317460313, 1256.966530612245,
                                         1354.4224943310653, 1355.7350566893424,
                                         1357.047619047619,  1358.3601814058957,
                                         1193.7041269841266, 1194.8588662131517,
                                         1196.0136054421766, 1197.1683446712018,
                                         1032.3544671201812, 1033.3513832199546,
                                         1034.3482993197279, 1035.345215419501,
                                         870.373514739229,   871.2126077097506,
                                         872.0517006802721,  872.8907936507936,
                                         957.916581632653,   958.8189682539681,
                                         959.7213548752835,  960.6237414965985,
                                         1139.9448129251698, 1141.0169274376417,
                                         1142.0890419501134, 1143.1611564625848,
                                         1322.6519557823124, 1323.893798185941,
                                         1325.135640589569,  1326.3774829931972,
                                         1506.0380102040813, 1507.4495804988662,
                                         1508.8611507936507, 1510.2727210884352,
                                         1406.9834467120177, 1408.2960090702945,
                                         1409.6085714285714, 1410.921133786848,
                                         1413.6367800453513, 1414.9493424036282,
                                         1416.2619047619048, 1417.5744671201812,
                                         1527.3445181405891, 1528.7560884353743,
                                         1530.1676587301586, 1531.5792290249433,
                                         1345.9951984126983, 1347.2370408163267,
                                         1348.4788832199545, 1349.7207256235824,
                                         1163.9669671201814, 1165.039081632653,
                                         1166.1111961451247, 1167.1833106575964,
                                         981.2598242630384,  982.1622108843538,
                                         983.0645975056689,  983.966984126984,
                                         857.4352891156462,  858.2291723356008,
                                         859.0230555555555,  859.8169387755102,
                                         1020.3410714285715, 1021.2842743764171,
                                         1022.2274773242631, 1023.1706802721088,
                                         1183.8441326530608, 1184.936655328798,
                                         1186.029178004535,  1187.121700680272,
                                         1347.9444727891153, 1349.1863151927437,
                                         1350.428157596372,  1351.6699999999998,
                                         1259.1875283446711, 1260.342267573696,
                                         1261.4970068027212, 1262.651746031746,
                                         1265.0408616780046, 1266.1956009070295,
                                         1267.3503401360545, 1268.5050793650794,
                                         1366.6890759637188, 1367.930918367347,
                                         1369.1727607709752, 1370.414603174603,
                                         1204.3805725623583, 1205.4730952380953,
                                         1206.5656179138323, 1207.658140589569,
                                         1041.474790249433,  1042.417993197279,
                                         1043.3611961451247, 1044.3043990929705,
                                         877.9717290249432,  878.7656122448979,
                                         879.5594954648527,  880.3533786848072,
                                         752.6138605442177,  753.2992403628118,
                                         753.9846201814058,  754.67,
                                         895.5808673469388,  896.3951587301586,
                                         897.2094501133787,  898.0237414965985,
                                         1039.0635204081634, 1040.006723356009,
                                         1040.9499263038551, 1041.8931292517007,
                                         1183.0618197278911, 1184.1339342403628,
                                         1185.2060487528345, 1186.278163265306,
                                         1105.0786848072564, 1106.0756009070292,
                                         1107.0725170068029, 1108.069433106576,
                                         1110.1320181405895, 1111.1289342403627,
                                         1112.125850340136,  1113.1227664399091,
                                         1199.2445181405894, 1200.316632653061,
                                         1201.388747165533,  1202.4608616780044,
                                         1056.7931575963719, 1057.7363605442176,
                                         1058.6795634920636, 1059.6227664399094,
                                         913.8261507936508,  914.6404421768707,
                                         915.4547335600907,  916.2690249433107,
                                         770.3434977324263,  771.0288775510205,
                                         771.7142573696144,  772.3996371882085,
                                         643.4522959183673,  644.029172335601,
                                         644.6060487528343,  645.1829251700681,
                                         765.6642006802721,  766.3495804988662,
                                         767.0349603174603,  767.7203401360543,
                                         888.3101190476191,  889.1040022675736,
                                         889.8978854875282,  890.691768707483,
                                         1011.3900510204082, 1012.2924376417233,
                                         1013.1948242630385, 1014.0972108843536,
                                         944.6569160997732,  945.4960090702947,
                                         946.3351020408162,  947.1741950113379,
                                         948.9102494331065,  949.7493424036281,
                                         950.5884353741495,  951.4275283446711,
                                         1025.0108446712018, 1025.9132312925171,
                                         1026.8156179138323, 1027.7180045351472,
                                         903.2329535147393,  904.0268367346939,
                                         904.8207199546486,  905.6146031746031,
                                         781.0210487528344,  781.7064285714287,
                                         782.3918083900226,  783.0771882086168,
                                         658.3751303854875,  658.9520068027211,
                                         659.5288832199547,  660.1057596371882};
  const std::array<int, 4> in_shape = {{3, 10, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612,
                                         0.04081632653061224,
                                         0.061224489795918366,
                                         0.08163265306122448,
                                         0.12244897959183672,
                                         0.16326530612244897,
                                         0.20408163265306123,
                                         0.24489795918367346,
                                         0.3061224489795918,
                                         0.36734693877551017,
                                         0.42857142857142855,
                                         0.4897959183673469,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5714285714285714,
                                         0.6530612244897959,
                                         0.7346938775510203,
                                         0.8163265306122449,
                                         0.5510204081632653,
                                         0.6122448979591837,
                                         0.6734693877551019,
                                         0.7346938775510203,
                                         0.44897959183673464,
                                         0.4897959183673469,
                                         0.5306122448979591,
                                         0.5714285714285714,
                                         0.26530612244897955,
                                         0.2857142857142857,
                                         0.3061224489795918,
                                         0.32653061224489793,
                                         0.3673469387755102,
                                         0.4081632653061224,
                                         0.4489795918367347,
                                         0.48979591836734687,
                                         0.8979591836734693,
                                         0.9795918367346937,
                                         1.0612244897959182,
                                         1.1428571428571428,
                                         1.5918367346938775,
                                         1.7142857142857142,
                                         1.8367346938775508,
                                         1.9591836734693875,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.4489795918367347,
                                         2.6122448979591835,
                                         2.7755102040816326,
                                         2.9387755102040813,
                                         2.0816326530612246,
                                         2.204081632653061,
                                         2.326530612244898,
                                         2.4489795918367347,
                                         1.5510204081632653,
                                         1.6326530612244894,
                                         1.714285714285714,
                                         1.7959183673469385,
                                         0.8571428571428571,
                                         0.8979591836734693,
                                         0.9387755102040816,
                                         0.9795918367346939,
                                         1.0408163265306123,
                                         1.1020408163265305,
                                         1.163265306122449,
                                         1.2244897959183672,
                                         2.3265306122448974,
                                         2.4489795918367347,
                                         2.571428571428571,
                                         2.693877551020408,
                                         3.8571428571428568,
                                         4.040816326530612,
                                         4.224489795918367,
                                         4.408163265306122,
                                         5.63265306122449,
                                         5.877551020408162,
                                         6.122448979591837,
                                         6.36734693877551,
                                         5.63265306122449,
                                         5.877551020408162,
                                         6.122448979591837,
                                         6.36734693877551,
                                         5.63265306122449,
                                         5.877551020408162,
                                         6.122448979591837,
                                         6.36734693877551,
                                         5.63265306122449,
                                         5.877551020408162,
                                         6.122448979591837,
                                         6.36734693877551,
                                         4.591836734693877,
                                         4.775510204081632,
                                         4.959183673469387,
                                         5.142857142857143,
                                         3.3061224489795915,
                                         3.428571428571428,
                                         3.551020408163265,
                                         3.6734693877551017,
                                         1.7755102040816326,
                                         1.8367346938775508,
                                         1.8979591836734693,
                                         1.9591836734693877,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         4.408163265306122,
                                         4.571428571428571,
                                         4.7346938775510194,
                                         4.8979591836734695,
                                         7.1020408163265305,
                                         7.346938775510203,
                                         7.591836734693876,
                                         7.83673469387755,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         8.081632653061224,
                                         8.326530612244897,
                                         8.57142857142857,
                                         8.816326530612246,
                                         5.7142857142857135,
                                         5.877551020408163,
                                         6.040816326530612,
                                         6.20408163265306,
                                         3.020408163265306,
                                         3.1020408163265305,
                                         3.183673469387755,
                                         3.2653061224489797,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         4.408163265306122,
                                         4.571428571428571,
                                         4.7346938775510194,
                                         4.8979591836734695,
                                         7.1020408163265305,
                                         7.346938775510203,
                                         7.591836734693876,
                                         7.83673469387755,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         8.081632653061224,
                                         8.326530612244897,
                                         8.57142857142857,
                                         8.816326530612246,
                                         5.7142857142857135,
                                         5.877551020408163,
                                         6.040816326530612,
                                         6.20408163265306,
                                         3.020408163265306,
                                         3.1020408163265305,
                                         3.183673469387755,
                                         3.2653061224489797,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         4.408163265306122,
                                         4.571428571428571,
                                         4.7346938775510194,
                                         4.8979591836734695,
                                         7.1020408163265305,
                                         7.346938775510203,
                                         7.591836734693876,
                                         7.83673469387755,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         8.081632653061224,
                                         8.326530612244897,
                                         8.57142857142857,
                                         8.816326530612246,
                                         5.7142857142857135,
                                         5.877551020408163,
                                         6.040816326530612,
                                         6.20408163265306,
                                         3.020408163265306,
                                         3.1020408163265305,
                                         3.183673469387755,
                                         3.2653061224489797,
                                         2.0408163265306123,
                                         2.1224489795918364,
                                         2.204081632653061,
                                         2.2857142857142856,
                                         4.408163265306122,
                                         4.571428571428571,
                                         4.7346938775510194,
                                         4.8979591836734695,
                                         7.1020408163265305,
                                         7.346938775510203,
                                         7.591836734693876,
                                         7.83673469387755,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         10.122448979591836,
                                         10.448979591836732,
                                         10.775510204081634,
                                         11.10204081632653,
                                         8.081632653061224,
                                         8.326530612244897,
                                         8.57142857142857,
                                         8.816326530612246,
                                         5.7142857142857135,
                                         5.877551020408163,
                                         6.040816326530612,
                                         6.20408163265306,
                                         3.020408163265306,
                                         3.1020408163265305,
                                         3.183673469387755,
                                         3.2653061224489797,
                                         2.020408163265306,
                                         2.0816326530612246,
                                         2.1428571428571423,
                                         2.204081632653061,
                                         4.285714285714286,
                                         4.408163265306122,
                                         4.530612244897958,
                                         4.653061224489795,
                                         6.795918367346939,
                                         6.979591836734693,
                                         7.163265306122447,
                                         7.3469387755102025,
                                         9.551020408163264,
                                         9.795918367346937,
                                         10.04081632653061,
                                         10.285714285714285,
                                         9.551020408163264,
                                         9.795918367346937,
                                         10.04081632653061,
                                         10.285714285714285,
                                         9.551020408163264,
                                         9.795918367346937,
                                         10.04081632653061,
                                         10.285714285714285,
                                         9.551020408163264,
                                         9.795918367346937,
                                         10.04081632653061,
                                         10.285714285714285,
                                         7.530612244897959,
                                         7.714285714285714,
                                         7.897959183673468,
                                         8.081632653061224,
                                         5.26530612244898,
                                         5.387755102040816,
                                         5.5102040816326525,
                                         5.632653061224489,
                                         2.7551020408163263,
                                         2.816326530612245,
                                         2.877551020408163,
                                         2.9387755102040813,
                                         1.673469387755102,
                                         1.7142857142857144,
                                         1.7551020408163263,
                                         1.7959183673469385,
                                         3.5102040816326525,
                                         3.591836734693877,
                                         3.6734693877551017,
                                         3.7551020408163263,
                                         5.5102040816326525,
                                         5.63265306122449,
                                         5.755102040816325,
                                         5.877551020408163,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         7.673469387755102,
                                         7.836734693877551,
                                         7.999999999999999,
                                         8.16326530612245,
                                         6.,
                                         6.122448979591836,
                                         6.244897959183673,
                                         6.367346938775509,
                                         4.163265306122449,
                                         4.244897959183673,
                                         4.326530612244897,
                                         4.408163265306122,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         2.2448979591836733,
                                         2.2857142857142856,
                                         0.9999999999999999,
                                         1.0204081632653061,
                                         1.040816326530612,
                                         1.0612244897959182,
                                         2.081632653061224,
                                         2.1224489795918364,
                                         2.1632653061224487,
                                         2.204081632653061,
                                         3.244897959183673,
                                         3.3061224489795915,
                                         3.36734693877551,
                                         3.428571428571428,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         4.489795918367346,
                                         4.571428571428571,
                                         4.653061224489796,
                                         4.7346938775510194,
                                         3.4897959183673466,
                                         3.5510204081632653,
                                         3.6122448979591835,
                                         3.6734693877551017,
                                         2.408163265306122,
                                         2.4489795918367347,
                                         2.4897959183673466,
                                         2.530612244897959,
                                         1.2448979591836733,
                                         1.2653061224489794,
                                         1.2857142857142856,
                                         1.3061224489795917,
                                         1.3265306122448979,
                                         1.346938775510204,
                                         1.3673469387755102,
                                         1.3877551020408163,
                                         2.7346938775510203,
                                         2.775510204081632,
                                         2.816326530612245,
                                         2.8571428571428568,
                                         4.224489795918367,
                                         4.285714285714285,
                                         4.346938775510204,
                                         4.408163265306122,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         5.795918367346938,
                                         5.877551020408162,
                                         5.959183673469388,
                                         6.040816326530612,
                                         4.469387755102041,
                                         4.530612244897958,
                                         4.591836734693877,
                                         4.653061224489796,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         3.1428571428571423,
                                         3.183673469387755,
                                         1.5714285714285714,
                                         1.5918367346938773,
                                         1.6122448979591835,
                                         1.6326530612244896,
                                         2.9795918367346936,
                                         3.020408163265306,
                                         3.061224489795918,
                                         3.1020408163265305,
                                         6.122448979591836,
                                         6.20408163265306,
                                         6.285714285714285,
                                         6.36734693877551,
                                         9.428571428571427,
                                         9.551020408163264,
                                         9.673469387755102,
                                         9.795918367346937,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         12.897959183673468,
                                         13.061224489795915,
                                         13.224489795918368,
                                         13.387755102040815,
                                         9.918367346938775,
                                         10.04081632653061,
                                         10.163265306122447,
                                         10.285714285714285,
                                         6.775510204081632,
                                         6.857142857142857,
                                         6.9387755102040805,
                                         7.020408163265307,
                                         3.4693877551020407,
                                         3.5102040816326525,
                                         3.5510204081632653,
                                         3.591836734693877,
                                         4.959183673469387,
                                         5.020408163265306,
                                         5.081632653061224,
                                         5.142857142857142,
                                         10.16326530612245,
                                         10.285714285714283,
                                         10.40816326530612,
                                         10.53061224489796,
                                         15.612244897959181,
                                         15.795918367346937,
                                         15.979591836734691,
                                         16.163265306122447,
                                         21.306122448979586,
                                         21.55102040816326,
                                         21.79591836734694,
                                         22.04081632653061,
                                         21.306122448979586,
                                         21.55102040816326,
                                         21.79591836734694,
                                         22.04081632653061,
                                         21.306122448979586,
                                         21.55102040816326,
                                         21.79591836734694,
                                         22.04081632653061,
                                         21.306122448979586,
                                         21.55102040816326,
                                         21.79591836734694,
                                         22.04081632653061,
                                         16.346938775510203,
                                         16.530612244897956,
                                         16.71428571428571,
                                         16.897959183673468,
                                         11.142857142857142,
                                         11.265306122448978,
                                         11.387755102040815,
                                         11.510204081632654,
                                         5.6938775510204085,
                                         5.755102040816325,
                                         5.816326530612244,
                                         5.877551020408163,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.428571428571427,
                                         7.5102040816326525,
                                         14.857142857142858,
                                         15.020408163265303,
                                         15.183673469387752,
                                         15.346938775510203,
                                         22.77551020408163,
                                         23.0204081632653,
                                         23.265306122448976,
                                         23.510204081632654,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         23.755102040816325,
                                         23.999999999999993,
                                         24.24489795918367,
                                         24.489795918367346,
                                         16.163265306122447,
                                         16.326530612244895,
                                         16.489795918367346,
                                         16.653061224489797,
                                         8.244897959183675,
                                         8.326530612244897,
                                         8.408163265306122,
                                         8.489795918367346,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.428571428571427,
                                         7.5102040816326525,
                                         14.857142857142858,
                                         15.020408163265303,
                                         15.183673469387752,
                                         15.346938775510203,
                                         22.77551020408163,
                                         23.0204081632653,
                                         23.265306122448976,
                                         23.510204081632654,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         23.755102040816325,
                                         23.999999999999993,
                                         24.24489795918367,
                                         24.489795918367346,
                                         16.163265306122447,
                                         16.326530612244895,
                                         16.489795918367346,
                                         16.653061224489797,
                                         8.244897959183675,
                                         8.326530612244897,
                                         8.408163265306122,
                                         8.489795918367346,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.428571428571427,
                                         7.5102040816326525,
                                         14.857142857142858,
                                         15.020408163265303,
                                         15.183673469387752,
                                         15.346938775510203,
                                         22.77551020408163,
                                         23.0204081632653,
                                         23.265306122448976,
                                         23.510204081632654,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         23.755102040816325,
                                         23.999999999999993,
                                         24.24489795918367,
                                         24.489795918367346,
                                         16.163265306122447,
                                         16.326530612244895,
                                         16.489795918367346,
                                         16.653061224489797,
                                         8.244897959183675,
                                         8.326530612244897,
                                         8.408163265306122,
                                         8.489795918367346,
                                         7.265306122448979,
                                         7.346938775510203,
                                         7.428571428571427,
                                         7.5102040816326525,
                                         14.857142857142858,
                                         15.020408163265303,
                                         15.183673469387752,
                                         15.346938775510203,
                                         22.77551020408163,
                                         23.0204081632653,
                                         23.265306122448976,
                                         23.510204081632654,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         31.0204081632653,
                                         31.346938775510196,
                                         31.6734693877551,
                                         32.,
                                         23.755102040816325,
                                         23.999999999999993,
                                         24.24489795918367,
                                         24.489795918367346,
                                         16.163265306122447,
                                         16.326530612244895,
                                         16.489795918367346,
                                         16.653061224489797,
                                         8.244897959183675,
                                         8.326530612244897,
                                         8.408163265306122,
                                         8.489795918367346,
                                         5.938775510204081,
                                         6.,
                                         6.061224489795918,
                                         6.122448979591836,
                                         12.122448979591837,
                                         12.244897959183673,
                                         12.36734693877551,
                                         12.489795918367344,
                                         18.551020408163264,
                                         18.73469387755102,
                                         18.918367346938773,
                                         19.10204081632653,
                                         25.224489795918366,
                                         25.469387755102034,
                                         25.71428571428571,
                                         25.959183673469383,
                                         25.224489795918366,
                                         25.469387755102034,
                                         25.71428571428571,
                                         25.959183673469383,
                                         25.224489795918366,
                                         25.469387755102034,
                                         25.71428571428571,
                                         25.959183673469383,
                                         25.224489795918366,
                                         25.469387755102034,
                                         25.71428571428571,
                                         25.959183673469383,
                                         19.285714285714285,
                                         19.46938775510204,
                                         19.653061224489797,
                                         19.836734693877546,
                                         13.102040816326529,
                                         13.224489795918364,
                                         13.346938775510203,
                                         13.46938775510204,
                                         6.673469387755102,
                                         6.73469387755102,
                                         6.795918367346939,
                                         6.857142857142856,
                                         4.285714285714285,
                                         4.326530612244897,
                                         4.36734693877551,
                                         4.408163265306122,
                                         8.73469387755102,
                                         8.816326530612244,
                                         8.89795918367347,
                                         8.979591836734693,
                                         13.346938775510203,
                                         13.46938775510204,
                                         13.591836734693876,
                                         13.714285714285714,
                                         18.122448979591834,
                                         18.285714285714285,
                                         18.448979591836732,
                                         18.612244897959183,
                                         18.122448979591834,
                                         18.285714285714285,
                                         18.448979591836732,
                                         18.612244897959183,
                                         18.122448979591834,
                                         18.285714285714285,
                                         18.448979591836732,
                                         18.612244897959183,
                                         18.122448979591834,
                                         18.285714285714285,
                                         18.448979591836732,
                                         18.612244897959183,
                                         13.836734693877549,
                                         13.959183673469385,
                                         14.081632653061224,
                                         14.20408163265306,
                                         9.387755102040817,
                                         9.46938775510204,
                                         9.551020408163264,
                                         9.632653061224488,
                                         4.775510204081632,
                                         4.816326530612244,
                                         4.857142857142857,
                                         4.8979591836734695,
                                         2.3061224489795915,
                                         2.326530612244898,
                                         2.346938775510204,
                                         2.36734693877551,
                                         4.693877551020408,
                                         4.73469387755102,
                                         4.775510204081632,
                                         4.816326530612244,
                                         7.163265306122448,
                                         7.224489795918367,
                                         7.285714285714285,
                                         7.346938775510203,
                                         9.714285714285714,
                                         9.795918367346939,
                                         9.877551020408163,
                                         9.959183673469386,
                                         9.714285714285714,
                                         9.795918367346939,
                                         9.877551020408163,
                                         9.959183673469386,
                                         9.714285714285714,
                                         9.795918367346939,
                                         9.877551020408163,
                                         9.959183673469386,
                                         9.714285714285714,
                                         9.795918367346939,
                                         9.877551020408163,
                                         9.959183673469386,
                                         7.408163265306122,
                                         7.469387755102041,
                                         7.530612244897959,
                                         7.591836734693876,
                                         5.020408163265306,
                                         5.061224489795918,
                                         5.1020408163265305,
                                         5.142857142857142,
                                         2.5510204081632653,
                                         2.571428571428571,
                                         2.5918367346938775,
                                         2.6122448979591835,
                                         2.6326530612244894,
                                         2.6530612244897958,
                                         2.6734693877551017,
                                         2.693877551020408,
                                         5.346938775510203,
                                         5.387755102040816,
                                         5.428571428571428,
                                         5.469387755102041,
                                         8.142857142857142,
                                         8.204081632653061,
                                         8.26530612244898,
                                         8.326530612244898,
                                         11.020408163265305,
                                         11.10204081632653,
                                         11.183673469387756,
                                         11.26530612244898,
                                         11.020408163265305,
                                         11.10204081632653,
                                         11.183673469387756,
                                         11.26530612244898,
                                         11.020408163265305,
                                         11.10204081632653,
                                         11.183673469387756,
                                         11.26530612244898,
                                         11.020408163265305,
                                         11.10204081632653,
                                         11.183673469387756,
                                         11.26530612244898,
                                         8.387755102040815,
                                         8.448979591836734,
                                         8.510204081632653,
                                         8.571428571428571,
                                         5.673469387755102,
                                         5.7142857142857135,
                                         5.755102040816326,
                                         5.795918367346938,
                                         2.877551020408163,
                                         2.897959183673469,
                                         2.9183673469387754,
                                         2.9387755102040813,
                                         5.591836734693877,
                                         5.63265306122449,
                                         5.673469387755102,
                                         5.7142857142857135,
                                         11.346938775510203,
                                         11.428571428571429,
                                         11.51020408163265,
                                         11.591836734693876,
                                         17.26530612244898,
                                         17.387755102040817,
                                         17.51020408163265,
                                         17.632653061224488,
                                         23.346938775510203,
                                         23.51020408163265,
                                         23.6734693877551,
                                         23.83673469387755,
                                         23.346938775510203,
                                         23.51020408163265,
                                         23.6734693877551,
                                         23.83673469387755,
                                         23.346938775510203,
                                         23.51020408163265,
                                         23.6734693877551,
                                         23.83673469387755,
                                         23.346938775510203,
                                         23.51020408163265,
                                         23.6734693877551,
                                         23.83673469387755,
                                         17.755102040816325,
                                         17.877551020408163,
                                         18.,
                                         18.122448979591834,
                                         12.,
                                         12.081632653061224,
                                         12.163265306122447,
                                         12.244897959183673,
                                         6.081632653061224,
                                         6.1224489795918355,
                                         6.163265306122449,
                                         6.204081632653061,
                                         8.877551020408163,
                                         8.938775510204081,
                                         9.,
                                         9.061224489795917,
                                         17.999999999999996,
                                         18.122448979591837,
                                         18.24489795918367,
                                         18.36734693877551,
                                         27.36734693877551,
                                         27.551020408163264,
                                         27.734693877551017,
                                         27.918367346938773,
                                         36.97959183673469,
                                         37.22448979591837,
                                         37.46938775510204,
                                         37.71428571428571,
                                         36.97959183673469,
                                         37.22448979591837,
                                         37.46938775510204,
                                         37.71428571428571,
                                         36.97959183673469,
                                         37.22448979591837,
                                         37.46938775510204,
                                         37.71428571428571,
                                         36.97959183673469,
                                         37.22448979591837,
                                         37.46938775510204,
                                         37.71428571428571,
                                         28.10204081632653,
                                         28.285714285714285,
                                         28.46938775510204,
                                         28.653061224489793,
                                         18.97959183673469,
                                         19.10204081632653,
                                         19.224489795918366,
                                         19.346938775510203,
                                         9.612244897959183,
                                         9.6734693877551,
                                         9.73469387755102,
                                         9.795918367346939,
                                         12.489795918367346,
                                         12.571428571428571,
                                         12.653061224489797,
                                         12.734693877551019,
                                         25.306122448979586,
                                         25.46938775510204,
                                         25.632653061224488,
                                         25.795918367346935,
                                         38.44897959183673,
                                         38.6938775510204,
                                         38.938775510204074,
                                         39.183673469387756,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         39.42857142857142,
                                         39.6734693877551,
                                         39.91836734693877,
                                         40.16326530612245,
                                         26.612244897959183,
                                         26.77551020408163,
                                         26.938775510204078,
                                         27.102040816326532,
                                         13.46938775510204,
                                         13.551020408163263,
                                         13.63265306122449,
                                         13.714285714285715,
                                         12.489795918367346,
                                         12.571428571428571,
                                         12.653061224489797,
                                         12.734693877551019,
                                         25.306122448979586,
                                         25.46938775510204,
                                         25.632653061224488,
                                         25.795918367346935,
                                         38.44897959183673,
                                         38.6938775510204,
                                         38.938775510204074,
                                         39.183673469387756,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         39.42857142857142,
                                         39.6734693877551,
                                         39.91836734693877,
                                         40.16326530612245,
                                         26.612244897959183,
                                         26.77551020408163,
                                         26.938775510204078,
                                         27.102040816326532,
                                         13.46938775510204,
                                         13.551020408163263,
                                         13.63265306122449,
                                         13.714285714285715,
                                         12.489795918367346,
                                         12.571428571428571,
                                         12.653061224489797,
                                         12.734693877551019,
                                         25.306122448979586,
                                         25.46938775510204,
                                         25.632653061224488,
                                         25.795918367346935,
                                         38.44897959183673,
                                         38.6938775510204,
                                         38.938775510204074,
                                         39.183673469387756,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         39.42857142857142,
                                         39.6734693877551,
                                         39.91836734693877,
                                         40.16326530612245,
                                         26.612244897959183,
                                         26.77551020408163,
                                         26.938775510204078,
                                         27.102040816326532,
                                         13.46938775510204,
                                         13.551020408163263,
                                         13.63265306122449,
                                         13.714285714285715,
                                         12.489795918367346,
                                         12.571428571428571,
                                         12.653061224489797,
                                         12.734693877551019,
                                         25.306122448979586,
                                         25.46938775510204,
                                         25.632653061224488,
                                         25.795918367346935,
                                         38.44897959183673,
                                         38.6938775510204,
                                         38.938775510204074,
                                         39.183673469387756,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         51.91836734693877,
                                         52.244897959183675,
                                         52.57142857142857,
                                         52.897959183673464,
                                         39.42857142857142,
                                         39.6734693877551,
                                         39.91836734693877,
                                         40.16326530612245,
                                         26.612244897959183,
                                         26.77551020408163,
                                         26.938775510204078,
                                         27.102040816326532,
                                         13.46938775510204,
                                         13.551020408163263,
                                         13.63265306122449,
                                         13.714285714285715,
                                         9.857142857142856,
                                         9.918367346938775,
                                         9.979591836734693,
                                         10.040816326530612,
                                         19.959183673469386,
                                         20.081632653061224,
                                         20.20408163265306,
                                         20.326530612244895,
                                         30.306122448979586,
                                         30.489795918367346,
                                         30.6734693877551,
                                         30.857142857142854,
                                         40.897959183673464,
                                         41.14285714285713,
                                         41.38775510204081,
                                         41.63265306122449,
                                         40.897959183673464,
                                         41.14285714285713,
                                         41.38775510204081,
                                         41.63265306122449,
                                         40.897959183673464,
                                         41.14285714285713,
                                         41.38775510204081,
                                         41.63265306122449,
                                         40.897959183673464,
                                         41.14285714285713,
                                         41.38775510204081,
                                         41.63265306122449,
                                         31.040816326530607,
                                         31.224489795918366,
                                         31.408163265306115,
                                         31.591836734693874,
                                         20.93877551020408,
                                         21.061224489795915,
                                         21.183673469387752,
                                         21.30612244897959,
                                         10.591836734693878,
                                         10.653061224489795,
                                         10.714285714285714,
                                         10.77551020408163,
                                         6.8979591836734695,
                                         6.938775510204081,
                                         6.979591836734693,
                                         7.020408163265305,
                                         13.959183673469386,
                                         14.04081632653061,
                                         14.122448979591837,
                                         14.204081632653061,
                                         21.18367346938775,
                                         21.30612244897959,
                                         21.428571428571427,
                                         21.55102040816326,
                                         28.571428571428566,
                                         28.734693877551017,
                                         28.897959183673464,
                                         29.061224489795915,
                                         28.571428571428566,
                                         28.734693877551017,
                                         28.897959183673464,
                                         29.061224489795915,
                                         28.571428571428566,
                                         28.734693877551017,
                                         28.897959183673464,
                                         29.061224489795915,
                                         28.571428571428566,
                                         28.734693877551017,
                                         28.897959183673464,
                                         29.061224489795915,
                                         21.6734693877551,
                                         21.795918367346935,
                                         21.918367346938773,
                                         22.040816326530614,
                                         14.612244897959183,
                                         14.693877551020407,
                                         14.775510204081632,
                                         14.857142857142858,
                                         7.387755102040815,
                                         7.428571428571428,
                                         7.469387755102041,
                                         7.5102040816326525,
                                         3.6122448979591835,
                                         3.6326530612244894,
                                         3.6530612244897958,
                                         3.6734693877551017,
                                         7.3061224489795915,
                                         7.346938775510203,
                                         7.387755102040815,
                                         7.428571428571428,
                                         11.081632653061224,
                                         11.142857142857142,
                                         11.20408163265306,
                                         11.26530612244898,
                                         14.938775510204081,
                                         15.020408163265305,
                                         15.102040816326529,
                                         15.183673469387756,
                                         14.938775510204081,
                                         15.020408163265305,
                                         15.102040816326529,
                                         15.183673469387756,
                                         14.938775510204081,
                                         15.020408163265305,
                                         15.102040816326529,
                                         15.183673469387756,
                                         14.938775510204081,
                                         15.020408163265305,
                                         15.102040816326529,
                                         15.183673469387756,
                                         11.326530612244898,
                                         11.387755102040815,
                                         11.448979591836734,
                                         11.510204081632653,
                                         7.632653061224489,
                                         7.673469387755102,
                                         7.7142857142857135,
                                         7.755102040816326,
                                         3.8571428571428568,
                                         3.877551020408163,
                                         3.897959183673469,
                                         3.9183673469387754};
  const std::array<int, 4> in_shape = {{3, 10, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}

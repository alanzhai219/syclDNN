/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_batchnorm_tests.py.
// Results calculated using Tensorflow v2.11.0.

#include <gtest/gtest.h>

#include "portdnn/data_format.h"

#include "portdnn/batchnorm/direction.h"
#include "portdnn/batchnorm/params.h"

#include "test/batchnorm/batchnorm_fixture.h"
#include "test/types/cartesian_product.h"
#include "test/types/data_format_types.h"
#include "test/types/kernel_data_types.h"
#include "test/types/nested_pairs_to_triple.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include <vector>

using DataTypeList = sycldnn::types::KernelDataTypes;
using Backends = sycldnn::types::AllBackendTypes;
using DataFormats = sycldnn::types::DataFormatTypes;

using TypeBackendPairs =
    sycldnn::types::CartesianProduct<DataTypeList, Backends>::type;
using TypeBackendFormatTriple =
    sycldnn::types::CartesianProduct<TypeBackendPairs, DataFormats>::type;

using TestTriples =
    sycldnn::types::NestedPairsToTriple<TypeBackendFormatTriple>::type;
using GTestTypeTriples = sycldnn::types::ToGTestTypes<TestTriples>::type;

using namespace sycldnn;  // NOLINT(google-build-using-namespace)
template <typename Triple>
using BatchnormForwardTraining = BatchNormFixture<Triple, batchnorm::Forward>;
TYPED_TEST_CASE(BatchnormForwardTraining, GTestTypeTriples);
TYPED_TEST(BatchnormForwardTraining, 1x1x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.};
  const std::vector<DataType> exp_running_var = {0.99};
  const std::vector<DataType> exp_out = {1.};
  const std::array<int, 4> in_shape = {{1, 1, 1, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x1x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 1, 1, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x1x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1., 2., 3., 4., 5., 5.949999999999999, 1.01, 2.01};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95, 5.9399999999999995,
                                                 6.93, 0.99};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319};
  const std::array<int, 4> in_shape = {{1, 1, 1, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x1x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.01625};
  const std::vector<DataType> exp_running_var = {1.00734375};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466};
  const std::array<int, 4> in_shape = {{1, 1, 8, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x1x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 1, 8, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x1x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1.0175, 2.01125,           2.99875, 3.9925,
      4.98,   5.967499999999999, 1.02125, 2.00875};
  const std::vector<DataType> exp_running_var = {
      1.009375, 1.99859375, 2.9885937499999997, 3.979375,
      4.9725,   5.959375,   6.94859375,         1.00859375};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664};
  const std::array<int, 4> in_shape = {{1, 1, 8, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x1x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.017777777777778};
  const std::vector<DataType> exp_running_var = {1.007283950617284};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197};
  const std::array<int, 4> in_shape = {{1, 1, 9, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x1x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 1, 9, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x1x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.02,
                                                  2.008888888888889,
                                                  2.9977777777777774,
                                                  3.9922222222222223,
                                                  4.981111111111112,
                                                  5.97,
                                                  1.018888888888889,
                                                  2.0077777777777777};
  const std::vector<DataType> exp_running_var = {
      1.0122222222222221, 2.0009876543209875, 2.9872839506172837,
      3.977283950617284,  4.970987654320988,  5.962222222222222,
      6.950987654320987,  1.007283950617284};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.};
  const std::array<int, 4> in_shape = {{1, 1, 9, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.01625};
  const std::vector<DataType> exp_running_var = {1.00734375};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466};
  const std::array<int, 4> in_shape = {{1, 8, 1, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 8, 1, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1.0175, 2.01125,           2.99875, 3.9925,
      4.98,   5.967499999999999, 1.02125, 2.00875};
  const std::vector<DataType> exp_running_var = {
      1.009375, 1.99859375, 2.9885937499999997, 3.979375,
      4.9725,   5.959375,   6.94859375,         1.00859375};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664};
  const std::array<int, 4> in_shape = {{1, 8, 1, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0196875};
  const std::vector<DataType> exp_running_var = {1.009677734375};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1.02,       2.00984375, 2.9996875,  3.9903125,
      4.98015625, 5.97,       1.01984375, 2.0096875};
  const std::vector<DataType> exp_running_var = {
      1.0103125,        2.00015380859375, 2.989677734375,     3.979677734375,
      4.97015380859375, 5.9603125,        6.9501538085937495, 1.009677734375};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0195833333333333};
  const std::vector<DataType> exp_running_var = {1.0101215277777778};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x8x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1.019861111111111, 2.0101388888888887,
      2.999722222222222, 3.99,
      4.980277777777778, 5.96986111111111,
      1.020138888888889, 2.0097222222222224};
  const std::vector<DataType> exp_running_var = {
      1.0101369598765433, 2.000136959876543, 2.9899922839506172,
      3.979722222222222,  4.969992283950617, 5.960136959876543,
      6.950136959876543,  1.0099922839506172};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803};
  const std::array<int, 4> in_shape = {{1, 8, 9, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.017777777777778};
  const std::vector<DataType> exp_running_var = {1.007283950617284};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197};
  const std::array<int, 4> in_shape = {{1, 9, 1, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 9, 1, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.02,
                                                  2.008888888888889,
                                                  2.9977777777777774,
                                                  3.9922222222222223,
                                                  4.981111111111112,
                                                  5.97,
                                                  1.018888888888889,
                                                  2.0077777777777777};
  const std::vector<DataType> exp_running_var = {
      1.0122222222222221, 2.0009876543209875, 2.9872839506172837,
      3.977283950617284,  4.970987654320988,  5.962222222222222,
      6.950987654320987,  1.007283950617284};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.};
  const std::array<int, 4> in_shape = {{1, 9, 1, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0195833333333333};
  const std::vector<DataType> exp_running_var = {1.0101215277777778};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1.019861111111111, 2.0101388888888887,
      2.999722222222222, 3.99,
      4.980277777777778, 5.96986111111111,
      1.020138888888889, 2.0097222222222224};
  const std::vector<DataType> exp_running_var = {
      1.0101369598765433, 2.000136959876543, 2.9899922839506172,
      3.979722222222222,  4.969992283950617, 5.960136959876543,
      6.950136959876543,  1.0099922839506172};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803};
  const std::array<int, 4> in_shape = {{1, 9, 8, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.019753086419753};
  const std::vector<DataType> exp_running_var = {1.0102408169486359};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 1x9x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.019753086419753,
                                                  2.0098765432098764,
                                                  3.,
                                                  3.9901234567901236,
                                                  4.980246913580247,
                                                  5.969753086419753,
                                                  1.0198765432098766,
                                                  2.01};
  const std::vector<DataType> exp_running_var = {
      1.0102408169486359, 1.9998750190519738, 2.989753086419753,
      3.9798750190519736, 4.970240816948636,  5.960240816948636,
      6.949875019051974,  1.009753086419753};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319};
  const std::array<int, 4> in_shape = {{1, 9, 9, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.01};
  const std::vector<DataType> exp_running_var = {0.9966666666666667};
  const std::vector<DataType> exp_out = {1., 1.999500374687773,
                                         2.9990007493755466};
  const std::array<int, 4> in_shape = {{3, 1, 1, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {1., 2., 3., 4., 1., 1., 2., 3.,
                                         4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 1, 1, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0133333333333334,
                                                  2.013333333333333,
                                                  2.9966666666666666,
                                                  3.9966666666666666,
                                                  4.98,
                                                  5.963333333333333,
                                                  1.0233333333333334,
                                                  2.006666666666667};
  const std::vector<DataType> exp_running_var = {
      1.0055555555555555, 1.9955555555555555, 2.9855555555555555,
      3.9755555555555557, 4.976666666666667,  5.955555555555555,
      6.945555555555555,  1.0055555555555555};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664};
  const std::array<int, 4> in_shape = {{3, 1, 1, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0191666666666668};
  const std::vector<DataType> exp_running_var = {1.0090972222222223};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197};
  const std::array<int, 4> in_shape = {{3, 1, 8, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 1, 8, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.02,
                                                  2.0095833333333335,
                                                  2.9991666666666665,
                                                  3.9908333333333332,
                                                  4.980416666666667,
                                                  5.97,
                                                  1.0195833333333333,
                                                  2.0091666666666668};
  const std::vector<DataType> exp_running_var = {
      1.0108333333333333, 2.0003993055555553, 2.989097222222222,
      3.9790972222222223, 4.9703993055555555, 5.9608333333333325,
      6.950399305555555,  1.0090972222222223};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.};
  const std::array<int, 4> in_shape = {{3, 1, 8, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.018888888888889};
  const std::vector<DataType> exp_running_var = {1.010246913580247};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773};
  const std::array<int, 4> in_shape = {{3, 1, 9, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 1, 9, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x1x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1.0196296296296297, 2.0103703703703704,
      2.999259259259259,  3.99,
      4.980740740740741,  5.969629629629629,
      1.0203703703703704, 2.009259259259259};
  const std::vector<DataType> exp_running_var = {
      1.0103566529492456, 2.0003566529492454, 2.9899451303155002,
      3.9792592592592593, 4.969945130315501,  5.960356652949245,
      6.950356652949245,  1.0099451303155007};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803};
  const std::array<int, 4> in_shape = {{3, 1, 9, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0191666666666668};
  const std::vector<DataType> exp_running_var = {1.0090972222222223};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197};
  const std::array<int, 4> in_shape = {{3, 8, 1, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 8, 1, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.02,
                                                  2.0095833333333335,
                                                  2.9991666666666665,
                                                  3.9908333333333332,
                                                  4.980416666666667,
                                                  5.97,
                                                  1.0195833333333333,
                                                  2.0091666666666668};
  const std::vector<DataType> exp_running_var = {
      1.0108333333333333, 2.0003993055555553, 2.989097222222222,
      3.9790972222222223, 4.9703993055555555, 5.9608333333333325,
      6.950399305555555,  1.0090972222222223};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.};
  const std::array<int, 4> in_shape = {{3, 8, 1, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.01984375};
  const std::vector<DataType> exp_running_var = {1.0100496419270832};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1.0199479166666667, 2.0100520833333335,
      2.999895833333333,  3.99,
      4.980104166666667,  5.9699479166666665,
      1.0200520833333333, 2.009895833333333};
  const std::vector<DataType> exp_running_var = {
      1.0100518120659723, 2.0000518120659723, 2.9899989149305553,
      3.9798958333333334, 4.969998914930556,  5.960051812065972,
      6.950051812065972,  1.0099989149305555};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803};
  const std::array<int, 4> in_shape = {{3, 8, 8, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0199074074074075};
  const std::vector<DataType> exp_running_var = {1.0100917352537724};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x8x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0199074074074075,
                                                  2.0099537037037036,
                                                  3.,
                                                  3.9900462962962964,
                                                  4.980092592592593,
                                                  5.9699074074074066,
                                                  1.0199537037037036,
                                                  2.01};
  const std::vector<DataType> exp_running_var = {
      1.0100917352537724, 1.9999534893689985, 2.989907407407407,
      3.9799534893689987, 4.970091735253773,  5.960091735253772,
      6.9499534893689985, 1.0099074074074075};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319};
  const std::array<int, 4> in_shape = {{3, 8, 9, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.018888888888889};
  const std::vector<DataType> exp_running_var = {1.010246913580247};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773};
  const std::array<int, 4> in_shape = {{3, 9, 1, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 9, 1, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {
      1.0196296296296297, 2.0103703703703704,
      2.999259259259259,  3.99,
      4.980740740740741,  5.969629629629629,
      1.0203703703703704, 2.009259259259259};
  const std::vector<DataType> exp_running_var = {
      1.0103566529492456, 2.0003566529492454, 2.9899451303155002,
      3.9792592592592593, 4.969945130315501,  5.960356652949245,
      6.950356652949245,  1.0099451303155007};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803};
  const std::array<int, 4> in_shape = {{3, 9, 1, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0199074074074075};
  const std::vector<DataType> exp_running_var = {1.0100917352537724};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0199074074074075,
                                                  2.0099537037037036,
                                                  3.,
                                                  3.9900462962962964,
                                                  4.980092592592593,
                                                  5.9699074074074066,
                                                  1.0199537037037036,
                                                  2.01};
  const std::vector<DataType> exp_running_var = {
      1.0100917352537724, 1.9999534893689985, 2.989907407407407,
      3.9799534893689987, 4.970091735253773,  5.960091735253772,
      6.9499534893689985, 1.0099074074074075};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319};
  const std::array<int, 4> in_shape = {{3, 9, 8, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.0198765432098766};
  const std::vector<DataType> exp_running_var = {1.0099573235787227};
  const std::vector<DataType> exp_out = {1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466,
                                         3.9985011240633197,
                                         4.998001498751092,
                                         1.,
                                         1.999500374687773,
                                         2.9990007493755466};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1., 2., 3., 4., 5.};
  const std::vector<DataType> exp_running_var = {0.99, 1.98, 2.9699999999999998,
                                                 3.96, 4.95};
  const std::vector<DataType> exp_out = {
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4.,
      1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2.,
      3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1.,
      1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3.,
      4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1., 2., 3., 4., 1., 1.,
      2., 3., 4., 1., 1., 2., 3., 4., 1.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 5}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}
TYPED_TEST(BatchnormForwardTraining, 3x9x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_running_mean = {1.019917695473251,
                                                  2.0100411522633745,
                                                  2.9999588477366252,
                                                  3.990082304526749,
                                                  4.98,
                                                  5.96991769547325,
                                                  1.0200411522633746,
                                                  2.0099588477366255};
  const std::vector<DataType> exp_running_var = {
      1.0099993225964876, 1.9999586783857475, 2.9899586783857472,
      3.9799993225964876, 4.970082304526749,  5.959999322596487,
      6.949958678385747,  1.0099586783857475};
  const std::vector<DataType> exp_out = {1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664,
                                         4.998001498751092,
                                         0.5861398584901953,
                                         1.268237795416975,
                                         2.000249953134764,
                                         -1.2358444042374703,
                                         1.5917857259750132,
                                         3.,
                                         4.,
                                         2.9990007493755466,
                                         4.827720283019609,
                                         6.463524409166052,
                                         -1.9992501405957088,
                                         -5.70753321271241,
                                         0.7753571779250394,
                                         5.267624870634663,
                                         12.99550337218996,
                                         1.,
                                         2.,
                                         3.,
                                         4.,
                                         1.,
                                         -0.04107137012493428,
                                         3.7558749568782206,
                                         6.998501124063319,
                                         3.9985011240633197,
                                         6.241580424529413,
                                         -0.4635244091660504,
                                         0.0004999062695274503,
                                         -3.4716888084749407,
                                         1.1835714519500262,
                                         6.023499827512882,
                                         1.0014988759366803,
                                         1.999500374687773,
                                         3.413860141509805,
                                         4.731762204583026,
                                         5.999750046865236,
                                         -7.9433776169498795,
                                         0.36714290390005255,
                                         4.511749913756441,
                                         9.99700224812664};
  const std::array<int, 4> in_shape = {{3, 9, 9, 8}};
  const bool is_training = true;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_beta_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_input_mean_val = 6.0;
  const DataType max_input_var_val = 7.0;
  this->test_batchnorm(exp_running_mean, exp_running_var, exp_out, params,
                       max_input_val, max_beta_val, max_gamma_val,
                       max_input_mean_val, max_input_var_val);
}

/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_batchnorm_tests.py.
// Results calculated using Tensorflow v2.11.0.

#include <gtest/gtest.h>

#include "portdnn/data_format.h"

#include "portdnn/batchnorm/direction.h"
#include "portdnn/batchnorm/params.h"

#include "test/batchnorm/batchnorm_fixture.h"
#include "test/types/cartesian_product.h"
#include "test/types/data_format_types.h"
#include "test/types/kernel_data_types.h"
#include "test/types/nested_pairs_to_triple.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include <vector>

using DataTypeList = sycldnn::types::KernelDataTypes;
using Backends = sycldnn::types::AllBackendTypes;
using DataFormats = sycldnn::types::DataFormatTypes;

using TypeBackendPairs =
    sycldnn::types::CartesianProduct<DataTypeList, Backends>::type;
using TypeBackendFormatTriple =
    sycldnn::types::CartesianProduct<TypeBackendPairs, DataFormats>::type;

using TestTriples =
    sycldnn::types::NestedPairsToTriple<TypeBackendFormatTriple>::type;
using GTestTypeTriples = sycldnn::types::ToGTestTypes<TestTriples>::type;

using namespace sycldnn;  // NOLINT(google-build-using-namespace)
template <typename Triple>
using BatchnormGradientFrozen = BatchNormFixture<Triple, batchnorm::Gradient>;
TYPED_TEST_CASE(BatchnormGradientFrozen, GTestTypeTriples);
TYPED_TEST(BatchnormGradientFrozen, 1x1x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {0.9995003746877732};
  const std::vector<DataType> beta_grad = {1.};
  const std::vector<DataType> gamma_grad = {0.};
  const std::array<int, 4> in_shape = {{1, 1, 1, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {0.9995003746877732,
                                          2.8277202830196093, 5.195286613749076,
                                          7.999000187460945, 2.23584440423747};
  const std::vector<DataType> beta_grad = {1., 2., 3., 4., 1.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 1, 1, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> gamma_grad = {0.,
                                            0.,
                                            0.,
                                            0.,
                                            0.,
                                            -4.082142740249869,
                                            1.1338124353173311,
                                            3.998001498751093};
  const std::array<int, 4> in_shape = {{1, 1, 1, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {20.};
  const std::vector<DataType> gamma_grad = {34.98251311407206};
  const std::array<int, 4> in_shape = {{1, 1, 8, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988};
  const std::vector<DataType> beta_grad = {20., 20., 20., 20., 20.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 1, 8, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279};
  const std::vector<DataType> beta_grad = {8., 16., 24., 32.,
                                           8., 16., 24., 32.};
  const std::vector<DataType> gamma_grad = {
      13.993005245628826,  12.724741273588243, -1.7317622045830254,
      -11.998500281191417, -7.154702093559904, -21.227142249299316,
      19.27481140039463,   27.986010491257648};
  const std::array<int, 4> in_shape = {{1, 1, 8, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732};
  const std::vector<DataType> beta_grad = {21.};
  const std::vector<DataType> gamma_grad = {37.98101423813538};
  const std::array<int, 4> in_shape = {{1, 1, 9, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747};
  const std::vector<DataType> beta_grad = {21., 22., 23., 24., 21.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 1, 9, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {9., 18., 27., 36.,
                                           9., 18., 27., 36.};
  const std::vector<DataType> gamma_grad = {
      17.99100674437992,   11.310881132078439, -3.463524409166051,
      -13.998250328056653, -7.601870974407398, -22.04357079734929,
      19.27481140039463,   27.986010491257648};
  const std::array<int, 4> in_shape = {{1, 1, 9, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {20.};
  const std::vector<DataType> gamma_grad = {34.98251311407206};
  const std::array<int, 4> in_shape = {{1, 8, 1, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988};
  const std::vector<DataType> beta_grad = {20., 20., 20., 20., 20.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 8, 1, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279};
  const std::vector<DataType> beta_grad = {8., 16., 24., 32.,
                                           8., 16., 24., 32.};
  const std::vector<DataType> gamma_grad = {
      13.993005245628826,  12.724741273588243, -1.7317622045830254,
      -11.998500281191417, -7.154702093559904, -21.227142249299316,
      19.27481140039463,   27.986010491257648};
  const std::array<int, 4> in_shape = {{1, 8, 1, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093};
  const std::vector<DataType> beta_grad = {160.};
  const std::vector<DataType> gamma_grad = {319.8401199000874};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988};
  const std::vector<DataType> beta_grad = {160., 160., 160., 160., 160.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {64., 128., 192., 256.,
                                           64., 128., 192., 256.};
  const std::vector<DataType> gamma_grad = {
      127.93604796003494,  89.07318891511773,   -3.463524409166051,
      -123.98450290564465, -56.790447867631705, -156.75428122559498,
      143.99417928530096,  247.87609292256775};
  const std::array<int, 4> in_shape = {{1, 8, 8, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {180.};
  const std::vector<DataType> gamma_grad = {349.82513114072066};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988};
  const std::vector<DataType> beta_grad = {180., 180., 180., 180., 180.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {72., 144., 216., 288.,
                                           72., 144., 216., 288.};
  const std::vector<DataType> gamma_grad = {
      142.92855358035155, 103.21179033021579, -3.463524409166051,
      -143.982003374297,  -63.49798108034411, -177.16499492684432,
      164.4028031210129,  279.8601049125765};
  const std::array<int, 4> in_shape = {{1, 8, 9, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732};
  const std::vector<DataType> beta_grad = {21.};
  const std::vector<DataType> gamma_grad = {37.98101423813538};
  const std::array<int, 4> in_shape = {{1, 9, 1, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747};
  const std::vector<DataType> beta_grad = {21., 22., 23., 24., 21.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 9, 1, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {9., 18., 27., 36.,
                                           9., 18., 27., 36.};
  const std::vector<DataType> gamma_grad = {
      17.99100674437992,   11.310881132078439, -3.463524409166051,
      -13.998250328056653, -7.601870974407398, -22.04357079734929,
      19.27481140039463,   27.986010491257648};
  const std::array<int, 4> in_shape = {{1, 9, 1, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {180.};
  const std::vector<DataType> gamma_grad = {349.82513114072066};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988};
  const std::vector<DataType> beta_grad = {180., 180., 180., 180., 180.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {72., 144., 216., 288.,
                                           72., 144., 216., 288.};
  const std::vector<DataType> gamma_grad = {
      142.92855358035155, 103.21179033021579, -3.463524409166051,
      -143.982003374297,  -63.49798108034411, -177.16499492684432,
      164.4028031210129,  279.8601049125765};
  const std::array<int, 4> in_shape = {{1, 9, 8, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732};
  const std::vector<DataType> beta_grad = {201.};
  const std::vector<DataType> gamma_grad = {399.8001498751093};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747};
  const std::vector<DataType> beta_grad = {201., 202., 203., 204., 201.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {81., 162., 243., 324.,
                                           81., 162., 243., 324.};
  const std::vector<DataType> gamma_grad = {
      159.92005995004368,  113.10881132078444, 0.,
      -159.98000374921887, -71.54702093559901, -200.0249942722436,
      182.54380208609018,  323.8381213988385};
  const std::array<int, 4> in_shape = {{1, 9, 9, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197};
  const std::vector<DataType> beta_grad = {6.};
  const std::vector<DataType> gamma_grad = {7.996002997502186};
  const std::array<int, 4> in_shape = {{3, 1, 1, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241};
  const std::vector<DataType> beta_grad = {6., 9., 8., 7., 6.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 1, 1, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {3., 6., 9., 12., 3., 6., 9., 12.};
  const std::vector<DataType> gamma_grad = {
      3.998001498751093,   5.655440566039219,  -1.7317622045830254,
      -1.9997500468652363, -2.683013285084964, -8.980714028549711,
      7.936687047221318,   7.996002997502186};
  const std::array<int, 4> in_shape = {{3, 1, 1, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {60.};
  const std::vector<DataType> gamma_grad = {119.9400449625328};
  const std::array<int, 4> in_shape = {{3, 1, 8, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988};
  const std::vector<DataType> beta_grad = {60., 60., 60., 60., 60.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 1, 8, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {24., 48., 72., 96.,
                                           24., 48., 72., 96.};
  const std::vector<DataType> gamma_grad = {
      47.976017985013115, 32.518783254725506,  -3.463524409166051,
      -43.9945010310352,  -21.016937399832212, -58.782855459598125,
      53.289184459914566, 87.95603297252406};
  const std::array<int, 4> in_shape = {{3, 1, 8, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197};
  const std::vector<DataType> beta_grad = {66.};
  const std::vector<DataType> gamma_grad = {126.93654758534721};
  const std::array<int, 4> in_shape = {{3, 1, 9, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241};
  const std::vector<DataType> beta_grad = {66., 69., 68., 67., 66.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 1, 9, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {27., 54., 81., 108.,
                                           27., 54., 81., 108.};
  const std::vector<DataType> gamma_grad = {
      52.97351985845198,  39.58808396227453,  -3.463524409166051,
      -53.99325126536138, -23.25278180406968, -66.94714094009787,
      62.359683942453216, 99.95003746877734};
  const std::array<int, 4> in_shape = {{3, 1, 9, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {60.};
  const std::vector<DataType> gamma_grad = {119.9400449625328};
  const std::array<int, 4> in_shape = {{3, 8, 1, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988};
  const std::vector<DataType> beta_grad = {60., 60., 60., 60., 60.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 8, 1, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {24., 48., 72., 96.,
                                           24., 48., 72., 96.};
  const std::vector<DataType> gamma_grad = {
      47.976017985013115, 32.518783254725506,  -3.463524409166051,
      -43.9945010310352,  -21.016937399832212, -58.782855459598125,
      53.289184459914566, 87.95603297252406};
  const std::array<int, 4> in_shape = {{3, 8, 1, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {480.};
  const std::vector<DataType> gamma_grad = {949.5253559533846};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988};
  const std::vector<DataType> beta_grad = {480., 480., 480., 480., 480.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {192., 384., 576., 768.,
                                           192., 384., 576., 768.};
  const std::vector<DataType> gamma_grad = {
      382.808643505417,    272.87500731139227, -3.463524409166051,
      -383.95200899812573, -170.8185124837426, -471.0792722248354,
      436.5177875971725,   759.6202847627075};
  const std::array<int, 4> in_shape = {{3, 8, 8, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {540.};
  const std::vector<DataType> gamma_grad = {1069.4654009159174};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988};
  const std::vector<DataType> beta_grad = {540., 540., 540., 540., 540.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {216., 432., 648., 864.,
                                           216., 432., 648., 864.};
  const std::vector<DataType> gamma_grad = {
      429.78516111574237,  303.97993042460797, 0.,
      -429.94626007602636, -192.2826187644223, -530.6785562324836,
      488.67315962176986,  863.5683237302359};
  const std::array<int, 4> in_shape = {{3, 8, 9, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197};
  const std::vector<DataType> beta_grad = {66.};
  const std::vector<DataType> gamma_grad = {126.93654758534721};
  const std::array<int, 4> in_shape = {{3, 9, 1, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241};
  const std::vector<DataType> beta_grad = {66., 69., 68., 67., 66.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 9, 1, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {27., 54., 81., 108.,
                                           27., 54., 81., 108.};
  const std::vector<DataType> gamma_grad = {
      52.97351985845198,  39.58808396227453,  -3.463524409166051,
      -53.99325126536138, -23.25278180406968, -66.94714094009787,
      62.359683942453216, 99.95003746877734};
  const std::array<int, 4> in_shape = {{3, 9, 1, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093};
  const std::vector<DataType> beta_grad = {540.};
  const std::vector<DataType> gamma_grad = {1069.4654009159174};
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988};
  const std::vector<DataType> beta_grad = {540., 540., 540., 540., 540.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {216., 432., 648., 864.,
                                           216., 432., 648., 864.};
  const std::vector<DataType> gamma_grad = {
      429.78516111574237,  303.97993042460797, 0.,
      -429.94626007602636, -192.2826187644223, -530.6785562324836,
      488.67315962176986,  863.5683237302359};
  const std::array<int, 4> in_shape = {{3, 9, 8, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197,
      3.998001498751093,  0.9995003746877732, 1.9990007493755464,
      2.9985011240633197, 3.998001498751093,  0.9995003746877732,
      1.9990007493755464, 2.9985011240633197, 3.998001498751093,
      0.9995003746877732, 1.9990007493755464, 2.9985011240633197};
  const std::vector<DataType> beta_grad = {606.};
  const std::vector<DataType> gamma_grad = {1207.39645262283};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241,
      3.998001498751093,  1.4138601415098047, 3.463524409166051,
      5.999250140595709,  8.94337761694988,   0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   1.9990007493755464, 4.241580424529414,
      6.927048818332102,  1.9997500468652363, 4.47168880847494,
      2.9985011240633197, 5.655440566039219,  1.7317622045830254,
      3.9995000937304725, 6.70753321271241,   3.998001498751093,
      1.4138601415098047, 3.463524409166051,  5.999250140595709,
      8.94337761694988,   0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      1.9990007493755464, 4.241580424529414,  6.927048818332102,
      1.9997500468652363, 4.47168880847494,   2.9985011240633197,
      5.655440566039219,  1.7317622045830254, 3.9995000937304725,
      6.70753321271241,   3.998001498751093,  1.4138601415098047,
      3.463524409166051,  5.999250140595709,  8.94337761694988,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   1.9990007493755464,
      4.241580424529414,  6.927048818332102,  1.9997500468652363,
      4.47168880847494,   2.9985011240633197, 5.655440566039219,
      1.7317622045830254, 3.9995000937304725, 6.70753321271241};
  const std::vector<DataType> beta_grad = {606., 609., 608., 607., 606.};
  const std::vector<DataType> gamma_grad = {0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 5}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279,
      0.9995003746877732, 2.8277202830196093, 5.195286613749076,
      7.999000187460945,  2.23584440423747,   0.8164285480499737,
      2.2676248706346622, 11.994004496253279, 0.9995003746877732,
      2.8277202830196093, 5.195286613749076,  7.999000187460945,
      2.23584440423747,   0.8164285480499737, 2.2676248706346622,
      11.994004496253279, 0.9995003746877732, 2.8277202830196093,
      5.195286613749076,  7.999000187460945,  2.23584440423747,
      0.8164285480499737, 2.2676248706346622, 11.994004496253279};
  const std::vector<DataType> beta_grad = {243., 486., 729., 972.,
                                           243., 486., 729., 972.};
  const std::vector<DataType> gamma_grad = {
      483.7581813488821,  344.98187452839227,  -1.7317622045830254,
      -481.9397612945227, -217.32407609188195, -596.8092686245317,
      552.1666559995404,  967.5163626977642};
  const std::array<int, 4> in_shape = {{3, 9, 9, 8}};
  const bool is_training = false;
  const float momentum = 0.99;
  const float epsilon = 0.001;
  const auto params =
      getBatchNormParams(in_shape, is_training, momentum, epsilon);
  const DataType max_input_val = 5.0;
  const DataType max_gradient_val = 4.0;
  const DataType max_gamma_val = 5.0;
  const DataType max_pop_mean_val = 6.0;
  const DataType max_pop_var_val = 7.0;
  this->test_batchnorm(exp_grad, beta_grad, gamma_grad, params, max_input_val,
                       max_gradient_val, max_gamma_val, max_pop_mean_val,
                       max_pop_var_val);
}
